"use strict";var gr=Object.create;var Re=Object.defineProperty;var _r=Object.getOwnPropertyDescriptor;var yr=Object.getOwnPropertyNames;var Rr=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty;var xn=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),Tr=(n,e)=>{for(var t in e)Re(n,t,{get:e[t],enumerable:!0})},Gn=(n,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of yr(e))!br.call(n,r)&&r!==t&&Re(n,r,{get:()=>e[r],enumerable:!(s=_r(e,r))||s.enumerable});return n};var Vn=(n,e,t)=>(t=n!=null?gr(Rr(n)):{},Gn(e||!n||!n.__esModule?Re(t,"default",{value:n,enumerable:!0}):t,n)),kr=n=>Gn(Re({},"__esModule",{value:!0}),n);var ir=xn(l=>{"use strict";var We=Uint8Array.of(65,82,82,79,87,49),Dr=Uint8Array.of(255,255,255,255,0,0,0,0),v={V1:0,V2:1,V3:2,V4:3,V5:4},is={Little:0,Big:1},O={NONE:0,Schema:1,DictionaryBatch:2,RecordBatch:3,Tensor:4,SparseTensor:5},a={Dictionary:-1,NONE:0,Null:1,Int:2,Float:3,Binary:4,Utf8:5,Bool:6,Decimal:7,Date:8,Time:9,Timestamp:10,Interval:11,List:12,Struct:13,Union:14,FixedSizeBinary:15,FixedSizeList:16,Map:17,Duration:18,LargeBinary:19,LargeUtf8:20,LargeList:21,RunEndEncoded:22,BinaryView:23,Utf8View:24,ListView:25,LargeListView:26},J={HALF:0,SINGLE:1,DOUBLE:2},Y={DAY:0,MILLISECOND:1},_={SECOND:0,MILLISECOND:1,MICROSECOND:2,NANOSECOND:3},U={YEAR_MONTH:0,DAY_TIME:1,MONTH_DAY_NANO:2},ie={Sparse:0,Dense:1},oe=Uint8Array,sn=Uint16Array,rn=Uint32Array,Be=BigUint64Array,xe=Int8Array,os=Int16Array,N=Int32Array,D=BigInt64Array,as=Float32Array,Ee=Float64Array;function Fr(n){return n instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer}function Pr(n,e){let t=Math.log2(n)-3;return(e?[xe,os,N,D]:[oe,sn,rn,Be])[t]}var Cr=Object.getPrototypeOf(Int8Array);function cs(n){return n instanceof Cr}function us(n){return Array.isArray(n)||cs(n)}function on(n){return n===D||n===Be}function an(n,e){let t=0,s=n.length;if(s<=2147483648)do{let r=t+s>>>1;n[r]<=e?t=r+1:s=r}while(t<s);else do{let r=Math.trunc((t+s)/2);n[r]<=e?t=r+1:s=r}while(t<s);return t}function Ur(n,e=1){return(n*e+7&-8)/e}function vr(n,e=n.length){let t=Ur(e,n.BYTES_PER_ELEMENT);return n.length>t?n.subarray(0,t):n.length<t?ds(n,t):n}function ds(n,e,t=0){let s=new n.constructor(e);return s.set(n,t),s}function ls(n,e,t){for(;n.length<=e;)n=ds(n,n.length<<1,t?n.length:0);return n}function Mr(n){return n instanceof Date}function Wr(n){return typeof n[Symbol.iterator]=="function"}function cn(n,e,t){if(e(n))return n;throw new Error(t(n))}function P(n,e,t){return e=Array.isArray(e)?e:Object.values(e),cn(n,s=>e.includes(s),t??(()=>`${n} must be one of ${e}`))}function fs(n,e){for(let[t,s]of Object.entries(n))if(s===e)return t;return"<Unknown>"}var ae=n=>`Unsupported data type: "${fs(a,n)}" (id ${n})`,ce=(n,e,t=!0,s=null)=>({name:n,type:e,nullable:t,metadata:s});function hs(n){return Object.hasOwn(n,"name")&&ps(n.type)}function ps(n){return typeof(n==null?void 0:n.typeId)=="number"}function M(n,e="",t=!0){return hs(n)?n:ce(e,cn(n,ps,()=>"Data type expected."),t)}var Ge=n=>({typeId:n}),un=(n,e,t=!1,s=-1)=>({typeId:a.Dictionary,id:s,dictionary:n,indices:e||me(),ordered:t}),Es=()=>Ge(a.Null),W=(n=32,e=!0)=>({typeId:a.Int,bitWidth:P(n,[8,16,32,64]),signed:e,values:Pr(n,e)}),dn=()=>W(8),ln=()=>W(16),me=()=>W(32),fn=()=>W(64),ms=()=>W(8,!1),Is=()=>W(16,!1),gs=()=>W(32,!1),_s=()=>W(64,!1),Ie=(n=2)=>({typeId:a.Float,precision:P(n,J),values:[sn,as,Ee][n]}),Br=()=>Ie(J.HALF),ys=()=>Ie(J.SINGLE),Ve=()=>Ie(J.DOUBLE),Rs=()=>({typeId:a.Binary,offsets:N}),hn=()=>({typeId:a.Utf8,offsets:N}),bs=()=>Ge(a.Bool),ue=(n,e,t=128)=>({typeId:a.Decimal,precision:n,scale:e,bitWidth:P(t,[32,64,128,256]),values:t===32?N:Be}),xr=(n,e)=>ue(n,e,32),Gr=(n,e)=>ue(n,e,64),Vr=(n,e)=>ue(n,e,128),jr=(n,e)=>ue(n,e,256),je=n=>({typeId:a.Date,unit:P(n,Y),values:n===Y.DAY?N:D}),Ts=()=>je(Y.DAY),Hr=()=>je(Y.MILLISECOND),de=(n=_.MILLISECOND)=>{n=P(n,_);let e=n===_.SECOND||n===_.MILLISECOND?32:64;return{typeId:a.Time,unit:n,bitWidth:e,values:e===32?N:D}},Yr=()=>de(_.SECOND),Qr=()=>de(_.MILLISECOND),Kr=()=>de(_.MICROSECOND),qr=()=>de(_.NANOSECOND),pn=(n=_.MILLISECOND,e=null)=>({typeId:a.Timestamp,unit:P(n,_),timezone:e,values:D}),ks=(n=U.MONTH_DAY_NANO)=>({typeId:a.Interval,unit:P(n,U),values:n===U.MONTH_DAY_NANO?void 0:N}),En=n=>({typeId:a.List,children:[M(n)],offsets:N}),He=n=>({typeId:a.Struct,children:Array.isArray(n)&&hs(n[0])?n:Object.entries(n).map(([e,t])=>ce(e,t))}),Ss=(n,e,t,s)=>(t??(t=e.map((r,i)=>i)),{typeId:a.Union,mode:P(n,ie),typeIds:t,typeMap:t.reduce((r,i,o)=>(r[i]=o,r),{}),children:e.map((r,i)=>M(r,`_${i}`)),typeIdForValue:s,offsets:N}),Os=n=>({typeId:a.FixedSizeBinary,stride:n}),mn=(n,e)=>({typeId:a.FixedSizeList,stride:e,children:[M(n)]}),As=(n,e)=>({typeId:a.Map,keysSorted:n,children:[e],offsets:N}),zr=(n,e,t=!1)=>As(t,ce("entries",He([M(n,"key",!1),M(e,"value")]),!1)),Ns=(n=_.MILLISECOND)=>({typeId:a.Duration,unit:P(n,_),values:D}),ws=()=>({typeId:a.LargeBinary,offsets:D}),Ls=()=>({typeId:a.LargeUtf8,offsets:D}),Ds=n=>({typeId:a.LargeList,children:[M(n)],offsets:D}),Fs=(n,e)=>({typeId:a.RunEndEncoded,children:[cn(M(n,"run_ends"),t=>t.type.typeId===a.Int,()=>"Run-ends must have an integer type."),M(e,"values")]}),$r=()=>Ge(a.BinaryView),Jr=()=>Ge(a.Utf8View),Ps=n=>({typeId:a.ListView,children:[M(n,"value")],offsets:N}),Cs=n=>({typeId:a.LargeListView,children:[M(n,"value")],offsets:D}),Us=new Ee(2),Ye=Us.buffer,Xr=new D(Ye),te=new rn(Ye),$n=new N(Ye),Zr=new oe(Ye);function ei(n){return n}function x(n){return BigInt(n)}function vs(n){return on(n)?x:ei}function ti(n){return n/864e5|0}function ni(n){return n===_.SECOND?e=>x(e/1e3):n===_.MILLISECOND?x:n===_.MICROSECOND?e=>x(e*1e3):e=>x(e*1e6)}function si([n,e,t]){return $n[0]=n,$n[1]=e,Xr[1]=x(t),Zr}function Q(n){if(n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER)throw Error(`BigInt exceeds integer number representation: ${n}`);return Number(n)}function In(n,e){return Number(n/e)+Number(n%e)/Number(e)}function ri(n){return e=>typeof e=="bigint"?Number(e):Math.trunc(e*n)}function ii(n,e,t,s,r){let i=typeof n=="bigint"?n:x(Math.trunc(n*r));e[t]=i,s>1&&(e[t+1]=i>>64n,s>2&&(e[t+2]=i>>128n,e[t+3]=i>>192n))}var ne=n=>BigInt.asUintN(64,n);function oi(n,e){return BigInt.asIntN(64,n[e])}function ai(n,e){let t=e<<1,s;return BigInt.asIntN(64,n[t+1])<0?(s=ne(~n[t])|ne(~n[t+1])<<64n,s=-(s+1n)):s=n[t]|n[t+1]<<64n,s}function ci(n,e){let t=e<<2,s;return BigInt.asIntN(64,n[t+3])<0?(s=ne(~n[t])|ne(~n[t+1])<<64n|ne(~n[t+2])<<128n|ne(~n[t+3])<<192n,s=-(s+1n)):s=n[t]|n[t+1]<<64n|n[t+2]<<128n|n[t+3]<<192n,s}function ui(n){if(n!==n)return 32256;Us[0]=n;let e=(te[1]&2147483648)>>16&65535,t=te[1]&2146435072,s=0;return t>=1089470464?te[0]>0?t=31744:(t=(t&2080374784)>>16,s=(te[1]&1048575)>>10):t<=1056964608?(s=1048576+(te[1]&1048575),s=1048576+(s<<(t>>20)-998)>>21,t=0):(t=t-1056964608>>10,s=(te[1]&1048575)+512>>10),e|t|s&65535}var di=new TextDecoder("utf-8"),li=new TextEncoder;function Qe(n){return di.decode(n)}function Ms(n){return li.encode(n)}function Ke(n){return`${typeof n!="object"||!n?n??null:Mr(n)?+n:us(n)?`[${n.map(Ke)}]`:fi(n)}`}function fi(n){let e="",t=-1;for(let s in n)++t>0&&(e+=","),e+=`"${s}":${Ke(n[s])}`;return`{${e}}`}var C=4,et=2;function Ws(n,e){return(n[e>>3]&1<<e%8)!==0}function V(n,e){let t=e+y(n,e),s=t-y(n,t),r=S(n,s);return(i,o,c=null)=>{if(i<r){let u=S(n,s+i);if(u)return o(n,t+u)}return c}}function K(n,e){return e}function fe(n,e){return!!hi(n,e)}function hi(n,e){return gn(n,e)<<24>>24}function gn(n,e){return n[e]}function S(n,e){return pi(n,e)<<16>>16}function pi(n,e){return n[e]|n[e+1]<<8}function y(n,e){return n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24}function Jn(n,e){return y(n,e)>>>0}function w(n,e){return Q(BigInt.asIntN(64,BigInt(Jn(n,e))+(BigInt(Jn(n,e+C))<<32n)))}function Se(n,e){let t=e+y(n,e),s=y(n,t);return t+=C,Qe(n.subarray(t,t+s))}function H(n,e,t,s){if(!e)return[];let r=e+y(n,e);return Array.from({length:y(n,r)},(i,o)=>s(n,r+C+o*t))}var Te=Symbol("rowIndex");function nt(n,e){class t{constructor(i){this[Te]=i}toJSON(){return xs(n,e,this[Te])}}let s=t.prototype;for(let r=0;r<n.length;++r){if(Object.hasOwn(s,n[r]))continue;let i=e[r];Object.defineProperty(s,n[r],{get(){return i.at(this[Te])},enumerable:!0})}return r=>new t(r)}function Bs(n,e){return t=>xs(n,e,t)}function xs(n,e,t){let s={};for(let r=0;r<n.length;++r)s[n[r]]=e[r].at(t);return s}function Ei(n){return n instanceof j}var z=class{static ArrayType=null;constructor({length:e,nullCount:t,type:s,validity:r,values:i,offsets:o,sizes:c,children:u}){this.length=e,this.nullCount=t,this.type=s,this.validity=r,this.values=i,this.offsets=o,this.sizes=c,this.children=u,(!t||!this.validity)&&(this.at=d=>this.value(d))}get[Symbol.toStringTag](){return"Batch"}at(e){return this.isValid(e)?this.value(e):null}isValid(e){return Ws(this.validity,e)}value(e){return this.values[e]}slice(e,t){let s=t-e,r=Array(s);for(let i=0;i<s;++i)r[i]=this.at(e+i);return r}*[Symbol.iterator](){for(let e=0;e<this.length;++e)yield this.at(e)}},j=class extends z{constructor(e){super(e);let{length:t,values:s}=this;this.values=s.subarray(0,t)}slice(e,t){return this.nullCount?super.slice(e,t):this.values.subarray(e,t)}[Symbol.iterator](){return this.nullCount?super[Symbol.iterator]():this.values[Symbol.iterator]()}},re=class extends z{static ArrayType=Ee},R=class extends z{static ArrayType=Array},Oe=class extends R{value(e){return null}},G=class extends re{value(e){return Q(this.values[e])}},st=class extends re{value(e){let t=this.values[e],s=(t&31744)>>10,r=(t&1023)/1024,i=(-1)**((t&32768)>>15);switch(s){case 31:return i*(r?Number.NaN:1/0);case 0:return i*(r?6103515625e-14*r:0)}return i*2**(s-15)*(1+r)}},rt=class extends R{value(e){return Ws(this.values,e)}},it=class extends re{constructor(e){super(e);let{scale:t}=this.type;this.scale=10**t}value(e){return this.values[e]/this.scale}},Ae=class extends z{constructor(e){super(e);let{bitWidth:t,scale:s}=this.type;this.decimal=t===64?oi:t===128?ai:ci,this.scale=10n**BigInt(s)}},ot=class extends Ae{static ArrayType=Ee;value(e){return In(this.decimal(this.values,e),this.scale)}},at=class extends Ae{static ArrayType=Array;value(e){return this.decimal(this.values,e)}},Ne=class extends R{constructor(e){super(e),this.source=e}value(e){return new Date(this.source.value(e))}},ct=class extends re{value(e){return 864e5*this.values[e]}},mi=G,ut=class extends G{value(e){return super.value(e)*1e3}},Ii=G,dt=class extends G{value(e){return In(this.values[e],1000n)}},lt=class extends G{value(e){return In(this.values[e],1000000n)}},ft=class extends R{value(e){return this.values.subarray(e<<1,e+1<<1)}},ht=class extends R{value(e){let t=this.values,s=e<<4;return Float64Array.of(y(t,s),y(t,s+4),w(t,s+8))}},Gs=({values:n,offsets:e},t)=>n.subarray(e[t],e[t+1]),Vs=({values:n,offsets:e},t)=>n.subarray(Q(e[t]),Q(e[t+1])),pt=class extends R{value(e){return Gs(this,e)}},Et=class extends R{value(e){return Vs(this,e)}},mt=class extends R{value(e){return Qe(Gs(this,e))}},It=class extends R{value(e){return Qe(Vs(this,e))}},gt=class extends R{value(e){let t=this.offsets;return this.children[0].slice(t[e],t[e+1])}},_t=class extends R{value(e){let t=this.offsets;return this.children[0].slice(Q(t[e]),Q(t[e+1]))}},yt=class extends R{value(e){let t=this.offsets[e],s=t+this.sizes[e];return this.children[0].slice(t,s)}},Rt=class extends R{value(e){let t=this.offsets[e],s=t+this.sizes[e];return this.children[0].slice(Q(t),Q(s))}},we=class extends R{constructor(e){super(e),this.stride=this.type.stride}},bt=class extends we{value(e){let{stride:t,values:s}=this;return s.subarray(e*t,(e+1)*t)}},Tt=class extends we{value(e){let{children:t,stride:s}=this;return t[0].slice(e*s,(e+1)*s)}};function js({children:n,offsets:e},t){let[s,r]=n[0].children,i=e[t],o=e[t+1],c=[];for(let u=i;u<o;++u)c.push([s.at(u),r.at(u)]);return c}var kt=class extends R{value(e){return js(this,e)}},St=class extends R{value(e){return new Map(js(this,e))}},Le=class extends R{constructor({typeIds:e,...t}){super(t),this.typeIds=e,this.typeMap=this.type.typeMap}value(e,t=e){let{typeIds:s,children:r,typeMap:i}=this;return r[i[s[e]]].at(t)}},Ot=class extends Le{value(e){return super.value(e,this.offsets[e])}},De=class extends R{constructor(e,t=Bs){super(e),this.names=this.type.children.map(s=>s.name),this.factory=t(this.names,this.children)}value(e){return this.factory(e)}},At=class extends De{constructor(e){super(e,nt)}},Nt=class extends R{value(e){let[{values:t},s]=this.children;return s.at(an(t,e))}},wt=class extends R{setDictionary(e){return this.dictionary=e,this.cache=e.cache(),this}value(e){return this.cache[this.key(e)]}key(e){return this.values[e]}},Fe=class extends R{constructor({data:e,...t}){super(t),this.data=e}view(e){let{values:t,data:s}=this,r=e<<4,i=r+4,o=t,c=y(o,r);return c>12&&(i=y(o,r+12),o=s[y(o,r+8)]),o.subarray(i,i+c)}},Lt=class extends Fe{value(e){return this.view(e)}},Dt=class extends Fe{value(e){return Qe(this.view(e))}};function Xn(n){let e=[];return{add(t){return e.push(t),this},clear:()=>e=[],done:()=>new $(e,n)}}var $=class{constructor(e,t=(s=>(s=e[0])==null?void 0:s.type)()){this.type=t,this.length=e.reduce((o,c)=>o+c.length,0),this.nullCount=e.reduce((o,c)=>o+c.nullCount,0),this.data=e;let r=e.length,i=new Int32Array(r+1);if(r===1){let[o]=e;i[1]=o.length,this.at=c=>o.at(c)}else for(let o=0,c=0;o<r;++o)i[o+1]=c+=e[o].length;this.offsets=i}get[Symbol.toStringTag](){return"Column"}[Symbol.iterator](){let e=this.data;return e.length===1?e[0][Symbol.iterator]():gi(e)}at(e){var i;let{data:t,offsets:s}=this,r=an(s,e)-1;return(i=t[r])==null?void 0:i.at(e-s[r])}get(e){return this.at(e)}toArray(){let{length:e,nullCount:t,data:s}=this,r=!t&&Ei(s[0]),i=s.length;if(r&&i===1)return s[0].values;let o=!i||t>0?Array:s[0].constructor.ArrayType??s[0].values.constructor,c=new o(e);return r?_i(c,s):yi(c,s)}cache(){return this._cache??(this._cache=this.toArray())}};function*gi(n){for(let e=0;e<n.length;++e){let t=n[e][Symbol.iterator]();for(let s=t.next();!s.done;s=t.next())yield s.value}}function _i(n,e){for(let t=0,s=0;t<e.length;++t){let{values:r}=e[t];n.set(r,s),s+=r.length}return n}function yi(n,e){let t=-1;for(let s=0;s<e.length;++s){let r=e[s];for(let i=0;i<r.length;++i)n[++t]=r.at(i)}return n}var he=class n{constructor(e,t,s=!1){let r=e.fields.map(o=>o.name);this.schema=e,this.names=r,this.children=t,this.factory=s?nt:Bs;let i=[];this.getFactory=o=>i[o]??(i[o]=this.factory(r,t.map(c=>c.data[o])))}get[Symbol.toStringTag](){return"Table"}get numCols(){return this.names.length}get numRows(){var e;return((e=this.children[0])==null?void 0:e.length)??0}getChildAt(e){return this.children[e]}getChild(e){let t=this.names.findIndex(s=>s===e);return t>-1?this.children[t]:void 0}selectAt(e,t=[]){let{children:s,factory:r,schema:i}=this,{fields:o}=i;return new n({...i,fields:e.map((c,u)=>Ri(o[c],t[u]))},e.map(c=>s[c]),r===nt)}select(e,t){let s=this.names,r=e.map(i=>s.indexOf(i));return this.selectAt(r,t)}toColumns(){let{children:e,names:t}=this,s={};return t.forEach((r,i)=>{var o;return s[r]=((o=e[i])==null?void 0:o.toArray())??[]}),s}toArray(){var o;let{children:e,getFactory:t,numRows:s}=this,r=((o=e[0])==null?void 0:o.data)??[],i=Array(s);for(let c=0,u=-1;c<r.length;++c){let d=t(c);for(let f=0;f<r[c].length;++f)i[++u]=d(f)}return i}*[Symbol.iterator](){var r;let{children:e,getFactory:t}=this,s=((r=e[0])==null?void 0:r.data)??[];for(let i=0;i<s.length;++i){let o=t(i);for(let c=0;c<s[i].length;++c)yield o(c)}}at(e){let{children:t,getFactory:s,numRows:r}=this;if(e<0||e>=r)return null;let[{offsets:i}]=t,o=an(i,e)-1;return s(o)(e-i[o])}get(e){return this.at(e)}};function Ri(n,e){return e!=null&&e!==n.name?{...n,name:e}:n}function qe(n,e={}){let{typeId:t,bitWidth:s,mode:r,precision:i,unit:o}=n,{useBigInt:c,useDate:u,useDecimalInt:d,useMap:f,useProxy:h}=e;switch(t){case a.Null:return Oe;case a.Bool:return rt;case a.Int:case a.Time:case a.Duration:return c||s<64?j:G;case a.Float:return i?j:st;case a.Date:return Zn(o===Y.DAY?ct:mi,u&&Ne);case a.Timestamp:return Zn(o===_.SECOND?ut:o===_.MILLISECOND?Ii:o===_.MICROSECOND?dt:lt,u&&Ne);case a.Decimal:return s===32?d?j:it:d?at:ot;case a.Interval:return o===U.DAY_TIME?ft:o===U.YEAR_MONTH?j:ht;case a.FixedSizeBinary:return bt;case a.Utf8:return mt;case a.LargeUtf8:return It;case a.Binary:return pt;case a.LargeBinary:return Et;case a.BinaryView:return Lt;case a.Utf8View:return Dt;case a.List:return gt;case a.LargeList:return _t;case a.Map:return f?St:kt;case a.ListView:return yt;case a.LargeListView:return Rt;case a.FixedSizeList:return Tt;case a.Struct:return h?At:De;case a.RunEndEncoded:return Nt;case a.Dictionary:return wt;case a.Union:return r?Ot:Le}throw new Error(ae(t))}function Zn(n,e){return e?class extends e{constructor(s){super(new n(s))}}:n}function bi(n,e){return{offset:w(n,e),metadataLength:y(n,e+8),bodyLength:w(n,e+16)}}function es(n,e){return H(n,e,24,bi)}function Hs(n,e,t){let s=V(n,e);if(s(10,K,0))throw new Error("Record batch compression not implemented");let r=t<v.V4?8:0;return{length:s(4,w,0),nodes:H(n,s(6,K),16,(i,o)=>({length:w(i,o),nullCount:w(i,o+8)})),regions:H(n,s(8,K),16+r,(i,o)=>({offset:w(i,o+r),length:w(i,o+r+8)})),variadic:H(n,s(12,K),8,w)}}function Ti(n,e,t){let s=V(n,e);return{id:s(4,w,0),data:s(6,(r,i)=>Hs(r,i,t)),isDelta:s(8,fe,!1)}}function Ys(n,e,t,s){P(t,a,ae);let r=V(n,e);switch(t){case a.Binary:return Rs();case a.Utf8:return hn();case a.LargeBinary:return ws();case a.LargeUtf8:return Ls();case a.List:return En(s[0]);case a.ListView:return Ps(s[0]);case a.LargeList:return Ds(s[0]);case a.LargeListView:return Cs(s[0]);case a.Struct:return He(s);case a.RunEndEncoded:return Fs(s[0],s[1]);case a.Int:return W(r(4,y,0),r(6,fe,!1));case a.Float:return Ie(r(4,S,J.HALF));case a.Decimal:return ue(r(4,y,0),r(6,y,0),r(8,y,128));case a.Date:return je(r(4,S,Y.MILLISECOND));case a.Time:return de(r(4,S,_.MILLISECOND));case a.Timestamp:return pn(r(4,S,_.SECOND),r(6,Se));case a.Interval:return ks(r(4,S,U.YEAR_MONTH));case a.Duration:return Ns(r(4,S,_.MILLISECOND));case a.FixedSizeBinary:return Os(r(4,y,0));case a.FixedSizeList:return mn(s[0],r(4,y,0));case a.Map:return As(r(4,fe,!1),s[0]);case a.Union:return Ss(r(4,S,ie.Sparse),s,H(n,r(6,K),4,y))}return{typeId:t}}function _n(n,e){let t=H(n,e,4,(s,r)=>{let i=V(s,r);return[i(4,Se),i(6,Se)]});return t.length?new Map(t):null}function Qs(n,e,t){let s=V(n,e);return{version:t,endianness:s(4,S,0),fields:s(6,ki,[]),metadata:s(8,_n)}}function ki(n,e){return H(n,e,4,Ks)}function Ks(n,e){let t=V(n,e),s=t(8,gn,a.NONE),r=t(10,K,0),i=t(12,Oi),o=t(14,(u,d)=>Si(u,d)),c=Ys(n,r,s,o);return i&&(i.dictionary=c,c=i),{name:t(4,Se),type:c,nullable:t(6,fe,!1),metadata:t(16,_n)}}function Si(n,e){let t=H(n,e,4,Ks);return t.length?t:null}function Oi(n,e){if(!e)return null;let t=V(n,e);return un(null,t(6,Ai,me()),t(8,fe,!1),t(4,w,0))}function Ai(n,e){return Ys(n,e,a.Int)}var Ni=(n,e)=>`Expected to read ${n} metadata bytes, but only read ${e}.`,wi=(n,e)=>`Expected to read ${n} bytes for message body, but only read ${e}.`,Li=n=>`Unsupported message type: ${n} (${fs(O,n)})`;function Ft(n,e){let t=y(n,e)||0;if(e+=C,t===-1&&(t=y(n,e)||0,e+=C),t===0)return null;let s=n.subarray(e,e+=t);if(s.byteLength<t)throw new Error(Ni(t,s.byteLength));let r=V(s,0),i=r(4,S,v.V1),o=r(6,gn,O.NONE),c=r(8,K,0),u=r(10,w,0),d;if(c){let f=o===O.Schema?Qs:o===O.DictionaryBatch?Ti:o===O.RecordBatch?Hs:null;if(!f)throw new Error(Li(o));if(d=f(s,c,i),u>0){let h=n.subarray(e,e+=u);if(h.byteLength<u)throw new Error(wi(u,h.byteLength));d.body=h}else o!==O.Schema&&(d.body=new Uint8Array(0))}return{version:i,type:o,index:e,content:d}}function Di(n){let e=Fr(n)?new Uint8Array(n):n;return e instanceof Uint8Array&&Fi(e)?Ci(e):Pi(e)}function Fi(n){if(!n||n.length<4)return!1;for(let e=0;e<6;++e)if(We[e]!==n[e])return!1;return!0}function Pi(n){let e=[n].flat(),t,s=[],r=[];for(let i of e){if(!(i instanceof Uint8Array))throw new Error("IPC data batch was not a Uint8Array.");let o=0;for(;;){let c=Ft(i,o);if(c===null)break;if(o=c.index,!!c.content)switch(c.type){case O.Schema:t||(t=c.content);break;case O.RecordBatch:s.push(c.content);break;case O.DictionaryBatch:r.push(c.content);break}}}return{schema:t,dictionaries:r,records:s,metadata:null}}function Ci(n){let e=n.byteLength-(We.length+4),t=y(n,e),s=V(n,e-t),r=s(4,S,v.V1),i=s(8,es,[]),o=s(10,es,[]);return{schema:s(6,(c,u)=>Qs(c,u,r)),dictionaries:i.map(({offset:c})=>Ft(n,c).content),records:o.map(({offset:c})=>Ft(n,c).content),metadata:s(12,_n)}}function Ui(n,e){return vi(Di(n),e)}function vi(n,e={}){let{schema:t={fields:[]},dictionaries:s,records:r}=n,{version:i,fields:o}=t,c=new Map,u=Wi(e,i,c),d=new Map;Mi(t,m=>{let p=m.type;p.typeId===a.Dictionary&&d.set(p.id,p.dictionary)});let f=new Map;for(let m of s){let{id:p,data:k,isDelta:T,body:X}=m,Z=d.get(p),ee=Pt(Z,u({...k,body:X}));if(f.has(p)){let g=f.get(p);T||g.clear(),g.add(ee)}else{if(T)throw new Error("Delta update can not be first dictionary batch.");f.set(p,Xn(Z).add(ee))}}f.forEach((m,p)=>c.set(p,m.done()));let h=o.map(m=>Xn(m.type));for(let m of r){let p=u(m);o.forEach((k,T)=>h[T].add(Pt(k.type,p)))}return new he(t,h.map(m=>m.done()),e.useProxy)}function Mi(n,e){n.fields.forEach(function t(s){var r,i,o;e(s),(i=(r=s.type.dictionary)==null?void 0:r.children)==null||i.forEach(t),(o=s.type.children)==null||o.forEach(t)})}function Wi(n,e,t){let s={version:e,options:n,dictionary:r=>t.get(r)};return r=>{let{length:i,nodes:o,regions:c,variadic:u,body:d}=r,f=-1,h=-1,m=-1;return{...s,length:i,node:()=>o[++f],buffer:p=>{let{length:k,offset:T}=c[++h];return p?new p(d.buffer,d.byteOffset+T,k/p.BYTES_PER_ELEMENT):d.subarray(T,T+k)},variadic:()=>u[++m],visit(p){return p.map(k=>Pt(k.type,this))}}}}function Pt(n,e){let{typeId:t}=n,{options:s,node:r,buffer:i,variadic:o,version:c}=e,u=qe(n,s),d={...r(),type:n};if(t===a.Null)return new u({...d,nullCount:d.length});switch(t){case a.Bool:case a.Int:case a.Time:case a.Duration:case a.Float:case a.Decimal:case a.Date:case a.Timestamp:case a.Interval:case a.FixedSizeBinary:return new u({...d,validity:i(),values:i(n.values)});case a.Utf8:case a.LargeUtf8:case a.Binary:case a.LargeBinary:return new u({...d,validity:i(),offsets:i(n.offsets),values:i()});case a.BinaryView:case a.Utf8View:return new u({...d,validity:i(),values:i(),data:Array.from({length:o()},()=>i())});case a.List:case a.LargeList:case a.Map:return new u({...d,validity:i(),offsets:i(n.offsets),children:e.visit(n.children)});case a.ListView:case a.LargeListView:return new u({...d,validity:i(),offsets:i(n.offsets),sizes:i(n.offsets),children:e.visit(n.children)});case a.FixedSizeList:case a.Struct:return new u({...d,validity:i(),children:e.visit(n.children)});case a.RunEndEncoded:return new u({...d,children:e.visit(n.children)});case a.Dictionary:{let{id:f,indices:h}=n;return new u({...d,validity:i(),values:i(h.values)}).setDictionary(e.dictionary(f))}case a.Union:return c<v.V5&&i(),new u({...d,typeIds:i(xe),offsets:n.mode===ie.Sparse?null:i(n.offsets),children:e.visit(n.children)});default:throw new Error(ae(t))}}function Ct(n,e,t){n[e]=t,n[e+1]=t>>8,n[e+2]=t>>16,n[e+3]=t>>24}var be=1024,Ut=class{constructor(e){this.sink=e,this.minalign=1,this.buf=new Uint8Array(be),this.space=be,this.vtables=[],this.outputBytes=0}offset(){return this.buf.length-this.space}writeInt8(e){this.buf[this.space-=1]=e}writeInt16(e){this.buf[this.space-=2]=e,this.buf[this.space+1]=e>>8}writeInt32(e){Ct(this.buf,this.space-=4,e)}writeInt64(e){let t=BigInt(e);this.writeInt32(Number(BigInt.asIntN(32,t>>BigInt(32)))),this.writeInt32(Number(BigInt.asIntN(32,t)))}addInt8(e){B(this,1,0),this.writeInt8(e)}addInt16(e){B(this,2,0),this.writeInt16(e)}addInt32(e){B(this,4,0),this.writeInt32(e)}addInt64(e){B(this,8,0),this.writeInt64(e)}addOffset(e){B(this,C,0),this.writeInt32(this.offset()-e+C)}addObject(e,t){let s=Bi(this,e);return t==null||t(s),s.finish()}addVector(e,t,s,r){let i=e==null?void 0:e.length;if(!i)return 0;B(this,C,t*i),B(this,s,t*i);for(let o=i;--o>=0;)r(this,e[o]);return this.writeInt32(i),this.offset()}addOffsetVector(e){return this.addVector(e,4,4,(t,s)=>t.addOffset(s))}addString(e){if(e==null)return 0;let t=Ms(e),s=t.length;return this.addInt8(0),B(this,C,s),this.buf.set(t,this.space-=s),this.writeInt32(s),this.offset()}finish(e){B(this,this.minalign,C),this.addOffset(e)}flush(){let{buf:e,sink:t}=this,s=e.subarray(this.space,e.length);t.write(s),this.outputBytes+=s.byteLength,this.minalign=1,this.vtables=[],this.buf=new Uint8Array(be),this.space=be}addBuffer(e){let t=e.byteLength;if(!t)return 0;this.sink.write(e),this.outputBytes+=t;let s=(t+7&-8)-t;return this.addPadding(s),t+s}addPadding(e){e>0&&(this.sink.write(new Uint8Array(e)),this.outputBytes+=e)}};function B(n,e,t){let{buf:s,space:r,minalign:i}=n;e>i&&(n.minalign=e);let o=s.length,c=o-r+t,u=~c+1&e-1;s=ls(s,c+u+e-1,!0),r+=s.length-o;for(let d=0;d<u;++d)s[--r]=0;n.buf=s,n.space=r}function Bi(n,e){let t=Array(e).fill(0),s=n.offset();function r(i){t[i]=n.offset()}return{addInt8(i,o,c){o!=c&&(n.addInt8(o),r(i))},addInt16(i,o,c){o!=c&&(n.addInt16(o),r(i))},addInt32(i,o,c){o!=c&&(n.addInt32(o),r(i))},addInt64(i,o,c){o!=c&&(n.addInt64(o),r(i))},addOffset(i,o,c){o!=c&&(n.addOffset(o),r(i))},finish(){n.addInt32(0);let i=n.offset(),o=e;for(;--o>=0&&t[o]===0;);let c=o+1;for(;o>=0;--o)n.addInt16(t[o]?i-t[o]:0);let u=2;n.addInt16(i-s);let d=(c+u)*et;n.addInt16(d);let f=0,{buf:h,vtables:m,space:p}=n;e:for(o=0;o<m.length;++o){let k=h.length-m[o];if(d==S(h,k)){for(let T=et;T<d;T+=et)if(S(h,p+T)!=S(h,k+T))continue e;f=m[o];break}}if(f)n.space=h.length-i,Ct(h,n.space,f-i);else{let k=n.offset();m.push(k),Ct(h,h.length-i,k-i)}return i}}}function qs(n,e){let{nodes:t,regions:s,variadic:r}=e,i=n.addVector(t,16,8,(u,d)=>(u.writeInt64(d.nullCount),u.writeInt64(d.length),u.offset())),o=n.addVector(s,16,8,(u,d)=>(u.writeInt64(d.length),u.writeInt64(d.offset),u.offset())),c=n.addVector(r,8,8,(u,d)=>u.addInt64(d));return n.addObject(5,u=>{u.addInt64(0,t[0].length,0),u.addOffset(1,i,0),u.addOffset(2,o,0),u.addOffset(4,c,0)})}function xi(n,e){let t=qs(n,e.data);return n.addObject(3,s=>{s.addInt64(0,e.id,0),s.addOffset(1,t,0),s.addInt8(2,+e.isDelta,0)})}function yn(n,e){return(e==null?void 0:e.size)>0?n.addOffsetVector(Array.from(e,([t,s])=>{let r=n.addString(`${t}`),i=n.addString(`${s}`);return n.addObject(2,o=>{o.addOffset(0,r,0),o.addOffset(1,i,0)})})):0}function ke(n,e){switch(P(e.typeId,a,ae)){case a.Dictionary:return Xi(n,e);case a.Int:return Qi(n,e);case a.Float:return Yi(n,e);case a.Decimal:return Vi(n,e);case a.Date:return Gi(n,e);case a.Time:return zi(n,e);case a.Timestamp:return $i(n,e);case a.Interval:return Ki(n,e);case a.Duration:return ji(n,e);case a.FixedSizeBinary:case a.FixedSizeList:return Hi(n,e);case a.Map:return qi(n,e);case a.Union:return Ji(n,e)}return n.addObject(0)}function Gi(n,e){return n.addObject(1,t=>{t.addInt16(0,e.unit,Y.MILLISECOND)})}function Vi(n,e){return n.addObject(3,t=>{t.addInt32(0,e.precision,0),t.addInt32(1,e.scale,0),t.addInt32(2,e.bitWidth,128)})}function ji(n,e){return n.addObject(1,t=>{t.addInt16(0,e.unit,_.MILLISECOND)})}function Hi(n,e){return n.addObject(1,t=>{t.addInt32(0,e.stride,0)})}function Yi(n,e){return n.addObject(1,t=>{t.addInt16(0,e.precision,J.HALF)})}function Qi(n,e){return n.addObject(2,t=>{t.addInt32(0,e.bitWidth,0),t.addInt8(1,+e.signed,0)})}function Ki(n,e){return n.addObject(1,t=>{t.addInt16(0,e.unit,U.YEAR_MONTH)})}function qi(n,e){return n.addObject(1,t=>{t.addInt8(0,+e.keysSorted,0)})}function zi(n,e){return n.addObject(2,t=>{t.addInt16(0,e.unit,_.MILLISECOND),t.addInt32(1,e.bitWidth,32)})}function $i(n,e){let t=n.addString(e.timezone);return n.addObject(2,s=>{s.addInt16(0,e.unit,_.SECOND),s.addOffset(1,t,0)})}function Ji(n,e){let t=n.addVector(e.typeIds,4,4,(s,r)=>s.addInt32(r));return n.addObject(2,s=>{s.addInt16(0,e.mode,ie.Sparse),s.addOffset(1,t,0)})}function Xi(n,e){return n.addObject(4,t=>{t.addInt64(0,e.id,0),t.addOffset(1,ke(n,e.indices),0),t.addInt8(2,+e.ordered,0)})}var Zi=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;function zs(n,e){let{fields:t,metadata:s}=e,r=t.map(c=>$s(n,c)),i=n.addOffsetVector(r),o=yn(n,s);return n.addObject(4,c=>{c.addInt16(0,+!Zi,0),c.addOffset(1,i,0),c.addOffset(2,o,0)})}function $s(n,e){let{name:t,nullable:s,type:r,metadata:i}=e,{typeId:o}=r,c=0,u=0;if(o!==a.Dictionary)c=ke(n,r);else{let p=r.dictionary;o=p.typeId,u=ke(n,r),c=ke(n,p)}let d=(r.children||[]).map(p=>$s(n,p)),f=n.addOffsetVector(d),h=yn(n,i),m=n.addString(t);return n.addObject(7,p=>{p.addOffset(0,m,0),p.addInt8(1,+s,0),p.addInt8(2,o,a.NONE),p.addOffset(3,c,0),p.addOffset(4,u,0),p.addOffset(5,f,0),p.addOffset(6,h,0)})}function eo(n,e,t,s,r){let i=yn(n,r),o=n.addVector(s,24,8,ts),c=n.addVector(t,24,8,ts),u=zs(n,e);n.finish(n.addObject(5,f=>{f.addInt16(0,v.V5,v.V1),f.addOffset(1,u,0),f.addOffset(2,c,0),f.addOffset(3,o,0),f.addOffset(4,i,0)}));let d=n.offset();n.addInt32(0),n.addInt32(-1),n.flush(),n.sink.write(new Uint8Array(Int32Array.of(d).buffer)),n.sink.write(We)}function ts(n,{offset:e,metadataLength:t,bodyLength:s}){return n.writeInt64(s),n.writeInt32(0),n.writeInt32(t),n.writeInt64(e),n.offset()}function tt(n,e,t,s,r){n.finish(n.addObject(5,u=>{u.addInt16(0,v.V5,v.V1),u.addInt8(1,e,O.NONE),u.addOffset(2,t,0),u.addInt64(3,s,0)}));let i=8,o=n.offset(),c=o+i+7&-8;r==null||r.push({offset:n.outputBytes,metadataLength:c,bodyLength:s}),n.addInt32(c-i),n.addInt32(-1),n.flush(),n.addPadding(c-o-i)}var vt=class{write(e){}pad(e){this.write(new Uint8Array(e))}finish(){return null}},Mt=class extends vt{constructor(){super(),this.buffers=[]}write(e){this.buffers.push(e)}finish(){let e=this.buffers,t=e.reduce((r,i)=>r+i.byteLength,0),s=new Uint8Array(t);for(let r=0,i=0;r<e.length;++r)s.set(e[r],i),i+=e[r].byteLength;return s}},ns="stream",ss="file";function to(n,{sink:e,format:t=ns}={}){if(t!==ns&&t!==ss)throw new Error(`Unrecognized Arrow IPC format: ${t}`);let{schema:s,dictionaries:r=[],records:i=[],metadata:o}=n,c=new Ut(e||new Mt),u=t===ss,d=[],f=[];u&&c.addBuffer(We),s&&tt(c,O.Schema,zs(c,s),0);for(let h of r){let{data:m}=h;tt(c,O.DictionaryBatch,xi(c,h),m.byteLength,d),rs(c,m.buffers)}for(let h of i)tt(c,O.RecordBatch,qs(c,h),h.byteLength,f),rs(c,h.buffers);return c.addBuffer(Dr),u&&eo(c,s,d,f,o),c.sink}function rs(n,e){for(let t=0;t<e.length;++t)n.addBuffer(e[t])}function no(n,e){typeof e=="string"&&(e={format:e});let t=n.children;so(t);let{dictionaries:s,idMap:r}=io(t),i=ao(t),c={schema:oo(n.schema,r),dictionaries:s,records:i};return to(c,e).finish()}function so(n){var t;let e=(t=n[0])==null?void 0:t.data.map(s=>s.length);n.forEach(({data:s})=>{if(s.length!==e.length||s.some((r,i)=>r.length!==e[i]))throw new Error("Columns have inconsistent batch sizes.")})}function ro(){let n=0,e=[],t=[],s=[],r=[];return{node(i,o){e.push({length:i,nullCount:o})},buffer(i){let o=i.byteLength,c=o+7&-8;t.push({offset:n,length:c}),n+=c,s.push(new Uint8Array(i.buffer,i.byteOffset,o))},variadic(i){r.push(i)},children(i,o){i.children.forEach((c,u)=>{Xs(c.type,o.children[u],this)})},done(){return{byteLength:n,nodes:e,regions:t,variadic:r,buffers:s}}}}function io(n){let e=[],t=new Map,s=new Map,r=-1,i=o=>{if(t.has(o))s.set(o.type,t.get(o));else{t.set(o,++r);for(let c=0;c<o.data.length;++c)e.push({id:r,isDelta:c>0,data:Js([o],c)});s.set(o.type,r)}};return n.forEach(o=>Wt(o.data[0],i)),{dictionaries:e,idMap:s}}function Wt(n,e){var t;if((n==null?void 0:n.type.typeId)===a.Dictionary){let s=n.dictionary;e(s),Wt(s.data[0],e)}(t=n==null?void 0:n.children)==null||t.forEach(s=>Wt(s,e))}function oo(n,e){if(!e.size)return n;let t=i=>{i.typeId===a.Dictionary&&(i.id=e.get(i.dictionary),r(i)),i.children&&(i.children=i.children.slice()).forEach(s)},s=(i,o,c)=>{let u={...i.type};c[o]={...i,type:u},t(u)},r=i=>{let o={...i.dictionary};i.dictionary=o,t(o)};return n={...n,fields:n.fields.slice()},n.fields.forEach(s),n}function ao(n){var e;return(((e=n[0])==null?void 0:e.data)||[]).map((t,s)=>Js(n,s))}function Js(n,e=0){let t=ro();return n.forEach(s=>{Xs(s.type,s.data[e],t)}),t.done()}function Xs(n,e,t){let{typeId:s}=n;if(t.node(e.length,e.nullCount),s!==a.Null)switch(s){case a.Bool:case a.Int:case a.Time:case a.Duration:case a.Float:case a.Date:case a.Timestamp:case a.Decimal:case a.Interval:case a.FixedSizeBinary:case a.Dictionary:t.buffer(e.validity),t.buffer(e.values);return;case a.Utf8:case a.LargeUtf8:case a.Binary:case a.LargeBinary:t.buffer(e.validity),t.buffer(e.offsets),t.buffer(e.values);return;case a.BinaryView:case a.Utf8View:t.buffer(e.validity),t.buffer(e.values),t.variadic(e.data.length),e.data.forEach(r=>t.buffer(r));return;case a.List:case a.LargeList:case a.Map:t.buffer(e.validity),t.buffer(e.offsets),t.children(n,e);return;case a.ListView:case a.LargeListView:t.buffer(e.validity),t.buffer(e.offsets),t.buffer(e.sizes),t.children(n,e);return;case a.FixedSizeList:case a.Struct:t.buffer(e.validity),t.children(n,e);return;case a.RunEndEncoded:t.children(n,e);return;case a.Union:{t.buffer(e.typeIds),n.mode===ie.Dense&&t.buffer(e.offsets),t.children(n,e);return}default:throw new Error(ae(s))}}function L(n){return new Pe(n)}var Pe=class{constructor(e=oe){this.buf=new e(512)}array(e){return vr(this.buf,e)}prep(e){e>=this.buf.length&&(this.buf=ls(this.buf,e))}get(e){return this.buf[e]}set(e,t){this.prep(t),this.buf[t]=e}write(e,t){this.prep(t+e.length),this.buf.set(e,t)}};function Zs(){return new Bt}var Bt=class extends Pe{set(e){let t=e>>3;this.prep(t),this.buf[t]|=1<<e%8}},pe=class{constructor(e,t){this.type=e,this.ctx=t,this.batchClass=t.batchType(e)}init(){return this.index=-1,this}set(e,t){return this.index=t,!1}done(){return null}batch(){let e=new this.batchClass(this.done());return this.init(),e}},A=class extends pe{constructor(e,t){super(e,t)}init(){return this.nullCount=0,this.validity=Zs(),super.init()}set(e,t){this.index=t;let s=e!=null;return s?this.validity.set(t):this.nullCount++,s}done(){let{index:e,nullCount:t,type:s,validity:r}=this;return{length:e+1,nullCount:t,type:s,validity:t?r.array((e>>3)+1):new oe(0)}}};function Rn(){let n=new Map,e=new Set;return{get(t,s){let r=t.id;if(r>=0&&n.has(r))return n.get(r);{let i=co(t,s);return r>=0&&n.set(r,i),e.add(i),i}},finish(t){e.forEach(s=>s.finish(t))}}}function co(n,e){let t=Object.create(null),s=e.builder(n.dictionary),r=[];s.init();let i=-1;return{type:n,values:s,add(o){return r.push(o),o},key(o){let c=Ke(o),u=t[c];return u===void 0&&(t[c]=u=++i,s.set(o,u)),u},finish(o){let c=n.dictionary,u=new(qe(c,o))(s.done()),d=new $([u]);r.forEach(f=>f.setDictionary(d))}}}var xt=class extends A{constructor(e,t){super(e,t),this.dict=t.dictionary(e)}init(){return this.values=L(this.type.indices.values),super.init()}set(e,t){super.set(e,t)&&this.values.set(this.dict.key(e),t)}done(){return{...super.done(),values:this.values.array(this.index+1)}}batch(){return this.dict.add(super.batch())}};function uo(n){let e=Gt();return n(t=>e.add(t)),e.type()}function Gt(){let n=0,e=0,t=0,s=0,r=0,i=0,o=0,c=0,u=0,d=0,f=0,h=1/0,m=-1/0,p=1/0,k=-1/0,T,X,Z,ee={};return{add(g){if(n++,g==null){e++;return}switch(typeof g){case"string":u++;break;case"number":s++,g<h&&(h=g),g>m&&(m=g),Number.isInteger(g)&&r++;break;case"bigint":i++,T===void 0?T=X=g:(g<T&&(T=g),g>X&&(X=g));break;case"boolean":t++;break;case"object":if(g instanceof Date)o++,+g%864e5===0&&c++;else if(us(g)){d++;let F=g.length;F<p&&(p=F),F>k&&(k=F),Z??(Z=Gt()),g.forEach(Z.add)}else{f++;for(let F in g)(ee[F]??(ee[F]=Gt())).add(g[F])}}},type(){let g=n-e;return g===0?Es():r===g?fo(h,m):s===g?Ve():i===g?ho(T,X):t===g?bs():c===g?Ts():o===g?pn():u===g?un(hn()):d===g?lo(Z.type(),p,k):f===g?He(Object.entries(ee).map(F=>ce(F[0],F[1].type()))):po()}}}function lo(n,e,t){return t===e?mn(n,e):En(n)}function fo(n,e){let t=Math.max(Math.abs(n)-1,e);return t<128?dn():t<32768?ln():t<2**31?me():Ve()}function ho(n,e){let t=-n>e?-n-1n:e;if(t>=2**63)throw new Error(`BigInt exceeds 64 bits: ${t}`);return fn()}function po(){throw new Error("Mixed types detected, please define a union type.")}var Ce=class extends A{constructor(e,t){super(e,t),this.toOffset=vs(e.offsets)}init(){return this.offsets=L(this.type.offsets),this.values=L(),this.pos=0,super.init()}set(e,t){let{offsets:s,values:r,toOffset:i}=this;super.set(e,t)&&(r.write(e,this.pos),this.pos+=e.length),s.set(i(this.pos),t+1)}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),values:this.values.array(this.pos+1)}}},Vt=class extends A{constructor(e,t){super(e,t)}init(){return this.values=Zs(),super.init()}set(e,t){super.set(e,t),e&&this.values.set(t)}done(){return{...super.done(),values:this.values.array((this.index>>3)+1)}}},jt=class extends A{constructor(e,t){super(e,t),this.scale=10**e.scale,this.stride=e.bitWidth>>6}init(){return this.values=L(this.type.values),super.init()}set(e,t){let{scale:s,stride:r,values:i}=this;super.set(e,t)&&(i.prep((t+1)*r),ii(e,i.buf,t*r,r,s))}done(){let{index:e,stride:t,values:s}=this;return{...super.done(),values:s.array((e+1)*t)}}},Ht=class extends A{constructor(e,t){super(e,t),this.stride=e.stride}init(){return this.values=L(),super.init()}set(e,t){super.set(e,t)&&this.values.write(e,t*this.stride)}done(){let{stride:e,values:t}=this;return{...super.done(),values:t.array(e*(this.index+1))}}},Yt=class extends A{constructor(e,t){super(e,t),this.child=t.builder(this.type.children[0].type),this.stride=e.stride}init(){return this.child.init(),super.init()}set(e,t){let{child:s,stride:r}=this,i=t*r;if(super.set(e,t))for(let o=0;o<r;++o)s.set(e[o],i+o);else s.index=i+r}done(){let{child:e}=this;return{...super.done(),children:[e.batch()]}}},Qt=class extends A{init(){return this.values=L(this.type.values),super.init()}set(e,t){if(super.set(e,t)){let s=t<<1;this.values.set(e[0],s),this.values.set(e[1],s+1)}}done(){return{...super.done(),values:this.values.array(this.index+1<<1)}}},Kt=class extends A{init(){return this.values=L(),super.init()}set(e,t){super.set(e,t)&&this.values.write(si(e),t<<4)}done(){return{...super.done(),values:this.values.array(this.index+1<<4)}}},Ue=class extends A{constructor(e,t,s){super(e,t),this.child=s}init(){this.child.init();let e=this.type.offsets;return this.offsets=L(e),this.toOffset=vs(e),this.pos=0,super.init()}done(){return{...super.done(),offsets:this.offsets.array(this.index+2),children:[this.child.batch()]}}},qt=class extends Ue{constructor(e,t){super(e,t,t.builder(e.children[0].type))}set(e,t){let{child:s,offsets:r,toOffset:i}=this;super.set(e,t)&&e.forEach(o=>s.set(o,this.pos++)),r.set(i(this.pos),t+1)}},ve=class extends A{constructor(e,t){super(e,t),this.children=e.children.map(s=>t.builder(s.type))}init(){return this.children.forEach(e=>e.init()),super.init()}done(){let{children:e}=this;return e.forEach(t=>t.index=this.index),{...super.done(),children:e.map(t=>t.batch())}}},zt=class extends ve{constructor(e,t){super(e,t),this.setters=this.children.map((s,r)=>{let i=e.children[r].name;return(o,c)=>s.set(o==null?void 0:o[i],c)})}set(e,t){super.set(e,t);let s=this.setters;for(let r=0;r<s.length;++r)s[r](e,t)}},$t=class extends Ue{constructor(e,t){super(e,t,new Jt(e.children[0].type,t))}set(e,t){let{child:s,offsets:r,toOffset:i}=this;if(super.set(e,t))for(let o of e)s.set(o,this.pos++);r.set(i(this.pos),t+1)}},Jt=class extends ve{set(e,t){super.set(e,t);let[s,r]=this.children;s.set(e[0],t),r.set(e[1],t)}},Eo={},Xt=class extends pe{constructor(e,t){super(e,t),this.children=e.children.map(s=>t.builder(s.type))}init(){return this.pos=0,this.key=null,this.value=Eo,this.children.forEach(e=>e.init()),super.init()}next(){let[e,t]=this.children;e.set(this.index+1,this.pos),t.set(this.value,this.pos++)}set(e,t){if(e!==this.value){let s=Ke(e);s!==this.key&&(this.key&&this.next(),this.key=s,this.value=e)}this.index=t}done(){this.next();let{children:e,index:t,type:s}=this;return{length:t+1,nullCount:0,type:s,children:e.map(r=>r.batch())}}},Me=class extends pe{constructor(e,t){super(e,t),this.children=e.children.map(s=>t.builder(s.type)),this.typeMap=e.typeMap,this.lookup=e.typeIdForValue}init(){return this.nullCount=0,this.typeIds=L(xe),this.children.forEach(e=>e.init()),super.init()}set(e,t){let{children:s,lookup:r,typeMap:i,typeIds:o}=this;this.index=t;let c=r(e,t),u=s[i[c]];o.set(c,t),e==null&&++this.nullCount,this.update(e,t,u)}done(){let{children:e,nullCount:t,type:s,typeIds:r}=this,i=this.index+1;return{length:i,nullCount:t,type:s,typeIds:r.array(i),children:e.map(o=>o.batch())}}},Zt=class extends Me{update(e,t,s){s.set(e,t),this.children.forEach(r=>{r!==s&&r.set(null,t)})}},en=class extends Me{init(){return this.offsets=L(this.type.offsets),super.init()}update(e,t,s){let r=s.index+1;s.set(e,r),this.offsets.set(r,t)}done(){return{...super.done(),offsets:this.offsets.array(this.index+1)}}},tn=class extends Ce{set(e,t){super.set(e&&Ms(e),t)}},q=class extends A{constructor(e,t){super(e,t),this.values=L(e.values)}init(){return this.values=L(this.type.values),super.init()}set(e,t){super.set(e,t)&&this.values.set(e,t)}done(){return{...super.done(),values:this.values.array(this.index+1)}}},nn=class extends q{set(e,t){super.set(e==null?e:x(e),t)}},se=class extends q{constructor(e,t,s){super(e,t),this.transform=s}set(e,t){super.set(e==null?e:this.transform(e),t)}};function er(n={},e=Rn()){return{batchType:t=>qe(t,n),builder(t){return tr(t,this)},dictionary(t){return e.get(t,this)},finish:()=>e.finish(n)}}function tr(n,e=er()){let{typeId:t}=n;switch(t){case a.Int:case a.Time:case a.Duration:return on(n.values)?new nn(n,e):new q(n,e);case a.Float:return n.precision?new q(n,e):new se(n,e,ui);case a.Binary:case a.LargeBinary:return new Ce(n,e);case a.Utf8:case a.LargeUtf8:return new tn(n,e);case a.Bool:return new Vt(n,e);case a.Decimal:return n.bitWidth===32?new se(n,e,ri(n.scale)):new jt(n,e);case a.Date:return new se(n,e,n.unit?x:ti);case a.Timestamp:return new se(n,e,ni(n.unit));case a.Interval:switch(n.unit){case U.DAY_TIME:return new Qt(n,e);case U.MONTH_DAY_NANO:return new Kt(n,e)}return new q(n,e);case a.List:case a.LargeList:return new qt(n,e);case a.Struct:return new zt(n,e);case a.Union:return n.mode?new en(n,e):new Zt(n,e);case a.FixedSizeBinary:return new Ht(n,e);case a.FixedSizeList:return new Yt(n,e);case a.Map:return new $t(n,e);case a.RunEndEncoded:return new Xt(n,e);case a.Dictionary:return new xt(n,e)}throw new Error(ae(t))}function nr(n,e,t={},s){let r=Wr(n)?u=>{for(let d of n)u(d)}:n;e??(e=uo(r));let{maxBatchRows:i=1/0,...o}=t,c;if(e.typeId===a.Null){let u=0;r(()=>++u),c=mo(e,u,i)}else{let u=er(o,s),d=tr(e,u).init(),f=m=>c.push(m.batch());c=[];let h=0;r(m=>{d.set(m,h++),h>=i&&(f(d),h=0)}),h&&f(d),u.finish()}return new $(c,e)}function mo(n,e,t){let s=[],r=c=>new Oe({length:c,nullCount:c,type:n}),i=Math.floor(e/t);for(let c=0;c<i;++c)s.push(r(t));let o=e%t;return o&&s.push(r(o)),s}function sr(n,e,t={},s){return!e&&cs(n)?Io(n,t):nr(r=>n.forEach(r),e,t,s)}function Io(n,{maxBatchRows:e,useBigInt:t}){let s=n.constructor,r=go(s),i=n.length,o=Math.min(e||1/0,i),c=Math.floor(i/o),u=[],d=on(s)&&!t?G:j,f=(m,p)=>u.push(new d({length:p-m,nullCount:0,type:r,validity:new oe(0),values:n.subarray(m,p)})),h=0;for(let m=0;m<c;++m)f(h,h+=o);return h<i&&f(h,i),new $(u)}function go(n){switch(n){case as:return ys();case Ee:return Ve();case xe:return dn();case os:return ln();case N:return me();case D:return fn();case oe:return ms();case sn:return Is();case rn:return gs();case Be:return _s()}}function rr(n,e){var c;let t=[],s=Array.isArray(n)?n:Object.entries(n),r=(c=s[0])==null?void 0:c[1].length,i=s.map(([u,d])=>{if(d.length!==r)throw new Error("All columns must have the same length.");return t.push(ce(u,d.type)),d}),o={version:v.V5,endianness:is.Little,fields:t,metadata:null};return new he(o,i,e)}function _o(n,e={}){let{types:t={},...s}=e,r=Rn(),o=(Array.isArray(n)?n:Object.entries(n)).map(([c,u])=>[c,sr(u,t[c],s,r)]);return rr(o,e.useProxy)}l.Batch=z;l.Column=$;l.DateUnit=Y;l.Endianness=is;l.IntervalUnit=U;l.Precision=J;l.RowIndex=Te;l.Table=he;l.TimeUnit=_;l.Type=a;l.UnionMode=ie;l.Version=v;l.batchType=qe;l.binary=Rs;l.binaryView=$r;l.bool=bs;l.columnFromArray=sr;l.columnFromValues=nr;l.date=je;l.dateDay=Ts;l.dateMillisecond=Hr;l.decimal=ue;l.decimal128=Vr;l.decimal256=jr;l.decimal32=xr;l.decimal64=Gr;l.dictionary=un;l.dictionaryContext=Rn;l.duration=Ns;l.field=ce;l.fixedSizeBinary=Os;l.fixedSizeList=mn;l.float=Ie;l.float16=Br;l.float32=ys;l.float64=Ve;l.int=W;l.int16=ln;l.int32=me;l.int64=fn;l.int8=dn;l.interval=ks;l.largeBinary=ws;l.largeList=Ds;l.largeListView=Cs;l.largeUtf8=Ls;l.list=En;l.listView=Ps;l.map=zr;l.nullType=Es;l.runEndEncoded=Fs;l.struct=He;l.tableFromArrays=_o;l.tableFromColumns=rr;l.tableFromIPC=Ui;l.tableToIPC=no;l.time=de;l.timeMicrosecond=Kr;l.timeMillisecond=Qr;l.timeNanosecond=qr;l.timeSecond=Yr;l.timestamp=pn;l.uint16=Is;l.uint32=gs;l.uint64=_s;l.uint8=ms;l.union=Ss;l.utf8=hn;l.utf8View=Jr});var mr=xn((pa,Er)=>{var Wn=require("url"),Po=require("vm"),le=require("worker_threads"),Mn=Symbol.for("worker"),ye=Symbol.for("events"),Je=class{constructor(){Object.defineProperty(this,ye,{value:new Map})}dispatchEvent(e){if(e.target=e.currentTarget=this,this["on"+e.type])try{this["on"+e.type](e)}catch(s){console.error(s)}let t=this[ye].get(e.type);t!=null&&t.forEach(s=>{try{s.call(this,e)}catch(r){console.error(r)}})}addEventListener(e,t){let s=this[ye].get(e);s||this[ye].set(e,s=[]),s.push(t)}removeEventListener(e,t){let s=this[ye].get(e);if(s){let r=s.indexOf(t);r!==-1&&s.splice(r,1)}}};function Bn(n,e){this.type=n,this.timeStamp=Date.now(),this.target=this.currentTarget=this.data=null}Er.exports=le.isMainThread?Uo():vo();var Co=Wn.pathToFileURL(process.cwd()+"/");function Uo(){class n extends Je{constructor(t,s){super();let{name:r,type:i}=s||{};t+="";let o;/^data:/.test(t)?o=t:o=Wn.fileURLToPath(new Wn.URL(t,Co));let c=new le.Worker(__filename,{workerData:{mod:o,name:r,type:i}});Object.defineProperty(this,Mn,{value:c}),c.on("message",u=>{let d=new Bn("message");d.data=u,this.dispatchEvent(d)}),c.on("error",u=>{u.type="error",this.dispatchEvent(u)}),c.on("exit",()=>{this.dispatchEvent(new Bn("close"))})}postMessage(t,s){this[Mn].postMessage(t,s)}terminate(){this[Mn].terminate()}}return n.prototype.onmessage=n.prototype.onerror=n.prototype.onclose=null,n}function vo(){let{mod:n,name:e,type:t}=le.workerData,s=global.self=global,r=[];function i(){let d=r;r=null,d.forEach(f=>{s.dispatchEvent(f)})}le.parentPort.on("message",d=>{let f=new Bn("message");f.data=d,r==null?s.dispatchEvent(f):r.push(f)}),le.parentPort.on("error",d=>{d.type="Error",s.dispatchEvent(d)});class o extends Je{postMessage(f,h){le.parentPort.postMessage(f,h)}close(){process.exit()}}let c=Object.getPrototypeOf(global);delete c.constructor,Object.defineProperties(o.prototype,c),c=Object.setPrototypeOf(global,new o),["postMessage","addEventListener","removeEventListener","dispatchEvent"].forEach(d=>{c[d]=c[d].bind(global)}),global.name=e;let u=/^data:/.test(n);if(t==="module")import(n).catch(d=>{if(u&&d.message==="Not supported")return console.warn("Worker(): Importing data: URLs requires Node 12.10+. Falling back to classic worker."),pr(n,e);console.error(d)}).then(i);else{try{/^data:/.test(n)?pr(n,e):require(n)}catch(d){console.error(d)}Promise.resolve().then(i)}}function pr(n,e){let{data:t}=Mo(n);return Po.runInThisContext(t,{filename:"worker.<"+(e||"data:")+">"})}function Mo(n){let[e,t,s,r]=n.match(/^data: *([^;,]*)(?: *; *([^,]*))? *,(.*)$/)||[];if(!e)throw Error("Invalid Data URL.");if(s)switch(s.toLowerCase()){case"base64":r=Buffer.from(r,"base64").toString();break;default:throw Error('Unknown Data URL encoding "'+s+'"')}return{type:t,data:r}}});var Bo={};Tr(Bo,{AsyncDuckDB:()=>Sn,AsyncDuckDBConnection:()=>ge,AsyncDuckDBDispatcher:()=>An,AsyncPreparedStatement:()=>ze,AsyncResultStreamIterator:()=>_e,ConsoleLogger:()=>Ze,DuckDBAccessMode:()=>jn,DuckDBDataProtocol:()=>On,IsArrowBuffer:()=>wr,IsDuckDBWasmRetry:()=>Lr,LogEvent:()=>Kn,LogLevel:()=>Yn,LogOrigin:()=>qn,LogTopic:()=>Qn,PACKAGE_NAME:()=>Nn,PACKAGE_VERSION:()=>wn,PACKAGE_VERSION_MAJOR:()=>Oo,PACKAGE_VERSION_MINOR:()=>Ao,PACKAGE_VERSION_PATCH:()=>No,StatusCode:()=>zn,TokenType:()=>Hn,VoidLogger:()=>Xe,WorkerRequestType:()=>Tn,WorkerResponseType:()=>kn,WorkerTask:()=>E,createWorker:()=>Wo,getJsDelivrBundles:()=>Do,getLogEventLabel:()=>Or,getLogLevelLabel:()=>Sr,getLogOriginLabel:()=>Nr,getLogTopicLabel:()=>Ar,getPlatformFeatures:()=>hr,isFirefox:()=>wo,isNode:()=>vn,isSafari:()=>Lo,selectBundle:()=>Fo});module.exports=kr(Bo);var jn=(r=>(r[r.UNDEFINED=0]="UNDEFINED",r[r.AUTOMATIC=1]="AUTOMATIC",r[r.READ_ONLY=2]="READ_ONLY",r[r.READ_WRITE=3]="READ_WRITE",r))(jn||{});var Hn=(o=>(o[o.IDENTIFIER=0]="IDENTIFIER",o[o.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",o[o.STRING_CONSTANT=2]="STRING_CONSTANT",o[o.OPERATOR=3]="OPERATOR",o[o.KEYWORD=4]="KEYWORD",o[o.COMMENT=5]="COMMENT",o))(Hn||{});var Yn=(i=>(i[i.NONE=0]="NONE",i[i.DEBUG=1]="DEBUG",i[i.INFO=2]="INFO",i[i.WARNING=3]="WARNING",i[i.ERROR=4]="ERROR",i))(Yn||{}),Qn=(o=>(o[o.NONE=0]="NONE",o[o.CONNECT=1]="CONNECT",o[o.DISCONNECT=2]="DISCONNECT",o[o.OPEN=3]="OPEN",o[o.QUERY=4]="QUERY",o[o.INSTANTIATE=5]="INSTANTIATE",o))(Qn||{}),Kn=(o=>(o[o.NONE=0]="NONE",o[o.OK=1]="OK",o[o.ERROR=2]="ERROR",o[o.START=3]="START",o[o.RUN=4]="RUN",o[o.CAPTURE=5]="CAPTURE",o))(Kn||{}),qn=(i=>(i[i.NONE=0]="NONE",i[i.WEB_WORKER=1]="WEB_WORKER",i[i.NODE_WORKER=2]="NODE_WORKER",i[i.BINDINGS=3]="BINDINGS",i[i.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",i))(qn||{}),Xe=class{log(e){}},Ze=class{constructor(e=2){this.level=e}log(e){e.level>=this.level&&console.log(e)}};function Sr(n){switch(n){case 0:return"NONE";case 1:return"DEBUG";case 2:return"INFO";case 3:return"WARNING";case 4:return"ERROR";default:return"?"}}function Or(n){switch(n){case 0:return"NONE";case 1:return"OK";case 2:return"ERROR";case 3:return"START";case 4:return"RUN";case 5:return"CAPTURE";default:return"?"}}function Ar(n){switch(n){case 1:return"CONNECT";case 2:return"DISCONNECT";case 5:return"INSTANTIATE";case 3:return"OPEN";case 4:return"QUERY";default:return"?"}}function Nr(n){switch(n){case 0:return"NONE";case 1:return"WEB WORKER";case 2:return"NODE WORKER";case 3:return"DUCKDB BINDINGS";case 4:return"DUCKDB";default:return"?"}}var zn=(s=>(s[s.SUCCESS=0]="SUCCESS",s[s.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",s[s.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",s))(zn||{});function wr(n){return n<=255}function Lr(n){return n===256}var bn=Vn(ir()),ge=class{constructor(e,t){this._bindings=e,this._conn=t}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(e){return e(this._bindings,this._conn)}async query(e){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let t=await this._bindings.runQuery(this._conn,e);return(0,bn.tableFromIPC)(t)}async send(e,t=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:e});let s=await this._bindings.startPendingQuery(this._conn,e,t);for(;s==null;){if(this._bindings.isDetached()){console.error("cannot send a message since the worker is not set!");return}s=await this._bindings.pollPendingQuery(this._conn)}return new _e(this._bindings,this._conn,s)}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(e){return await this._bindings.getTableNames(this._conn,e)}async prepare(e){let t=await this._bindings.createPrepared(this._conn,e);return new ze(this._bindings,this._conn,t)}async insertArrowFromIPCStream(e,t){await this._bindings.insertArrowFromIPCStream(this._conn,e,t)}async insertCSVFromPath(e,t){await this._bindings.insertCSVFromPath(this._conn,e,t)}async insertJSONFromPath(e,t){await this._bindings.insertJSONFromPath(this._conn,e,t)}},_e=class{constructor(e,t,s){this.db=e;this.conn=t;this.header=s;this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let e=null;for(this._inFlight!=null&&(e=await this._inFlight,this._inFlight=null);e==null;)e=await this.db.fetchQueryResults(this.conn);return this._depleted=e.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:e}}[Symbol.asyncIterator](){return this}},ze=class{constructor(e,t,s){this.bindings=e,this.connectionId=t,this.statementId=s}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...e){let t=await this.bindings.runPrepared(this.connectionId,this.statementId,e);return(0,bn.tableFromIPC)(t)}async send(...e){let t=await this.bindings.sendPrepared(this.connectionId,this.statementId,e);return new _e(this.bindings,this.connectionId,t)}};var Tn=(I=>(I.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",I.CLOSE_PREPARED="CLOSE_PREPARED",I.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",I.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",I.CONNECT="CONNECT",I.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",I.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",I.CREATE_PREPARED="CREATE_PREPARED",I.DISCONNECT="DISCONNECT",I.DROP_FILE="DROP_FILE",I.DROP_FILES="DROP_FILES",I.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",I.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",I.FLUSH_FILES="FLUSH_FILES",I.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",I.GET_TABLE_NAMES="GET_TABLE_NAMES",I.GET_VERSION="GET_VERSION",I.GLOB_FILE_INFOS="GLOB_FILE_INFOS",I.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",I.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",I.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",I.INSTANTIATE="INSTANTIATE",I.OPEN="OPEN",I.PING="PING",I.POLL_PENDING_QUERY="POLL_PENDING_QUERY",I.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",I.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",I.REGISTER_FILE_URL="REGISTER_FILE_URL",I.RESET="RESET",I.RUN_PREPARED="RUN_PREPARED",I.RUN_QUERY="RUN_QUERY",I.SEND_PREPARED="SEND_PREPARED",I.START_PENDING_QUERY="START_PENDING_QUERY",I.TOKENIZE="TOKENIZE",I))(Tn||{}),kn=(b=>(b.CONNECTION_INFO="CONNECTION_INFO",b.ERROR="ERROR",b.FEATURE_FLAGS="FEATURE_FLAGS",b.FILE_BUFFER="FILE_BUFFER",b.FILE_INFOS="FILE_INFOS",b.FILE_SIZE="FILE_SIZE",b.FILE_STATISTICS="FILE_STATISTICS",b.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",b.LOG="LOG",b.PROGRESS_UPDATE="PROGRESS_UPDATE",b.OK="OK",b.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",b.QUERY_PLAN="QUERY_PLAN",b.QUERY_RESULT="QUERY_RESULT",b.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",b.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",b.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",b.REGISTERED_FILE="REGISTERED_FILE",b.SCRIPT_TOKENS="SCRIPT_TOKENS",b.SUCCESS="SUCCESS",b.TABLE_NAMES="TABLE_NAMES",b.VERSION_STRING="VERSION_STRING",b))(kn||{}),E=class{constructor(e,t){this.promiseResolver=()=>{};this.promiseRejecter=()=>{};this.type=e,this.data=t,this.promise=new Promise((s,r)=>{this.promiseResolver=s,this.promiseRejecter=r})}};var yo=/'(opfs:\/\/\S*?)'/g,Ro=/(opfs:\/\/\S*?)/g;function or(n){return n.search(Ro)>-1}function ar(n){return[...n.matchAll(yo)].map(e=>e[1])}var bo=new TextEncoder,Sn=class{constructor(e,t=null){this._onInstantiationProgress=[];this._onExecutionProgress=[];this._worker=null;this._workerShutdownPromise=null;this._workerShutdownResolver=()=>{};this._nextMessageId=0;this._pendingRequests=new Map;this._config={};this._logger=e,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),t!=null&&this.attach(t)}get logger(){return this._logger}get config(){return this._config}attach(e){this._worker=e,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((t,s)=>{this._workerShutdownResolver=t})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(e,t=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!:"+e.type+","+e.data);return}let s=this._nextMessageId++;return this._pendingRequests.set(s,e),this._worker.postMessage({messageId:s,type:e.type,data:e.data},t),await e.promise}onMessage(e){var r;let t=e.data;switch(t.type){case"PROGRESS_UPDATE":{for(let i of this._onExecutionProgress)i(t.data);return}case"LOG":{this._logger.log(t.data);return}case"INSTANTIATE_PROGRESS":{for(let i of this._onInstantiationProgress)i(t.data);return}}let s=this._pendingRequests.get(t.requestId);if(!s){console.warn(`unassociated response: [${t.requestId}, ${t.type.toString()}]`);return}if(this._pendingRequests.delete(t.requestId),t.type=="ERROR"){let i=new Error(t.data.message);i.name=t.data.name,(r=Object.getOwnPropertyDescriptor(i,"stack"))!=null&&r.writable&&(i.stack=t.data.stack),s.promiseRejecter(i);return}switch(s.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(t.type=="OK"){s.promiseResolver(t.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],t.type=="OK"){s.promiseResolver(t.data);return}break;case"GLOB_FILE_INFOS":if(t.type=="FILE_INFOS"){s.promiseResolver(t.data);return}break;case"GET_VERSION":if(t.type=="VERSION_STRING"){s.promiseResolver(t.data);return}break;case"GET_FEATURE_FLAGS":if(t.type=="FEATURE_FLAGS"){s.promiseResolver(t.data);return}break;case"GET_TABLE_NAMES":if(t.type=="TABLE_NAMES"){s.promiseResolver(t.data);return}break;case"TOKENIZE":if(t.type=="SCRIPT_TOKENS"){s.promiseResolver(t.data);return}break;case"COPY_FILE_TO_BUFFER":if(t.type=="FILE_BUFFER"){s.promiseResolver(t.data);return}break;case"EXPORT_FILE_STATISTICS":if(t.type=="FILE_STATISTICS"){s.promiseResolver(t.data);return}break;case"CONNECT":if(t.type=="CONNECTION_INFO"){s.promiseResolver(t.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(t.type=="QUERY_RESULT"){s.promiseResolver(t.data);return}break;case"SEND_PREPARED":if(t.type=="QUERY_RESULT_HEADER"){s.promiseResolver(t.data);return}break;case"START_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"POLL_PENDING_QUERY":if(t.type=="QUERY_RESULT_HEADER_OR_NULL"){s.promiseResolver(t.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],t.type=="SUCCESS"){s.promiseResolver(t.data);return}break;case"FETCH_QUERY_RESULTS":if(t.type=="QUERY_RESULT_CHUNK"){s.promiseResolver(t.data);return}break;case"CREATE_PREPARED":if(t.type=="PREPARED_STATEMENT_ID"){s.promiseResolver(t.data);return}break}s.promiseRejecter(new Error(`unexpected response type: ${t.type.toString()}`))}onError(e){console.error(e),console.error(`error in duckdb worker: ${e.message}`),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);return}this._pendingRequests.clear()}isDetached(){return!this._worker}async reset(){let e=new E("RESET",null);return await this.postTask(e)}async ping(){let e=new E("PING",null);await this.postTask(e)}async dropFile(e){let t=new E("DROP_FILE",e);return await this.postTask(t)}async dropFiles(e){let t=new E("DROP_FILES",e);return await this.postTask(t)}async flushFiles(){let e=new E("FLUSH_FILES",null);return await this.postTask(e)}async instantiate(e,t=null,s=r=>{}){this._onInstantiationProgress.push(s);let r=new E("INSTANTIATE",[e,t]);return await this.postTask(r)}async getVersion(){let e=new E("GET_VERSION",null);return await this.postTask(e)}async getFeatureFlags(){let e=new E("GET_FEATURE_FLAGS",null);return await this.postTask(e)}async open(e){this._config=e;let t=new E("OPEN",e);await this.postTask(t)}async tokenize(e){let t=new E("TOKENIZE",e);return await this.postTask(t)}async connectInternal(){let e=new E("CONNECT",null);return await this.postTask(e)}async connect(){let e=await this.connectInternal();return new ge(this,e)}async disconnect(e){let t=new E("DISCONNECT",e);await this.postTask(t)}async runQuery(e,t){if(this.shouldOPFSFileHandling()){let s=await this.registerOPFSFileFromSQL(t);try{return await this._runQueryAsync(e,t)}finally{s.length>0&&await this.dropFiles(s)}}else return await this._runQueryAsync(e,t)}async _runQueryAsync(e,t){let s=new E("RUN_QUERY",[e,t]);return await this.postTask(s)}async startPendingQuery(e,t,s=!1){if(this.shouldOPFSFileHandling()){let r=await this.registerOPFSFileFromSQL(t);try{return await this._startPendingQueryAsync(e,t,s)}finally{r.length>0&&await this.dropFiles(r)}}else return await this._startPendingQueryAsync(e,t,s)}async _startPendingQueryAsync(e,t,s=!1){let r=new E("START_PENDING_QUERY",[e,t,s]);return await this.postTask(r)}async pollPendingQuery(e){let t=new E("POLL_PENDING_QUERY",e);return await this.postTask(t)}async cancelPendingQuery(e){let t=new E("CANCEL_PENDING_QUERY",e);return await this.postTask(t)}async fetchQueryResults(e){let t=new E("FETCH_QUERY_RESULTS",e);return await this.postTask(t)}async getTableNames(e,t){let s=new E("GET_TABLE_NAMES",[e,t]);return await this.postTask(s)}async createPrepared(e,t){let s=new E("CREATE_PREPARED",[e,t]);return await this.postTask(s)}async closePrepared(e,t){let s=new E("CLOSE_PREPARED",[e,t]);await this.postTask(s)}async runPrepared(e,t,s){let r=new E("RUN_PREPARED",[e,t,s]);return await this.postTask(r)}async sendPrepared(e,t,s){let r=new E("SEND_PREPARED",[e,t,s]);return await this.postTask(r)}async globFiles(e){let t=new E("GLOB_FILE_INFOS",e);return await this.postTask(t)}async registerFileText(e,t){let s=bo.encode(t);await this.registerFileBuffer(e,s)}async registerFileURL(e,t,s,r){t===void 0&&(t=e);let i=new E("REGISTER_FILE_URL",[e,t,s,r]);await this.postTask(i)}async registerEmptyFileBuffer(e){}async registerFileBuffer(e,t){let s=new E("REGISTER_FILE_BUFFER",[e,t]);await this.postTask(s,[t.buffer])}async registerFileHandle(e,t,s,r){let i=new E("REGISTER_FILE_HANDLE",[e,t,s,r]);await this.postTask(i,[])}async registerOPFSFileName(e){let t=new E("REGISTER_OPFS_FILE_NAME",[e]);await this.postTask(t,[])}async collectFileStatistics(e,t){let s=new E("COLLECT_FILE_STATISTICS",[e,t]);await this.postTask(s,[])}async exportFileStatistics(e){let t=new E("EXPORT_FILE_STATISTICS",e);return await this.postTask(t,[])}async copyFileToBuffer(e){let t=new E("COPY_FILE_TO_BUFFER",e);return await this.postTask(t)}async copyFileToPath(e,t){let s=new E("COPY_FILE_TO_PATH",[e,t]);await this.postTask(s)}async insertArrowFromIPCStream(e,t,s){if(t.length==0)return;let r=new E("INSERT_ARROW_FROM_IPC_STREAM",[e,t,s]);await this.postTask(r,[t.buffer])}async insertCSVFromPath(e,t,s){let r=new E("IMPORT_CSV_FROM_PATH",[e,t,s]);await this.postTask(r)}async insertJSONFromPath(e,t,s){let r=new E("IMPORT_JSON_FROM_PATH",[e,t,s]);await this.postTask(r)}shouldOPFSFileHandling(){var e;return or(this.config.path??"")?((e=this.config.opfs)==null?void 0:e.fileHandling)=="auto":!1}async registerOPFSFileFromSQL(e){let t=ar(e),s=[];for(let r of t)try{await this.registerOPFSFileName(r),s.push(r)}catch(i){throw console.error(i),new Error("File Not found:"+r)}return s}};function To(){let n=new TextDecoder;return e=>(typeof SharedArrayBuffer<"u"&&e.buffer instanceof SharedArrayBuffer&&(e=new Uint8Array(e)),n.decode(e))}var oa=To();var On=(o=>(o[o.BUFFER=0]="BUFFER",o[o.NODE_FS=1]="NODE_FS",o[o.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",o[o.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",o[o.HTTP=4]="HTTP",o[o.S3=5]="S3",o))(On||{});var An=class{constructor(){this._bindings=null;this._nextMessageId=0}log(e){this.postMessage({messageId:this._nextMessageId++,requestId:0,type:"LOG",data:e},[])}sendOK(e){this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"OK",data:null},[])}failWith(e,t){let s={name:t.name,message:t.message,stack:t.stack||void 0};this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"ERROR",data:s},[])}async onMessage(e){switch(e.type){case"PING":this.sendOK(e);return;case"INSTANTIATE":this._bindings!=null&&this.failWith(e,new Error("duckdb already initialized"));try{this._bindings=await this.instantiate(e.data[0],e.data[1],t=>{this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"INSTANTIATE_PROGRESS",data:t},[])}),this.sendOK(e)}catch(t){console.log(t),this._bindings=null,this.failWith(e,t)}return;default:break}if(!this._bindings)return this.failWith(e,new Error("duckdb is not initialized"));try{switch(e.type){case"GET_VERSION":this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"VERSION_STRING",data:this._bindings.getVersion()},[]);break;case"GET_FEATURE_FLAGS":this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"FEATURE_FLAGS",data:this._bindings.getFeatureFlags()},[]);break;case"RESET":this._bindings.reset(),this.sendOK(e);break;case"OPEN":{let t=e.data.path;t!=null&&t.startsWith("opfs://")&&(await this._bindings.prepareDBFileHandle(t,3),e.data.useDirectIO=!0),this._bindings.open(e.data),this.sendOK(e);break}case"DROP_FILE":this._bindings.dropFile(e.data),this.sendOK(e);break;case"DROP_FILES":this._bindings.dropFiles(e.data),this.sendOK(e);break;case"FLUSH_FILES":this._bindings.flushFiles(),this.sendOK(e);break;case"CONNECT":{let t=this._bindings.connect();this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"CONNECTION_INFO",data:t.useUnsafe((s,r)=>r)},[]);break}case"DISCONNECT":this._bindings.disconnect(e.data),this.sendOK(e);break;case"CREATE_PREPARED":{let t=this._bindings.createPrepared(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"PREPARED_STATEMENT_ID",data:t},[]);break}case"CLOSE_PREPARED":{this._bindings.closePrepared(e.data[0],e.data[1]),this.sendOK(e);break}case"RUN_PREPARED":{let t=this._bindings.runPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT",data:t},[t.buffer]);break}case"RUN_QUERY":{let t=this._bindings.runQuery(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT",data:t},[t.buffer]);break}case"SEND_PREPARED":{let t=this._bindings.sendPrepared(e.data[0],e.data[1],e.data[2]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT_HEADER",data:t},[t.buffer]);break}case"START_PENDING_QUERY":{let t=this._bindings.startPendingQuery(e.data[0],e.data[1],e.data[2]),s=[];t&&s.push(t.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:t},s);break}case"POLL_PENDING_QUERY":{let t=this._bindings.pollPendingQuery(e.data),s=[];t&&s.push(t.buffer),this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT_HEADER_OR_NULL",data:t},s);break}case"CANCEL_PENDING_QUERY":{let t=this._bindings.cancelPendingQuery(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"SUCCESS",data:t},[]);break}case"FETCH_QUERY_RESULTS":{let t=this._bindings.fetchQueryResults(e.data),s=t?[t.buffer]:[];this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"QUERY_RESULT_CHUNK",data:t},s);break}case"GET_TABLE_NAMES":{let t=this._bindings.getTableNames(e.data[0],e.data[1]);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"TABLE_NAMES",data:t},[]);break}case"GLOB_FILE_INFOS":{let t=this._bindings.globFiles(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"FILE_INFOS",data:t},[]);break}case"REGISTER_FILE_URL":this._bindings.registerFileURL(e.data[0],e.data[1],e.data[2],e.data[3]),this.sendOK(e);break;case"REGISTER_FILE_BUFFER":this._bindings.registerFileBuffer(e.data[0],e.data[1]),this.sendOK(e);break;case"REGISTER_FILE_HANDLE":await this._bindings.registerFileHandleAsync(e.data[0],e.data[1],e.data[2],e.data[3]),this.sendOK(e);break;case"COPY_FILE_TO_PATH":this._bindings.copyFileToPath(e.data[0],e.data[1]),this.sendOK(e);break;case"COPY_FILE_TO_BUFFER":{let t=this._bindings.copyFileToBuffer(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"FILE_BUFFER",data:t},[]);break}case"COLLECT_FILE_STATISTICS":this._bindings.collectFileStatistics(e.data[0],e.data[1]),this.sendOK(e);break;case"REGISTER_OPFS_FILE_NAME":await this._bindings.registerOPFSFileName(e.data[0]),this.sendOK(e);break;case"EXPORT_FILE_STATISTICS":{this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"FILE_STATISTICS",data:this._bindings.exportFileStatistics(e.data)},[]);break}case"INSERT_ARROW_FROM_IPC_STREAM":{this._bindings.insertArrowFromIPCStream(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case"IMPORT_CSV_FROM_PATH":{this._bindings.insertCSVFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case"IMPORT_JSON_FROM_PATH":{this._bindings.insertJSONFromPath(e.data[0],e.data[1],e.data[2]),this.sendOK(e);break}case"TOKENIZE":{let t=this._bindings.tokenize(e.data);this.postMessage({messageId:this._nextMessageId++,requestId:e.messageId,type:"SCRIPT_TOKENS",data:t},[]);break}}}catch(t){return console.log(t),this.failWith(e,t)}}};var cr=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),ur=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11]));var dr=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));var lr=()=>(async n=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(n)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));var $e={name:"@duckdb/duckdb-wasm",version:"1.11.0",description:"DuckDB powered by WebAssembly",license:"MIT",repository:{type:"git",url:"https://github.com/duckdb/duckdb-wasm.git"},keywords:["sql","duckdb","relational","database","data","query","wasm","analytics","olap","arrow","parquet","json","csv"],dependencies:{"@nodelib/fs.stat":"^4.0.0","@nodelib/fs.walk":"^3.0.1","@uwdata/flechette":"latest","fast-glob":"^3.3.3","glob-parent":"^6.0.2",merge2:"^1.4.1",micromatch:"^4.0.8"},devDependencies:{"@nodelib/fs.stat":"^4.0.0","@nodelib/fs.walk":"^3.0.1","@types/emscripten":"^1.39.10","@types/jasmine":"^5.1.4","@types/merge2":"^1","@types/micromatch":"^4","@typescript-eslint/eslint-plugin":"^6.21.0","@typescript-eslint/parser":"^6.21.0",esbuild:"^0.20.2",eslint:"^8.57.0","eslint-plugin-jasmine":"^4.1.3","eslint-plugin-react":"^7.34.0",glob:"^13.0.0",jasmine:"^5.1.0","jasmine-core":"^5.1.2","jasmine-spec-reporter":"^7.0.0","js-sha256":"^0.11.1",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-firefox-launcher":"^2.1.3","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","karma-sourcemap-loader":"^0.4.0","karma-spec-reporter":"^0.0.36","make-dir":"^4.0.0",nyc:"^15.1.0",prettier:"^3.2.5",puppeteer:"^22.8.0",rimraf:"^3.0.2",s3rver:"^3.7.1",semver:"^7.6.0",typedoc:"^0.25.13",typescript:"^5.3.3","wasm-feature-detect":"^1.6.1","web-worker":"^1.2.0"},scripts:{"build:debug":"node bundle.mjs debug && tsc --emitDeclarationOnly","build:release":"node bundle.mjs release && tsc --emitDeclarationOnly",docs:"typedoc",format:'prettier --write "**/*.+(js|ts)"',report:"node ./coverage.mjs","test:node":"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:debug":"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:node:coverage":"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs","test:firefox":"karma start ./karma/tests-firefox.cjs","test:chrome":"karma start ./karma/tests-chrome.cjs","test:chrome:eh":"karma start ./karma/tests-chrome-eh.cjs","test:chrome:coverage":"karma start ./karma/tests-chrome-coverage.cjs","test:browser":"karma start ./karma/tests-all.cjs","test:browser:debug":"karma start ./karma/tests-debug.cjs",test:"npm run test:chrome && npm run test:node","test:coverage":"npm run test:chrome:coverage && npm run test:node:coverage && npm run report",lint:"eslint src test"},files:["dist","!dist/tests-*","!dist/duckdb-browser-mvp.worker.js.map","!dist/types/test"],main:"dist/duckdb-browser.cjs",module:"dist/duckdb-browser.mjs",types:"dist/duckdb-browser.d.ts",jsdelivr:"dist/duckdb-browser.cjs",unpkg:"dist/duckdb-browser.mjs",sideEffects:!1,browser:{fs:!1,os:!1,path:!1,perf_hooks:!1,worker_threads:!1},exports:{"./dist/duckdb-mvp.wasm":"./dist/duckdb-mvp.wasm","./dist/duckdb-eh.wasm":"./dist/duckdb-eh.wasm","./dist/duckdb-coi.wasm":"./dist/duckdb-coi.wasm","./dist/duckdb-browser":"./dist/duckdb-browser.mjs","./dist/duckdb-browser.cjs":"./dist/duckdb-browser.cjs","./dist/duckdb-browser.mjs":"./dist/duckdb-browser.mjs","./dist/duckdb-browser-coi.pthread.worker.js":"./dist/duckdb-browser-coi.pthread.worker.js","./dist/duckdb-browser-coi.worker.js":"./dist/duckdb-browser-coi.worker.js","./dist/duckdb-browser-eh.worker.js":"./dist/duckdb-browser-eh.worker.js","./dist/duckdb-browser-mvp.worker.js":"./dist/duckdb-browser-mvp.worker.js","./dist/duckdb-node":"./dist/duckdb-node.cjs","./dist/duckdb-node.cjs":"./dist/duckdb-node.cjs","./dist/duckdb-node-blocking":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-blocking.cjs":"./dist/duckdb-node-blocking.cjs","./dist/duckdb-node-eh.worker.cjs":"./dist/duckdb-node-eh.worker.cjs","./dist/duckdb-node-mvp.worker.cjs":"./dist/duckdb-node-mvp.worker.cjs","./blocking":{node:{types:"./dist/duckdb-node-blocking.d.ts",require:"./dist/duckdb-node-blocking.cjs",import:"./dist/duckdb-node-blocking.cjs"},types:"./dist/duckdb-node-blocking.d.ts",import:"./dist/duckdb-node-blocking.mjs",require:"./dist/duckdb-node-blocking.cjs"},".":{browser:{types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"},node:{types:"./dist/duckdb-node.d.ts",import:"./dist/duckdb-node.cjs",require:"./dist/duckdb-node.cjs"},types:"./dist/duckdb-browser.d.ts",import:"./dist/duckdb-browser.mjs",require:"./dist/duckdb-browser.cjs"}}};var Nn=$e.name,wn=$e.version,Ln=$e.version.split("."),Oo=Ln[0],Ao=Ln[1],No=Ln[2];var vn=()=>typeof navigator>"u",fr=()=>vn()?"node":navigator.userAgent,wo=()=>fr().includes("Firefox"),Lo=()=>/^((?!chrome|android).)*safari/i.test(fr());function Do(){let n=`https://cdn.jsdelivr.net/npm/${Nn}@${wn}/dist/`;return{mvp:{mainModule:`${n}duckdb-mvp.wasm`,mainWorker:`${n}duckdb-browser-mvp.worker.js`},eh:{mainModule:`${n}duckdb-eh.wasm`,mainWorker:`${n}duckdb-browser-eh.worker.js`}}}var Dn=null,Fn=null,Pn=null,Cn=null,Un=null;async function hr(){return Dn==null&&(Dn=typeof BigInt64Array<"u"),Fn==null&&(Fn=await ur()),Pn==null&&(Pn=await lr()),Cn==null&&(Cn=await dr()),Un==null&&(Un=await cr()),{bigInt64Array:Dn,crossOriginIsolated:vn()||globalThis.crossOriginIsolated||!1,wasmExceptions:Fn,wasmSIMD:Cn,wasmThreads:Pn,wasmBulkMemory:Un}}async function Fo(n){let e=await hr();if(e.wasmExceptions){if(e.wasmSIMD&&e.wasmThreads&&e.crossOriginIsolated&&n.coi)return{mainModule:n.coi.mainModule,mainWorker:n.coi.mainWorker,pthreadWorker:n.coi.pthreadWorker};if(n.eh)return{mainModule:n.eh.mainModule,mainWorker:n.eh.mainWorker,pthreadWorker:null}}return{mainModule:n.mvp.mainModule,mainWorker:n.mvp.mainWorker,pthreadWorker:null}}var Ir=Vn(mr());async function Wo(n){let e=new Request(n),t=await fetch(e),s=URL.createObjectURL(await t.blob());return new Ir.default(s)}0&&(module.exports={AsyncDuckDB,AsyncDuckDBConnection,AsyncDuckDBDispatcher,AsyncPreparedStatement,AsyncResultStreamIterator,ConsoleLogger,DuckDBAccessMode,DuckDBDataProtocol,IsArrowBuffer,IsDuckDBWasmRetry,LogEvent,LogLevel,LogOrigin,LogTopic,PACKAGE_NAME,PACKAGE_VERSION,PACKAGE_VERSION_MAJOR,PACKAGE_VERSION_MINOR,PACKAGE_VERSION_PATCH,StatusCode,TokenType,VoidLogger,WorkerRequestType,WorkerResponseType,WorkerTask,createWorker,getJsDelivrBundles,getLogEventLabel,getLogLevelLabel,getLogOriginLabel,getLogTopicLabel,getPlatformFeatures,isFirefox,isNode,isSafari,selectBundle});
//# sourceMappingURL=duckdb-node.cjs.map
