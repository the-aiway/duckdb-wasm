{
  "version": 3,
  "sources": ["../../../../../mods/data/yarn/berry/cache/web-worker-npm-1.2.0-ef71df710e-10c0.zip/node_modules/web-worker/cjs/browser.js", "../src/bindings/config.ts", "../src/bindings/tokens.ts", "../src/log.ts", "../src/status.ts", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/constants.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/arrays.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/objects.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/data-types.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/numbers.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/strings.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/read.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/util/struct.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/batch.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/column.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/table.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/batch-type.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/block.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/record-batch.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/dictionary-batch.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/data-type.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/metadata.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/schema.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/message.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/decode-ipc.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/decode/table-from-ipc.js", "../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/src/encode/schema.js", "../src/parallel/async_connection.ts", "../src/parallel/worker_request.ts", "../src/utils/opfs_util.ts", "../src/parallel/async_bindings.ts", "../src/bindings/runtime.ts", "../src/parallel/worker_dispatcher.ts", "../../../../../mods/data/yarn/berry/cache/wasm-feature-detect-npm-1.6.1-a6f6bca5d0-10c0.zip/node_modules/wasm-feature-detect/dist/esm/index.js", "../package.json", "../src/version.ts", "../src/platform.ts", "../src/worker.ts"],
  "sourcesContent": ["/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nmodule.exports = Worker;", "export interface DuckDBQueryConfig {\n    /**\n     * The polling interval for queries\n     */\n    queryPollingInterval?: number;\n    /**\n     * Cast BigInt to Double?\n     */\n    castBigIntToDouble?: boolean;\n    /**\n     * Cast Timestamp to Date64?\n     */\n    castTimestampToDate?: boolean;\n    /**\n     * Cast Timestamp to Date64?\n     */\n    castDurationToTime64?: boolean;\n    /**\n     * Cast Decimal to Double?\n     */\n    castDecimalToDouble?: boolean;\n}\n\nexport interface DuckDBFilesystemConfig {\n    reliableHeadRequests?: boolean;\n    /**\n     * Allow falling back to full HTTP reads if the server does not support range requests.\n     */\n    allowFullHTTPReads?: boolean;\n    /**\n     * Force use of full HTTP reads, suppressing range requests.\n     */\n    forceFullHTTPReads?: boolean;\n}\n\nexport interface DuckDBOPFSConfig {\n    /**\n     * Defines how `opfs://` files are handled during SQL execution.\n     * - \"auto\": Automatically register `opfs://` files and drop them after execution.\n     * - \"manual\": Files must be manually registered and dropped.\n     */\n    fileHandling?: 'auto' | 'manual';\n}\n\nexport enum DuckDBAccessMode {\n    UNDEFINED = 0,\n    AUTOMATIC = 1,\n    READ_ONLY = 2,\n    READ_WRITE = 3,\n}\n\nexport interface DuckDBConfig {\n    /**\n     * The database path\n     */\n    path?: string;\n    /**\n     * The access mode\n     */\n    accessMode?: DuckDBAccessMode;\n    /**\n     * The maximum number of threads.\n     * Note that this will only work with cross-origin isolated sites since it requires SharedArrayBuffers.\n     */\n    maximumThreads?: number;\n    /**\n     * The direct io flag\n     */\n    useDirectIO?: boolean;\n    /**\n     * The query config\n     */\n    query?: DuckDBQueryConfig;\n    /**\n     * The filesystem config\n     */\n    filesystem?: DuckDBFilesystemConfig;\n    /**\n     * Whether to allow unsigned extensions\n     */\n    allowUnsignedExtensions?: boolean;\n    /**\n     * Whether to use alternate Arrow conversion that preserves full range and precision of data.\n     */\n    arrowLosslessConversion?: boolean;\n    /**\n     * Custom user agent string\n     */\n    customUserAgent?: string;\n    /**\n     * Authentication token for HTTP requests.\n     * Will be sent as \"Authorization: Bearer <token>\" header with all HTTP requests.\n     */\n    authToken?: string;\n    /**\n     * opfs string\n     */\n    opfs?: DuckDBOPFSConfig;\n}\n", "export enum TokenType {\n    IDENTIFIER = 0,\n    NUMERIC_CONSTANT = 1,\n    STRING_CONSTANT = 2,\n    OPERATOR = 3,\n    KEYWORD = 4,\n    COMMENT = 5,\n}\n\nexport interface ScriptTokens {\n    offsets: number[];\n    types: TokenType[];\n}\n", "export enum LogLevel {\n    NONE = 0,\n    DEBUG = 1,\n    INFO = 2,\n    WARNING = 3,\n    ERROR = 4,\n}\n\nexport enum LogTopic {\n    NONE = 0,\n    CONNECT = 1,\n    DISCONNECT = 2,\n    OPEN = 3,\n    QUERY = 4,\n    INSTANTIATE = 5,\n}\n\nexport enum LogEvent {\n    NONE = 0,\n    OK = 1,\n    ERROR = 2,\n    START = 3,\n    RUN = 4,\n    CAPTURE = 5,\n}\n\nexport enum LogOrigin {\n    NONE = 0,\n    WEB_WORKER = 1,\n    NODE_WORKER = 2,\n    BINDINGS = 3,\n    ASYNC_DUCKDB = 4,\n}\n\nexport type LogEntry<O, T, E, V> = {\n    readonly timestamp: Date;\n    readonly level: LogLevel;\n    readonly origin: O;\n    readonly topic: T;\n    readonly event: E;\n    readonly value: V;\n};\n\nexport type ProgressEntry = {\n    readonly status: string;\n    readonly percentage: string;\n    readonly repetitions: string;\n};\n\n/** An execution progress handler */\nexport type ExecutionProgressHandler = (p: ProgressEntry) => void;\n\nexport type LogEntryVariant =\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.INSTANTIATE, LogEvent.ERROR, string>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.START, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.CONNECT, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.CONNECT, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.DISCONNECT, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.DISCONNECT, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.START, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.ASYNC_DUCKDB, LogTopic.QUERY, LogEvent.RUN, string>;\n\nexport interface Logger {\n    log(entry: LogEntryVariant): void;\n}\n\nexport class VoidLogger implements Logger {\n    public log(_entry: LogEntryVariant): void {}\n}\n\nexport class ConsoleLogger implements Logger {\n    constructor(protected level: LogLevel = LogLevel.INFO) {}\n    public log(entry: LogEntryVariant): void {\n        if (entry.level >= this.level) {\n            console.log(entry);\n        }\n    }\n}\n\nexport function getLogLevelLabel(level: LogLevel): string {\n    switch (level) {\n        case LogLevel.NONE:\n            return 'NONE';\n        case LogLevel.DEBUG:\n            return 'DEBUG';\n        case LogLevel.INFO:\n            return 'INFO';\n        case LogLevel.WARNING:\n            return 'WARNING';\n        case LogLevel.ERROR:\n            return 'ERROR';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogEventLabel(event: LogEvent): string {\n    switch (event) {\n        case LogEvent.NONE:\n            return 'NONE';\n        case LogEvent.OK:\n            return 'OK';\n        case LogEvent.ERROR:\n            return 'ERROR';\n        case LogEvent.START:\n            return 'START';\n        case LogEvent.RUN:\n            return 'RUN';\n        case LogEvent.CAPTURE:\n            return 'CAPTURE';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogTopicLabel(topic: LogTopic): string {\n    switch (topic) {\n        case LogTopic.CONNECT:\n            return 'CONNECT';\n        case LogTopic.DISCONNECT:\n            return 'DISCONNECT';\n        case LogTopic.INSTANTIATE:\n            return 'INSTANTIATE';\n        case LogTopic.OPEN:\n            return 'OPEN';\n        case LogTopic.QUERY:\n            return 'QUERY';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogOriginLabel(origin: LogOrigin): string {\n    switch (origin) {\n        case LogOrigin.NONE:\n            return 'NONE';\n        case LogOrigin.WEB_WORKER:\n            return 'WEB WORKER';\n        case LogOrigin.NODE_WORKER:\n            return 'NODE WORKER';\n        case LogOrigin.BINDINGS:\n            return 'DUCKDB BINDINGS';\n        case LogOrigin.ASYNC_DUCKDB:\n            return 'DUCKDB';\n        default:\n            return '?';\n    }\n}\n", "export enum StatusCode {\n    SUCCESS = 0,\n    MAX_ARROW_ERROR = 255,\n    DUCKDB_WASM_RETRY = 256,\n}\n\nexport function IsArrowBuffer(status: StatusCode): boolean {\n    return status <= StatusCode.MAX_ARROW_ERROR;\n}\n\nexport function IsDuckDBWasmRetry(status: StatusCode): boolean {\n    return status === StatusCode.DUCKDB_WASM_RETRY;\n}\n", "/** Magic bytes 'ARROW1' indicating the Arrow 'file' format. */\nexport const MAGIC = Uint8Array.of(65, 82, 82, 79, 87, 49);\n\n/** Bytes for an 'end of stream' message. */\nexport const EOS = Uint8Array.of(255, 255, 255, 255, 0, 0, 0, 0);\n\n/**\n * Apache Arrow version.\n */\nexport const Version = /** @type {const} */ ({\n  /** 0.1.0 (October 2016). */\n  V1: 0,\n  /** 0.2.0 (February 2017). Non-backwards compatible with V1. */\n  V2: 1,\n  /** 0.3.0 -> 0.7.1 (May - December 2017). Non-backwards compatible with V2. */\n  V3: 2,\n  /** >= 0.8.0 (December 2017). Non-backwards compatible with V3. */\n  V4: 3,\n  /**\n   * >= 1.0.0 (July 2020). Backwards compatible with V4 (V5 readers can read V4\n   * metadata and IPC messages). Implementations are recommended to provide a\n   * V4 compatibility mode with V5 format changes disabled.\n   *\n   * Incompatible changes between V4 and V5:\n   * - Union buffer layout has changed.\n   *   In V5, Unions don't have a validity bitmap buffer.\n   */\n  V5: 4\n});\n\n/**\n * Endianness of Arrow-encoded data.\n */\nexport const Endianness = /** @type {const} */ ({\n  Little: 0,\n  Big: 1\n});\n\n/**\n * Message header type codes.\n */\nexport const MessageHeader = /** @type {const} */ ({\n  NONE: 0,\n  /**\n   * A Schema describes the columns in a record batch.\n   */\n  Schema: 1,\n  /**\n   * For sending dictionary encoding information. Any Field can be\n   * dictionary-encoded, but in this case none of its children may be\n   * dictionary-encoded.\n   * There is one vector / column per dictionary, but that vector / column\n   * may be spread across multiple dictionary batches by using the isDelta\n   * flag.\n   */\n  DictionaryBatch: 2,\n  /**\n   * A data header describing the shared memory layout of a \"record\" or \"row\"\n   * batch. Some systems call this a \"row batch\" internally and others a \"record\n   * batch\".\n   */\n  RecordBatch: 3,\n  /**\n   * EXPERIMENTAL: Metadata for n-dimensional arrays, aka \"tensors\" or\n   * \"ndarrays\". Arrow implementations in general are not required to implement\n   * this type.\n   *\n   * Not currently supported by Flechette.\n   */\n  Tensor: 4,\n  /**\n   * EXPERIMENTAL: Metadata for n-dimensional sparse arrays, aka \"sparse\n   * tensors\". Arrow implementations in general are not required to implement\n   * this type.\n   *\n   * Not currently supported by Flechette.\n   */\n  SparseTensor: 5\n});\n\n/**\n * Field data type ids.\n * Only non-negative values ever occur in IPC flatbuffer binary data.\n */\nexport const Type = /** @type {const} */ ({\n  /**\n   * Dictionary types compress data by using a set of integer indices to\n   * lookup potentially repeated vales in a separate dictionary of values.\n   *\n   * This type entry is provided for API convenience, it does not occur\n   * in actual Arrow IPC binary data.\n   */\n  Dictionary: -1,\n  /** No data type. Included for flatbuffer compatibility. */\n  NONE: 0,\n  /** Null values only. */\n  Null: 1,\n  /** Integers, either signed or unsigned, with 8, 16, 32, or 64 bit widths. */\n  Int: 2,\n  /** Floating point numbers with 16, 32, or 64 bit precision. */\n  Float: 3,\n  /** Opaque binary data. */\n  Binary: 4,\n  /** Unicode with UTF-8 encoding. */\n  Utf8: 5,\n  /** Booleans represented as 8 bit bytes. */\n  Bool: 6,\n  /**\n   * Exact decimal value represented as an integer value in two's complement.\n   * Currently only 128-bit (16-byte) and 256-bit (32-byte) integers are used.\n   * The representation uses the endianness indicated in the schema.\n   */\n  Decimal: 7,\n  /**\n   * Date is either a 32-bit or 64-bit signed integer type representing an\n   * elapsed time since UNIX epoch (1970-01-01), stored in either of two units:\n   * - Milliseconds (64 bits) indicating UNIX time elapsed since the epoch (no\n   * leap seconds), where the values are evenly divisible by 86400000\n   * - Days (32 bits) since the UNIX epoch\n   */\n  Date: 8,\n  /**\n   * Time is either a 32-bit or 64-bit signed integer type representing an\n   * elapsed time since midnight, stored in either of four units: seconds,\n   * milliseconds, microseconds or nanoseconds.\n   *\n   * The integer `bitWidth` depends on the `unit` and must be one of the following:\n   * - SECOND and MILLISECOND: 32 bits\n   * - MICROSECOND and NANOSECOND: 64 bits\n   *\n   * The allowed values are between 0 (inclusive) and 86400 (=24*60*60) seconds\n   * (exclusive), adjusted for the time unit (for example, up to 86400000\n   * exclusive for the MILLISECOND unit).\n   * This definition doesn't allow for leap seconds. Time values from\n   * measurements with leap seconds will need to be corrected when ingesting\n   * into Arrow (for example by replacing the value 86400 with 86399).\n   */\n  Time: 9,\n  /**\n   * Timestamp is a 64-bit signed integer representing an elapsed time since a\n   * fixed epoch, stored in either of four units: seconds, milliseconds,\n   * microseconds or nanoseconds, and is optionally annotated with a timezone.\n   *\n   * Timestamp values do not include any leap seconds (in other words, all\n   * days are considered 86400 seconds long).\n   *\n   * The timezone is an optional string for the name of a timezone, one of:\n   *\n   *  - As used in the Olson timezone database (the \"tz database\" or\n   *    \"tzdata\"), such as \"America/New_York\".\n   *  - An absolute timezone offset of the form \"+XX:XX\" or \"-XX:XX\",\n   *    such as \"+07:30\".\n   *\n   * Whether a timezone string is present indicates different semantics about\n   * the data.\n   */\n  Timestamp: 10,\n  /**\n   * A \"calendar\" interval which models types that don't necessarily\n   * have a precise duration without the context of a base timestamp (e.g.\n   * days can differ in length during day light savings time transitions).\n   * All integers in the units below are stored in the endianness indicated\n   * by the schema.\n   *\n   *  - YEAR_MONTH - Indicates the number of elapsed whole months, stored as\n   *    4-byte signed integers.\n   *  - DAY_TIME - Indicates the number of elapsed days and milliseconds (no\n   *    leap seconds), stored as 2 contiguous 32-bit signed integers (8-bytes\n   *    in total). Support of this IntervalUnit is not required for full arrow\n   *    compatibility.\n   *  - MONTH_DAY_NANO - A triple of the number of elapsed months, days, and\n   *    nanoseconds. The values are stored contiguously in 16-byte blocks.\n   *    Months and days are encoded as 32-bit signed integers and nanoseconds\n   *    is encoded as a 64-bit signed integer. Nanoseconds does not allow for\n   *    leap seconds. Each field is independent (e.g. there is no constraint\n   *    that nanoseconds have the same sign as days or that the quantity of\n   *    nanoseconds represents less than a day's worth of time).\n   */\n  Interval: 11,\n  /**\n   * List (vector) data supporting variably-sized lists.\n   * A list has a single child data type for list entries.\n   */\n  List: 12,\n  /**\n   * A struct consisting of multiple named child data types.\n   */\n  Struct: 13,\n  /**\n   * A union is a complex type with parallel child data types. By default ids\n   * in the type vector refer to the offsets in the children. Optionally\n   * typeIds provides an indirection between the child offset and the type id.\n   * For each child `typeIds[offset]` is the id used in the type vector.\n   */\n  Union: 14,\n  /**\n   * Binary data where each entry has the same fixed size.\n   */\n  FixedSizeBinary: 15,\n  /**\n   * List (vector) data where every list has the same fixed size.\n   * A list has a single child data type for list entries.\n   */\n  FixedSizeList: 16,\n  /**\n   * A Map is a logical nested type that is represented as\n   * List<entries: Struct<key: K, value: V>>\n   *\n   * In this layout, the keys and values are each respectively contiguous. We do\n   * not constrain the key and value types, so the application is responsible\n   * for ensuring that the keys are hashable and unique. Whether the keys are sorted\n   * may be set in the metadata for this field.\n   *\n   * In a field with Map type, the field has a child Struct field, which then\n   * has two children: key type and the second the value type. The names of the\n   * child fields may be respectively \"entries\", \"key\", and \"value\", but this is\n   * not enforced.\n   *\n   * Map\n   * ```text\n   *   - child[0] entries: Struct\n   *   - child[0] key: K\n   *   - child[1] value: V\n   *  ```\n   * Neither the \"entries\" field nor the \"key\" field may be nullable.\n   *\n   * The metadata is structured so that Arrow systems without special handling\n   * for Map can make Map an alias for List. The \"layout\" attribute for the Map\n   * field must have the same contents as a List.\n   */\n  Map: 17,\n  /**\n   * An absolute length of time unrelated to any calendar artifacts. For the\n   * purposes of Arrow implementations, adding this value to a Timestamp\n   * (\"t1\") naively (i.e. simply summing the two numbers) is acceptable even\n   * though in some cases the resulting Timestamp (t2) would not account for\n   * leap-seconds during the elapsed time between \"t1\" and \"t2\". Similarly,\n   * representing the difference between two Unix timestamp is acceptable, but\n   * would yield a value that is possibly a few seconds off from the true\n   * elapsed time.\n   *\n   * The resolution defaults to millisecond, but can be any of the other\n   * supported TimeUnit values as with Timestamp and Time types. This type is\n   * always represented as an 8-byte integer.\n   */\n  Duration: 18,\n  /**\n   * Same as Binary, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeBinary: 19,\n  /**\n   * Same as Utf8, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeUtf8: 20,\n  /**\n   * Same as List, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeList: 21,\n  /**\n   * Contains two child arrays, run_ends and values. The run_ends child array\n   * must be a 16/32/64-bit integer array which encodes the indices at which\n   * the run with the value in each corresponding index in the values child\n   * array ends. Like list/struct types, the value array can be of any type.\n   */\n  RunEndEncoded: 22,\n  /**\n   * Logically the same as Binary, but the internal representation uses a view\n   * struct that contains the string length and either the string's entire data\n   * inline (for small strings) or an inlined prefix, an index of another buffer,\n   * and an offset pointing to a slice in that buffer (for non-small strings).\n   *\n   * Since it uses a variable number of data buffers, each Field with this type\n   * must have a corresponding entry in `variadicBufferCounts`.\n   */\n  BinaryView: 23,\n  /**\n   * Logically the same as Utf8, but the internal representation uses a view\n   * struct that contains the string length and either the string's entire data\n   * inline (for small strings) or an inlined prefix, an index of another buffer,\n   * and an offset pointing to a slice in that buffer (for non-small strings).\n   *\n   * Since it uses a variable number of data buffers, each Field with this type\n   * must have a corresponding entry in `variadicBufferCounts`.\n   */\n  Utf8View: 24,\n  /**\n   * Represents the same logical types that List can, but contains offsets and\n   * sizes allowing for writes in any order and sharing of child values among\n   * list values.\n   */\n  ListView: 25,\n  /**\n   * Same as ListView, but with 64-bit offsets and sizes, allowing to represent\n   * extremely large data values.\n   */\n  LargeListView: 26\n});\n\n/**\n * Floating point number precision.\n */\nexport const Precision = /** @type {const} */ ({\n  /** 16-bit floating point number. */\n  HALF: 0,\n  /** 32-bit floating point number. */\n  SINGLE: 1,\n  /** 64-bit floating point number. */\n  DOUBLE: 2\n});\n\n/**\n * Date units.\n */\nexport const DateUnit = /** @type {const} */ ({\n  /* Days (as 32 bit int) since the UNIX epoch. */\n  DAY: 0,\n  /**\n   * Milliseconds (as 64 bit int) indicating UNIX time elapsed since the epoch\n   * (no leap seconds), with values evenly divisible by 86400000.\n   */\n  MILLISECOND: 1\n});\n\n/**\n * Time units.\n */\nexport const TimeUnit = /** @type {const} */ ({\n  /** Seconds. */\n  SECOND: 0,\n  /** Milliseconds. */\n  MILLISECOND: 1,\n  /** Microseconds. */\n  MICROSECOND: 2,\n  /** Nanoseconds. */\n  NANOSECOND: 3\n});\n\n/**\n * Date/time interval units.\n */\nexport const IntervalUnit = /** @type {const} */ ({\n  /**\n   * Indicates the number of elapsed whole months, stored as 4-byte signed\n   * integers.\n   */\n  YEAR_MONTH: 0,\n  /**\n   * Indicates the number of elapsed days and milliseconds (no leap seconds),\n   * stored as 2 contiguous 32-bit signed integers (8-bytes in total). Support\n   * of this IntervalUnit is not required for full arrow compatibility.\n   */\n  DAY_TIME: 1,\n  /**\n   * A triple of the number of elapsed months, days, and nanoseconds.\n   * The values are stored contiguously in 16-byte blocks. Months and days are\n   * encoded as 32-bit signed integers and nanoseconds is encoded as a 64-bit\n   * signed integer. Nanoseconds does not allow for leap seconds. Each field is\n   * independent (e.g. there is no constraint that nanoseconds have the same\n   * sign as days or that the quantity of nanoseconds represents less than a\n   * day's worth of time).\n   */\n  MONTH_DAY_NANO: 2\n});\n\n/**\n * Union type modes.\n */\nexport const UnionMode = /** @type {const} */ ({\n  /** Sparse union layout with full arrays for each sub-type. */\n  Sparse: 0,\n  /** Dense union layout with offsets into value arrays. */\n  Dense: 1\n});\n", "/**\n * @import { Int64ArrayConstructor, IntArrayConstructor, IntegerArray, TypedArray } from '../types.js'\n */\nexport const uint8Array = Uint8Array;\nexport const uint16Array = Uint16Array;\nexport const uint32Array = Uint32Array;\nexport const uint64Array = BigUint64Array;\nexport const int8Array = Int8Array;\nexport const int16Array = Int16Array;\nexport const int32Array = Int32Array;\nexport const int64Array = BigInt64Array;\nexport const float32Array = Float32Array;\nexport const float64Array = Float64Array;\n\n/**\n * Check if an input value is an ArrayBuffer or SharedArrayBuffer.\n * @param {unknown} data\n * @returns {data is ArrayBufferLike}\n */\nexport function isArrayBufferLike(data) {\n  return data instanceof ArrayBuffer || (\n    typeof SharedArrayBuffer !== 'undefined' &&\n    data instanceof SharedArrayBuffer\n  );\n}\n\n/**\n * Return the appropriate typed array constructor for the given\n * integer type metadata.\n * @param {number} bitWidth The integer size in bits.\n * @param {boolean} signed Flag indicating if the integer is signed.\n * @returns {IntArrayConstructor}\n */\nexport function intArrayType(bitWidth, signed) {\n  const i = Math.log2(bitWidth) - 3;\n  return (\n    signed\n      ? [int8Array, int16Array, int32Array, int64Array]\n      : [uint8Array, uint16Array, uint32Array, uint64Array]\n  )[i];\n}\n\n/** Shared prototype for typed arrays. */\nconst TypedArray = Object.getPrototypeOf(Int8Array);\n\n/**\n * Check if a value is a typed array.\n * @param {*} value The value to check.\n * @returns {value is TypedArray}\n *  True if value is a typed array, false otherwise.\n */\nexport function isTypedArray(value) {\n  return value instanceof TypedArray;\n}\n\n/**\n * Check if a value is either a standard array or typed array.\n * @param {*} value The value to check.\n * @returns {value is (Array | TypedArray)}\n *  True if value is an array, false otherwise.\n */\nexport function isArray(value) {\n  return Array.isArray(value) || isTypedArray(value);\n}\n\n/**\n * Check if a value is an array type (constructor) for 64-bit integers,\n * one of BigInt64Array or BigUint64Array.\n * @param {*} value The value to check.\n * @returns {value is Int64ArrayConstructor}\n *  True if value is a 64-bit array type, false otherwise.\n */\nexport function isInt64ArrayType(value) {\n  return value === int64Array || value === uint64Array;\n}\n\n/**\n * Determine the correct index into an offset array for a given\n * full column row index. Assumes offset indices can be manipulated\n * as 32-bit signed integers.\n * @param {IntegerArray} offsets The offsets array.\n * @param {number} index The full column row index.\n */\nexport function bisect(offsets, index) {\n  let a = 0;\n  let b = offsets.length;\n  if (b <= 2147483648) { // 2 ** 31\n    // fast version, use unsigned bit shift\n    // array length fits within 32-bit signed integer\n    do {\n      const mid = (a + b) >>> 1;\n      if (offsets[mid] <= index) a = mid + 1;\n      else b = mid;\n    } while (a < b);\n  } else {\n    // slow version, use division and truncate\n    // array length exceeds 32-bit signed integer\n    do {\n      const mid = Math.trunc((a + b) / 2);\n      if (offsets[mid] <= index) a = mid + 1;\n      else b = mid;\n    } while (a < b);\n  }\n  return a;\n}\n\n/**\n * Compute a 64-bit aligned buffer size.\n * @param {number} length The starting size.\n * @param {number} bpe Bytes per element.\n * @returns {number} The aligned size.\n */\nfunction align64(length, bpe = 1) {\n  return (((length * bpe) + 7) & ~7) / bpe;\n}\n\n/**\n * Return a 64-bit aligned version of the array.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} length The current array length.\n * @returns {T} The aligned array.\n */\nexport function align(array, length = array.length) {\n  const alignedLength = align64(length, array.BYTES_PER_ELEMENT);\n  return array.length > alignedLength ? /** @type {T} */ (array.subarray(0, alignedLength))\n    : array.length < alignedLength ? resize(array, alignedLength)\n    : array;\n}\n\n/**\n * Resize a typed array to exactly the specified length.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} newLength The new length.\n * @param {number} [offset] The offset at which to copy the old array.\n * @returns {T} The resized array.\n */\nexport function resize(array, newLength, offset = 0) {\n  // @ts-ignore\n  const newArray = new array.constructor(newLength);\n  newArray.set(array, offset);\n  return newArray;\n}\n\n/**\n * Grow a typed array to accommdate a minimum index. The array size is\n * doubled until it exceeds the minimum index.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} index The minimum index.\n * @param {boolean} [shift] Flag to shift copied bytes to back of array.\n * @returns {T} The resized array.\n */\nexport function grow(array, index, shift) {\n  while (array.length <= index) {\n    array = resize(array, array.length << 1, shift ? array.length : 0);\n  }\n  return array;\n}\n", "/**\n * Check if a value is a Date instance\n * @param {*} value The value to check.\n * @returns {value is Date} True if value is a Date, false otherwise.\n */\nexport function isDate(value) {\n  return value instanceof Date;\n}\n\n/**\n * Check if a value is iterable.\n * @param {*} value The value to check.\n * @returns {value is Iterable} True if value is iterable, false otherwise.\n */\nexport function isIterable(value) {\n  return typeof value[Symbol.iterator] === 'function';\n}\n\n/**\n * Return the input value if it passes a test.\n * Otherwise throw an error using the given message generator.\n * @template T\n * @param {T} value The value to check.\n * @param {(value: T) => boolean} test The test function.\n * @param {(value: *) => string} message Message generator.\n * @returns {T} The input value.\n * @throws if the value does not pass the test\n */\nexport function check(value, test, message) {\n  if (test(value)) return value;\n  throw new Error(message(value));\n}\n\n/**\n * Return the input value if it exists in the provided set.\n * Otherwise throw an error using the given message generator.\n * @template T\n * @param {T} value The value to check.\n * @param {T[] | Record<string,T>} set The set of valid values.\n * @param {(value: *) => string} [message] Message generator.\n * @returns {T} The input value.\n * @throws if the value is not included in the set\n */\nexport function checkOneOf(value, set, message) {\n  set = Array.isArray(set) ? set : Object.values(set);\n  return check(\n    value,\n    (value) => set.includes(value),\n    message ?? (() => `${value} must be one of ${set}`)\n  );\n}\n\n/**\n * Return the first object key that pairs with the given value.\n * @param {Record<string,any>} object The object to search.\n * @param {any} value The value to lookup.\n * @returns {string} The first matching key, or '<Unknown>' if not found.\n */\nexport function keyFor(object, value) {\n  for (const [key, val] of Object.entries(object)) {\n    if (val === value) return key;\n  }\n  return '<Unknown>';\n}\n", "/**\n * @import { BinaryType, BinaryViewType, BoolType, DataType, DateType, DateUnit_, DecimalType, DictionaryType, DurationType, Field, FixedSizeBinaryType, FixedSizeListType, FloatType, IntBitWidth, IntervalType, IntervalUnit_, IntType, LargeBinaryType, LargeListType, LargeListViewType, LargeUtf8Type, ListType, ListViewType, MapType, NullType, Precision_, RunEndEncodedType, StructType, TimestampType, TimeType, TimeUnit_, UnionMode_, UnionType, Utf8Type, Utf8ViewType } from './types.js'\n */\nimport { DateUnit, IntervalUnit, Precision, TimeUnit, Type, UnionMode } from './constants.js';\nimport { intArrayType, float32Array, float64Array, int32Array, int64Array, uint16Array, uint64Array } from './util/arrays.js';\nimport { check, checkOneOf, keyFor } from './util/objects.js';\n\n/**\n * @typedef {Field | DataType} FieldInput\n */\n\nexport const invalidDataType = (typeId) =>\n  `Unsupported data type: \"${keyFor(Type, typeId)}\" (id ${typeId})`;\n\n/**\n * Return a new field instance for use in a schema or type definition. A field\n * represents a field name, data type, and additional metadata. Fields are used\n * to represent child types within nested types like List, Struct, and Union.\n * @param {string} name The field name.\n * @param {DataType} type The field data type.\n * @param {boolean} [nullable=true] Flag indicating if the field is nullable\n *  (default `true`).\n * @param {Map<string,string>|null} [metadata=null] Custom field metadata\n *  annotations (default `null`).\n * @returns {Field} The field instance.\n */\nexport const field = (name, type, nullable = true, metadata = null) => ({\n  name,\n  type,\n  nullable,\n  metadata\n});\n\n/**\n * Checks if a value is a field instance.\n * @param {any} value\n * @returns {value is Field}\n */\nfunction isField(value) {\n  return Object.hasOwn(value, 'name') && isDataType(value.type)\n}\n\n/**\n * Checks if a value is a data type instance.\n * @param {any} value\n * @returns {value is DataType}\n */\nfunction isDataType(value) {\n  return typeof value?.typeId === 'number';\n}\n\n/**\n * Return a field instance from a field or data type input.\n * @param {FieldInput} value\n *  The value to map to a field.\n * @param {string} [defaultName] The default field name.\n * @param {boolean} [defaultNullable=true] The default nullable value.\n * @returns {Field} The field instance.\n */\nfunction asField(value, defaultName = '', defaultNullable = true) {\n  return isField(value)\n    ? value\n    : field(\n        defaultName,\n        check(value, isDataType, () => `Data type expected.`),\n        defaultNullable\n      );\n}\n\n/////\n\n/**\n * Return a basic type with only a type id.\n * @template {typeof Type[keyof typeof Type]} T\n * @param {T} typeId The type id.\n */\nconst basicType = (typeId) => ({ typeId });\n\n/**\n * Return a Dictionary data type instance.  A dictionary type consists of a\n * dictionary of values (which may be of any type) and corresponding integer\n * indices that reference those values. If values are repeated, a dictionary\n * encoding can provide substantial space savings. In the IPC format,\n * dictionary indices reside alongside other columns in a record batch, while\n * dictionary values are written to special dictionary batches, linked by a\n * unique dictionary *id*.\n * @param {DataType} type The data type of dictionary\n *  values.\n * @param {IntType} [indexType] The data type of\n *  dictionary indices. Must be an integer type (default `int32`).\n * @param {boolean} [ordered=false] Indicates if dictionary values are\n *  ordered (default `false`).\n * @param {number} [id=-1] The dictionary id. The default value (-1) indicates\n *  the dictionary applies to a single column only. Provide an explicit id in\n *  order to reuse a dictionary across columns when building, in which case\n *  different dictionaries *must* have different unique ids. All dictionary\n *  ids are later resolved (possibly to new values) upon IPC encoding.\n * @returns {DictionaryType}\n */\nexport const dictionary = (type, indexType, ordered = false, id = -1) => ({\n  typeId: Type.Dictionary,\n  id,\n  dictionary: type,\n  indices: indexType || int32(),\n  ordered\n});\n\n/**\n * Return a Null data type instance. Null data requires no storage and all\n * extracted values are `null`.\n * @returns {NullType} The null data type.\n */\nexport const nullType = () => basicType(Type.Null);\n\n/**\n * Return an Int data type instance.\n * @param {IntBitWidth} [bitWidth=32] The integer bit width.\n *  One of `8`, `16`, `32` (default), or `64`.\n * @param {boolean} [signed=true] Flag for signed or unsigned integers\n *  (default `true`).\n * @returns {IntType} The integer data type.\n */\nexport const int = (bitWidth = 32, signed = true) => ({\n  typeId: Type.Int,\n  bitWidth: checkOneOf(bitWidth, [8, 16, 32, 64]),\n  signed,\n  values: intArrayType(bitWidth, signed)\n});\n/**\n * Return an Int data type instance for 8 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nexport const int8 = () => int(8);\n/**\n * Return an Int data type instance for 16 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nexport const int16 = () => int(16);\n/**\n * Return an Int data type instance for 32 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nexport const int32 = () => int(32);\n/**\n * Return an Int data type instance for 64 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nexport const int64 = () => int(64);\n/**\n * Return an Int data type instance for 8 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nexport const uint8 = () => int(8, false);\n/**\n * Return an Int data type instance for 16 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nexport const uint16 = () => int(16, false);\n/**\n * Return an Int data type instance for 32 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nexport const uint32 = () => int(32, false);\n/**\n * Return an Int data type instance for 64 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nexport const uint64 = () => int(64, false);\n\n/**\n * Return a Float data type instance for floating point numbers.\n * @param {Precision_} [precision=2] The floating point\n *  precision. One of `Precision.HALF` (16-bit), `Precision.SINGLE` (32-bit)\n *  or `Precision.DOUBLE` (64-bit, default).\n * @returns {FloatType} The floating point data type.\n */\nexport const float = (precision = 2) => ({\n  typeId: Type.Float,\n  precision: checkOneOf(precision, Precision),\n  values: [uint16Array, float32Array, float64Array][precision]\n});\n/**\n * Return a Float data type instance for half-precision (16 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nexport const float16 = () => float(Precision.HALF);\n/**\n * Return a Float data type instance for single-precision (32 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nexport const float32 = () => float(Precision.SINGLE);\n/**\n * Return a Float data type instance for double-precision (64 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nexport const float64 = () => float(Precision.DOUBLE);\n\n/**\n * Return a Binary data type instance for variably-sized opaque binary data\n * with 32-bit offsets.\n * @returns {BinaryType} The binary data type.\n */\nexport const binary = () => ({\n  typeId: Type.Binary,\n  offsets: int32Array\n});\n\n/**\n * Return a Utf8 data type instance for Unicode string data.\n * [UTF-8](https://en.wikipedia.org/wiki/UTF-8) code points are stored as\n * binary data.\n * @returns {Utf8Type} The utf8 data type.\n */\nexport const utf8 = () => ({\n  typeId: Type.Utf8,\n  offsets: int32Array\n});\n\n/**\n * Return a Bool data type instance. Bool values are stored compactly in\n * bitmaps with eight values per byte.\n * @returns {BoolType} The bool data type.\n */\nexport const bool = () => basicType(Type.Bool);\n\n/**\n * Return a Decimal data type instance. Decimal values are represented as 32,\n * 64, 128, or 256 bit integers in two's complement. Decimals are fixed point\n * numbers with a set *precision* (total number of decimal digits) and *scale*\n * (number of fractional digits). For example, the number `35.42` can be\n * represented as `3542` with *precision* \u2265 4 and *scale* = 2.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @param {32 | 64 | 128 | 256} [bitWidth] The decimal bit width.\n *  One of 32, 64, 128 (default), or 256.\n * @returns {DecimalType} The decimal data type.\n */\nexport const decimal = (precision, scale, bitWidth = 128) => ({\n  typeId: Type.Decimal,\n  precision,\n  scale,\n  bitWidth: checkOneOf(bitWidth, [32, 64, 128, 256]),\n  values: bitWidth === 32 ? int32Array : uint64Array\n});\n/**\n * Return an Decimal data type instance with a bit width of 32.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nexport const decimal32 = (precision, scale) => decimal(precision, scale, 32);\n/**\n * Return an Decimal data type instance with a bit width of 64.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nexport const decimal64 = (precision, scale) => decimal(precision, scale, 64);\n/**\n * Return an Decimal data type instance with a bit width of 128.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nexport const decimal128 = (precision, scale) => decimal(precision, scale, 128);\n/**\n * Return an Decimal data type instance with a bit width of 256.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nexport const decimal256 = (precision, scale) => decimal(precision, scale, 256);\n\n/**\n * Return a Date data type instance. Date values are 32-bit or 64-bit signed\n * integers representing elapsed time since the UNIX epoch (Jan 1, 1970 UTC),\n * either in units of days (32 bits) or milliseconds (64 bits, with values\n * evenly divisible by 86400000).\n * @param {DateUnit_} unit The date unit.\n *  One of `DateUnit.DAY` or `DateUnit.MILLISECOND`.\n * @returns {DateType} The date data type.\n */\nexport const date = (unit) => ({\n  typeId: Type.Date,\n  unit: checkOneOf(unit, DateUnit),\n  values: unit === DateUnit.DAY ? int32Array : int64Array\n});\n/**\n * Return a Date data type instance with units of days.\n * @returns {DateType} The date data type.\n */\nexport const dateDay = () => date(DateUnit.DAY);\n/**\n * Return a Date data type instance with units of milliseconds.\n * @returns {DateType} The date data type.\n */\nexport const dateMillisecond = () => date(DateUnit.MILLISECOND);\n\n/**\n * Return a Time data type instance, stored in one of four *unit*s: seconds,\n * milliseconds, microseconds or nanoseconds. The integer *bitWidth* is\n * inferred from the *unit* and is 32 bits for seconds and milliseconds or\n * 64 bits for microseconds and nanoseconds. The allowed values are between 0\n * (inclusive) and 86400 (=24*60*60) seconds (exclusive), adjusted for the\n * time unit (for example, up to 86400000 exclusive for the\n * `DateUnit.MILLISECOND` unit.\n *\n * This definition doesn't allow for leap seconds. Time values from\n * measurements with leap seconds will need to be corrected when ingesting\n * into Arrow (for example by replacing the value 86400 with 86399).\n * @param {TimeUnit_} unit The time unit.\n *  One of `TimeUnit.SECOND`, `TimeUnit.MILLISECOND` (default),\n *  `TimeUnit.MICROSECOND`, or `TimeUnit.NANOSECOND`.\n * @returns {TimeType} The time data type.\n */\nexport const time = (unit = TimeUnit.MILLISECOND) => {\n  unit = checkOneOf(unit, TimeUnit);\n  const bitWidth = unit === TimeUnit.SECOND || unit === TimeUnit.MILLISECOND ? 32 : 64;\n  return {\n    typeId: Type.Time,\n    unit,\n    bitWidth,\n    values: bitWidth === 32 ? int32Array : int64Array\n  };\n};\n/**\n * Return a Time data type instance, represented as seconds.\n * @returns {TimeType} The time data type.\n */\nexport const timeSecond = () => time(TimeUnit.SECOND);\n/**\n * Return a Time data type instance, represented as milliseconds.\n * @returns {TimeType} The time data type.\n */\nexport const timeMillisecond = () => time(TimeUnit.MILLISECOND);\n/**\n * Return a Time data type instance, represented as microseconds.\n * @returns {TimeType} The time data type.\n */\nexport const timeMicrosecond = () => time(TimeUnit.MICROSECOND);\n/**\n * Return a Time data type instance, represented as nanoseconds.\n * @returns {TimeType} The time data type.\n */\nexport const timeNanosecond = () => time(TimeUnit.NANOSECOND);\n\n/**\n * Return a Timestamp data type instance. Timestamp values are 64-bit signed\n * integers representing an elapsed time since a fixed epoch, stored in either\n * of four units: seconds, milliseconds, microseconds or nanoseconds, and are\n * optionally annotated with a timezone. Timestamp values do not include any\n * leap seconds (in other words, all days are considered 86400 seconds long).\n * @param {TimeUnit_} [unit] The time unit.\n *  One of `TimeUnit.SECOND`, `TimeUnit.MILLISECOND` (default),\n *  `TimeUnit.MICROSECOND`, or `TimeUnit.NANOSECOND`.\n * @param {string|null} [timezone=null] An optional string for the name of a\n *  timezone. If provided, the value should either be a string as used in the\n *  Olson timezone database (the \"tz database\" or \"tzdata\"), such as\n *  \"America/New_York\", or an absolute timezone offset of the form \"+XX:XX\" or\n *  \"-XX:XX\", such as \"+07:30\".Whether a timezone string is present indicates\n *  different semantics about the data.\n * @returns {TimestampType} The time data type.\n */\nexport const timestamp = (unit = TimeUnit.MILLISECOND, timezone = null) => ({\n  typeId: Type.Timestamp,\n  unit: checkOneOf(unit, TimeUnit),\n  timezone,\n  values: int64Array\n});\n\n/**\n * Return an Interval type instance. Values represent calendar intervals stored\n * as integers for each date part. The supported *unit*s are year/moth,\n * day/time, and month/day/nanosecond intervals.\n *\n * `IntervalUnit.YEAR_MONTH` indicates the number of elapsed whole months,\n * stored as 32-bit signed integers.\n *\n * `IntervalUnit.DAY_TIME` indicates the number of elapsed days and\n * milliseconds (no leap seconds), stored as 2 contiguous 32-bit signed\n * integers (8-bytes in total).\n *\n * `IntervalUnit.MONTH_DAY_NANO` is a triple of the number of elapsed months,\n * days, and nanoseconds. The values are stored contiguously in 16-byte blocks.\n * Months and days are encoded as 32-bit signed integers and nanoseconds is\n * encoded as a 64-bit signed integer. Nanoseconds does not allow for leap\n * seconds. Each field is independent (e.g. there is no constraint that\n * nanoseconds have the same sign as days or that the quantity of nanoseconds\n * represents less than a day's worth of time).\n * @param {IntervalUnit_} unit  The interval unit.\n *  One of `IntervalUnit.YEAR_MONTH`, `IntervalUnit.DAY_TIME`, or\n *  `IntervalUnit.MONTH_DAY_NANO` (default).\n * @returns {IntervalType} The interval data type.\n */\nexport const interval = (unit = IntervalUnit.MONTH_DAY_NANO) => ({\n  typeId: Type.Interval,\n  unit: checkOneOf(unit, IntervalUnit),\n  values: unit === IntervalUnit.MONTH_DAY_NANO ? undefined : int32Array\n});\n\n/**\n * Return a List data type instance, representing variably-sized lists\n * (arrays) with 32-bit offsets. A list has a single child data type for\n * list entries. Lists are represented using integer offsets that indicate\n * list extents within a single child array containing all list values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {ListType} The list data type.\n */\nexport const list = (child) => ({\n  typeId: Type.List,\n  children: [ asField(child) ],\n  offsets: int32Array\n});\n\n/**\n * Return a Struct data type instance. A struct consists of multiple named\n * child data types. Struct values are stored as parallel child batches, one\n * per child type, and extracted to standard JavaScript objects.\n * @param {Field[] | Record<string, DataType>} children\n *  An array of property fields, or an object mapping property names to data\n *  types. If an object, the instantiated fields are assumed to be nullable\n *  and have no metadata.\n * @returns {StructType} The struct data type.\n */\nexport const struct = (children) => ({\n  typeId: Type.Struct,\n  children: Array.isArray(children) && isField(children[0])\n    ? /** @type {Field[]} */ (children)\n    : Object.entries(children).map(([name, type]) => field(name, type))\n});\n\n/**\n * Return a Union type instance. A union is a complex type with parallel\n * *children* data types. Union values are stored in either a sparse\n * (`UnionMode.Sparse`) or dense (`UnionMode.Dense`) layout *mode*. In a\n * sparse layout, child types are stored in parallel arrays with the same\n * lengths, resulting in many unused, empty values. In a dense layout, child\n * types have variable lengths and an offsets array is used to index the\n * appropriate value.\n *\n * By default, ids in the type vector refer to the index in the children\n * array. Optionally, *typeIds* provide an indirection between the child\n * index and the type id. For each child, `typeIds[index]` is the id used\n * in the type vector. The *typeIdForValue* argument provides a lookup\n * function for mapping input data to the proper child type id, and is\n * required if using builder methods.\n * @param {UnionMode_} mode The union mode.\n *  One of `UnionMode.Sparse` or `UnionMode.Dense`.\n * @param {FieldInput[]} children The children fields or data types.\n *  Types are mapped to nullable fields with no metadata.\n * @param {number[]} [typeIds]  Children type ids, in the same order as the\n *  children types. Type ids provide a level of indirection over children\n *  types. If not provided, the children indices are used as the type ids.\n * @param {(value: any, index: number) => number} [typeIdForValue]\n *  A function that takes an arbitrary value and a row index and returns a\n *  correponding union type id. Required by builder methods.\n * @returns {UnionType} The union data type.\n */\nexport const union = (mode, children, typeIds, typeIdForValue) => {\n  typeIds ??= children.map((v, i) => i);\n  return {\n    typeId: Type.Union,\n    mode: checkOneOf(mode, UnionMode),\n    typeIds,\n    typeMap: typeIds.reduce((m, id, i) => ((m[id] = i), m), {}),\n    children: children.map((v, i) => asField(v, `_${i}`)),\n    typeIdForValue,\n    offsets: int32Array,\n  };\n};\n\n/**\n * Create a FixedSizeBinary data type instance for opaque binary data where\n * each entry has the same fixed size.\n * @param {number} stride The fixed size in bytes.\n * @returns {FixedSizeBinaryType} The fixed size binary data type.\n */\nexport const fixedSizeBinary = (stride) => ({\n  typeId: Type.FixedSizeBinary,\n  stride\n});\n\n/**\n * Return a FixedSizeList type instance for list (array) data where every list\n * has the same fixed size. A list has a single child data type for list\n * entries. Fixed size lists are represented as a single child array containing\n * all list values, indexed using the known stride.\n * @param {FieldInput} child The list item data type.\n * @param {number} stride The fixed list size.\n * @returns {FixedSizeListType} The fixed size list data type.\n */\nexport const fixedSizeList = (child, stride) => ({\n  typeId: Type.FixedSizeList,\n  stride,\n  children: [ asField(child) ]\n});\n\n/**\n * Internal method to create a Map type instance.\n * @param {boolean} keysSorted Flag indicating if the map keys are sorted.\n * @param {Field} child The child fields.\n * @returns {MapType} The map data type.\n */\nexport const mapType = (keysSorted, child) => ({\n  typeId: Type.Map,\n  keysSorted,\n  children: [child],\n  offsets: int32Array\n});\n\n/**\n * Return a Map data type instance representing collections of key-value pairs.\n * A Map is a logical nested type that is represented as a list of key-value\n * structs. The key and value types are not constrained, so the application is\n * responsible for ensuring that the keys are hashable and unique, and that\n * keys are properly sorted if *keysSorted* is `true`.\n * @param {FieldInput} keyField The map key field or data type.\n * @param {FieldInput} valueField The map value field or data type.\n * @param {boolean} [keysSorted=false] Flag indicating if the map keys are\n *  sorted (default `false`).\n * @returns {MapType} The map data type.\n */\nexport const map = (keyField, valueField, keysSorted = false) => mapType(\n  keysSorted,\n  field(\n    'entries',\n    struct([ asField(keyField, 'key', false), asField(valueField, 'value') ]),\n    false\n  )\n);\n\n/**\n * Return a Duration data type instance. Durations represent an absolute length\n * of time unrelated to any calendar artifacts. The resolution defaults to\n * millisecond, but can be any of the other `TimeUnit` values. This type is\n * always represented as a 64-bit integer.\n * @param {TimeUnit_} unit\n * @returns {DurationType} The duration data type.\n */\nexport const duration = (unit = TimeUnit.MILLISECOND) => ({\n  typeId: Type.Duration,\n  unit: checkOneOf(unit, TimeUnit),\n  values: int64Array\n});\n\n/**\n * Return a LargeBinary data type instance for variably-sized opaque binary\n * data with 64-bit offsets, allowing representation of extremely large data\n * values.\n * @returns {LargeBinaryType} The large binary data type.\n */\nexport const largeBinary = () => ({\n  typeId: Type.LargeBinary,\n  offsets: int64Array\n});\n\n/**\n * Return a LargeUtf8 data type instance for Unicode string data of variable\n * length with 64-bit offsets, allowing representation of extremely large data\n * values. [UTF-8](https://en.wikipedia.org/wiki/UTF-8) code points are stored\n * as binary data.\n * @returns {LargeUtf8Type} The large utf8 data type.\n */\nexport const largeUtf8 = () => ({\n  typeId: Type.LargeUtf8,\n  offsets: int64Array\n});\n\n/**\n * Return a LargeList data type instance, representing variably-sized lists\n * (arrays) with 64-bit offsets, allowing representation of extremely large\n * data values. A list has a single child data type for list entries. Lists\n * are represented using integer offsets that indicate list extents within a\n * single child array containing all list values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {LargeListType} The large list data type.\n */\nexport const largeList = (child) => ({\n  typeId: Type.LargeList,\n  children: [ asField(child) ],\n  offsets: int64Array\n});\n\n/**\n * Return a RunEndEncoded data type instance, which compresses data by\n * representing consecutive repeated values as a run. This data type uses two\n * child arrays, `run_ends` and `values`. The `run_ends` child array must be\n * a 16, 32, or 64 bit integer array which encodes the indices at which the\n * run with the value in each corresponding index in the values child array\n * ends. Like list and struct types, the `values` array can be of any type.\n * @param {FieldInput} runsField The run-ends field or data type.\n * @param {FieldInput} valuesField The values field or data type.\n * @returns {RunEndEncodedType} The large list data type.\n */\nexport const runEndEncoded = (runsField, valuesField) => ({\n  typeId: Type.RunEndEncoded,\n  children: [\n    check(\n      asField(runsField, 'run_ends'),\n      (field) => field.type.typeId === Type.Int,\n      () => 'Run-ends must have an integer type.'\n    ),\n    asField(valuesField, 'values')\n  ]\n});\n\n/**\n * Return a BinaryView data type instance. BinaryView data is logically the\n * same as the Binary type, but the internal representation uses a view struct\n * that contains the string length and either the string's entire data inline\n * (for small strings) or an inlined prefix, an index of another buffer, and an\n * offset pointing to a slice in that buffer (for non-small strings).\n *\n * Flechette can encode and decode BinaryView data; however, Flechette does\n * not currently support building BinaryView columns from JavaScript values.\n * @returns {BinaryViewType} The binary view data type.\n */\nexport const binaryView = () => /** @type {BinaryViewType} */\n  (basicType(Type.BinaryView));\n\n/**\n * Return a Utf8View data type instance. Utf8View data is logically the same as\n * the Utf8 type, but the internal representation uses a view struct that\n * contains the string length and either the string's entire data inline (for\n * small strings) or an inlined prefix, an index of another buffer, and an\n * offset pointing to a slice in that buffer (for non-small strings).\n *\n * Flechette can encode and decode Utf8View data; however, Flechette does\n * not currently support building Utf8View columns from JavaScript values.\n * @returns {Utf8ViewType} The utf8 view data type.\n */\nexport const utf8View = () => /** @type {Utf8ViewType} */\n  (basicType(Type.Utf8View));\n\n/**\n * Return a ListView data type instance, representing variably-sized lists\n * (arrays) with 32-bit offsets. ListView data represents the same logical\n * types that List can, but contains both offsets and sizes allowing for\n * writes in any order and sharing of child values among list values.\n *\n * Flechette can encode and decode ListView data; however, Flechette does not\n * currently support building ListView columns from JavaScript values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {ListViewType} The list view data type.\n */\nexport const listView = (child) => ({\n  typeId: Type.ListView,\n  children: [ asField(child, 'value') ],\n  offsets: int32Array\n});\n\n/**\n * Return a LargeListView data type instance, representing variably-sized lists\n * (arrays) with 64-bit offsets, allowing representation of extremely large\n * data values. LargeListView data represents the same logical types that\n * LargeList can, but contains both offsets and sizes allowing for writes\n * in any order and sharing of child values among list values.\n *\n * Flechette can encode and decode LargeListView data; however, Flechette does\n * not currently support building LargeListView columns from JavaScript values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {LargeListViewType} The large list view data type.\n */\nexport const largeListView = (child) => ({\n  typeId: Type.LargeListView,\n  children: [ asField(child, 'value') ],\n  offsets: int64Array\n});\n", "/**\n * @import { TimeUnit_, TypedArray } from '../types.js';\n */\nimport { float64Array, int32Array, int64Array, isInt64ArrayType, uint32Array, uint8Array } from './arrays.js';\nimport { TimeUnit } from '../constants.js';\n\n// typed arrays over a shared buffer to aid binary conversion\nconst f64 = new float64Array(2);\nconst buf = f64.buffer;\nconst i64 = new int64Array(buf);\nconst u32 = new uint32Array(buf);\nconst i32 = new int32Array(buf);\nconst u8 = new uint8Array(buf);\n\n/**\n * Return a value unchanged.\n * @template T\n * @param {T} value The value.\n * @returns {T} The value.\n */\nexport function identity(value) {\n  return value;\n}\n\n/**\n * Return a value coerced to a BigInt.\n * @param {*} value The value.\n * @returns {bigint} The BigInt value.\n */\nexport function toBigInt(value) {\n  return BigInt(value);\n}\n\n/**\n * Return an offset conversion method for the given data type.\n * @param {{ offsets: TypedArray}} type The array type.\n */\nexport function toOffset(type) {\n  return isInt64ArrayType(type) ? toBigInt : identity;\n}\n\n/**\n * Return the number of days from a millisecond timestamp.\n * @param {number} value The millisecond timestamp.\n * @returns {number} The number of days.\n */\nexport function toDateDay(value) {\n  return (value / 864e5) | 0;\n}\n\n/**\n * Return a timestamp conversion method for the given time unit.\n * @param {TimeUnit_} unit The time unit.\n * @returns {(value: number) => bigint} The conversion method.\n */\nexport function toTimestamp(unit) {\n  return unit === TimeUnit.SECOND ? value => toBigInt(value / 1e3)\n    : unit === TimeUnit.MILLISECOND ? toBigInt\n    : unit === TimeUnit.MICROSECOND ? value => toBigInt(value * 1e3)\n    : value => toBigInt(value * 1e6);\n}\n\n/**\n * Write month/day/nanosecond interval to a byte buffer.\n * @param {Array | Float64Array} interval The interval data.\n * @returns {Uint8Array} A byte buffer with the interval data.\n *  The returned buffer is reused across calls, and so should be\n *  copied to a target buffer immediately.\n */\nexport function toMonthDayNanoBytes([m, d, n]) {\n  i32[0] = m;\n  i32[1] = d;\n  i64[1] = toBigInt(n);\n  return u8;\n}\n\n/**\n * Coerce a bigint value to a number. Throws an error if the bigint value\n * lies outside the range of what a number can precisely represent.\n * @param {bigint} value The value to check and possibly convert.\n * @returns {number} The converted number value.\n */\nexport function toNumber(value) {\n  if (value > Number.MAX_SAFE_INTEGER || value < Number.MIN_SAFE_INTEGER) {\n    throw Error(`BigInt exceeds integer number representation: ${value}`);\n  }\n  return Number(value);\n}\n\n/**\n * Divide one BigInt value by another, and return the result as a number.\n * The division may involve unsafe integers and a loss of precision.\n * @param {bigint} num The numerator.\n * @param {bigint} div The divisor.\n * @returns {number} The result of the division as a floating point number.\n */\nexport function divide(num, div) {\n  return Number(num / div) + Number(num % div) / Number(div);\n}\n\n/**\n * Return a 32-bit decimal conversion method for the given decimal scale.\n * @param {number} scale The scale mapping fractional digits to integers.\n * @returns {(value: number|bigint) => number} A conversion method that maps\n *  floating point numbers to 32-bit decimals.\n */\nexport function toDecimal32(scale) {\n  return (value) => typeof value === 'bigint'\n    ? Number(value)\n    : Math.trunc(value * scale);\n}\n\n/**\n * Convert a floating point number or bigint to decimal bytes.\n * @param {number|bigint} value The number to encode. If a bigint, we assume\n *  it already represents the decimal in integer form with the correct scale.\n *  Otherwise, we assume a float that requires scaled integer conversion.\n * @param {BigUint64Array} buf The uint64 array to write to.\n * @param {number} offset The starting index offset into the array.\n * @param {number} stride The stride of an encoded decimal, in 64-bit steps.\n * @param {number} scale The scale mapping fractional digits to integers.\n */\nexport function toDecimal(value, buf, offset, stride, scale) {\n  const v = typeof value === 'bigint'\n    ? value\n    : toBigInt(Math.trunc(value * scale));\n  // assignment into uint64array performs needed truncation for us\n  buf[offset] = v;\n  if (stride > 1) {\n    buf[offset + 1] = (v >> 64n);\n    if (stride > 2) {\n      buf[offset + 2] = (v >> 128n);\n      buf[offset + 3] = (v >> 192n);\n    }\n  }\n}\n\n// helper method to extract uint64 values from bigints\nconst asUint64 = v => BigInt.asUintN(64, v);\n\n/**\n * Convert a 64-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nexport function fromDecimal64(buf, offset) {\n  return BigInt.asIntN(64, buf[offset]);\n}\n\n/**\n * Convert a 128-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nexport function fromDecimal128(buf, offset) {\n  const i = offset << 1;\n  let x;\n  if (BigInt.asIntN(64, buf[i + 1]) < 0) {\n    x = asUint64(~buf[i]) | (asUint64(~buf[i + 1]) << 64n);\n    x = -(x + 1n);\n  } else {\n    x = buf[i] | (buf[i + 1] << 64n);\n  }\n  return x;\n}\n\n/**\n * Convert a 256-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nexport function fromDecimal256(buf, offset) {\n  const i = offset << 2;\n  let x;\n  if (BigInt.asIntN(64, buf[i + 3]) < 0) {\n    x = asUint64(~buf[i])\n      | (asUint64(~buf[i + 1]) << 64n)\n      | (asUint64(~buf[i + 2]) << 128n)\n      | (asUint64(~buf[i + 3]) << 192n);\n    x = -(x + 1n);\n  } else {\n    x = buf[i]\n      | (buf[i + 1] << 64n)\n      | (buf[i + 2] << 128n)\n      | (buf[i + 3] << 192n);\n  }\n  return x;\n}\n\n/**\n * Convert a 16-bit float from integer bytes to a number.\n * Adapted from https://github.com/apache/arrow/blob/main/js/src/util/math.ts\n * @param {number} value The float as a 16-bit integer.\n * @returns {number} The converted 64-bit floating point number.\n */\nexport function fromFloat16(value) {\n  const expo = (value & 0x7C00) >> 10;\n  const sigf = (value & 0x03FF) / 1024;\n  const sign = (-1) ** ((value & 0x8000) >> 15);\n  switch (expo) {\n    case 0x1F: return sign * (sigf ? Number.NaN : 1 / 0);\n    case 0x00: return sign * (sigf ? 6.103515625e-5 * sigf : 0);\n  }\n  return sign * (2 ** (expo - 15)) * (1 + sigf);\n}\n\n/**\n * Convert a number to a 16-bit float as integer bytes..\n * Inspired by numpy's `npy_double_to_half`:\n * https://github.com/numpy/numpy/blob/5a5987291dc95376bb098be8d8e5391e89e77a2c/numpy/core/src/npymath/halffloat.c#L43\n * Adapted from https://github.com/apache/arrow/blob/main/js/src/util/math.ts\n * @param {number} value The 64-bit floating point number to convert.\n * @returns {number} The converted 16-bit integer.\n */\nexport function toFloat16(value) {\n  if (value !== value) return 0x7E00; // NaN\n  f64[0] = value;\n\n  // Magic numbers:\n  // 0x80000000 = 10000000 00000000 00000000 00000000 -- masks the 32nd bit\n  // 0x7ff00000 = 01111111 11110000 00000000 00000000 -- masks the 21st-31st bits\n  // 0x000fffff = 00000000 00001111 11111111 11111111 -- masks the 1st-20th bit\n  const sign = (u32[1] & 0x80000000) >> 16 & 0xFFFF;\n  let expo = (u32[1] & 0x7FF00000), sigf = 0x0000;\n\n  if (expo >= 0x40F00000) {\n    //\n    // If exponent overflowed, the float16 is either NaN or Infinity.\n    // Rules to propagate the sign bit: mantissa > 0 ? NaN : +/-Infinity\n    //\n    // Magic numbers:\n    // 0x40F00000 = 01000000 11110000 00000000 00000000 -- 6-bit exponent overflow\n    // 0x7C000000 = 01111100 00000000 00000000 00000000 -- masks the 27th-31st bits\n    //\n    // returns:\n    // qNaN, aka 32256 decimal, 0x7E00 hex, or 01111110 00000000 binary\n    // sNaN, aka 32000 decimal, 0x7D00 hex, or 01111101 00000000 binary\n    // +inf, aka 31744 decimal, 0x7C00 hex, or 01111100 00000000 binary\n    // -inf, aka 64512 decimal, 0xFC00 hex, or 11111100 00000000 binary\n    //\n    // If mantissa is greater than 23 bits, set to +Infinity like numpy\n    if (u32[0] > 0) {\n      expo = 0x7C00;\n    } else {\n      expo = (expo & 0x7C000000) >> 16;\n      sigf = (u32[1] & 0x000FFFFF) >> 10;\n    }\n  } else if (expo <= 0x3F000000) {\n    //\n    // If exponent underflowed, the float is either signed zero or subnormal.\n    //\n    // Magic numbers:\n    // 0x3F000000 = 00111111 00000000 00000000 00000000 -- 6-bit exponent underflow\n    //\n    sigf = 0x100000 + (u32[1] & 0x000FFFFF);\n    sigf = 0x100000 + (sigf << ((expo >> 20) - 998)) >> 21;\n    expo = 0;\n  } else {\n    //\n    // No overflow or underflow, rebase the exponent and round the mantissa\n    // Magic numbers:\n    // 0x200 = 00000010 00000000 -- masks off the 10th bit\n    //\n    // Ensure the first mantissa bit (the 10th one) is 1 and round\n    expo = (expo - 0x3F000000) >> 10;\n    sigf = ((u32[1] & 0x000FFFFF) + 0x200) >> 10;\n  }\n  return sign | expo | sigf & 0xFFFF;\n}\n", "import { isArray } from './arrays.js';\nimport { isDate } from './objects.js';\n\nconst textDecoder = new TextDecoder('utf-8');\nconst textEncoder = new TextEncoder();\n\n/**\n * Return a UTF-8 string decoded from a byte buffer.\n * @param {Uint8Array} buf The byte buffer.\n * @returns {string} The decoded string.\n */\nexport function decodeUtf8(buf) {\n  return textDecoder.decode(buf);\n}\n\n/**\n * Return a byte buffer encoded from a UTF-8 string.\n * @param {string } str The string to encode.\n * @returns {Uint8Array} The encoded byte buffer.\n */\nexport function encodeUtf8(str) {\n  return textEncoder.encode(str);\n}\n\n/**\n * Return a string-coercible key value that uniquely identifies a value.\n * @param {*} value The input value.\n * @returns {string} The key string.\n */\nexport function keyString(value) {\n  const val = typeof value !== 'object' || !value ? (value ?? null)\n    : isDate(value) ? +value\n    // @ts-ignore\n    : isArray(value) ? `[${value.map(keyString)}]`\n    : objectKey(value);\n  return `${val}`;\n}\n\nfunction objectKey(value) {\n  let s = '';\n  let i = -1;\n  for (const k in value) {\n    if (++i > 0) s += ',';\n    s += `\"${k}\":${keyString(value[k])}`;\n  }\n  return `{${s}}`;\n}\n", "import { toNumber } from './numbers.js';\nimport { decodeUtf8 } from './strings.js';\n\n/** The size in bytes of a 32-bit integer. */\nexport const SIZEOF_INT = 4;\n\n/** The size in bytes of a 16-bit integer. */\nexport const SIZEOF_SHORT = 2;\n\n/**\n * Return a boolean for a single bit in a bitmap.\n * @param {Uint8Array} bitmap The bitmap.\n * @param {number} index The bit index to read.\n * @returns {boolean} The boolean bitmap value.\n */\nexport function decodeBit(bitmap, index) {\n  return (bitmap[index >> 3] & 1 << (index % 8)) !== 0;\n}\n\n/**\n * Lookup helper for flatbuffer object (table) entries.\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} index The base index of the object.\n */\nexport function readObject(buf, index) {\n  const pos = index + readInt32(buf, index);\n  const vtable = pos - readInt32(buf, pos);\n  const size = readInt16(buf, vtable);\n  /**\n   * Retrieve a value from a flatbuffer table layout.\n   * @template T\n   * @param {number} index The table entry index.\n   * @param {(buf: Uint8Array, offset: number) => T} read Read function to invoke.\n   * @param {T} [fallback=null] The default fallback value.\n   * @returns {T}\n   */\n  return (index, read, fallback = null) => {\n    if (index < size) {\n      const off = readInt16(buf, vtable + index);\n      if (off) return read(buf, pos + off);\n    }\n    return fallback;\n  };\n}\n\n/**\n * Return a buffer offset value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readOffset(buf, offset) {\n  return offset;\n}\n\n/**\n * Return a boolean value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {boolean}\n */\nexport function readBoolean(buf, offset) {\n  return !!readInt8(buf, offset);\n}\n\n/**\n * Return a signed 8-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readInt8(buf, offset) {\n  return readUint8(buf, offset) << 24 >> 24;\n}\n\n/**\n * Return an unsigned 8-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readUint8(buf, offset) {\n  return buf[offset];\n}\n\n/**\n * Return a signed 16-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readInt16(buf, offset) {\n  return readUint16(buf, offset) << 16 >> 16;\n}\n\n/**\n * Return an unsigned 16-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readUint16(buf, offset) {\n  return buf[offset] | buf[offset + 1] << 8;\n}\n\n/**\n * Return a signed 32-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readInt32(buf, offset) {\n  return buf[offset]\n    | buf[offset + 1] << 8\n    | buf[offset + 2] << 16\n    | buf[offset + 3] << 24;\n}\n\n/**\n * Return an unsigned 32-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readUint32(buf, offset) {\n  return readInt32(buf, offset) >>> 0;\n}\n\n/**\n * Return a signed 64-bit integer value coerced to a JS number.\n * Throws an error if the value exceeds what a JS number can represent.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nexport function readInt64(buf, offset) {\n  return toNumber(BigInt.asIntN(\n    64,\n    BigInt(readUint32(buf, offset)) +\n      (BigInt(readUint32(buf, offset + SIZEOF_INT)) << 32n)\n  ));\n}\n\n/**\n * Create a JavaScript string from UTF-8 data stored inside the FlatBuffer.\n * This allocates a new string and converts to wide chars upon each access.\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} index The index of the string entry.\n * @returns {string} The decoded string.\n */\nexport function readString(buf, index) {\n  let offset = index + readInt32(buf, index); // get the string offset\n  const length = readInt32(buf, offset);  // get the string length\n  offset += SIZEOF_INT; // skip length value\n  return decodeUtf8(buf.subarray(offset, offset + length));\n}\n\n/**\n * Extract a flatbuffer vector to an array.\n * @template T\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} offset The offset location of the vector.\n * @param {number} stride The stride between vector entries.\n * @param {(buf: Uint8Array, pos: number) => T} extract Vector entry extraction function.\n * @returns {T[]} The extracted vector entries.\n */\nexport function readVector(buf, offset, stride, extract) {\n  if (!offset) return [];\n\n  // get base position by adding offset delta\n  const base = offset + readInt32(buf, offset);\n\n  // read vector size, extract entries\n  return Array.from(\n    { length: readInt32(buf, base) },\n    (_, i) => extract(buf, base + SIZEOF_INT + i * stride)\n  );\n}\n", "/**\n * @import { Batch } from '../batch.js';\n */\n\n/**\n * Symbol for the row index value of a struct object proxy.\n */\nexport const RowIndex = Symbol('rowIndex');\n\n/**\n * Returns a row proxy object factory. The resulting method takes a\n * batch-level row index as input and returns an object that proxies\n * access to underlying batches.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @returns {(index: number) => Record<string, any>}\n */\nexport function proxyFactory(names, batches) {\n  class RowObject {\n    /**\n     * Create a new proxy row object representing a struct or table row.\n     * @param {number} index The record batch row index.\n     */\n    constructor(index) {\n      this[RowIndex] = index;\n    }\n\n    /**\n     * Return a JSON-compatible object representation.\n     */\n    toJSON() {\n      return structObject(names, batches, this[RowIndex]);\n    }\n  };\n\n  // prototype for row proxy objects\n  const proto = RowObject.prototype;\n\n  for (let i = 0; i < names.length; ++i) {\n    // skip duplicated column names\n    if (Object.hasOwn(proto, names[i])) continue;\n\n    // add a getter method for the current batch\n    const batch = batches[i];\n    Object.defineProperty(proto, names[i], {\n      get() { return batch.at(this[RowIndex]); },\n      enumerable: true\n    });\n  }\n\n  return index => new RowObject(index);\n}\n\n/**\n * Returns a row object factory. The resulting method takes a\n * batch-level row index as input and returns an object whose property\n * values have been extracted from the batches.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @returns {(index: number) => Record<string, any>}\n */\nexport function objectFactory(names, batches) {\n  return index => structObject(names, batches, index);\n}\n\n/**\n * Return a vanilla object representing a struct (row object) type.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @param {number} index The record batch row index.\n * @returns {Record<string, any>}\n */\nexport function structObject(names, batches, index) {\n  const obj = {};\n  for (let i = 0; i < names.length; ++i) {\n    obj[names[i]] = batches[i].at(index);\n  }\n  return obj;\n}\n", "/**\n * @import { Column } from './column.js'\n * @import { DataType, DecimalType, IntegerArray, OffsetArray, TypedArray, TypedArrayConstructor, ValueArray } from './types.js'\n */\nimport { bisect, float64Array } from './util/arrays.js';\nimport { divide, fromDecimal128, fromDecimal256, fromDecimal64, toNumber } from './util/numbers.js';\nimport { decodeBit, readInt32, readInt64 } from './util/read.js';\nimport { decodeUtf8 } from './util/strings.js';\nimport { objectFactory, proxyFactory } from './util/struct.js';\n\n/**\n * Check if the input is a batch that supports direct access to\n * binary data in the form of typed arrays.\n * @param {Batch<any>?} batch The data batch to check.\n * @returns {boolean} True if a direct batch, false otherwise.\n */\nexport function isDirectBatch(batch) {\n  return batch instanceof DirectBatch;\n}\n\n/**\n * Column values from a single record batch.\n * A column may contain multiple batches.\n * @template T\n */\nexport class Batch {\n  /**\n   * The array type to use when extracting data from the batch.\n   * A null value indicates that the array type should match\n   * the type of the batch's values array.\n   * @type {ArrayConstructor | TypedArrayConstructor | null}\n   */\n  static ArrayType = null;\n\n  /**\n   * Create a new column batch.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {TypedArray} [options.values] Values buffer\n   * @param {OffsetArray} [options.offsets] Offsets buffer\n   * @param {OffsetArray} [options.sizes] Sizes buffer\n   * @param {Batch[]} [options.children] Children batches\n   */\n  constructor({\n    length,\n    nullCount,\n    type,\n    validity,\n    values,\n    offsets,\n    sizes,\n    children\n  }) {\n    this.length = length;\n    this.nullCount = nullCount;\n    this.type = type;\n    this.validity = validity;\n    this.values = values;\n    this.offsets = offsets;\n    this.sizes = sizes;\n    this.children = children;\n\n    // optimize access if this batch has no null values\n    // some types (like union) may have null values in\n    // child batches, but no top-level validity buffer\n    if (!nullCount || !this.validity) {\n      /** @type {(index: number) => T | null} */\n      this.at = index => this.value(index);\n    }\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Batch';\n  }\n\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {T | null} The value.\n   */\n  at(index) {\n    return this.isValid(index) ? this.value(index) : null;\n  }\n\n  /**\n   * Check if a value at the given index is valid (non-null).\n   * @param {number} index The value index.\n   * @returns {boolean} True if valid, false otherwise.\n   */\n  isValid(index) {\n    return decodeBit(this.validity, index);\n  }\n\n  /**\n   * Return the value at the given index. This method does not check the\n   * validity bitmap and is intended primarily for internal use. In most\n   * cases, callers should use the `at()` method instead.\n   * @param {number} index The value index\n   * @returns {T} The value, ignoring the validity bitmap.\n   */\n  value(index) {\n    return /** @type {T} */ (this.values[index]);\n  }\n\n  /**\n   * Extract an array of values within the given index range. Unlike\n   * Array.slice, all arguments are required and may not be negative indices.\n   * @param {number} start The starting index, inclusive\n   * @param {number} end The ending index, exclusive\n   * @returns {ValueArray<T?>} The slice of values\n   */\n  slice(start, end) {\n    const n = end - start;\n    const values = Array(n);\n    for (let i = 0; i < n; ++i) {\n      values[i] = this.at(start + i);\n    }\n    return values;\n  }\n\n  /**\n   * Return an iterator over the values in this batch.\n   * @returns {Iterator<T?>}\n   */\n  *[Symbol.iterator]() {\n    for (let i = 0; i < this.length; ++i) {\n      yield this.at(i);\n    }\n  }\n}\n\n/**\n * A batch whose value buffer can be used directly, without transformation.\n * @template T\n * @extends {Batch<T>}\n */\nexport class DirectBatch extends Batch {\n  /**\n   * Create a new column batch with direct value array access.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {TypedArray} options.values Values buffer\n   */\n  constructor(options) {\n    super(options);\n    // underlying buffers may be padded, exceeding the logical batch length\n    // we trim the values array so we can safely access it directly\n    const { length, values } = this;\n    this.values = values.subarray(0, length);\n  }\n\n  /**\n   * Extract an array of values within the given index range. Unlike\n   * Array.slice, all arguments are required and may not be negative indices.\n   * When feasible, a zero-copy subarray of a typed array is returned.\n   * @param {number} start The starting index, inclusive\n   * @param {number} end The ending index, exclusive\n   * @returns {ValueArray<T?>} The slice of values\n   */\n  slice(start, end) {\n    // @ts-ignore\n    return this.nullCount\n      ? super.slice(start, end)\n      : this.values.subarray(start, end);\n  }\n\n  /**\n   * Return an iterator over the values in this batch.\n   * @returns {Iterator<T?>}\n   */\n  [Symbol.iterator]() {\n    return this.nullCount\n      ? super[Symbol.iterator]()\n      : /** @type {Iterator<T?>} */ (this.values[Symbol.iterator]());\n  }\n}\n\n/**\n * A batch whose values are transformed to 64-bit numbers.\n * @extends {Batch<number>}\n */\nexport class NumberBatch extends Batch {\n  static ArrayType = float64Array;\n}\n\n/**\n * A batch whose values should be returned in a standard array.\n * @template T\n * @extends {Batch<T>}\n */\nexport class ArrayBatch extends Batch {\n  static ArrayType = Array;\n}\n\n/**\n * A batch of null values only.\n * @extends {ArrayBatch<null>}\n */\nexport class NullBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {null}\n   */\n  value(index) { // eslint-disable-line no-unused-vars\n    return null;\n  }\n}\n\n/**\n * A batch that coerces BigInt values to 64-bit numbers.\n * @extends {NumberBatch}\n */\nexport class Int64Batch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return toNumber(/** @type {bigint} */ (this.values[index]));\n  }\n}\n\n/**\n * A batch of 16-bit floating point numbers, accessed as unsigned\n * 16-bit ints and transformed to 64-bit numbers.\n */\nexport class Float16Batch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    const v = /** @type {number} */ (this.values[index]);\n    const expo = (v & 0x7C00) >> 10;\n    const sigf = (v & 0x03FF) / 1024;\n    const sign = (-1) ** ((v & 0x8000) >> 15);\n    switch (expo) {\n      case 0x1F: return sign * (sigf ? Number.NaN : 1 / 0);\n      case 0x00: return sign * (sigf ? 6.103515625e-5 * sigf : 0);\n    }\n    return sign * (2 ** (expo - 15)) * (1 + sigf);\n  }\n}\n\n/**\n * A batch of boolean values stored as a bitmap.\n * @extends {ArrayBatch<boolean>}\n */\nexport class BoolBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return decodeBit(/** @type {Uint8Array} */ (this.values), index);\n  }\n}\n\n/**\n * A batch of 32-bit decimal numbers, returned as converted 64-bit floating\n * point numbers. Number coercion may be lossy if the decimal precision can\n * not be represented in a 64-bit floating point format.\n * @extends {NumberBatch}\n */\nexport class Decimal32NumberBatch extends NumberBatch {\n  constructor(options) {\n    super(options);\n    const { scale } = /** @type {DecimalType} */ (this.type);\n    this.scale = 10 ** scale;\n  }\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return /** @type {number} */(this.values[index]) / this.scale;\n  }\n}\n\n/**\n * An abstract class for a batch of 64-, 128- or 256-bit decimal numbers,\n * accessed in strided BigUint64Arrays.\n * @template T\n * @extends {Batch<T>}\n */\nexport class DecimalBatch extends Batch {\n  constructor(options) {\n    super(options);\n    const { bitWidth, scale } = /** @type {DecimalType} */ (this.type);\n    this.decimal = bitWidth === 64 ? fromDecimal64\n      : bitWidth === 128 ? fromDecimal128\n      : fromDecimal256;\n    this.scale = 10n ** BigInt(scale);\n  }\n}\n\n/**\n * A batch of 64-, 128- or 256-bit decimal numbers, returned as converted\n * 64-bit floating point numbers. Number coercion may be lossy if the decimal\n * precision can not be represented in a 64-bit floating point format.\n * @extends {DecimalBatch<number>}\n */\nexport class DecimalNumberBatch extends DecimalBatch {\n  static ArrayType = float64Array;\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return divide(\n      this.decimal(/** @type {BigUint64Array} */ (this.values), index),\n      this.scale\n    );\n  }\n}\n\n/**\n * A batch of 64-, 128- or 256-bit decimal numbers, returned as scaled\n * bigint values, such that all fractional digits have been shifted\n * to integer places by the decimal type scale factor.\n * @extends {DecimalBatch<bigint>}\n */\nexport class DecimalBigIntBatch extends DecimalBatch {\n  static ArrayType = Array;\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return this.decimal(/** @type {BigUint64Array} */ (this.values), index);\n  }\n}\n\n/**\n * A batch of date or timestamp values that are coerced to UNIX epoch timestamps\n * and returned as JS Date objects. This batch wraps a source batch that provides\n * timestamp values.\n * @extends {ArrayBatch<Date>}\n */\nexport class DateBatch extends ArrayBatch {\n  /**\n   * Create a new date batch.\n   * @param {Batch<number>} batch A batch of timestamp values.\n   */\n  constructor(batch) {\n    super(batch);\n    this.source = batch;\n  }\n\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return new Date(this.source.value(index));\n  }\n}\n\n/**\n * A batch of dates as day counts, coerced to timestamp numbers.\n */\nexport class DateDayBatch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {number}\n   */\n  value(index) {\n    // epoch days to milliseconds\n    return 86400000 * /** @type {number} */ (this.values[index]);\n  }\n}\n\n/**\n * A batch of dates as millisecond timestamps, coerced to numbers.\n */\nexport const DateDayMillisecondBatch = Int64Batch;\n\n/**\n * A batch of timestaps in seconds, coerced to millisecond numbers.\n */\nexport class TimestampSecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return super.value(index) * 1e3; // seconds to milliseconds\n  }\n}\n\n/**\n * A batch of timestaps in milliseconds, coerced to numbers.\n */\nexport const TimestampMillisecondBatch = Int64Batch;\n\n/**\n * A batch of timestaps in microseconds, coerced to millisecond numbers.\n */\nexport class TimestampMicrosecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    // microseconds to milliseconds\n    return divide(/** @type {bigint} */ (this.values[index]), 1000n);\n  }\n}\n\n/**\n * A batch of timestaps in nanoseconds, coerced to millisecond numbers.\n */\nexport class TimestampNanosecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    // nanoseconds to milliseconds\n    return divide(/** @type {bigint} */ (this.values[index]), 1000000n);\n  }\n}\n\n/**\n * A batch of day/time intervals, returned as two-element 32-bit int arrays.\n * @extends {ArrayBatch<Int32Array>}\n */\nexport class IntervalDayTimeBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {Int32Array}\n   */\n  value(index) {\n    const values = /** @type {Int32Array} */ (this.values);\n    return values.subarray(index << 1, (index + 1) << 1);\n  }\n}\n\n/**\n * A batch of month/day/nanosecond intervals, returned as three-element arrays.\n * @extends {ArrayBatch<Float64Array>}\n */\nexport class IntervalMonthDayNanoBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    const values = /** @type {Uint8Array} */ (this.values);\n    const base = index << 4;\n    return Float64Array.of(\n      readInt32(values, base),\n      readInt32(values, base + 4),\n      readInt64(values, base + 8)\n    );\n  }\n}\n\nconst offset32 = ({values, offsets}, index) => values.subarray(offsets[index], offsets[index + 1]);\nconst offset64 = ({values, offsets}, index) => values.subarray(toNumber(offsets[index]), toNumber(offsets[index + 1]));\n\n/**\n * A batch of binary blobs with variable offsets, returned as byte buffers of\n * unsigned 8-bit integers. The offsets are 32-bit ints.\n * @extends {ArrayBatch<Uint8Array>}\n */\nexport class BinaryBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    return offset32(this, index);\n  }\n}\n\n/**\n * A batch of binary blobs with variable offsets, returned as byte buffers of\n * unsigned 8-bit integers. The offsets are 64-bit ints. Value extraction will\n * fail if an offset exceeds `Number.MAX_SAFE_INTEGER`.\n * @extends {ArrayBatch<Uint8Array>}\n */\nexport class LargeBinaryBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    return offset64(this, index);\n  }\n}\n\n/**\n * A batch of UTF-8 strings with variable offsets. The offsets are 32-bit ints.\n * @extends {ArrayBatch<string>}\n */\nexport class Utf8Batch extends ArrayBatch {\n  /**\n   * @param {number} index\n   */\n  value(index) {\n    return decodeUtf8(offset32(this, index));\n  }\n}\n\n/**\n * A batch of UTF-8 strings with variable offsets. The offsets are 64-bit ints.\n * Value extraction will fail if an offset exceeds `Number.MAX_SAFE_INTEGER`.\n * @extends {ArrayBatch<string>}\n */\nexport class LargeUtf8Batch extends ArrayBatch {\n  /**\n   * @param {number} index\n   */\n  value(index) {\n    return decodeUtf8(offset64(this, index));\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets are\n * 32-bit ints.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nexport class ListBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const offsets = /** @type {Int32Array} */ (this.offsets);\n    return this.children[0].slice(offsets[index], offsets[index + 1]);\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets are\n * 64-bit ints. Value extraction will fail if an offset exceeds\n * `Number.MAX_SAFE_INTEGER`.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nexport class LargeListBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const offsets = /** @type {BigInt64Array} */ (this.offsets);\n    return this.children[0].slice(toNumber(offsets[index]), toNumber(offsets[index + 1]));\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets and\n * sizes are 32-bit ints.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nexport class ListViewBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const a = /** @type {number} */ (this.offsets[index]);\n    const b = a + /** @type {number} */ (this.sizes[index]);\n    return this.children[0].slice(a, b);\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets and\n * sizes are 64-bit ints. Value extraction will fail if an offset or size\n * exceeds `Number.MAX_SAFE_INTEGER`.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nexport class LargeListViewBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const a = /** @type {bigint} */ (this.offsets[index]);\n    const b = a + /** @type {bigint} */ (this.sizes[index]);\n    return this.children[0].slice(toNumber(a), toNumber(b));\n  }\n}\n\n/**\n * A batch with a fixed stride.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass FixedBatch extends ArrayBatch {\n  constructor(options) {\n    super(options);\n    /** @type {number} */\n    // @ts-ignore\n    this.stride = this.type.stride;\n  }\n}\n\n/**\n * A batch of binary blobs of fixed size, returned as byte buffers of unsigned\n * 8-bit integers.\n * @extends {FixedBatch<Uint8Array>}\n */\nexport class FixedBinaryBatch extends FixedBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    const { stride, values } = this;\n    return /** @type {Uint8Array} */ (values)\n      .subarray(index * stride, (index + 1) * stride);\n  }\n}\n\n/**\n * A batch of list (array) values of fixed length.\n * @template V\n * @extends {FixedBatch<ValueArray<V>>}\n */\nexport class FixedListBatch extends FixedBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const { children, stride } = this;\n    return children[0].slice(index * stride, (index + 1) * stride);\n  }\n}\n\n/**\n * Extract Map key-value pairs from parallel child batches.\n */\nfunction pairs({ children, offsets }, index) {\n  const [ keys, vals ] = children[0].children;\n  const start = offsets[index];\n  const end = offsets[index + 1];\n  const entries = [];\n  for (let i = start; i < end; ++i) {\n    entries.push([keys.at(i), vals.at(i)]);\n  }\n  return entries;\n}\n\n/**\n * A batch of map (key, value) values. The map is represented as a list of\n * key-value structs.\n * @template K, V\n * @extends {ArrayBatch<[K, V][]>}\n */\nexport class MapEntryBatch extends ArrayBatch {\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {[K, V][]} The map entries as an array of [key, value] arrays.\n   */\n  value(index) {\n    return /** @type {[K, V][]} */ (pairs(this, index));\n  }\n}\n\n/**\n * A batch of map (key, value) values. The map is represented as a list of\n * key-value structs.\n * @template K, V\n * @extends {ArrayBatch<Map<K, V>>}\n */\nexport class MapBatch extends ArrayBatch {\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {Map<K, V>} The map value.\n   */\n  value(index) {\n    return new Map(/** @type {[K, V][]} */ (pairs(this, index)));\n  }\n}\n\n/**\n * A batch of union-type values with a sparse layout, enabling direct\n * lookup from the child value batches.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nexport class SparseUnionBatch extends ArrayBatch {\n  /**\n   * Create a new column batch.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {Int32Array} [options.offsets] Offsets buffer\n   * @param {Batch[]} options.children Children batches\n   * @param {Int8Array} options.typeIds Union type ids buffer\n   * @param {Record<string, number>} options.map A typeId to children index map\n   */\n  constructor({ typeIds, ...options }) {\n    super(options);\n    /** @type {Int8Array} */\n    this.typeIds = typeIds;\n    /** @type {Record<string, number>} */\n    // @ts-ignore\n    this.typeMap = this.type.typeMap;\n  }\n\n  /**\n   * @param {number} index The value index.\n   */\n  value(index, offset = index) {\n    const { typeIds, children, typeMap } = this;\n    return children[typeMap[typeIds[index]]].at(offset);\n  }\n}\n\n/**\n * A batch of union-type values with a dense layout, reqiring offset\n * lookups from the child value batches.\n * @template T\n * @extends {SparseUnionBatch<T>}\n */\nexport class DenseUnionBatch extends SparseUnionBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return super.value(index, /** @type {number} */ (this.offsets[index]));\n  }\n}\n\n/**\n * A batch of struct values, containing a set of named properties.\n * Struct property values are extracted and returned as JS objects.\n * @extends {ArrayBatch<Record<string, any>>}\n */\nexport class StructBatch extends ArrayBatch {\n  constructor(options, factory = objectFactory) {\n    super(options);\n    /** @type {string[]} */\n    // @ts-ignore\n    this.names = this.type.children.map(child => child.name);\n    this.factory = factory(this.names, this.children);\n  }\n\n  /**\n   * @param {number} index The value index.\n   * @returns {Record<string, any>}\n   */\n  value(index) {\n    return this.factory(index);\n  }\n}\n\n/**\n * A batch of struct values, containing a set of named properties.\n * Structs are returned as proxy objects that extract data directly\n * from underlying Arrow batches.\n * @extends {StructBatch}\n */\nexport class StructProxyBatch extends StructBatch {\n  constructor(options) {\n    super(options, proxyFactory);\n  }\n}\n\n/**\n * A batch of run-end-encoded values.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nexport class RunEndEncodedBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    const [ { values: runs }, vals ] = this.children;\n    return vals.at(\n      bisect(/** @type {IntegerArray} */(runs), index)\n    );\n  }\n}\n\n/**\n * A batch of dictionary-encoded values.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nexport class DictionaryBatch extends ArrayBatch {\n  /**\n   * Register the backing dictionary. Dictionaries are added\n   * after batch creation as the complete dictionary may not\n   * be finished across multiple record batches.\n   * @param {Column<T>} dictionary\n   * The dictionary of column values.\n   */\n  setDictionary(dictionary) {\n    this.dictionary = dictionary;\n    this.cache = dictionary.cache();\n    return this;\n  }\n\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return this.cache[this.key(index)];\n  }\n\n  /**\n   * @param {number} index The value index.\n   * @returns {number} The dictionary key\n   */\n  key(index) {\n    return /** @type {number} */ (this.values[index]);\n  }\n}\n\n/**\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass ViewBatch extends ArrayBatch {\n  /**\n   * Create a new view batch.\n   * @param {object} options Batch options.\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {Uint8Array} options.values Values buffer\n   * @param {Uint8Array[]} options.data View data buffers\n   */\n  constructor({ data, ...options }) {\n    super(options);\n    this.data = data;\n  }\n\n  /**\n   * Get the binary data at the provided index.\n   * @param {number} index The value index.\n   * @returns {Uint8Array}\n   */\n  view(index) {\n    const { values, data } = this;\n    const offset = index << 4; // each entry is 16 bytes\n    let start = offset + 4;\n    let buf = /** @type {Uint8Array} */ (values);\n    const length = readInt32(buf, offset);\n    if (length > 12) {\n      // longer strings are in a data buffer\n      start = readInt32(buf, offset + 12);\n      buf = data[readInt32(buf, offset + 8)];\n    }\n    return buf.subarray(start, start + length);\n  }\n}\n\n/**\n * A batch of binary blobs from variable data buffers, returned as byte\n * buffers of unsigned 8-bit integers.\n * @extends {ViewBatch<Uint8Array>}\n */\nexport class BinaryViewBatch extends ViewBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return this.view(index);\n  }\n}\n\n/**\n * A batch of UTF-8 strings from variable data buffers.\n * @extends {ViewBatch<string>}\n */\nexport class Utf8ViewBatch extends ViewBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return decodeUtf8(this.view(index));\n  }\n}\n", "/**\n * @import { Batch } from './batch.js'\n * @import { DataType, ValueArray } from './types.js'\n */\nimport { bisect } from './util/arrays.js';\nimport { isDirectBatch } from './batch.js';\n\n/**\n * Build up a column from batches.\n */\nexport function columnBuilder(type) {\n  let data = [];\n  return {\n    add(batch) { data.push(batch); return this; },\n    clear: () => data = [],\n    done: () => new Column(data, type)\n  };\n}\n\n/**\n * A data column. A column provides a view over one or more value batches,\n * each drawn from an Arrow record batch. This class supports random access\n * to column values by integer index; however, extracting arrays using\n * `toArray()` or iterating over values (`for (const value of column) {...}`)\n * provide more efficient ways for bulk access or scanning.\n * @template T\n */\nexport class Column {\n  /**\n   * Create a new column instance.\n   * @param {Batch<T>[]} data The value batches.\n   * @param {DataType} [type] The column data type.\n   *  If not specified, the type is extracted from the batches.\n   */\n  constructor(data, type = data[0]?.type) {\n    /**\n     * The column data type.\n     * @type {DataType}\n     * @readonly\n     */\n    this.type = type;\n    /**\n     * The column length.\n     * @type {number}\n     * @readonly\n     */\n    this.length = data.reduce((m, c) => m + c.length, 0);\n    /**\n     * The count of null values in the column.\n     * @type {number}\n     * @readonly\n     */\n    this.nullCount = data.reduce((m, c) => m + c.nullCount, 0);\n    /**\n     * An array of column data batches.\n     * @type {readonly Batch<T>[]}\n     * @readonly\n     */\n    this.data = data;\n\n    const n = data.length;\n    const offsets = new Int32Array(n + 1);\n    if (n === 1) {\n      const [ batch ] = data;\n      offsets[1] = batch.length;\n      // optimize access to single batch\n      this.at = index => batch.at(index);\n    } else {\n      for (let i = 0, s = 0; i < n; ++i) {\n        offsets[i + 1] = (s += data[i].length);\n      }\n    }\n\n    /**\n     * Index offsets for data batches.\n     * Used to map a column row index to a batch-specific index.\n     * @type {Int32Array}\n     * @readonly\n     */\n    this.offsets = offsets;\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Column';\n  }\n\n  /**\n   * Return an iterator over the values in this column.\n   * @returns {Iterator<T?>}\n   */\n  [Symbol.iterator]() {\n    const data = this.data;\n    return data.length === 1\n      ? data[0][Symbol.iterator]()\n      : batchedIterator(data);\n  }\n\n  /**\n   * Return the column value at the given index. If a column has multiple\n   * batches, this method performs binary search over the batch lengths to\n   * determine the batch from which to retrieve the value. The search makes\n   * lookup less efficient than a standard array access. If making a full\n   * scan of a column, consider extracting arrays via `toArray()` or using an\n   * iterator (`for (const value of column) {...}`).\n   * @param {number} index The row index.\n   * @returns {T | null} The value.\n   */\n  at(index) {\n    // NOTE: if there is only one batch, this method is replaced with an\n    // optimized version in the Column constructor.\n    const { data, offsets } = this;\n    const i = bisect(offsets, index) - 1;\n    return data[i]?.at(index - offsets[i]); // undefined if out of range\n  }\n\n  /**\n   * Return the column value at the given index. This method is the same as\n   * `at()` and is provided for better compatibility with Apache Arrow JS.\n   * @param {number} index The row index.\n   * @returns {T | null} The value.\n   */\n  get(index) {\n    return this.at(index);\n  }\n\n  /**\n   * Extract column values into a single array instance. When possible,\n   * a zero-copy subarray of the input Arrow data is returned.\n   * @returns {ValueArray<T?>}\n   */\n  toArray() {\n    const { length, nullCount, data } = this;\n    const copy = !nullCount && isDirectBatch(data[0]);\n    const n = data.length;\n\n    if (copy && n === 1) {\n      // use batch array directly\n      // @ts-ignore\n      return data[0].values;\n    }\n\n    // determine output array type\n    const ArrayType = !n || nullCount > 0 ? Array\n      // @ts-ignore\n      : (data[0].constructor.ArrayType ?? data[0].values.constructor);\n\n    const array = new ArrayType(length);\n    return copy ? copyArray(array, data) : extractArray(array, data);\n  }\n\n  /**\n   * Return an array of cached column values.\n   * Used internally to accelerate dictionary types.\n   */\n  cache() {\n    return this._cache ?? (this._cache = this.toArray());\n  }\n}\n\nfunction *batchedIterator(data) {\n  for (let i = 0; i < data.length; ++i) {\n    const iter = data[i][Symbol.iterator]();\n    for (let next = iter.next(); !next.done; next = iter.next()) {\n      yield next.value;\n    }\n  }\n}\n\nfunction copyArray(array, data) {\n  for (let i = 0, offset = 0; i < data.length; ++i) {\n    const { values } = data[i];\n    array.set(values, offset);\n    offset += values.length;\n  }\n  return array;\n}\n\nfunction extractArray(array, data) {\n  let index = -1;\n  for (let i = 0; i < data.length; ++i) {\n    const batch = data[i];\n    for (let j = 0; j < batch.length; ++j) {\n      array[++index] = batch.at(j);\n    }\n  }\n  return array;\n}\n", "/**\n * @import { Column } from './column.js'\n * @import { Schema, StructFactory, TypeMap, ValueArray } from './types.js'\n */\nimport { bisect } from './util/arrays.js';\nimport { objectFactory, proxyFactory } from './util/struct.js';\n\n/**\n * A table consists of a collection of named columns (or 'children').\n * To work with table data directly in JavaScript, use `toColumns()`\n * to extract an object that maps column names to extracted value arrays,\n * or `toArray()` to extract an array of row objects. For random access\n * by row index, use `getChild()` to access data for a specific column.\n * @template {TypeMap} [T=TypeMap]\n */\nexport class Table {\n  /**\n   * Create a new table with the given schema and columns (children).\n   * @param {Schema} schema The table schema.\n   * @param {Column[]} children The table columns.\n   * @param {boolean} [useProxy=false] Flag indicating if row proxy\n   *  objects should be used to represent table rows (default `false`).\n   */\n  constructor(schema, children, useProxy = false) {\n    const names = schema.fields.map(f => f.name);\n\n    /**\n     * @type {Schema}\n     * @readonly\n     */\n    this.schema = schema;\n    /**\n     * @type {(keyof T)[]}\n     * @readonly\n     */\n    this.names = names;\n    /**\n     * @type {Column[]}\n     * @readonly\n     */\n    this.children = children;\n    /**\n     * @type {StructFactory}\n     * @readonly\n     */\n    this.factory = useProxy ? proxyFactory : objectFactory;\n\n    // lazily created row object generators\n    const gen = [];\n\n    /**\n     * Returns a row object generator for the given batch index.\n     * @private\n     * @readonly\n     * @param {number} b The batch index.\n     * @returns {(index: number) => { [P in keyof T]: T[P] }}\n     */\n    this.getFactory = b => gen[b]\n      ?? (gen[b] = this.factory(names, children.map(c => c.data[b])));\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Table';\n  }\n\n  /**\n   * The number of columns in this table.\n   * @return {number} The number of columns.\n   */\n  get numCols() {\n    return this.names.length;\n  }\n\n  /**\n   * The number of rows in this table.\n   * @return {number} The number of rows.\n   */\n  get numRows() {\n    return this.children[0]?.length ?? 0;\n  }\n\n  /**\n   * Return the child column at the given index position.\n   * @template {T[keyof T]} R\n   * @param {number} index The column index.\n   * @returns {Column<R>}\n   */\n  getChildAt(index) {\n    return this.children[index];\n  }\n\n  /**\n   * Return the first child column with the given name.\n   * @template {keyof T} P\n   * @param {P} name The column name.\n   * @returns {Column<T[P]>}\n   */\n  getChild(name) {\n    const i = this.names.findIndex(x => x === name);\n    return i > -1 ? this.children[i] : undefined;\n  }\n\n  /**\n   * Construct a new table containing only columns at the specified indices.\n   * The order of columns in the new table matches the order of input indices.\n   * @template {T[keyof T]} V\n   * @param {number[]} indices The indices of columns to keep.\n   * @param {string[]} [as] Optional new names for selected columns.\n   * @returns {Table<{ [key: string]: V }>} A new table with selected columns.\n   */\n  selectAt(indices, as = []) {\n    const { children, factory, schema } = this;\n    const { fields } = schema;\n    return new Table(\n      {\n        ...schema,\n        fields: indices.map((i, j) => renameField(fields[i], as[j]))\n      },\n      indices.map(i => children[i]),\n      factory === proxyFactory\n    );\n  }\n\n  /**\n   * Construct a new table containing only columns with the specified names.\n   * If columns have duplicate names, the first (with lowest index) is used.\n   * The order of columns in the new table matches the order of input names.\n   * @template {keyof T} K\n   * @param {K[]} names Names of columns to keep.\n   * @param {string[]} [as] Optional new names for selected columns.\n   * @returns A new table with columns matching the specified names.\n   */\n  select(names, as) {\n    const all = /** @type {K[]} */(this.names);\n    const indices = names.map(name => all.indexOf(name));\n    return this.selectAt(indices, as);\n  }\n\n  /**\n   * Return an object mapping column names to extracted value arrays.\n   * @returns {{ [P in keyof T]: ValueArray<T[P]> }}\n   */\n  toColumns() {\n    const { children, names } = this;\n    /** @type {{ [P in keyof T]: ValueArray<T[P]> }} */\n    // @ts-expect-error assign to empty object\n    const cols = {};\n    names.forEach((name, i) => cols[name] = children[i]?.toArray() ?? [] );\n    return cols;\n  }\n\n  /**\n   * Return an array of objects representing the rows of this table.\n   * @returns {{ [P in keyof T]: T[P] }[]}\n   */\n  toArray() {\n    const { children, getFactory, numRows } = this;\n    const data = children[0]?.data ?? [];\n    const output = Array(numRows);\n    for (let b = 0, row = -1; b < data.length; ++b) {\n      const f = getFactory(b);\n      for (let i = 0; i < data[b].length; ++i) {\n        output[++row] = f(i);\n      }\n    }\n    return output;\n  }\n\n  /**\n   * Return an iterator over objects representing the rows of this table.\n   * @returns {Generator<{ [P in keyof T]: T[P] }, any, any>}\n   */\n  *[Symbol.iterator]() {\n    const { children, getFactory } = this;\n    const data = children[0]?.data ?? [];\n    for (let b = 0; b < data.length; ++b) {\n      const f = getFactory(b);\n      for (let i = 0; i < data[b].length; ++i) {\n        yield f(i);\n      }\n    }\n  }\n\n  /**\n   * Return a row object for the given index.\n   * @param {number} index The row index.\n   * @returns {{ [P in keyof T]: T[P] }} The row object.\n   */\n  at(index) {\n    const { children, getFactory, numRows } = this;\n    if (index < 0 || index >= numRows) return null;\n    const [{ offsets }] = children;\n    const b = bisect(offsets, index) - 1;\n    return getFactory(b)(index - offsets[b]);\n  }\n\n  /**\n   * Return a row object for the given index. This method is the same as\n   * `at()` and is provided for better compatibility with Apache Arrow JS.\n   * @param {number} index The row index.\n   * @returns {{ [P in keyof T]: T[P] }} The row object.\n   */\n  get(index) {\n    return this.at(index);\n  }\n}\n\nfunction renameField(field, name) {\n  return (name != null && name !== field.name)\n    ? { ...field, name }\n    : field;\n}\n", "/**\n * @import { DataType, ExtractionOptions } from './types.js';\n */\nimport { BinaryBatch, BinaryViewBatch, BoolBatch, DateBatch, DateDayBatch, DateDayMillisecondBatch, Decimal32NumberBatch, DecimalBigIntBatch, DecimalNumberBatch, DenseUnionBatch, DictionaryBatch, DirectBatch, FixedBinaryBatch, FixedListBatch, Float16Batch, Int64Batch, IntervalDayTimeBatch, IntervalMonthDayNanoBatch, LargeBinaryBatch, LargeListBatch, LargeListViewBatch, LargeUtf8Batch, ListBatch, ListViewBatch, MapBatch, MapEntryBatch, NullBatch, RunEndEncodedBatch, SparseUnionBatch, StructBatch, StructProxyBatch, TimestampMicrosecondBatch, TimestampMillisecondBatch, TimestampNanosecondBatch, TimestampSecondBatch, Utf8Batch, Utf8ViewBatch } from './batch.js';\nimport { DateUnit, IntervalUnit, TimeUnit, Type } from './constants.js';\nimport { invalidDataType } from './data-types.js';\n\n/**\n * Return a batch constructor for the given data type and extraction options.\n * @param {DataType} type The data type.\n * @param {ExtractionOptions} options The extraction options.\n */\nexport function batchType(type, options = {}) {\n  const { typeId, bitWidth, mode, precision, unit } = /** @type {any} */(type);\n  const { useBigInt, useDate, useDecimalInt, useMap, useProxy } = options;\n\n  switch (typeId) {\n    case Type.Null: return NullBatch;\n    case Type.Bool: return BoolBatch;\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n      return useBigInt || bitWidth < 64 ? DirectBatch : Int64Batch;\n    case Type.Float:\n      return precision ? DirectBatch : Float16Batch;\n    case Type.Date:\n      return wrap(\n        unit === DateUnit.DAY ? DateDayBatch : DateDayMillisecondBatch,\n        useDate && DateBatch\n      );\n    case Type.Timestamp:\n      return wrap(\n        unit === TimeUnit.SECOND ? TimestampSecondBatch\n          : unit === TimeUnit.MILLISECOND ? TimestampMillisecondBatch\n          : unit === TimeUnit.MICROSECOND ? TimestampMicrosecondBatch\n          : TimestampNanosecondBatch,\n        useDate && DateBatch\n      );\n    case Type.Decimal:\n      return bitWidth === 32\n        ? (useDecimalInt ? DirectBatch : Decimal32NumberBatch)\n        : (useDecimalInt ? DecimalBigIntBatch : DecimalNumberBatch);\n    case Type.Interval:\n      return unit === IntervalUnit.DAY_TIME ? IntervalDayTimeBatch\n        : unit === IntervalUnit.YEAR_MONTH ? DirectBatch\n        : IntervalMonthDayNanoBatch;\n    case Type.FixedSizeBinary: return FixedBinaryBatch;\n    case Type.Utf8: return Utf8Batch;\n    case Type.LargeUtf8: return LargeUtf8Batch;\n    case Type.Binary: return BinaryBatch;\n    case Type.LargeBinary: return LargeBinaryBatch;\n    case Type.BinaryView: return BinaryViewBatch;\n    case Type.Utf8View: return Utf8ViewBatch;\n    case Type.List: return ListBatch;\n    case Type.LargeList: return LargeListBatch;\n    case Type.Map: return useMap ? MapBatch : MapEntryBatch;\n    case Type.ListView: return ListViewBatch;\n    case Type.LargeListView: return LargeListViewBatch;\n    case Type.FixedSizeList: return FixedListBatch;\n    case Type.Struct: return useProxy ? StructProxyBatch : StructBatch;\n    case Type.RunEndEncoded: return RunEndEncodedBatch;\n    case Type.Dictionary: return DictionaryBatch;\n    case Type.Union: return mode ? DenseUnionBatch : SparseUnionBatch;\n  }\n  throw new Error(invalidDataType(typeId));\n}\n\nfunction wrap(BaseClass, WrapperClass) {\n  return WrapperClass\n    ? class WrapBatch extends WrapperClass {\n        constructor(options) {\n          super(new BaseClass(options));\n        }\n      }\n    : BaseClass;\n}\n", "import { readInt32, readInt64, readVector } from '../util/read.js';\n\n/**\n * Decode a block that points to messages within an Arrow 'file' format.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns The file block.\n */\nexport function decodeBlock(buf, index) {\n  //  0: offset\n  //  8: metadataLength\n  // 16: bodyLength\n  return {\n    offset: readInt64(buf, index),\n    metadataLength: readInt32(buf, index + 8),\n    bodyLength: readInt64(buf, index + 16)\n  }\n}\n\n/**\n * Decode a vector of blocks.\n * @param {Uint8Array} buf\n * @param {number} index\n * @returns An array of file blocks.\n */\nexport function decodeBlocks(buf, index) {\n  return readVector(buf, index, 24, decodeBlock);\n}\n", "/**\n * @import { RecordBatch, Version_ } from '../types.js'\n */\nimport { Version } from '../constants.js';\nimport { readInt64, readObject, readOffset, readVector } from '../util/read.js';\n\n/**\n * Decode a record batch.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {RecordBatch} The record batch\n */\nexport function decodeRecordBatch(buf, index, version) {\n  //  4: length\n  //  6: nodes\n  //  8: buffers\n  // 10: compression (not supported)\n  // 12: variadicBuffers (buffer counts for view-typed fields)\n  const get = readObject(buf, index);\n  if (get(10, readOffset, 0)) {\n    throw new Error('Record batch compression not implemented');\n  }\n\n  // If an Arrow buffer was written before version 4,\n  // advance 8 bytes to skip the now-removed page_id field\n  const offset = version < Version.V4 ? 8 : 0;\n\n  return {\n    length: get(4, readInt64, 0),\n    nodes: readVector(buf, get(6, readOffset), 16, (buf, pos) => ({\n      length: readInt64(buf, pos),\n      nullCount: readInt64(buf, pos + 8)\n    })),\n    regions: readVector(buf, get(8, readOffset), 16 + offset, (buf, pos) => ({\n      offset: readInt64(buf, pos + offset),\n      length: readInt64(buf, pos + offset + 8)\n    })),\n    variadic: readVector(buf, get(12, readOffset), 8, readInt64)\n  };\n}\n", "/**\n * @import { DictionaryBatch, Version_ } from '../types.js'\n */\nimport { readBoolean, readInt64, readObject } from '../util/read.js';\nimport { decodeRecordBatch } from './record-batch.js';\n\n/**\n * Decode a dictionary batch.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {DictionaryBatch} The dictionary batch\n */\nexport function decodeDictionaryBatch(buf, index, version) {\n  //  4: id\n  //  6: data\n  //  8: isDelta\n  const get = readObject(buf, index);\n  return {\n    id: get(4, readInt64, 0),\n    data: get(6, (buf, off) => decodeRecordBatch(buf, off, version)),\n    /**\n     * If isDelta is true the values in the dictionary are to be appended to a\n     * dictionary with the indicated id. If isDelta is false this dictionary\n     * should replace the existing dictionary.\n     */\n    isDelta: get(8, readBoolean, false)\n  };\n}\n", "/**\n * @import { DataType, Field } from '../types.js'\n */\nimport { DateUnit, IntervalUnit, Precision, TimeUnit, Type, UnionMode } from '../constants.js';\nimport { binary, date, decimal, duration, fixedSizeBinary, fixedSizeList, float, int, interval, invalidDataType, largeBinary, largeList, largeListView, largeUtf8, list, listView, mapType, runEndEncoded, struct, time, timestamp, union, utf8 } from '../data-types.js';\nimport { checkOneOf } from '../util/objects.js';\nimport { readBoolean, readInt16, readInt32, readObject, readOffset, readString, readVector } from '../util/read.js';\n\n/**\n * Decode a data type definition for a field.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data.\n * @param {number} index The starting index in the byte buffer.\n * @param {number} typeId The data type id.\n * @param {Field[]} [children] A list of parsed child fields.\n * @returns {DataType} The data type.\n */\nexport function decodeDataType(buf, index, typeId, children) {\n  checkOneOf(typeId, Type, invalidDataType);\n  const get = readObject(buf, index);\n\n  switch (typeId) {\n    // types without flatbuffer objects\n    case Type.Binary: return binary();\n    case Type.Utf8: return utf8();\n    case Type.LargeBinary: return largeBinary();\n    case Type.LargeUtf8: return largeUtf8();\n    case Type.List: return list(children[0]);\n    case Type.ListView: return listView(children[0]);\n    case Type.LargeList: return largeList(children[0]);\n    case Type.LargeListView: return largeListView(children[0]);\n    case Type.Struct: return struct(children);\n    case Type.RunEndEncoded: return runEndEncoded(children[0], children[1]);\n\n    // types with flatbuffer objects\n    case Type.Int: return int(\n      // @ts-ignore\n      get(4, readInt32, 0), // bitwidth\n      get(6, readBoolean, false) // signed\n    );\n    case Type.Float: return float(\n      // @ts-ignore\n      get(4, readInt16, Precision.HALF) // precision\n    );\n    case Type.Decimal: return decimal(\n      get(4, readInt32, 0), // precision\n      get(6, readInt32, 0), // scale\n      // @ts-ignore\n      get(8, readInt32, 128) // bitwidth\n    );\n    case Type.Date: return date(\n      // @ts-ignore\n      get(4, readInt16, DateUnit.MILLISECOND) // unit\n    );\n    case Type.Time: return time(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.MILLISECOND) // unit\n    );\n    case Type.Timestamp: return timestamp(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.SECOND), // unit\n      get(6, readString) // timezone\n    );\n    case Type.Interval: return interval(\n      // @ts-ignore\n      get(4, readInt16, IntervalUnit.YEAR_MONTH) // unit\n    );\n    case Type.Duration: return duration(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.MILLISECOND) // unit\n    );\n\n    case Type.FixedSizeBinary: return fixedSizeBinary(\n      get(4, readInt32, 0) // stride\n    );\n    case Type.FixedSizeList: return fixedSizeList(\n      children[0],\n      get(4, readInt32, 0), // stride\n    );\n    case Type.Map: return mapType(\n      get(4, readBoolean, false), // keysSorted\n      children[0]\n    );\n\n    case Type.Union: return union(\n      // @ts-ignore\n      get(4, readInt16, UnionMode.Sparse), // mode\n      children,\n      readVector(buf, get(6, readOffset), 4, readInt32) // type ids\n    );\n  }\n  // case Type.NONE:\n  // case Type.Null:\n  // case Type.Bool:\n  // case Type.BinaryView:\n  // case Type.Utf8View:\n  // @ts-ignore\n  return { typeId };\n}\n", "/**\n * @import { Metadata } from '../types.js'\n */\nimport { readObject, readString, readVector } from '../util/read.js';\n\n/**\n * Decode custom metadata consisting of key-value string pairs.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns {Metadata | null} The custom metadata map\n */\nexport function decodeMetadata(buf, index) {\n  const entries = readVector(buf, index, 4, (buf, pos) => {\n    const get = readObject(buf, pos);\n    return /** @type {[string, string]} */ ([\n      get(4, readString), // 4: key (string)\n      get(6, readString)  // 6: key (string)\n    ]);\n  });\n  return entries.length ? new Map(entries) : null;\n}\n", "/**\n * @import { DictionaryType, Endianness_, Field, IntType, Schema, Version_ } from '../types.js'\n */\nimport { Type } from '../constants.js';\nimport { dictionary, int32 } from '../data-types.js';\nimport { readBoolean, readInt16, readInt64, readObject, readOffset, readString, readUint8, readVector } from '../util/read.js';\nimport { decodeDataType } from './data-type.js';\nimport { decodeMetadata } from './metadata.js';\n\n/**\n * Decode a table schema describing the fields and their data types.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {Schema} The schema\n */\nexport function decodeSchema(buf, index, version) {\n  //  4: endianness (int16)\n  //  6: fields (vector)\n  //  8: metadata (vector)\n  // 10: features (int64[])\n  const get = readObject(buf, index);\n  return {\n    version,\n    endianness: /** @type {Endianness_} */ (get(4, readInt16, 0)),\n    fields: get(6, decodeSchemaFields, []),\n    metadata: get(8, decodeMetadata)\n  };\n}\n\n/**\n * @returns {Field[] | null}\n */\nfunction decodeSchemaFields(buf, fieldsOffset) {\n  return readVector(buf, fieldsOffset, 4, decodeField);\n}\n\n/**\n * @returns {Field}\n */\nfunction decodeField(buf, index) {\n  //  4: name (string)\n  //  6: nullable (bool)\n  //  8: type id (uint8)\n  // 10: type (union)\n  // 12: dictionary (table)\n  // 14: children (vector)\n  // 16: metadata (vector)\n  const get = readObject(buf, index);\n  const typeId = get(8, readUint8, Type.NONE);\n  const typeOffset = get(10, readOffset, 0);\n  const dict = get(12, decodeDictionary);\n  const children = get(14, (buf, off) => decodeFieldChildren(buf, off));\n\n  let type = decodeDataType(buf, typeOffset, typeId, children);\n  if (dict) {\n    dict.dictionary = type;\n    type = dict;\n  }\n\n  return {\n    name: get(4, readString),\n    type,\n    nullable: get(6, readBoolean, false),\n    metadata: get(16, decodeMetadata)\n  };\n}\n\n/**\n * @returns {Field[] | null}\n */\nfunction decodeFieldChildren(buf, fieldOffset) {\n  const children = readVector(buf, fieldOffset, 4, decodeField);\n  return children.length ? children : null;\n}\n\n/**\n * @param {Uint8Array} buf\n * @param {number} index\n * @returns {DictionaryType}\n */\nfunction decodeDictionary(buf, index) {\n  if (!index) return null;\n  //  4: id (int64)\n  //  6: indexType (Int type)\n  //  8: isOrdered (boolean)\n  // 10: kind (int16) currently only dense array is supported\n  const get = readObject(buf, index);\n  return dictionary(\n    null, // data type will be populated by caller\n    get(6, decodeInt, int32()), // index type\n    get(8, readBoolean, false), // ordered\n    get(4, readInt64, 0), // id\n  );\n}\n\n/**\n * Decode an integer data type.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data.\n * @param {number} index The starting index in the byte buffer.\n * @returns {IntType}\n */\nfunction decodeInt(buf, index) {\n  return /** @type {IntType} */ (\n    decodeDataType(buf, index, Type.Int)\n  );\n}\n", "/**\n * @import { Message, MessageHeader_, Version_ } from '../types.js'\n */\nimport { MessageHeader, Version } from '../constants.js';\nimport { keyFor } from '../util/objects.js';\nimport { SIZEOF_INT, readInt16, readInt32, readInt64, readObject, readOffset, readUint8 } from '../util/read.js';\nimport { decodeDictionaryBatch } from './dictionary-batch.js';\nimport { decodeRecordBatch } from './record-batch.js';\nimport { decodeSchema } from './schema.js';\n\nconst invalidMessageMetadata = (expected, actual) =>\n  `Expected to read ${expected} metadata bytes, but only read ${actual}.`;\n\nconst invalidMessageBodyLength = (expected, actual) =>\n  `Expected to read ${expected} bytes for message body, but only read ${actual}.`;\n\nconst invalidMessageType = (type) =>\n  `Unsupported message type: ${type} (${keyFor(MessageHeader, type)})`;\n\n/**\n * A \"message\" contains a block of Apache Arrow data, such as a schema,\n * record batch, or dictionary batch. This message decodes a single\n * message, returning its associated metadata and content.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns {Message} The decoded message.\n */\nexport function decodeMessage(buf, index) {\n  // get message start\n  let metadataLength = readInt32(buf, index) || 0;\n  index += SIZEOF_INT;\n\n  // ARROW-6313: If the first 4 bytes are continuation indicator (-1), read\n  // the next 4 for the 32-bit metadata length. Otherwise, assume this is a\n  // pre-v0.15 message, where the first 4 bytes are the metadata length.\n  if (metadataLength === -1) {\n    metadataLength = readInt32(buf, index) || 0;\n    index += SIZEOF_INT;\n  }\n  if (metadataLength === 0) return null;\n\n  const head = buf.subarray(index, index += metadataLength);\n  if (head.byteLength < metadataLength) {\n    throw new Error(invalidMessageMetadata(metadataLength, head.byteLength));\n  }\n\n  // decode message metadata\n  //  4: version\n  //  6: headerType\n  //  8: headerIndex\n  // 10: bodyLength\n  const get = readObject(head, 0);\n  const version = /** @type {Version_} */\n    (get(4, readInt16, Version.V1));\n  const type = /** @type {MessageHeader_} */\n    (get(6, readUint8, MessageHeader.NONE));\n  const offset = get(8, readOffset, 0);\n  const bodyLength = get(10, readInt64, 0);\n  let content;\n\n  if (offset) {\n    // decode message header\n    const decoder = type === MessageHeader.Schema ? decodeSchema\n      : type === MessageHeader.DictionaryBatch ? decodeDictionaryBatch\n      : type === MessageHeader.RecordBatch ? decodeRecordBatch\n      : null;\n    if (!decoder) throw new Error(invalidMessageType(type));\n    content = decoder(head, offset, version);\n\n    // extract message body\n    if (bodyLength > 0) {\n      const body = buf.subarray(index, index += bodyLength);\n      if (body.byteLength < bodyLength) {\n        throw new Error(invalidMessageBodyLength(bodyLength, body.byteLength));\n      }\n      // @ts-ignore\n      content.body = body;\n    } else if (type !== MessageHeader.Schema) {\n      // table-from-ipc.js buffer accessor requires body to exist, even for empty batches\n      // @ts-ignore\n      content.body = new Uint8Array(0);\n    }\n  }\n\n  return { version, type, index, content };\n}\n", "/**\n * @import { ArrowData, Version_ } from '../types.js'\n */\nimport { MAGIC, MessageHeader, Version } from '../constants.js';\nimport { isArrayBufferLike } from '../util/arrays.js';\nimport { readInt16, readInt32, readObject } from '../util/read.js';\nimport { decodeBlocks } from './block.js';\nimport { decodeMessage } from './message.js';\nimport { decodeMetadata } from './metadata.js';\nimport { decodeSchema } from './schema.js';\n\n/**\n * Decode [Apache Arrow IPC data][1] and return parsed schema, record batch,\n * and dictionary batch definitions. The input binary data may be either\n * an `ArrayBuffer` or `Uint8Array`. For Arrow data in the IPC 'stream' format,\n * an array of `Uint8Array` instances is also supported.\n *\n * This method stops short of generating views over field buffers. Use the\n * `createData()` method on the result to enable column data access.\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#serialization-and-interprocess-communication-ipc\n * @param {ArrayBufferLike | Uint8Array | Uint8Array[]} data\n *  The source byte buffer, or an array of buffers. If an array, each byte\n *  array may contain one or more self-contained messages. Messages may NOT\n *  span multiple byte arrays.\n * @returns {import('../types.js').ArrowData}\n */\nexport function decodeIPC(data) {\n  const source = isArrayBufferLike(data) ? new Uint8Array(data) : data;\n  return source instanceof Uint8Array && isArrowFileFormat(source)\n    ? decodeIPCFile(source)\n    : decodeIPCStream(source);\n}\n\n/**\n * @param {Uint8Array} buf\n * @returns {boolean}\n */\nfunction isArrowFileFormat(buf) {\n  if (!buf || buf.length < 4) return false;\n  for (let i = 0; i < 6; ++i) {\n    if (MAGIC[i] !== buf[i]) return false;\n  }\n  return true;\n}\n\n/**\n * Decode data in the [Arrow IPC 'stream' format][1].\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format\n * @param {Uint8Array | Uint8Array[]} data The source byte buffer, or an\n *  array of buffers. If an array, each byte array may contain one or more\n *  self-contained messages. Messages may NOT span multiple byte arrays.\n * @returns {ArrowData}\n */\nexport function decodeIPCStream(data) {\n  const stream = [data].flat();\n\n  let schema;\n  const records = [];\n  const dictionaries = [];\n\n  // consume each message in the stream\n  for (const buf of stream) {\n    if (!(buf instanceof Uint8Array)) {\n      throw new Error(`IPC data batch was not a Uint8Array.`);\n    }\n    let offset = 0;\n\n    // decode all messages in current buffer\n    while (true) {\n      const m = decodeMessage(buf, offset);\n      if (m === null) break; // end of messages\n      offset = m.index;\n      if (!m.content) continue;\n      switch (m.type) {\n        case MessageHeader.Schema:\n          // ignore repeated schema messages\n          if (!schema) schema = m.content;\n          break;\n        case MessageHeader.RecordBatch:\n          records.push(m.content);\n          break;\n        case MessageHeader.DictionaryBatch:\n          dictionaries.push(m.content);\n          break;\n      }\n    }\n  }\n\n  return /** @type {ArrowData} */ (\n    { schema, dictionaries, records, metadata: null }\n  );\n}\n\n/**\n * Decode data in the [Arrow IPC 'file' format][1].\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#ipc-file-format\n * @param {Uint8Array} data The source byte buffer.\n * @returns {ArrowData}\n */\nexport function decodeIPCFile(data) {\n  // find footer location\n  const offset = data.byteLength - (MAGIC.length + 4);\n  const length = readInt32(data, offset);\n\n  // decode file footer\n  //  4: version\n  //  6: schema\n  //  8: dictionaries (vector)\n  // 10: batches (vector)\n  // 12: metadata\n  const get = readObject(data, offset - length);\n  const version = /** @type {Version_} */\n    (get(4, readInt16, Version.V1));\n  const dicts = get(8, decodeBlocks, []);\n  const recs = get(10, decodeBlocks, []);\n\n  return /** @type {ArrowData} */ ({\n    schema: get(6, (buf, index) => decodeSchema(buf, index, version)),\n    dictionaries: dicts.map(({ offset }) => decodeMessage(data, offset).content),\n    records: recs.map(({ offset }) => decodeMessage(data, offset).content),\n    metadata: get(12, decodeMetadata)\n  });\n}\n", "/**\n * @import { ArrowData, ExtractionOptions, Field, RecordBatch, Schema } from '../types.js'\n */\nimport { batchType } from '../batch-type.js';\nimport { columnBuilder } from '../column.js';\nimport { Type, UnionMode, Version } from '../constants.js';\nimport { invalidDataType } from '../data-types.js';\nimport { Table } from '../table.js';\nimport { int8Array } from '../util/arrays.js';\nimport { decodeIPC } from './decode-ipc.js';\n\n/**\n * Decode [Apache Arrow IPC data][1] and return a new Table. The input binary\n * data may be either an `ArrayBuffer` or `Uint8Array`. For Arrow data in the\n * [IPC 'stream' format][2], an array of `Uint8Array` values is also supported.\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#serialization-and-interprocess-communication-ipc\n * [2]: https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format\n * @param {ArrayBufferLike | Uint8Array | Uint8Array[]} data\n *  The source byte buffer, or an array of buffers. If an array, each byte\n *  array may contain one or more self-contained messages. Messages may NOT\n *  span multiple byte arrays.\n * @param {ExtractionOptions} [options]\n *  Options for controlling how values are transformed when extracted\n *  from an Arrow binary representation.\n * @returns {Table} A Table instance.\n */\nexport function tableFromIPC(data, options) {\n  return createTable(decodeIPC(data), options);\n}\n\n/**\n * Create a table from parsed IPC data.\n * @param {ArrowData} data\n *  The IPC data, as returned by parseIPC.\n * @param {ExtractionOptions} [options]\n *  Options for controlling how values are transformed when extracted\n *  from am Arrow binary representation.\n * @returns {Table} A Table instance.\n */\nexport function createTable(data, options = {}) {\n  const { schema = { fields: [] }, dictionaries, records } = data;\n  const { version, fields } = schema;\n  const dictionaryMap = new Map;\n  const context = contextGenerator(options, version, dictionaryMap);\n\n  // build dictionary type map\n  const dictionaryTypes = new Map;\n  visitSchemaFields(schema, field => {\n    const type = field.type;\n    if (type.typeId === Type.Dictionary) {\n      dictionaryTypes.set(type.id, type.dictionary);\n    }\n  });\n\n  // decode dictionaries, build dictionary column map\n  const dicts = new Map;\n  for (const dict of dictionaries) {\n    const { id, data, isDelta, body } = dict;\n    const type = dictionaryTypes.get(id);\n    const batch = visit(type, context({ ...data, body }));\n    if (!dicts.has(id)) {\n      if (isDelta) {\n        throw new Error('Delta update can not be first dictionary batch.');\n      }\n      dicts.set(id, columnBuilder(type).add(batch));\n    } else {\n      const dict = dicts.get(id);\n      if (!isDelta) dict.clear();\n      dict.add(batch);\n    }\n  }\n  dicts.forEach((value, key) => dictionaryMap.set(key, value.done()));\n\n  // decode column fields\n  const cols = fields.map(f => columnBuilder(f.type));\n  for (const batch of records) {\n    const ctx = context(batch);\n    fields.forEach((f, i) => cols[i].add(visit(f.type, ctx)));\n  }\n\n  return new Table(schema, cols.map(c => c.done()), options.useProxy);\n}\n\n/**\n * Visit all fields within a schema.\n * @param {Schema} schema\n * @param {(field: Field) => void} visitor\n */\nfunction visitSchemaFields(schema, visitor) {\n  schema.fields.forEach(function visitField(field) {\n    visitor(field);\n    // @ts-ignore\n    field.type.dictionary?.children?.forEach(visitField);\n    // @ts-ignore\n    field.type.children?.forEach(visitField);\n  });\n}\n\n/**\n * Context object generator for field visitation and buffer definition.\n */\nfunction contextGenerator(options, version, dictionaryMap) {\n  const base = {\n    version,\n    options,\n    dictionary: id => dictionaryMap.get(id),\n  };\n\n  /**\n   * Return a context generator.\n   * @param {RecordBatch} batch\n   */\n  return batch => {\n    const { length, nodes, regions, variadic, body } = batch;\n    let nodeIndex = -1;\n    let bufferIndex = -1;\n    let variadicIndex = -1;\n    return {\n      ...base,\n      length,\n      node: () => nodes[++nodeIndex],\n      buffer: (ArrayType) => {\n        const { length, offset } = regions[++bufferIndex];\n        return ArrayType\n          ? new ArrayType(body.buffer, body.byteOffset + offset, length / ArrayType.BYTES_PER_ELEMENT)\n          : body.subarray(offset, offset + length)\n      },\n      variadic: () => variadic[++variadicIndex],\n      visit(children) { return children.map(f => visit(f.type, this)); }\n    };\n  };\n}\n\n/**\n * Visit a field, instantiating views of buffer regions.\n */\nfunction visit(type, ctx) {\n  const { typeId } = type;\n  const { options, node, buffer, variadic, version } = ctx;\n  const BatchType = batchType(type, options);\n\n  // extract the next { length, nullCount } field node - ALL fields have field nodes\n  const base = { ...node(), type };\n\n  if (typeId === Type.Null) {\n    // null fields have field nodes but no data buffers\n    return new BatchType({ ...base, nullCount: base.length });\n  }\n\n  switch (typeId) {\n    // validity and data value buffers\n    case Type.Bool:\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n    case Type.Float:\n    case Type.Decimal:\n    case Type.Date:\n    case Type.Timestamp:\n    case Type.Interval:\n    case Type.FixedSizeBinary:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(type.values)\n      });\n\n    // validity, offset, and value buffers\n    case Type.Utf8:\n    case Type.LargeUtf8:\n    case Type.Binary:\n    case Type.LargeBinary:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        values: buffer()\n      });\n\n    // views with variadic buffers\n    case Type.BinaryView:\n    case Type.Utf8View:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(), // views buffer\n        data: Array.from({ length: variadic() }, () => buffer()) // data buffers\n      });\n\n    // validity, offset, and list child\n    case Type.List:\n    case Type.LargeList:\n    case Type.Map:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n\n    // validity, offset, size, and list child\n    case Type.ListView:\n    case Type.LargeListView:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        sizes: buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n\n    // validity and children\n    case Type.FixedSizeList:\n    case Type.Struct:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        children: ctx.visit(type.children)\n      });\n\n    // children only\n    case Type.RunEndEncoded:\n      return new BatchType({\n        ...base,\n        children: ctx.visit(type.children)\n      });\n\n    // dictionary\n    case Type.Dictionary: {\n      const { id, indices } = type;\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(indices.values),\n      }).setDictionary(ctx.dictionary(id));\n    }\n\n    // union\n    case Type.Union: {\n      if (version < Version.V5) {\n        buffer(); // skip unused null bitmap\n      }\n      return new BatchType({\n        ...base,\n        typeIds: buffer(int8Array),\n        offsets: type.mode === UnionMode.Sparse ? null : buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n    }\n\n    // unsupported type\n    default:\n      throw new Error(invalidDataType(typeId));\n  }\n}\n", "/**\n * @import { DictionaryType, Field, Schema } from '../types.js';\n * @import { Builder } from './builder.js';\n */\nimport { Type } from '../constants.js';\nimport { encodeDataType } from './data-type.js';\nimport { encodeMetadata } from './metadata.js';\n\nconst isLittleEndian = new Uint16Array(new Uint8Array([1, 0]).buffer)[0] === 1;\n\n/**\n * @param {Builder} builder\n * @param {Schema} schema\n * @returns {number}\n */\nexport function encodeSchema(builder, schema) {\n  const { fields, metadata } = schema;\n  const fieldOffsets = fields.map(f => encodeField(builder, f));\n  const fieldsVectorOffset = builder.addOffsetVector(fieldOffsets);\n  const metadataOffset = encodeMetadata(builder, metadata);\n  return builder.addObject(4, b => {\n    b.addInt16(0, +(!isLittleEndian), 0);\n    b.addOffset(1, fieldsVectorOffset, 0);\n    b.addOffset(2, metadataOffset, 0);\n    // NOT SUPPORTED: 3, features\n  });\n}\n\n/**\n * @param {Builder} builder\n * @param {Field} field\n * @returns {number}\n */\nfunction encodeField(builder, field) {\n  const { name, nullable, type, metadata } = field;\n  let { typeId } = type;\n\n  // encode field data type\n  let typeOffset = 0;\n  let dictionaryOffset = 0;\n  if (typeId !== Type.Dictionary) {\n    typeOffset = encodeDataType(builder, type);\n  } else {\n    const dict = /** @type {DictionaryType} */ (type).dictionary;\n    typeId = dict.typeId;\n    dictionaryOffset = encodeDataType(builder, type);\n    typeOffset = encodeDataType(builder, dict);\n  }\n\n  // encode children, metadata, name, and field object\n  // @ts-ignore\n  const childOffsets = (type.children || []).map(f => encodeField(builder, f));\n  const childrenVectorOffset = builder.addOffsetVector(childOffsets);\n  const metadataOffset = encodeMetadata(builder, metadata);\n  const nameOffset = builder.addString(name);\n  return builder.addObject(7, b => {\n    b.addOffset(0, nameOffset, 0);\n    b.addInt8(1, +nullable, +false);\n    b.addInt8(2, typeId, Type.NONE);\n    b.addOffset(3, typeOffset, 0);\n    b.addOffset(4, dictionaryOffset, 0);\n    b.addOffset(5, childrenVectorOffset, 0);\n    b.addOffset(6, metadataOffset, 0);\n  });\n}\n", "import { AsyncDuckDB } from './async_bindings';\nimport { LogLevel, LogTopic, LogOrigin, LogEvent } from '../log';\nimport { ArrowInsertOptions, CSVInsertOptions, JSONInsertOptions } from '../bindings/insert_options';\nimport { tableFromIPC, Table } from '@uwdata/flechette';\n\n/** A thin helper to memoize the connection id */\nexport class AsyncDuckDBConnection {\n    /** The async duckdb */\n    protected readonly _bindings: AsyncDuckDB;\n    /** The conn handle */\n    protected readonly _conn: number;\n\n    constructor(bindings: AsyncDuckDB, conn: number) {\n        this._bindings = bindings;\n        this._conn = conn;\n    }\n\n    /** Access the database bindings */\n    public get bindings(): AsyncDuckDB {\n        return this._bindings;\n    }\n\n    /** Disconnect from the database */\n    public async close(): Promise<void> {\n        return this._bindings.disconnect(this._conn);\n    }\n\n    /** Brave souls may use this function to consume the underlying connection id */\n    public useUnsafe<R>(callback: (bindings: AsyncDuckDB, conn: number) => R) {\n        return callback(this._bindings, this._conn);\n    }\n\n    /** \n     * Run a query and return Arrow IPC table\n     */\n    public async query(text: string): Promise<Table> {\n        this._bindings.logger.log({\n            timestamp: new Date(),\n            level: LogLevel.INFO,\n            origin: LogOrigin.ASYNC_DUCKDB,\n            topic: LogTopic.QUERY,\n            event: LogEvent.RUN,\n            value: text,\n        });\n        const buffer = await this._bindings.runQuery(this._conn, text);\n        return tableFromIPC(buffer);\n    }\n\n    /** \n     * Send a query and return async iterable of Arrow IPC buffers\n     * Use with arrow library of choice (e.g., @uwdata/flechette, apache-arrow)\n     */\n    public async send(\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<AsyncIterable<Uint8Array>> {\n        this._bindings.logger.log({\n            timestamp: new Date(),\n            level: LogLevel.INFO,\n            origin: LogOrigin.ASYNC_DUCKDB,\n            topic: LogTopic.QUERY,\n            event: LogEvent.RUN,\n            value: text,\n        });\n        let header = await this._bindings.startPendingQuery(this._conn, text, allowStreamResult);\n        while (header == null) {\n            // Avoid infinite loop on detached state\n            if (this._bindings.isDetached()) {\n                console.error('cannot send a message since the worker is not set!');\n                return undefined as any;\n            }\n            header = await this._bindings.pollPendingQuery(this._conn);\n        }\n        return new AsyncResultStreamIterator(this._bindings, this._conn, header);\n    }\n\n    /** Cancel a query that was sent earlier */\n    public async cancelSent(): Promise<boolean> {\n        return await this._bindings.cancelPendingQuery(this._conn);\n    }\n\n    /** Get table names */\n    public async getTableNames(query: string): Promise<string[]> {\n        return await this._bindings.getTableNames(this._conn, query);\n    }\n\n    /** Create a prepared statement */\n    public async prepare(\n        text: string,\n    ): Promise<AsyncPreparedStatement> {\n        const stmt = await this._bindings.createPrepared(this._conn, text);\n        return new AsyncPreparedStatement(this._bindings, this._conn, stmt);\n    }\n\n    /** Insert an arrow table from an ipc stream */\n    public async insertArrowFromIPCStream(buffer: Uint8Array, options: ArrowInsertOptions): Promise<void> {\n        await this._bindings.insertArrowFromIPCStream(this._conn, buffer, options);\n    }\n    /** Insert csv file from path */\n    public async insertCSVFromPath(text: string, options: CSVInsertOptions): Promise<void> {\n        await this._bindings.insertCSVFromPath(this._conn, text, options);\n    }\n    /** Insert json file from path */\n    public async insertJSONFromPath(text: string, options: JSONInsertOptions): Promise<void> {\n        await this._bindings.insertJSONFromPath(this._conn, text, options);\n    }\n}\n\n/** An async result stream iterator */\nexport class AsyncResultStreamIterator implements AsyncIterable<Uint8Array> {\n    /** First chunk? */\n    protected _first: boolean;\n    /** Reached end of stream? */\n    protected _depleted: boolean;\n    /** In-flight */\n    protected _inFlight: Promise<Uint8Array | null> | null;\n\n    constructor(\n        protected readonly db: AsyncDuckDB,\n        protected readonly conn: number,\n        protected readonly header: Uint8Array,\n    ) {\n        this._first = true;\n        this._depleted = false;\n        this._inFlight = null;\n    }\n\n    async next(): Promise<IteratorResult<Uint8Array>> {\n        if (this._first) {\n            this._first = false;\n            return { done: false, value: this.header };\n        }\n        if (this._depleted) {\n            return { done: true, value: null };\n        }\n        let buffer: Uint8Array | null = null;\n        if (this._inFlight != null) {\n            buffer = await this._inFlight;\n            this._inFlight = null;\n        }\n\n        while (buffer == null) {\n            buffer = await this.db.fetchQueryResults(this.conn);\n        }\n\n        this._depleted = buffer.length == 0;\n        if (!this._depleted) {\n            this._inFlight = this.db.fetchQueryResults(this.conn);\n        }\n\n        return {\n            done: this._depleted,\n            value: buffer,\n        };\n    }\n\n    [Symbol.asyncIterator]() {\n        return this;\n    }\n}\n\n/** A thin helper to bind the prepared statement id */\nexport class AsyncPreparedStatement {\n    /** The bindings */\n    protected readonly bindings: AsyncDuckDB;\n    /** The connection id */\n    protected readonly connectionId: number;\n    /** The statement id */\n    protected readonly statementId: number;\n\n    /** Constructor */\n    constructor(bindings: AsyncDuckDB, connectionId: number, statementId: number) {\n        this.bindings = bindings;\n        this.connectionId = connectionId;\n        this.statementId = statementId;\n    }\n\n    /** Close a prepared statement */\n    public async close() {\n        await this.bindings.closePrepared(this.connectionId, this.statementId);\n    }\n\n    /** \n     * Run a prepared statement and return Arrow IPC table\n     */\n    public async query(...params: any[]): Promise<Table> {\n        const buffer = await this.bindings.runPrepared(this.connectionId, this.statementId, params);\n        return tableFromIPC(buffer);\n    }\n\n    /** \n     * Send a prepared statement and return async iterable of Arrow IPC buffers\n     * Use with arrow library of choice (e.g., @uwdata/flechette, apache-arrow)\n     */\n    public async send(...params: any[]): Promise<AsyncIterable<Uint8Array>> {\n        const header = await this.bindings.sendPrepared(this.connectionId, this.statementId, params);\n        return new AsyncResultStreamIterator(this.bindings, this.connectionId, header);\n    }\n}\n", "import { CSVInsertOptions, JSONInsertOptions, ArrowInsertOptions } from '../bindings/insert_options';\nimport { LogEntryVariant, ProgressEntry } from '../log';\nimport { ScriptTokens } from '../bindings/tokens';\nimport { FileStatistics } from '../bindings/file_stats';\nimport { DuckDBConfig } from '../bindings/config';\nimport { WebFile } from '../bindings/web_file';\nimport { InstantiationProgress } from '../bindings/progress';\nimport { DuckDBDataProtocol } from '../bindings';\n\nexport type ConnectionID = number;\nexport type StatementID = number;\n\nexport enum WorkerRequestType {\n    CANCEL_PENDING_QUERY = 'CANCEL_PENDING_QUERY',\n    CLOSE_PREPARED = 'CLOSE_PREPARED',\n    COLLECT_FILE_STATISTICS = 'COLLECT_FILE_STATISTICS',\n    REGISTER_OPFS_FILE_NAME = 'REGISTER_OPFS_FILE_NAME',\n    CONNECT = 'CONNECT',\n    COPY_FILE_TO_BUFFER = 'COPY_FILE_TO_BUFFER',\n    COPY_FILE_TO_PATH = 'COPY_FILE_TO_PATH',\n    CREATE_PREPARED = 'CREATE_PREPARED',\n    DISCONNECT = 'DISCONNECT',\n    DROP_FILE = 'DROP_FILE',\n    DROP_FILES = 'DROP_FILES',\n    EXPORT_FILE_STATISTICS = 'EXPORT_FILE_STATISTICS',\n    FETCH_QUERY_RESULTS = 'FETCH_QUERY_RESULTS',\n    FLUSH_FILES = 'FLUSH_FILES',\n    GET_FEATURE_FLAGS = 'GET_FEATURE_FLAGS',\n    GET_TABLE_NAMES = 'GET_TABLE_NAMES',\n    GET_VERSION = 'GET_VERSION',\n    GLOB_FILE_INFOS = 'GLOB_FILE_INFOS',\n    INSERT_ARROW_FROM_IPC_STREAM = 'INSERT_ARROW_FROM_IPC_STREAM',\n    INSERT_CSV_FROM_PATH = 'IMPORT_CSV_FROM_PATH',\n    INSERT_JSON_FROM_PATH = 'IMPORT_JSON_FROM_PATH',\n    INSTANTIATE = 'INSTANTIATE',\n    OPEN = 'OPEN',\n    PING = 'PING',\n    POLL_PENDING_QUERY = 'POLL_PENDING_QUERY',\n    REGISTER_FILE_BUFFER = 'REGISTER_FILE_BUFFER',\n    REGISTER_FILE_HANDLE = 'REGISTER_FILE_HANDLE',\n    REGISTER_FILE_URL = 'REGISTER_FILE_URL',\n    RESET = 'RESET',\n    RUN_PREPARED = 'RUN_PREPARED',\n    RUN_QUERY = 'RUN_QUERY',\n    SEND_PREPARED = 'SEND_PREPARED',\n    START_PENDING_QUERY = 'START_PENDING_QUERY',\n    TOKENIZE = 'TOKENIZE',\n}\n\nexport enum WorkerResponseType {\n    CONNECTION_INFO = 'CONNECTION_INFO',\n    ERROR = 'ERROR',\n    FEATURE_FLAGS = 'FEATURE_FLAGS',\n    FILE_BUFFER = 'FILE_BUFFER',\n    FILE_INFOS = 'FILE_INFOS',\n    FILE_SIZE = 'FILE_SIZE',\n    FILE_STATISTICS = 'FILE_STATISTICS',\n    INSTANTIATE_PROGRESS = 'INSTANTIATE_PROGRESS',\n    LOG = 'LOG',\n    PROGRESS_UPDATE = 'PROGRESS_UPDATE',\n    OK = 'OK',\n    PREPARED_STATEMENT_ID = 'PREPARED_STATEMENT_ID',\n    QUERY_PLAN = 'QUERY_PLAN',\n    QUERY_RESULT = 'QUERY_RESULT',\n    QUERY_RESULT_CHUNK = 'QUERY_RESULT_CHUNK',\n    QUERY_RESULT_HEADER = 'QUERY_RESULT_HEADER',\n    QUERY_RESULT_HEADER_OR_NULL = 'QUERY_RESULT_HEADER_OR_NULL',\n    REGISTERED_FILE = 'REGISTERED_FILE',\n    SCRIPT_TOKENS = 'SCRIPT_TOKENS',\n    SUCCESS = 'SUCCESS',\n    TABLE_NAMES = 'TABLE_NAMES',\n    VERSION_STRING = 'VERSION_STRING',\n}\n\nexport type WorkerRequest<T, P> = {\n    readonly messageId: number;\n    readonly type: T;\n    readonly data: P;\n};\n\nexport type WorkerResponse<T, P> = {\n    readonly messageId: number;\n    readonly requestId: number;\n    readonly type: T;\n    readonly data: P;\n};\n\nexport type WorkerTaskReturnType<T extends WorkerTaskVariant> = T extends WorkerTask<any, any, infer P> ? P : never;\n\nexport class WorkerTask<T, D, P> {\n    readonly type: T;\n    readonly data: D;\n    promise: Promise<P>;\n    promiseResolver: (value: P | PromiseLike<P>) => void = () => {};\n    promiseRejecter: (value: any) => void = () => {};\n\n    constructor(type: T, data: D) {\n        this.type = type;\n        this.data = data;\n        this.promise = new Promise<P>(\n            (resolve: (value: P | PromiseLike<P>) => void, reject: (reason?: void) => void) => {\n                this.promiseResolver = resolve;\n                this.promiseRejecter = reject;\n            },\n        );\n    }\n}\n\nexport type WorkerRequestVariant =\n    | WorkerRequest<WorkerRequestType.CLOSE_PREPARED, [ConnectionID, StatementID]>\n    | WorkerRequest<WorkerRequestType.CANCEL_PENDING_QUERY, number>\n    | WorkerRequest<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean]>\n    | WorkerRequest<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string]>\n    | WorkerRequest<WorkerRequestType.CONNECT, null>\n    | WorkerRequest<WorkerRequestType.COPY_FILE_TO_BUFFER, string>\n    | WorkerRequest<WorkerRequestType.COPY_FILE_TO_PATH, [string, string]>\n    | WorkerRequest<WorkerRequestType.CREATE_PREPARED, [ConnectionID, string]>\n    | WorkerRequest<WorkerRequestType.DISCONNECT, number>\n    | WorkerRequest<WorkerRequestType.DROP_FILE, string>\n    | WorkerRequest<WorkerRequestType.DROP_FILES, string[] | undefined>\n    | WorkerRequest<WorkerRequestType.EXPORT_FILE_STATISTICS, string>\n    | WorkerRequest<WorkerRequestType.FETCH_QUERY_RESULTS, number>\n    | WorkerRequest<WorkerRequestType.FLUSH_FILES, null>\n    | WorkerRequest<WorkerRequestType.GET_FEATURE_FLAGS, null>\n    | WorkerRequest<WorkerRequestType.GET_TABLE_NAMES, [number, string]>\n    | WorkerRequest<WorkerRequestType.GET_VERSION, null>\n    | WorkerRequest<WorkerRequestType.GLOB_FILE_INFOS, string>\n    | WorkerRequest<\n          WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n          [number, Uint8Array, ArrowInsertOptions | undefined]\n      >\n    | WorkerRequest<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions]>\n    | WorkerRequest<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions]>\n    | WorkerRequest<WorkerRequestType.INSTANTIATE, [string, string | null]>\n    | WorkerRequest<WorkerRequestType.OPEN, DuckDBConfig>\n    | WorkerRequest<WorkerRequestType.PING, null>\n    | WorkerRequest<WorkerRequestType.POLL_PENDING_QUERY, number>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array]>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_HANDLE, [string, any, DuckDBDataProtocol, boolean]>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_URL, [string, string, DuckDBDataProtocol, boolean]>\n    | WorkerRequest<WorkerRequestType.RESET, null>\n    | WorkerRequest<WorkerRequestType.RUN_PREPARED, [number, number, any[]]>\n    | WorkerRequest<WorkerRequestType.RUN_QUERY, [number, string]>\n    | WorkerRequest<WorkerRequestType.SEND_PREPARED, [number, number, any[]]>\n    | WorkerRequest<WorkerRequestType.START_PENDING_QUERY, [number, string, boolean]>\n    | WorkerRequest<WorkerRequestType.TOKENIZE, string>;\n\nexport type WorkerResponseVariant =\n    | WorkerResponse<WorkerResponseType.CONNECTION_INFO, number>\n    | WorkerResponse<WorkerResponseType.ERROR, any>\n    | WorkerResponse<WorkerResponseType.FEATURE_FLAGS, number>\n    | WorkerResponse<WorkerResponseType.FILE_BUFFER, Uint8Array>\n    | WorkerResponse<WorkerResponseType.FILE_INFOS, WebFile[]>\n    | WorkerResponse<WorkerResponseType.FILE_SIZE, number>\n    | WorkerResponse<WorkerResponseType.FILE_STATISTICS, FileStatistics>\n    | WorkerResponse<WorkerResponseType.INSTANTIATE_PROGRESS, InstantiationProgress>\n    | WorkerResponse<WorkerResponseType.LOG, LogEntryVariant>\n    | WorkerResponse<WorkerResponseType.PROGRESS_UPDATE, ProgressEntry>\n    | WorkerResponse<WorkerResponseType.OK, null>\n    | WorkerResponse<WorkerResponseType.PREPARED_STATEMENT_ID, number>\n    | WorkerResponse<WorkerResponseType.QUERY_PLAN, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_CHUNK, Uint8Array | null>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_HEADER, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL, Uint8Array | null>\n    | WorkerResponse<WorkerResponseType.SCRIPT_TOKENS, ScriptTokens>\n    | WorkerResponse<WorkerResponseType.SUCCESS, boolean>\n    | WorkerResponse<WorkerResponseType.TABLE_NAMES, string[]>\n    | WorkerResponse<WorkerResponseType.VERSION_STRING, string>;\n\nexport type WorkerTaskVariant =\n    | WorkerTask<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean], null>\n    | WorkerTask<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string], null>\n    | WorkerTask<WorkerRequestType.CLOSE_PREPARED, [number, number], null>\n    | WorkerTask<WorkerRequestType.CONNECT, null, ConnectionID>\n    | WorkerTask<WorkerRequestType.COPY_FILE_TO_BUFFER, string, Uint8Array>\n    | WorkerTask<WorkerRequestType.COPY_FILE_TO_PATH, [string, string], null>\n    | WorkerTask<WorkerRequestType.CREATE_PREPARED, [number, string], number>\n    | WorkerTask<WorkerRequestType.DISCONNECT, ConnectionID, null>\n    | WorkerTask<WorkerRequestType.DROP_FILE, string, null>\n    | WorkerTask<WorkerRequestType.DROP_FILES, string[] | undefined, null>\n    | WorkerTask<WorkerRequestType.EXPORT_FILE_STATISTICS, string, FileStatistics>\n    | WorkerTask<WorkerRequestType.FETCH_QUERY_RESULTS, ConnectionID, Uint8Array | null>\n    | WorkerTask<WorkerRequestType.FLUSH_FILES, null, null>\n    | WorkerTask<WorkerRequestType.GET_FEATURE_FLAGS, null, number>\n    | WorkerTask<WorkerRequestType.GET_TABLE_NAMES, [number, string], string[]>\n    | WorkerTask<WorkerRequestType.GET_VERSION, null, string>\n    | WorkerTask<\n          WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n          [number, Uint8Array, ArrowInsertOptions | undefined],\n          null\n      >\n    | WorkerTask<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions], null>\n    | WorkerTask<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions], null>\n    | WorkerTask<WorkerRequestType.INSTANTIATE, [string, string | null], null>\n    | WorkerTask<WorkerRequestType.OPEN, DuckDBConfig, null>\n    | WorkerTask<WorkerRequestType.PING, null, null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_HANDLE, [string, any, DuckDBDataProtocol, boolean], null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_URL, [string, string, DuckDBDataProtocol, boolean], null>\n    | WorkerTask<WorkerRequestType.GLOB_FILE_INFOS, string, WebFile[]>\n    | WorkerTask<WorkerRequestType.RESET, null, null>\n    | WorkerTask<WorkerRequestType.RUN_PREPARED, [number, number, any[]], Uint8Array>\n    | WorkerTask<WorkerRequestType.RUN_QUERY, [ConnectionID, string], Uint8Array>\n    | WorkerTask<WorkerRequestType.SEND_PREPARED, [number, number, any[]], Uint8Array>\n    | WorkerTask<WorkerRequestType.START_PENDING_QUERY, [ConnectionID, string, boolean], Uint8Array | null>\n    | WorkerTask<WorkerRequestType.POLL_PENDING_QUERY, ConnectionID, Uint8Array | null>\n    | WorkerTask<WorkerRequestType.CANCEL_PENDING_QUERY, ConnectionID, boolean>\n    | WorkerTask<WorkerRequestType.TOKENIZE, string, ScriptTokens>;\n", "export const REGEX_OPFS_FILE = /'(opfs:\\/\\/\\S*?)'/g;\nexport const REGEX_OPFS_PROTOCOL = /(opfs:\\/\\/\\S*?)/g;\n\nexport function isOPFSProtocol(path: string): boolean {\n    return path.search(REGEX_OPFS_PROTOCOL) > -1;\n}\n\nexport function searchOPFSFiles(text: string) {\n    return [...text.matchAll(REGEX_OPFS_FILE)].map(match => match[1]);\n}", "import {\n    WorkerRequestType,\n    WorkerResponseType,\n    WorkerResponseVariant,\n    WorkerTaskVariant,\n    WorkerTask,\n    ConnectionID,\n    WorkerTaskReturnType,\n} from './worker_request';\nimport { AsyncDuckDBBindings } from './async_bindings_interface';\nimport { Logger } from '../log';\nimport { AsyncDuckDBConnection } from './async_connection';\nimport { CSVInsertOptions, JSONInsertOptions, ArrowInsertOptions } from '../bindings/insert_options';\nimport { ScriptTokens } from '../bindings/tokens';\nimport { FileStatistics } from '../bindings/file_stats';\nimport { DuckDBConfig } from '../bindings/config';\nimport { InstantiationProgress } from '../bindings/progress';\nimport { WebFile } from '../bindings/web_file';\nimport { DuckDBDataProtocol } from '../bindings';\nimport { searchOPFSFiles, isOPFSProtocol } from '../utils/opfs_util';\nimport { ProgressEntry } from '../log';\n\nconst TEXT_ENCODER = new TextEncoder();\n\nexport class AsyncDuckDB implements AsyncDuckDBBindings {\n    /** The message handler */\n    protected readonly _onMessageHandler: (event: MessageEvent) => void;\n    /** The error handler */\n    protected readonly _onErrorHandler: (event: ErrorEvent) => void;\n    /** The close handler */\n    protected readonly _onCloseHandler: () => void;\n\n    /** Instantiate the module */\n    protected _onInstantiationProgress: ((p: InstantiationProgress) => void)[] = [];\n\n    /** Progress callbacks */\n    protected _onExecutionProgress: ((p: ProgressEntry) => void)[] = [];\n\n    /** The logger */\n    protected readonly _logger: Logger;\n    /** The worker */\n    protected _worker: Worker | null = null;\n    /** The promise for the worker shutdown */\n    protected _workerShutdownPromise: Promise<null> | null = null;\n    /** Make the worker as terminated */\n    protected _workerShutdownResolver: (value: PromiseLike<null> | null) => void = () => {};\n\n    /** The next message id */\n    protected _nextMessageId = 0;\n    /** The pending requests */\n    protected _pendingRequests: Map<number, WorkerTaskVariant> = new Map();\n    /** The DuckDBConfig */\n    protected _config: DuckDBConfig = {};\n\n    constructor(logger: Logger, worker: Worker | null = null) {\n        this._logger = logger;\n        this._onMessageHandler = this.onMessage.bind(this);\n        this._onErrorHandler = this.onError.bind(this);\n        this._onCloseHandler = this.onClose.bind(this);\n        if (worker != null) this.attach(worker);\n    }\n\n    /** Get the logger */\n    public get logger(): Logger {\n        return this._logger;\n    }\n\n    /** Get the logger */\n    public get config(): DuckDBConfig {\n        return this._config;\n    }\n\n    /** Attach to worker */\n    protected attach(worker: Worker): void {\n        this._worker = worker;\n        this._worker.addEventListener('message', this._onMessageHandler);\n        this._worker.addEventListener('error', this._onErrorHandler);\n        this._worker.addEventListener('close', this._onCloseHandler);\n        this._workerShutdownPromise = new Promise<null>(\n            (resolve: (value: PromiseLike<null> | null) => void, _reject: (reason?: void) => void) => {\n                this._workerShutdownResolver = resolve;\n            },\n        );\n    }\n\n    /** Detach from worker */\n    public detach(): void {\n        if (!this._worker) return;\n        this._worker.removeEventListener('message', this._onMessageHandler);\n        this._worker.removeEventListener('error', this._onErrorHandler);\n        this._worker.removeEventListener('close', this._onCloseHandler);\n        this._worker = null;\n        this._workerShutdownResolver(null);\n        this._workerShutdownPromise = null;\n        this._workerShutdownResolver = () => {};\n    }\n\n    /** Kill the worker */\n    public async terminate(): Promise<void> {\n        if (!this._worker) return;\n        this._worker.terminate();\n        //await this._workerShutdownPromise; TODO deadlocking in karma?\n        this._worker = null;\n        this._workerShutdownPromise = null;\n        this._workerShutdownResolver = () => {};\n    }\n\n    /** Post a task */\n    protected async postTask<W extends WorkerTaskVariant>(\n        task: W,\n        transfer: ArrayBuffer[] = [],\n    ): Promise<WorkerTaskReturnType<W>> {\n        if (!this._worker) {\n            console.error('cannot send a message since the worker is not set!:' + task.type + ',' + task.data);\n            return undefined as any;\n        }\n        const mid = this._nextMessageId++;\n        this._pendingRequests.set(mid, task);\n        this._worker.postMessage(\n            {\n                messageId: mid,\n                type: task.type,\n                data: task.data,\n            },\n            transfer,\n        );\n        return (await task.promise) as WorkerTaskReturnType<W>;\n    }\n\n    /** Received a message */\n    protected onMessage(event: MessageEvent): void {\n        // Unassociated responses?\n        const response = event.data as WorkerResponseVariant;\n        switch (response.type) {\n            // Request failed?\n            case WorkerResponseType.PROGRESS_UPDATE: {\n                for (const p of this._onExecutionProgress) {\n                    p(response.data);\n                }\n                return;\n            }\n            case WorkerResponseType.LOG: {\n                this._logger.log(response.data);\n                return;\n            }\n            // Call progress callback\n            case WorkerResponseType.INSTANTIATE_PROGRESS: {\n                for (const p of this._onInstantiationProgress) {\n                    p(response.data);\n                }\n                return;\n            }\n        }\n\n        // Get associated task\n        const task = this._pendingRequests.get(response.requestId);\n        if (!task) {\n            console.warn(`unassociated response: [${response.requestId}, ${response.type.toString()}]`);\n            return;\n        }\n        this._pendingRequests.delete(response.requestId);\n\n        // Request failed?\n        if (response.type == WorkerResponseType.ERROR) {\n            // Workaround for Firefox not being able to perform structured-clone on Native Errors\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1556604\n            const e = new Error(response.data.message);\n            e.name = response.data.name;\n            if (Object.getOwnPropertyDescriptor(e, 'stack')?.writable) {\n                e.stack = response.data.stack;\n            }\n            task.promiseRejecter(e);\n            return;\n        }\n\n        // Otherwise differentiate between the tasks first\n        switch (task.type) {\n            case WorkerRequestType.CLOSE_PREPARED:\n            case WorkerRequestType.COLLECT_FILE_STATISTICS:\n            case WorkerRequestType.REGISTER_OPFS_FILE_NAME:\n            case WorkerRequestType.COPY_FILE_TO_PATH:\n            case WorkerRequestType.DISCONNECT:\n            case WorkerRequestType.DROP_FILE:\n            case WorkerRequestType.DROP_FILES:\n            case WorkerRequestType.FLUSH_FILES:\n            case WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM:\n            case WorkerRequestType.INSERT_CSV_FROM_PATH:\n            case WorkerRequestType.INSERT_JSON_FROM_PATH:\n            case WorkerRequestType.OPEN:\n            case WorkerRequestType.PING:\n            case WorkerRequestType.REGISTER_FILE_BUFFER:\n            case WorkerRequestType.REGISTER_FILE_HANDLE:\n            case WorkerRequestType.REGISTER_FILE_URL:\n            case WorkerRequestType.RESET:\n                if (response.type == WorkerResponseType.OK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.INSTANTIATE:\n                this._onInstantiationProgress = [];\n                if (response.type == WorkerResponseType.OK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GLOB_FILE_INFOS:\n                if (response.type == WorkerResponseType.FILE_INFOS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_VERSION:\n                if (response.type == WorkerResponseType.VERSION_STRING) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_FEATURE_FLAGS:\n                if (response.type == WorkerResponseType.FEATURE_FLAGS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_TABLE_NAMES:\n                if (response.type == WorkerResponseType.TABLE_NAMES) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.TOKENIZE:\n                if (response.type == WorkerResponseType.SCRIPT_TOKENS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.COPY_FILE_TO_BUFFER:\n                if (response.type == WorkerResponseType.FILE_BUFFER) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.EXPORT_FILE_STATISTICS:\n                if (response.type == WorkerResponseType.FILE_STATISTICS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CONNECT:\n                if (response.type == WorkerResponseType.CONNECTION_INFO) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.RUN_PREPARED:\n            case WorkerRequestType.RUN_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.SEND_PREPARED:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.START_PENDING_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.POLL_PENDING_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CANCEL_PENDING_QUERY:\n                this._onInstantiationProgress = [];\n                if (response.type == WorkerResponseType.SUCCESS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.FETCH_QUERY_RESULTS:\n                if (response.type == WorkerResponseType.QUERY_RESULT_CHUNK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CREATE_PREPARED:\n                if (response.type == WorkerResponseType.PREPARED_STATEMENT_ID) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n        }\n        task.promiseRejecter(new Error(`unexpected response type: ${response.type.toString()}`));\n    }\n\n    /** Received an error */\n    protected onError(event: ErrorEvent): void {\n        console.error(event);\n        console.error(`error in duckdb worker: ${event.message}`);\n        this._pendingRequests.clear();\n    }\n\n    /** The worker was closed */\n    protected onClose(): void {\n        this._workerShutdownResolver(null);\n        if (this._pendingRequests.size != 0) {\n            console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);\n            return;\n        }\n        this._pendingRequests.clear();\n    }\n\n    /** Is in detached state, no worker defined */\n    public isDetached(): boolean {\n        return !this._worker;\n    }\n\n    /** Reset the duckdb */\n    public async reset(): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.RESET, null, null>(WorkerRequestType.RESET, null);\n        return await this.postTask(task);\n    }\n\n    /** Ping the worker thread */\n    public async ping(): Promise<any> {\n        const task = new WorkerTask<WorkerRequestType.PING, null, null>(WorkerRequestType.PING, null);\n        await this.postTask(task);\n    }\n    /** Try to drop a file */\n    public async dropFile(name: string): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.DROP_FILE, string, null>(WorkerRequestType.DROP_FILE, name);\n        return await this.postTask(task);\n    }\n    /** Try to drop files */\n    public async dropFiles(names?: string[]): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.DROP_FILES, string[] | undefined, null>(\n            WorkerRequestType.DROP_FILES,\n            names,\n        );\n        return await this.postTask(task);\n    }\n    /** Flush all files */\n    public async flushFiles(): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.FLUSH_FILES, null, null>(WorkerRequestType.FLUSH_FILES, null);\n        return await this.postTask(task);\n    }\n\n    /** Open the database */\n    public async instantiate(\n        mainModuleURL: string,\n        pthreadWorkerURL: string | null = null,\n        progress: (progress: InstantiationProgress) => void = _p => {},\n    ): Promise<null> {\n        this._onInstantiationProgress.push(progress);\n        const task = new WorkerTask<WorkerRequestType.INSTANTIATE, [string, string | null], null>(\n            WorkerRequestType.INSTANTIATE,\n            [mainModuleURL, pthreadWorkerURL],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Get the version */\n    public async getVersion(): Promise<string> {\n        const task = new WorkerTask<WorkerRequestType.GET_VERSION, null, string>(WorkerRequestType.GET_VERSION, null);\n        const version = await this.postTask(task);\n        return version;\n    }\n\n    /** Get the feature flags */\n    public async getFeatureFlags(): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.GET_FEATURE_FLAGS, null, number>(\n            WorkerRequestType.GET_FEATURE_FLAGS,\n            null,\n        );\n        const feature = await this.postTask(task);\n        return feature;\n    }\n\n    /** Open a new database */\n    public async open(config: DuckDBConfig): Promise<void> {\n        this._config = config;\n        const task = new WorkerTask<WorkerRequestType.OPEN, DuckDBConfig, null>(WorkerRequestType.OPEN, config);\n        await this.postTask(task);\n    }\n\n    /** Tokenize a script text */\n    public async tokenize(text: string): Promise<ScriptTokens> {\n        const task = new WorkerTask<WorkerRequestType.TOKENIZE, string, ScriptTokens>(WorkerRequestType.TOKENIZE, text);\n        const tokens = await this.postTask(task);\n        return tokens;\n    }\n\n    /** Connect to the database */\n    public async connectInternal(): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.CONNECT, null, ConnectionID>(WorkerRequestType.CONNECT, null);\n        return await this.postTask(task);\n    }\n\n    /** Connect to the database */\n    public async connect(): Promise<AsyncDuckDBConnection> {\n        const cid = await this.connectInternal();\n        return new AsyncDuckDBConnection(this, cid);\n    }\n\n    /** Disconnect from the database */\n    public async disconnect(conn: ConnectionID): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.DISCONNECT, ConnectionID, null>(\n            WorkerRequestType.DISCONNECT,\n            conn,\n        );\n        await this.postTask(task);\n    }\n\n    /** Run a query */\n    public async runQuery(conn: ConnectionID, text: string): Promise<Uint8Array> {\n        if (this.shouldOPFSFileHandling()) {\n            const files = await this.registerOPFSFileFromSQL(text);\n            try {\n                return await this._runQueryAsync(conn, text);\n            } finally {\n                if (files.length > 0) {\n                    await this.dropFiles(files);\n                }\n            }\n        } else {\n            return await this._runQueryAsync(conn, text);\n        }\n    }\n\n    private async _runQueryAsync(conn: ConnectionID, text: string): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.RUN_QUERY, [ConnectionID, string], Uint8Array>(\n            WorkerRequestType.RUN_QUERY,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Start a pending query */\n    public async startPendingQuery(\n        conn: ConnectionID,\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<Uint8Array | null> {\n        if (this.shouldOPFSFileHandling()) {\n            const files = await this.registerOPFSFileFromSQL(text);\n            try {\n                return await this._startPendingQueryAsync(conn, text, allowStreamResult);\n            } finally {\n                if (files.length > 0) {\n                    await this.dropFiles(files);\n                }\n            }\n        } else {\n            return await this._startPendingQueryAsync(conn, text, allowStreamResult);\n        }\n    }\n\n    private async _startPendingQueryAsync(\n        conn: ConnectionID,\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<Uint8Array | null> {\n        const task = new WorkerTask<\n            WorkerRequestType.START_PENDING_QUERY,\n            [ConnectionID, string, boolean],\n            Uint8Array | null\n        >(WorkerRequestType.START_PENDING_QUERY, [conn, text, allowStreamResult]);\n        return await this.postTask(task);\n    }\n\n    /** Poll a pending query */\n    public async pollPendingQuery(conn: ConnectionID): Promise<Uint8Array | null> {\n        const task = new WorkerTask<WorkerRequestType.POLL_PENDING_QUERY, ConnectionID, Uint8Array | null>(\n            WorkerRequestType.POLL_PENDING_QUERY,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n    /** Cancel a pending query */\n    public async cancelPendingQuery(conn: ConnectionID): Promise<boolean> {\n        const task = new WorkerTask<WorkerRequestType.CANCEL_PENDING_QUERY, ConnectionID, boolean>(\n            WorkerRequestType.CANCEL_PENDING_QUERY,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Fetch query results */\n    public async fetchQueryResults(conn: ConnectionID): Promise<Uint8Array | null> {\n        const task = new WorkerTask<WorkerRequestType.FETCH_QUERY_RESULTS, ConnectionID, Uint8Array | null>(\n            WorkerRequestType.FETCH_QUERY_RESULTS,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Get table names */\n    public async getTableNames(conn: number, text: string): Promise<string[]> {\n        const task = new WorkerTask<WorkerRequestType.GET_TABLE_NAMES, [number, string], string[]>(\n            WorkerRequestType.GET_TABLE_NAMES,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Prepare a statement and return its identifier */\n    public async createPrepared(conn: number, text: string): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.CREATE_PREPARED, [number, string], number>(\n            WorkerRequestType.CREATE_PREPARED,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n    /** Close a prepared statement */\n    public async closePrepared(conn: number, statement: number): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.CLOSE_PREPARED, [number, number], null>(\n            WorkerRequestType.CLOSE_PREPARED,\n            [conn, statement],\n        );\n        await this.postTask(task);\n    }\n    /** Execute a prepared statement and return the full result */\n    public async runPrepared(conn: number, statement: number, params: any[]): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.RUN_PREPARED, [ConnectionID, number, any[]], Uint8Array>(\n            WorkerRequestType.RUN_PREPARED,\n            [conn, statement, params],\n        );\n        return await this.postTask(task);\n    }\n    /** Execute a prepared statement and stream the result */\n    public async sendPrepared(conn: number, statement: number, params: any[]): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.SEND_PREPARED, [ConnectionID, number, any[]], Uint8Array>(\n            WorkerRequestType.SEND_PREPARED,\n            [conn, statement, params],\n        );\n        return await this.postTask(task);\n    }\n    /** Glob file infos */\n    public async globFiles(path: string): Promise<WebFile[]> {\n        const task = new WorkerTask<WorkerRequestType.GLOB_FILE_INFOS, string, WebFile[]>(\n            WorkerRequestType.GLOB_FILE_INFOS,\n            path,\n        );\n        return await this.postTask(task);\n    }\n    /** Register file text */\n    public async registerFileText(name: string, text: string): Promise<void> {\n        const buffer = TEXT_ENCODER.encode(text);\n        await this.registerFileBuffer(name, buffer);\n    }\n    /** Register a file path. */\n    public async registerFileURL(\n        name: string,\n        url: string,\n        proto: DuckDBDataProtocol,\n        directIO: boolean,\n    ): Promise<void> {\n        if (url === undefined) {\n            url = name;\n        }\n        const task = new WorkerTask<\n            WorkerRequestType.REGISTER_FILE_URL,\n            [string, string, DuckDBDataProtocol, boolean],\n            null\n        >(WorkerRequestType.REGISTER_FILE_URL, [name, url, proto, directIO]);\n        await this.postTask(task);\n    }\n\n    /** Register an empty file buffer. */\n    public async registerEmptyFileBuffer(name: string): Promise<void> {\n        /*\n        const task = new WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>(\n            WorkerRequestType.REGISTER_FILE_BUFFER,\n            [name, new Uint8Array()],\n        );\n        await this.postTask(task);\n*/\n    }\n\n    /** Register a file buffer. */\n    public async registerFileBuffer(name: string, buffer: Uint8Array): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>(\n            WorkerRequestType.REGISTER_FILE_BUFFER,\n            [name, buffer],\n        );\n        await this.postTask(task, [buffer.buffer]);\n    }\n\n    /** Register a file handle. */\n    public async registerFileHandle<HandleType>(\n        name: string,\n        handle: HandleType,\n        protocol: DuckDBDataProtocol,\n        directIO: boolean,\n    ): Promise<void> {\n        const task = new WorkerTask<\n            WorkerRequestType.REGISTER_FILE_HANDLE,\n            [string, any, DuckDBDataProtocol, boolean],\n            null\n        >(WorkerRequestType.REGISTER_FILE_HANDLE, [name, handle, protocol, directIO]);\n        await this.postTask(task, []);\n    }\n\n    /** Enable file statistics */\n    public async registerOPFSFileName(name: string): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string], null>(\n            WorkerRequestType.REGISTER_OPFS_FILE_NAME,\n            [name],\n        );\n        await this.postTask(task, []);\n    }\n\n    /** Enable file statistics */\n    public async collectFileStatistics(name: string, enable: boolean): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean], null>(\n            WorkerRequestType.COLLECT_FILE_STATISTICS,\n            [name, enable],\n        );\n        await this.postTask(task, []);\n    }\n\n    /** Export file statistics */\n    public async exportFileStatistics(name: string): Promise<FileStatistics> {\n        const task = new WorkerTask<WorkerRequestType.EXPORT_FILE_STATISTICS, string, FileStatistics>(\n            WorkerRequestType.EXPORT_FILE_STATISTICS,\n            name,\n        );\n        return await this.postTask(task, []);\n    }\n\n    /** Copy a file to a buffer. */\n    public async copyFileToBuffer(name: string): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.COPY_FILE_TO_BUFFER, string, Uint8Array>(\n            WorkerRequestType.COPY_FILE_TO_BUFFER,\n            name,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Copy a file to a path. */\n    public async copyFileToPath(name: string, path: string): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.COPY_FILE_TO_PATH, [string, string], null>(\n            WorkerRequestType.COPY_FILE_TO_PATH,\n            [name, path],\n        );\n        await this.postTask(task);\n    }\n\n    /** Insert arrow from an ipc stream */\n    public async insertArrowFromIPCStream(\n        conn: ConnectionID,\n        buffer: Uint8Array,\n        options?: ArrowInsertOptions,\n    ): Promise<void> {\n        if (buffer.length == 0) return;\n        // Pass to the worker\n        const task = new WorkerTask<\n            WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n            [number, Uint8Array, ArrowInsertOptions | undefined],\n            null\n        >(WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM, [conn, buffer, options]);\n        await this.postTask(task, [buffer.buffer]);\n    }\n    /** Insert a csv file */\n    public async insertCSVFromPath(conn: ConnectionID, path: string, options: CSVInsertOptions): Promise<void> {\n        // Pass to the worker\n        const task = new WorkerTask<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions], null>(\n            WorkerRequestType.INSERT_CSV_FROM_PATH,\n            [conn, path, options],\n        );\n        await this.postTask(task);\n    }\n    /** Insert a json file */\n    public async insertJSONFromPath(conn: ConnectionID, path: string, options: JSONInsertOptions): Promise<void> {\n        // Pass to the worker\n        const task = new WorkerTask<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions], null>(\n            WorkerRequestType.INSERT_JSON_FROM_PATH,\n            [conn, path, options],\n        );\n        await this.postTask(task);\n    }\n\n    private shouldOPFSFileHandling(): boolean {\n        if (isOPFSProtocol(this.config.path ?? '')) {\n            return this.config.opfs?.fileHandling == 'auto';\n        }\n        return false;\n    }\n\n    private async registerOPFSFileFromSQL(text: string) {\n        const files = searchOPFSFiles(text);\n        const result: string[] = [];\n        for (const file of files) {\n            try {\n                await this.registerOPFSFileName(file);\n                result.push(file);\n            } catch (e) {\n                console.error(e);\n                throw new Error('File Not found:' + file);\n            }\n        }\n        return result;\n    }\n}\n", "import { DuckDBModule } from './duckdb_module';\nimport { UDFFunction } from './udf_function';\nimport * as udf_rt from './udf_runtime';\n\n/** Wrapper for TextDecoder to support shared array buffers */\nfunction TextDecoderWrapper(): (input?: BufferSource) => string {\n    const decoder = new TextDecoder();\n    return (data: any) => {\n        if (typeof SharedArrayBuffer !== 'undefined' && data.buffer instanceof SharedArrayBuffer) {\n            data = new Uint8Array(data);\n        }\n        return decoder.decode(data);\n    };\n}\n/** Helper to decode text */\nexport const decodeText = TextDecoderWrapper();\n\n/** Copy a buffer */\nexport function failWith(mod: DuckDBModule, msg: string): void {\n    console.error(`FAIL WITH: ${msg}`);\n    mod.ccall('duckdb_web_fail_with', null, ['string'], [msg]);\n}\n\n/** Copy a buffer */\nexport function copyBuffer(mod: DuckDBModule, begin: number, length: number): Uint8Array {\n    const buffer = mod.HEAPU8.subarray(begin, begin + length);\n    const copy = new Uint8Array(new ArrayBuffer(buffer.byteLength));\n    copy.set(buffer);\n    return copy;\n}\n\n/** Decode a string */\nexport function readString(mod: DuckDBModule, begin: number, length: number): string {\n    return decodeText(mod.HEAPU8.subarray(begin, begin + length));\n}\n\n/** The data protocol */\nexport enum DuckDBDataProtocol {\n    BUFFER = 0,\n    NODE_FS = 1,\n    BROWSER_FILEREADER = 2,\n    BROWSER_FSACCESS = 3,\n    HTTP = 4,\n    S3 = 5,\n}\n\n/** File flags for opening files*/\nexport enum FileFlags {\n    //! Open file with read access\n    FILE_FLAGS_READ = 1 << 0,\n    //! Open file with write access\n    FILE_FLAGS_WRITE = 1 << 1,\n    //! Use direct IO when reading/writing to the file\n    FILE_FLAGS_DIRECT_IO = 1 << 2,\n    //! Create file if not exists, can only be used together with WRITE\n    FILE_FLAGS_FILE_CREATE = 1 << 3,\n    //! Always create a new file. If a file exists, the file is truncated. Cannot be used together with CREATE.\n    FILE_FLAGS_FILE_CREATE_NEW = 1 << 4,\n    //! Open file in append mode\n    FILE_FLAGS_APPEND = 1 << 5,\n    FILE_FLAGS_PRIVATE = 1 << 6,\n    FILE_FLAGS_NULL_IF_NOT_EXISTS = 1 << 7,\n    FILE_FLAGS_PARALLEL_ACCESS = 1 << 8,\n    FILE_FLAGS_EXCLUSIVE_CREATE = 1 << 9,\n    FILE_FLAGS_NULL_IF_EXISTS = 1 << 10,\n}\n\n/** Configuration for the AWS S3 Filesystem */\nexport interface S3Config {\n    region?: string;\n    endpoint?: string;\n    accessKeyId?: string;\n    secretAccessKey?: string;\n    sessionToken?: string;\n}\n\n/** An info for a file registered with DuckDB */\nexport interface DuckDBFileInfo {\n    cacheEpoch: number;\n    fileId: number;\n    fileName: string;\n    dataProtocol: DuckDBDataProtocol;\n    dataUrl: string | null;\n    reliableHeadRequests?: boolean;\n    allowFullHttpReads?: boolean;\n    forceFullHttpReads?: boolean;\n    bearerToken?: string;\n    s3Config?: S3Config;\n}\n\n/** Global info for all files registered with DuckDB */\nexport interface DuckDBGlobalFileInfo {\n    cacheEpoch: number;\n    reliableHeadRequests?: boolean;\n    allowFullHttpReads?: boolean;\n    forceFullHttpReads?: boolean;\n    bearerToken?: string;\n    s3Config?: S3Config;\n}\n\nexport interface PreparedDBFileHandle {\n    path: string;\n    handle: any;\n    fromCached: boolean;\n}\n\n/** Call a function with packed response buffer */\nexport function callSRet(\n    mod: DuckDBModule,\n    funcName: string,\n    argTypes: Array<Emscripten.JSType>,\n    args: Array<any>,\n): [number, number, number] {\n    const stackPointer = mod.stackSave();\n\n    // Allocate the packed response buffer\n    const response = mod.stackAlloc(3 * 8);\n    argTypes.unshift('number');\n    args.unshift(response);\n\n    // Do the call\n    mod.ccall(funcName, null, argTypes, args);\n\n    // Read the response\n    const status = mod.HEAPF64[(response >> 3) + 0];\n    const data = mod.HEAPF64[(response >> 3) + 1];\n    const dataSize = mod.HEAPF64[(response >> 3) + 2];\n\n    // Restore the stack\n    mod.stackRestore(stackPointer);\n    return [status, data, dataSize];\n}\n\n/** Drop response buffers */\nexport function dropResponseBuffers(mod: DuckDBModule): void {\n    mod.ccall('duckdb_web_clear_response', null, [], []);\n}\n\n/** The duckdb runtime */\nexport interface DuckDBRuntime {\n    _files?: Map<string, any>;\n    _udfFunctions: Map<number, UDFFunction>;\n\n    // Test a platform feature\n    testPlatformFeature(mod: DuckDBModule, feature: number): boolean;\n\n    // File APIs with dedicated file identifier\n    getDefaultDataProtocol(mod: DuckDBModule): number;\n    openFile(mod: DuckDBModule, fileId: number, flags: FileFlags): void;\n    syncFile(mod: DuckDBModule, fileId: number): void;\n    closeFile(mod: DuckDBModule, fileId: number): void;\n    dropFile(mod: DuckDBModule, fileNamePtr: number, fileNameLen: number): void;\n    getLastFileModificationTime(mod: DuckDBModule, fileId: number): number;\n    truncateFile(mod: DuckDBModule, fileId: number, newSize: number): void;\n    readFile(mod: DuckDBModule, fileId: number, buffer: number, bytes: number, location: number): number;\n    writeFile(mod: DuckDBModule, fileId: number, buffer: number, bytes: number, location: number): number;\n\n    // File APIs with path parameter\n    removeDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    checkDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    createDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    listDirectoryEntries(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    glob(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    moveFile(mod: DuckDBModule, fromPtr: number, fromLen: number, toPtr: number, toLen: number): void;\n    checkFile(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    removeFile(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n\n    // Prepare a file handle that could only be acquired aschronously\n    prepareFileHandle?: (path: string, protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n    prepareFileHandles?: (path: string[], protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n    prepareDBFileHandle?: (path: string, protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n\n    // Internal API - experimental\n    progressUpdate(final: number, percentage: number, iteration: number): void;\n\n    // Call a scalar UDF function\n    callScalarUDF(\n        mod: DuckDBModule,\n        response: number,\n        funcId: number,\n        descPtr: number,\n        descSize: number,\n        ptrsPtr: number,\n        ptrsSize: number,\n    ): void;\n}\n\nexport const DEFAULT_RUNTIME: DuckDBRuntime = {\n    _udfFunctions: new Map(),\n\n    testPlatformFeature: (_mod: DuckDBModule, _feature: number): boolean => false,\n    getDefaultDataProtocol: (_mod: DuckDBModule): number => DuckDBDataProtocol.BUFFER,\n    openFile: (_mod: DuckDBModule, _fileId: number, flags: FileFlags): void => {},\n    syncFile: (_mod: DuckDBModule, _fileId: number): void => {},\n    closeFile: (_mod: DuckDBModule, _fileId: number): void => {},\n    dropFile: (_mod: DuckDBModule, _fileNamePtr: number, _fileNameLen: number): void => {},\n    getLastFileModificationTime: (_mod: DuckDBModule, _fileId: number): number => {\n        return 0;\n    },\n    progressUpdate: (_final: number, _percentage: number, _iteration: number): void => {\n        return;\n    },\n    truncateFile: (_mod: DuckDBModule, _fileId: number, _newSize: number): void => {},\n    readFile: (_mod: DuckDBModule, _fileId: number, _buffer: number, _bytes: number, _location: number): number => {\n        return 0;\n    },\n    writeFile: (_mod: DuckDBModule, _fileId: number, _buffer: number, _bytes: number, _location: number): number => {\n        return 0;\n    },\n\n    removeDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    checkDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    createDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    listDirectoryEntries: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    glob: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    moveFile: (_mod: DuckDBModule, _fromPtr: number, _fromLen: number, _toPtr: number, _toLen: number): void => {},\n    checkFile: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    removeFile: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    callScalarUDF: (\n        mod: DuckDBModule,\n        response: number,\n        funcId: number,\n        descPtr: number,\n        descSize: number,\n        ptrsPtr: number,\n        ptrsSize: number,\n    ): void => {\n        udf_rt.callScalarUDF(DEFAULT_RUNTIME, mod, response, funcId, descPtr, descSize, ptrsPtr, ptrsSize);\n    },\n};\n", "import { DuckDBBindings, DuckDBDataProtocol } from '../bindings';\nimport { WorkerResponseVariant, WorkerRequestVariant, WorkerRequestType, WorkerResponseType } from './worker_request';\nimport { Logger, LogEntryVariant } from '../log';\nimport { InstantiationProgress } from '../bindings/progress';\n\nexport abstract class AsyncDuckDBDispatcher implements Logger {\n    /** The bindings */\n    protected _bindings: DuckDBBindings | null = null;\n    /** The next message id */\n    protected _nextMessageId = 0;\n\n    /** Instantiate the wasm module */\n    protected abstract instantiate(\n        mainModule: string,\n        pthreadWorker: string | null,\n        progress: (p: InstantiationProgress) => void,\n    ): Promise<DuckDBBindings>;\n    /** Post a response to the main thread */\n    protected abstract postMessage(response: WorkerResponseVariant, transfer: ArrayBuffer[]): void;\n\n    /** Send log entry to the main thread */\n    public log(entry: LogEntryVariant): void {\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: 0,\n                type: WorkerResponseType.LOG,\n                data: entry,\n            },\n            [],\n        );\n    }\n\n    /** Send plain OK without further data */\n    protected sendOK(request: WorkerRequestVariant): void {\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: request.messageId,\n                type: WorkerResponseType.OK,\n                data: null,\n            },\n            [],\n        );\n    }\n\n    /** Fail with an error */\n    protected failWith(request: WorkerRequestVariant, e: Error): void {\n        // Workaround for Firefox not being able to perform structured-clone on Native Errors\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=1556604\n        const obj: any = {\n            name: e.name,\n            message: e.message,\n            stack: e.stack || undefined,\n        };\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: request.messageId,\n                type: WorkerResponseType.ERROR,\n                data: obj,\n            },\n            [],\n        );\n        return;\n    }\n\n    /** Process a request from the main thread */\n    public async onMessage(request: WorkerRequestVariant): Promise<void> {\n        // First process those requests that don't need bindings\n        switch (request.type) {\n            case WorkerRequestType.PING:\n                this.sendOK(request);\n                return;\n            case WorkerRequestType.INSTANTIATE:\n                if (this._bindings != null) {\n                    this.failWith(request, new Error('duckdb already initialized'));\n                }\n                try {\n                    this._bindings = await this.instantiate(request.data[0], request.data[1], p => {\n                        this.postMessage(\n                            {\n                                messageId: this._nextMessageId++,\n                                requestId: request.messageId,\n                                type: WorkerResponseType.INSTANTIATE_PROGRESS,\n                                data: p,\n                            },\n                            [],\n                        );\n                    });\n                    this.sendOK(request);\n                } catch (e: any) {\n                    console.log(e);\n                    this._bindings = null;\n                    this.failWith(request, e);\n                }\n                return;\n            default:\n                break;\n        }\n\n        // Bindings not initialized?\n        if (!this._bindings) {\n            return this.failWith(request, new Error('duckdb is not initialized'));\n        }\n\n        // Catch every exception and forward it as error message to the main thread\n        try {\n            switch (request.type) {\n                case WorkerRequestType.GET_VERSION:\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.VERSION_STRING,\n                            data: this._bindings.getVersion(),\n                        },\n                        [],\n                    );\n                    break;\n                case WorkerRequestType.GET_FEATURE_FLAGS:\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FEATURE_FLAGS,\n                            data: this._bindings.getFeatureFlags(),\n                        },\n                        [],\n                    );\n                    break;\n                case WorkerRequestType.RESET:\n                    this._bindings.reset();\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.OPEN: {\n                    const path = request.data.path;\n                    if (path?.startsWith('opfs://')) {\n                        await this._bindings.prepareDBFileHandle(path, DuckDBDataProtocol.BROWSER_FSACCESS);\n                        request.data.useDirectIO = true;\n                    }\n                    this._bindings.open(request.data);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.DROP_FILE:\n                    this._bindings.dropFile(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.DROP_FILES:\n                    this._bindings.dropFiles(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.FLUSH_FILES:\n                    this._bindings.flushFiles();\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.CONNECT: {\n                    const conn = this._bindings.connect();\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.CONNECTION_INFO,\n                            data: conn.useUnsafe((_, c) => c),\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.DISCONNECT:\n                    this._bindings.disconnect(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.CREATE_PREPARED: {\n                    const result = this._bindings.createPrepared(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.PREPARED_STATEMENT_ID,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.CLOSE_PREPARED: {\n                    this._bindings.closePrepared(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.RUN_PREPARED: {\n                    const result = this._bindings.runPrepared(request.data[0], request.data[1], request.data[2]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.RUN_QUERY: {\n                    const result = this._bindings.runQuery(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.SEND_PREPARED: {\n                    const result = this._bindings.sendPrepared(request.data[0], request.data[1], request.data[2]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.START_PENDING_QUERY: {\n                    const result = this._bindings.startPendingQuery(request.data[0], request.data[1], request.data[2]);\n                    const transfer = [];\n                    if (result) {\n                        transfer.push(result.buffer);\n                    }\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.POLL_PENDING_QUERY: {\n                    const result = this._bindings.pollPendingQuery(request.data);\n                    const transfer = [];\n                    if (result) {\n                        transfer.push(result.buffer);\n                    }\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.CANCEL_PENDING_QUERY: {\n                    const result = this._bindings.cancelPendingQuery(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.SUCCESS,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.FETCH_QUERY_RESULTS: {\n                    const result = this._bindings.fetchQueryResults(request.data);\n                    const transfer = result ? [result.buffer] : [];\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_CHUNK,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.GET_TABLE_NAMES: {\n                    const result = this._bindings.getTableNames(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.TABLE_NAMES,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.GLOB_FILE_INFOS: {\n                    const infos = this._bindings.globFiles(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_INFOS,\n                            data: infos,\n                        },\n                        [],\n                    );\n                    break;\n                }\n\n                case WorkerRequestType.REGISTER_FILE_URL:\n                    this._bindings.registerFileURL(request.data[0], request.data[1], request.data[2], request.data[3]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_FILE_BUFFER:\n                    this._bindings.registerFileBuffer(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_FILE_HANDLE:\n                    await this._bindings.registerFileHandleAsync(\n                        request.data[0],\n                        request.data[1],\n                        request.data[2],\n                        request.data[3],\n                    );\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.COPY_FILE_TO_PATH:\n                    this._bindings.copyFileToPath(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.COPY_FILE_TO_BUFFER: {\n                    const buffer = this._bindings.copyFileToBuffer(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_BUFFER,\n                            data: buffer,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.COLLECT_FILE_STATISTICS:\n                    this._bindings.collectFileStatistics(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_OPFS_FILE_NAME:\n                    await this._bindings.registerOPFSFileName(request.data[0]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.EXPORT_FILE_STATISTICS: {\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_STATISTICS,\n                            data: this._bindings.exportFileStatistics(request.data),\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM: {\n                    this._bindings.insertArrowFromIPCStream(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.INSERT_CSV_FROM_PATH: {\n                    this._bindings.insertCSVFromPath(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.INSERT_JSON_FROM_PATH: {\n                    this._bindings.insertJSONFromPath(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.TOKENIZE: {\n                    const result = this._bindings.tokenize(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.SCRIPT_TOKENS,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n            }\n        } catch (e: any) {\n            console.log(e);\n            return this.failWith(request, e);\n        }\n    }\n}\n", "export const bigInt=()=>(async e=>{try{return(await WebAssembly.instantiate(e)).instance.exports.b(BigInt(0))===BigInt(0)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,126,1,126,3,2,1,0,7,5,1,1,98,0,0,10,6,1,4,0,32,0,11])),bulkMemory=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),exceptions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),extendedConst=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,0,1,11,9,1,0,65,1,65,2,106,11,0])),gc=()=>(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,95,1,120,0])))(),jspi=()=>(async()=>\"Suspender\"in WebAssembly)(),memory64=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,4,1])),multiMemory=()=>(async()=>{try{return new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,5,5,2,0,0,0,0])),!0}catch(e){return!1}})(),multiValue=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,0,2,127,127,3,2,1,0,10,8,1,6,0,65,0,65,0,11])),mutableGlobals=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1])),referenceTypes=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,7,1,5,0,208,112,26,11])),relaxedSimd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,15,1,13,0,65,1,253,15,65,2,253,15,253,128,2,11])),saturatedFloatToInt=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])),signExtensions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])),simd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),streamingCompilation=()=>(async()=>\"compileStreaming\"in WebAssembly)(),tailCall=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,6,1,4,0,18,0,11])),threads=()=>(async e=>{try{return\"undefined\"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),typeReflection=()=>(async()=>\"Function\"in WebAssembly)();\n", "{\n    \"name\": \"@duckdb/duckdb-wasm\",\n    \"version\": \"1.11.0\",\n    \"description\": \"DuckDB powered by WebAssembly\",\n    \"license\": \"MIT\",\n    \"repository\": {\n        \"type\": \"git\",\n        \"url\": \"https://github.com/duckdb/duckdb-wasm.git\"\n    },\n    \"keywords\": [\n        \"sql\",\n        \"duckdb\",\n        \"relational\",\n        \"database\",\n        \"data\",\n        \"query\",\n        \"wasm\",\n        \"analytics\",\n        \"olap\",\n        \"arrow\",\n        \"parquet\",\n        \"json\",\n        \"csv\"\n    ],\n    \"dependencies\": {\n        \"@nodelib/fs.stat\": \"^4.0.0\",\n        \"@nodelib/fs.walk\": \"^3.0.1\",\n        \"@uwdata/flechette\": \"latest\",\n        \"fast-glob\": \"^3.3.3\",\n        \"glob-parent\": \"^6.0.2\",\n        \"merge2\": \"^1.4.1\",\n        \"micromatch\": \"^4.0.8\"\n    },\n    \"devDependencies\": {\n        \"@nodelib/fs.stat\": \"^4.0.0\",\n        \"@nodelib/fs.walk\": \"^3.0.1\",\n        \"@types/emscripten\": \"^1.39.10\",\n        \"@types/jasmine\": \"^5.1.4\",\n        \"@types/merge2\": \"^1\",\n        \"@types/micromatch\": \"^4\",\n        \"@typescript-eslint/eslint-plugin\": \"^6.21.0\",\n        \"@typescript-eslint/parser\": \"^6.21.0\",\n        \"esbuild\": \"^0.20.2\",\n        \"eslint\": \"^8.57.0\",\n        \"eslint-plugin-jasmine\": \"^4.1.3\",\n        \"eslint-plugin-react\": \"^7.34.0\",\n        \"glob\": \"^13.0.0\",\n        \"jasmine\": \"^5.1.0\",\n        \"jasmine-core\": \"^5.1.2\",\n        \"jasmine-spec-reporter\": \"^7.0.0\",\n        \"js-sha256\": \"^0.11.1\",\n        \"karma\": \"^6.4.2\",\n        \"karma-chrome-launcher\": \"^3.2.0\",\n        \"karma-coverage\": \"^2.2.1\",\n        \"karma-firefox-launcher\": \"^2.1.3\",\n        \"karma-jasmine\": \"^5.1.0\",\n        \"karma-jasmine-html-reporter\": \"^2.1.0\",\n        \"karma-sourcemap-loader\": \"^0.4.0\",\n        \"karma-spec-reporter\": \"^0.0.36\",\n        \"make-dir\": \"^4.0.0\",\n        \"nyc\": \"^15.1.0\",\n        \"prettier\": \"^3.2.5\",\n        \"puppeteer\": \"^22.8.0\",\n        \"rimraf\": \"^3.0.2\",\n        \"s3rver\": \"^3.7.1\",\n        \"semver\": \"^7.6.0\",\n        \"typedoc\": \"^0.25.13\",\n        \"typescript\": \"^5.3.3\",\n        \"wasm-feature-detect\": \"^1.6.1\",\n        \"web-worker\": \"^1.2.0\"\n    },\n    \"scripts\": {\n        \"build:debug\": \"node bundle.mjs debug && tsc --emitDeclarationOnly\",\n        \"build:release\": \"node bundle.mjs release && tsc --emitDeclarationOnly\",\n        \"docs\": \"typedoc\",\n        \"format\": \"prettier --write \\\"**/*.+(js|ts)\\\"\",\n        \"report\": \"node ./coverage.mjs\",\n        \"test:node\": \"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:node:debug\": \"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:node:coverage\": \"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:firefox\": \"karma start ./karma/tests-firefox.cjs\",\n        \"test:chrome\": \"karma start ./karma/tests-chrome.cjs\",\n        \"test:chrome:eh\": \"karma start ./karma/tests-chrome-eh.cjs\",\n        \"test:chrome:coverage\": \"karma start ./karma/tests-chrome-coverage.cjs\",\n        \"test:browser\": \"karma start ./karma/tests-all.cjs\",\n        \"test:browser:debug\": \"karma start ./karma/tests-debug.cjs\",\n        \"test\": \"npm run test:chrome && npm run test:node\",\n        \"test:coverage\": \"npm run test:chrome:coverage && npm run test:node:coverage && npm run report\",\n        \"lint\": \"eslint src test\"\n    },\n    \"files\": [\n        \"dist\",\n        \"!dist/tests-*\",\n        \"!dist/duckdb-browser-mvp.worker.js.map\",\n        \"!dist/types/test\"\n    ],\n    \"main\": \"dist/duckdb-browser.cjs\",\n    \"module\": \"dist/duckdb-browser.mjs\",\n    \"types\": \"dist/duckdb-browser.d.ts\",\n    \"jsdelivr\": \"dist/duckdb-browser.cjs\",\n    \"unpkg\": \"dist/duckdb-browser.mjs\",\n    \"sideEffects\": false,\n    \"browser\": {\n        \"fs\": false,\n        \"os\": false,\n        \"path\": false,\n        \"perf_hooks\": false,\n        \"worker_threads\": false\n    },\n    \"exports\": {\n        \"./dist/duckdb-mvp.wasm\": \"./dist/duckdb-mvp.wasm\",\n        \"./dist/duckdb-eh.wasm\": \"./dist/duckdb-eh.wasm\",\n        \"./dist/duckdb-coi.wasm\": \"./dist/duckdb-coi.wasm\",\n        \"./dist/duckdb-browser\": \"./dist/duckdb-browser.mjs\",\n        \"./dist/duckdb-browser.cjs\": \"./dist/duckdb-browser.cjs\",\n        \"./dist/duckdb-browser.mjs\": \"./dist/duckdb-browser.mjs\",\n        \"./dist/duckdb-browser-coi.pthread.worker.js\": \"./dist/duckdb-browser-coi.pthread.worker.js\",\n        \"./dist/duckdb-browser-coi.worker.js\": \"./dist/duckdb-browser-coi.worker.js\",\n        \"./dist/duckdb-browser-eh.worker.js\": \"./dist/duckdb-browser-eh.worker.js\",\n        \"./dist/duckdb-browser-mvp.worker.js\": \"./dist/duckdb-browser-mvp.worker.js\",\n        \"./dist/duckdb-node\": \"./dist/duckdb-node.cjs\",\n        \"./dist/duckdb-node.cjs\": \"./dist/duckdb-node.cjs\",\n        \"./dist/duckdb-node-blocking\": \"./dist/duckdb-node-blocking.cjs\",\n        \"./dist/duckdb-node-blocking.cjs\": \"./dist/duckdb-node-blocking.cjs\",\n        \"./dist/duckdb-node-eh.worker.cjs\": \"./dist/duckdb-node-eh.worker.cjs\",\n        \"./dist/duckdb-node-mvp.worker.cjs\": \"./dist/duckdb-node-mvp.worker.cjs\",\n        \"./blocking\": {\n            \"node\": {\n                \"types\": \"./dist/duckdb-node-blocking.d.ts\",\n                \"require\": \"./dist/duckdb-node-blocking.cjs\",\n                \"import\": \"./dist/duckdb-node-blocking.cjs\"\n            },\n            \"types\": \"./dist/duckdb-node-blocking.d.ts\",\n            \"import\": \"./dist/duckdb-node-blocking.mjs\",\n            \"require\": \"./dist/duckdb-node-blocking.cjs\"\n        },\n        \".\": {\n            \"browser\": {\n                \"types\": \"./dist/duckdb-browser.d.ts\",\n                \"import\": \"./dist/duckdb-browser.mjs\",\n                \"require\": \"./dist/duckdb-browser.cjs\"\n            },\n            \"node\": {\n                \"types\": \"./dist/duckdb-node.d.ts\",\n                \"import\": \"./dist/duckdb-node.cjs\",\n                \"require\": \"./dist/duckdb-node.cjs\"\n            },\n            \"types\": \"./dist/duckdb-browser.d.ts\",\n            \"import\": \"./dist/duckdb-browser.mjs\",\n            \"require\": \"./dist/duckdb-browser.cjs\"\n        }\n    }\n}\n", "import config from '../package.json';\n\nexport const PACKAGE_NAME = config.name;\nexport const PACKAGE_VERSION = config.version;\n\nconst VERSION_PARTS = config.version.split('.');\nexport const PACKAGE_VERSION_MAJOR = VERSION_PARTS[0];\nexport const PACKAGE_VERSION_MINOR = VERSION_PARTS[1];\nexport const PACKAGE_VERSION_PATCH = VERSION_PARTS[2];\n", "import * as check from 'wasm-feature-detect';\nimport { PACKAGE_NAME, PACKAGE_VERSION } from './version';\n\n// Platform check taken from here:\n// https://github.com/xtermjs/xterm.js/blob/master/src/common/Platform.ts#L21\n\ninterface INavigator {\n    userAgent: string;\n    language: string;\n    platform: string;\n}\n\n// We're declaring a navigator global here as we expect it in all runtimes (node and browser), but\n// we want this module to live in common.\ndeclare const navigator: INavigator;\n\nexport const isNode = () => (typeof navigator === 'undefined' ? true : false);\nconst userAgent = () => (isNode() ? 'node' : navigator.userAgent);\nexport const isFirefox = () => userAgent().includes('Firefox');\nexport const isSafari = () => /^((?!chrome|android).)*safari/i.test(userAgent());\n\n/** Bundles have different characteristics:\n * - MVP: minimum viable product (uses features from first stable version of WebAssembly standard)\n * - EH: exception handling\n * - COI: cross origin isolation\n */\nexport interface DuckDBBundles {\n    mvp: {\n        mainModule: string;\n        mainWorker: string;\n    };\n    eh?: {\n        mainModule: string;\n        mainWorker: string;\n    };\n    coi?: {\n        mainModule: string;\n        mainWorker: string;\n        pthreadWorker: string;\n    };\n}\n\nexport function getJsDelivrBundles(): DuckDBBundles {\n    const jsdelivr_dist_url = `https://cdn.jsdelivr.net/npm/${PACKAGE_NAME}@${PACKAGE_VERSION}/dist/`;\n    return {\n        mvp: {\n            mainModule: `${jsdelivr_dist_url}duckdb-mvp.wasm`,\n            mainWorker: `${jsdelivr_dist_url}duckdb-browser-mvp.worker.js`,\n        },\n        eh: {\n            mainModule: `${jsdelivr_dist_url}duckdb-eh.wasm`,\n            mainWorker: `${jsdelivr_dist_url}duckdb-browser-eh.worker.js`,\n        },\n        // COI is still experimental, let the user opt in explicitly\n    };\n}\n\nexport interface DuckDBBundle {\n    mainModule: string;\n    mainWorker: string | null;\n    pthreadWorker: string | null;\n}\n\nexport interface PlatformFeatures {\n    bigInt64Array: boolean;\n    crossOriginIsolated: boolean;\n    wasmExceptions: boolean;\n    wasmSIMD: boolean;\n    wasmBulkMemory: boolean;\n    wasmThreads: boolean;\n}\n\nlet bigInt64Array: boolean | null = null;\nlet wasmExceptions: boolean | null = null;\nlet wasmThreads: boolean | null = null;\nlet wasmSIMD: boolean | null = null;\nlet wasmBulkMemory: boolean | null = null;\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\ndeclare namespace globalThis {\n    let crossOriginIsolated: boolean;\n}\n\nexport async function getPlatformFeatures(): Promise<PlatformFeatures> {\n    if (bigInt64Array == null) {\n        bigInt64Array = typeof BigInt64Array != 'undefined';\n    }\n    if (wasmExceptions == null) {\n        wasmExceptions = await check.exceptions();\n    }\n    if (wasmThreads == null) {\n        wasmThreads = await check.threads();\n    }\n    if (wasmSIMD == null) {\n        wasmSIMD = await check.simd();\n    }\n    if (wasmBulkMemory == null) {\n        wasmBulkMemory = await check.bulkMemory();\n    }\n    return {\n        bigInt64Array: bigInt64Array!,\n        crossOriginIsolated: isNode() || globalThis.crossOriginIsolated || false,\n        wasmExceptions: wasmExceptions!,\n        wasmSIMD: wasmSIMD!,\n        wasmThreads: wasmThreads!,\n        wasmBulkMemory: wasmBulkMemory!,\n    };\n}\n\nexport async function selectBundle(bundles: DuckDBBundles): Promise<DuckDBBundle> {\n    const platform = await getPlatformFeatures();\n    if (platform.wasmExceptions) {\n        if (platform.wasmSIMD && platform.wasmThreads && platform.crossOriginIsolated && bundles.coi) {\n            return {\n                mainModule: bundles.coi.mainModule,\n                mainWorker: bundles.coi.mainWorker,\n                pthreadWorker: bundles.coi.pthreadWorker,\n            };\n        }\n        if (bundles.eh) {\n            return {\n                mainModule: bundles.eh.mainModule,\n                mainWorker: bundles.eh.mainWorker,\n                pthreadWorker: null,\n            };\n        }\n    }\n    return {\n        mainModule: bundles.mvp.mainModule,\n        mainWorker: bundles.mvp.mainWorker,\n        pthreadWorker: null,\n    };\n}\n", "import Worker from 'web-worker';\n\nexport async function createWorker(url: string) {\n    const request = new Request(url);\n    const workerScript = await fetch(request);\n    const workerURL = URL.createObjectURL(await workerScript.blob());\n    return new Worker(workerURL);\n}\n"],
  "mappings": "yqBAAA,IAAAA,GAAAC,GAAA,CAAAC,GAAAC,KAAA,CAeAA,GAAO,QAAU,SC6BV,IAAKC,QACRA,IAAA,UAAY,GAAZ,YACAA,IAAA,UAAY,GAAZ,YACAA,IAAA,UAAY,GAAZ,YACAA,IAAA,WAAa,GAAb,aAJQA,QAAA,IC5CL,IAAKC,QACRA,IAAA,WAAa,GAAb,aACAA,IAAA,iBAAmB,GAAnB,mBACAA,IAAA,gBAAkB,GAAlB,kBACAA,IAAA,SAAW,GAAX,WACAA,IAAA,QAAU,GAAV,UACAA,IAAA,QAAU,GAAV,UANQA,QAAA,ICAL,IAAKC,QACRA,IAAA,KAAO,GAAP,OACAA,IAAA,MAAQ,GAAR,QACAA,IAAA,KAAO,GAAP,OACAA,IAAA,QAAU,GAAV,UACAA,IAAA,MAAQ,GAAR,QALQA,QAAA,IAQAC,QACRA,IAAA,KAAO,GAAP,OACAA,IAAA,QAAU,GAAV,UACAA,IAAA,WAAa,GAAb,aACAA,IAAA,KAAO,GAAP,OACAA,IAAA,MAAQ,GAAR,QACAA,IAAA,YAAc,GAAd,cANQA,QAAA,IASAC,QACRA,IAAA,KAAO,GAAP,OACAA,IAAA,GAAK,GAAL,KACAA,IAAA,MAAQ,GAAR,QACAA,IAAA,MAAQ,GAAR,QACAA,IAAA,IAAM,GAAN,MACAA,IAAA,QAAU,GAAV,UANQA,QAAA,IASAC,QACRA,IAAA,KAAO,GAAP,OACAA,IAAA,WAAa,GAAb,aACAA,IAAA,YAAc,GAAd,cACAA,IAAA,SAAW,GAAX,WACAA,IAAA,aAAe,GAAf,eALQA,QAAA,IA4CCC,GAAN,KAAmC,CAC/B,IAAIC,EAA+B,CAAC,CAC/C,EAEaC,GAAN,KAAsC,CACzC,YAAsBC,EAAkB,EAAe,CAAjC,WAAAA,CAAkC,CACjD,IAAIC,EAA8B,CACjCA,EAAM,OAAS,KAAK,OACpB,QAAQ,IAAIA,CAAK,CAEzB,CACJ,EAEO,SAASC,GAAiBF,EAAyB,CACtD,OAAQA,EAAO,CACX,IAAK,GACD,MAAO,OACX,IAAK,GACD,MAAO,QACX,IAAK,GACD,MAAO,OACX,IAAK,GACD,MAAO,UACX,IAAK,GACD,MAAO,QACX,QACI,MAAO,GACf,CACJ,CAEO,SAASG,GAAiBC,EAAyB,CACtD,OAAQA,EAAO,CACX,IAAK,GACD,MAAO,OACX,IAAK,GACD,MAAO,KACX,IAAK,GACD,MAAO,QACX,IAAK,GACD,MAAO,QACX,IAAK,GACD,MAAO,MACX,IAAK,GACD,MAAO,UACX,QACI,MAAO,GACf,CACJ,CAEO,SAASC,GAAiBC,EAAyB,CACtD,OAAQA,EAAO,CACX,IAAK,GACD,MAAO,UACX,IAAK,GACD,MAAO,aACX,IAAK,GACD,MAAO,cACX,IAAK,GACD,MAAO,OACX,IAAK,GACD,MAAO,QACX,QACI,MAAO,GACf,CACJ,CAEO,SAASC,GAAkBC,EAA2B,CACzD,OAAQA,EAAQ,CACZ,IAAK,GACD,MAAO,OACX,IAAK,GACD,MAAO,aACX,IAAK,GACD,MAAO,cACX,IAAK,GACD,MAAO,kBACX,IAAK,GACD,MAAO,SACX,QACI,MAAO,GACf,CACJ,CCvJO,IAAKC,QACRA,IAAA,QAAU,GAAV,UACAA,IAAA,gBAAkB,KAAlB,kBACAA,IAAA,kBAAoB,KAApB,oBAHQA,QAAA,IAML,SAASC,GAAcC,EAA6B,CACvD,OAAOA,GAAU,GACrB,CAEO,SAASC,GAAkBD,EAA6B,CAC3D,OAAOA,IAAW,GACtB,CCXO,IAAME,GAAQ,WAAW,GAAG,GAAI,GAAI,GAAI,GAAI,GAAI,EAAE,EAG5CC,GAAM,WAAW,GAAG,IAAK,IAAK,IAAK,IAAK,EAAG,EAAG,EAAG,CAAC,EAKlDC,EAAgC,CAE3C,GAAI,EAEJ,GAAI,EAEJ,GAAI,EAEJ,GAAI,EAUJ,GAAI,CACN,EAaO,IAAMC,EAAsC,CACjD,KAAM,EAIN,OAAQ,EASR,gBAAiB,EAMjB,YAAa,EAQb,OAAQ,EAQR,aAAc,CAChB,EAMaC,EAA6B,CAQxC,WAAY,GAEZ,KAAM,EAEN,KAAM,EAEN,IAAK,EAEL,MAAO,EAEP,OAAQ,EAER,KAAM,EAEN,KAAM,EAMN,QAAS,EAQT,KAAM,EAiBN,KAAM,EAmBN,UAAW,GAsBX,SAAU,GAKV,KAAM,GAIN,OAAQ,GAOR,MAAO,GAIP,gBAAiB,GAKjB,cAAe,GA2Bf,IAAK,GAeL,SAAU,GAKV,YAAa,GAKb,UAAW,GAKX,UAAW,GAOX,cAAe,GAUf,WAAY,GAUZ,SAAU,GAMV,SAAU,GAKV,cAAe,EACjB,EAKaC,EAAkC,CAE7C,KAAM,EAEN,OAAQ,EAER,OAAQ,CACV,EAKaC,EAAiC,CAE5C,IAAK,EAKL,YAAa,CACf,EAKaC,EAAiC,CAE5C,OAAQ,EAER,YAAa,EAEb,YAAa,EAEb,WAAY,CACd,EAKaC,EAAqC,CAKhD,WAAY,EAMZ,SAAU,EAUV,eAAgB,CAClB,EAKaC,EAAkC,CAE7C,OAAQ,EAER,MAAO,CACT,ECpXO,IAAMC,EAAa,WACbC,GAAc,YACdC,GAAc,YACdC,GAAc,eACdC,GAAY,UACZC,GAAa,WACbC,EAAa,WACbC,EAAa,cACbC,GAAe,aACfC,EAAe,aAOrB,SAASC,GAAkBC,EAAM,CACtC,OAAOA,aAAgB,aACrB,OAAO,kBAAsB,KAC7BA,aAAgB,iBAEpB,CASO,SAASC,GAAaC,EAAUC,EAAQ,CAC7C,IAAMC,EAAI,KAAK,KAAKF,CAAQ,EAAI,EAChC,OACEC,EACI,CAACV,GAAWC,GAAYC,EAAYC,CAAU,EAC9C,CAACP,EAAYC,GAAaC,GAAaC,EAAW,GACtDY,CAAC,CACL,CAGA,IAAMC,GAAa,OAAO,eAAe,SAAS,EAwC3C,SAASC,EAAOC,EAASC,EAAO,CACrC,IAAIC,EAAI,EACJC,EAAIH,EAAQ,OAChB,GAAIG,GAAK,WAGP,EAAG,CACD,IAAMC,EAAOF,EAAIC,IAAO,EACpBH,EAAQI,CAAG,GAAKH,EAAOC,EAAIE,EAAM,EAChCD,EAAIC,CACX,OAASF,EAAIC,OAIb,GAAG,CACD,IAAMC,EAAM,KAAK,OAAOF,EAAIC,GAAK,CAAC,EAC9BH,EAAQI,CAAG,GAAKH,EAAOC,EAAIE,EAAM,EAChCD,EAAIC,CACX,OAASF,EAAIC,GAEf,OAAOD,CACT,CC5EO,SAASG,GAAMC,EAAOC,EAAMC,EAAS,CAC1C,GAAID,EAAKD,CAAK,EAAG,OAAOA,EACxB,MAAM,IAAI,MAAME,EAAQF,CAAK,CAAC,CAChC,CAYO,SAASG,EAAWH,EAAOI,EAAKF,EAAS,CAC9C,OAAAE,EAAM,MAAM,QAAQA,CAAG,EAAIA,EAAM,OAAO,OAAOA,CAAG,EAC3CL,GACLC,EACCA,GAAUI,EAAI,SAASJ,CAAK,EAC7BE,GAAA,KAAAA,EAAY,IAAM,GAAGF,CAAK,mBAAmBI,CAAG,EAClD,CACF,CAQO,SAASC,GAAOC,EAAQN,EAAO,CACpC,OAAW,CAACO,EAAKC,CAAG,IAAK,OAAO,QAAQF,CAAM,EAC5C,GAAIE,IAAQR,EAAO,OAAOO,EAE5B,MAAO,WACT,CCpDO,IAAME,EAAmBC,GAC9B,2BAA2BC,GAAOC,EAAMF,CAAM,CAAC,SAASA,CAAM,IAcnDG,GAAQ,CAACC,EAAMC,EAAMC,EAAW,GAAMC,EAAW,QAAU,CACtE,KAAAH,EACA,KAAAC,EACA,SAAAC,EACA,SAAAC,CACF,GAOA,SAASC,GAAQC,EAAO,CACtB,OAAO,OAAO,OAAOA,EAAO,MAAM,GAAKC,GAAWD,EAAM,IAAI,CAC9D,CAOA,SAASC,GAAWD,EAAO,CACzB,OAAO,OAAOA,GAAA,YAAAA,EAAO,SAAW,QAClC,CAUA,SAASE,EAAQF,EAAOG,EAAc,GAAIC,EAAkB,GAAM,CAChE,OAAOL,GAAQC,CAAK,EAChBA,EACAN,GACES,EACAE,GAAML,EAAOC,GAAY,IAAM,qBAAqB,EACpDG,CACF,CACN,CAgCO,IAAME,GAAa,CAACC,EAAMC,EAAWC,EAAU,GAAOC,EAAK,MAAQ,CACxE,OAAQC,EAAK,WACb,GAAAD,EACA,WAAYH,EACZ,QAASC,GAAaI,GAAM,EAC5B,QAAAH,CACF,GAiBO,IAAMI,GAAM,CAACC,EAAW,GAAIC,EAAS,MAAU,CACpD,OAAQC,EAAK,IACb,SAAUC,EAAWH,EAAU,CAAC,EAAG,GAAI,GAAI,EAAE,CAAC,EAC9C,OAAAC,EACA,OAAQG,GAAaJ,EAAUC,CAAM,CACvC,GAeO,IAAMI,GAAQ,IAAMC,GAAI,EAAE,EAkC1B,IAAMC,GAAQ,CAACC,EAAY,KAAO,CACvC,OAAQC,EAAK,MACb,UAAWC,EAAWF,EAAWG,CAAS,EAC1C,OAAQ,CAACC,GAAaC,GAAcC,CAAY,EAAEN,CAAS,CAC7D,GAsBO,IAAMO,GAAS,KAAO,CAC3B,OAAQC,EAAK,OACb,QAASC,CACX,GAQaC,GAAO,KAAO,CACzB,OAAQF,EAAK,KACb,QAASC,CACX,GAuBO,IAAME,GAAU,CAACC,EAAWC,EAAOC,EAAW,OAAS,CAC5D,OAAQC,EAAK,QACb,UAAAH,EACA,MAAAC,EACA,SAAUG,EAAWF,EAAU,CAAC,GAAI,GAAI,IAAK,GAAG,CAAC,EACjD,OAAQA,IAAa,GAAKG,EAAaC,EACzC,GA+CO,IAAMC,GAAQC,IAAU,CAC7B,OAAQC,EAAK,KACb,KAAMC,EAAWF,EAAMG,CAAQ,EAC/B,OAAQH,IAASG,EAAS,IAAMC,EAAaC,CAC/C,GA6BO,IAAMC,GAAO,CAACC,EAAOC,EAAS,cAAgB,CACnDD,EAAOE,EAAWF,EAAMC,CAAQ,EAChC,IAAME,EAAWH,IAASC,EAAS,QAAUD,IAASC,EAAS,YAAc,GAAK,GAClF,MAAO,CACL,OAAQG,EAAK,KACb,KAAAJ,EACA,SAAAG,EACA,OAAQA,IAAa,GAAKE,EAAaC,CACzC,CACF,EAuCO,IAAMC,GAAY,CAACC,EAAOC,EAAS,YAAaC,EAAW,QAAU,CAC1E,OAAQC,EAAK,UACb,KAAMC,EAAWJ,EAAMC,CAAQ,EAC/B,SAAAC,EACA,OAAQG,CACV,GA0BaC,GAAW,CAACN,EAAOO,EAAa,kBAAoB,CAC/D,OAAQJ,EAAK,SACb,KAAMC,EAAWJ,EAAMO,CAAY,EACnC,OAAQP,IAASO,EAAa,eAAiB,OAAYC,CAC7D,GAUaC,GAAQC,IAAW,CAC9B,OAAQP,EAAK,KACb,SAAU,CAAEQ,EAAQD,CAAK,CAAE,EAC3B,QAASF,CACX,GAYaI,GAAUC,IAAc,CACnC,OAAQV,EAAK,OACb,SAAU,MAAM,QAAQU,CAAQ,GAAKC,GAAQD,EAAS,CAAC,CAAC,EAC5BA,EACxB,OAAO,QAAQA,CAAQ,EAAE,IAAI,CAAC,CAACE,EAAMC,CAAI,IAAMC,GAAMF,EAAMC,CAAI,CAAC,CACtE,GA6BaE,GAAQ,CAACC,EAAMN,EAAUO,EAASC,KAC7CD,GAAA,OAAAA,EAAYP,EAAS,IAAI,CAACS,EAAGC,IAAMA,CAAC,GAC7B,CACL,OAAQpB,EAAK,MACb,KAAMC,EAAWe,EAAMK,CAAS,EAChC,QAAAJ,EACA,QAASA,EAAQ,OAAO,CAACK,EAAGC,EAAI,KAAQD,EAAEC,CAAE,EAAI,EAAID,GAAI,CAAC,CAAC,EAC1D,SAAUZ,EAAS,IAAI,CAACS,EAAGC,IAAMZ,EAAQW,EAAG,IAAIC,CAAC,EAAE,CAAC,EACpD,eAAAF,EACA,QAASb,CACX,GASWmB,GAAmBC,IAAY,CAC1C,OAAQzB,EAAK,gBACb,OAAAyB,CACF,GAWaC,GAAgB,CAACnB,EAAOkB,KAAY,CAC/C,OAAQzB,EAAK,cACb,OAAAyB,EACA,SAAU,CAAEjB,EAAQD,CAAK,CAAE,CAC7B,GAQaoB,GAAU,CAACC,EAAYrB,KAAW,CAC7C,OAAQP,EAAK,IACb,WAAA4B,EACA,SAAU,CAACrB,CAAK,EAChB,QAASF,CACX,GA+BO,IAAMwB,GAAW,CAACC,EAAOC,EAAS,eAAiB,CACxD,OAAQC,EAAK,SACb,KAAMC,EAAWH,EAAMC,CAAQ,EAC/B,OAAQG,CACV,GAQaC,GAAc,KAAO,CAChC,OAAQH,EAAK,YACb,QAASE,CACX,GASaE,GAAY,KAAO,CAC9B,OAAQJ,EAAK,UACb,QAASE,CACX,GAWaG,GAAaC,IAAW,CACnC,OAAQN,EAAK,UACb,SAAU,CAAEO,EAAQD,CAAK,CAAE,EAC3B,QAASJ,CACX,GAaaM,GAAgB,CAACC,EAAWC,KAAiB,CACxD,OAAQV,EAAK,cACb,SAAU,CACRW,GACEJ,EAAQE,EAAW,UAAU,EAC5BG,GAAUA,EAAM,KAAK,SAAWZ,EAAK,IACtC,IAAM,qCACR,EACAO,EAAQG,EAAa,QAAQ,CAC/B,CACF,GAyCO,IAAMG,GAAYC,IAAW,CAClC,OAAQC,EAAK,SACb,SAAU,CAAEC,EAAQF,EAAO,OAAO,CAAE,EACpC,QAASG,CACX,GAcaC,GAAiBJ,IAAW,CACvC,OAAQC,EAAK,cACb,SAAU,CAAEC,EAAQF,EAAO,OAAO,CAAE,EACpC,QAASK,CACX,GC9pBA,IAAMC,GAAM,IAAIC,EAAa,CAAC,EACxBC,GAAMF,GAAI,OACVG,GAAM,IAAIC,EAAWF,EAAG,EACxBG,GAAM,IAAIC,GAAYJ,EAAG,EACzBK,GAAM,IAAIC,EAAWN,EAAG,EACxBO,GAAK,IAAIC,EAAWR,EAAG,EAsEtB,SAASS,EAASC,EAAO,CAC9B,GAAIA,EAAQ,OAAO,kBAAoBA,EAAQ,OAAO,iBACpD,MAAM,MAAM,iDAAiDA,CAAK,EAAE,EAEtE,OAAO,OAAOA,CAAK,CACrB,CASO,SAASC,GAAOC,EAAKC,EAAK,CAC/B,OAAO,OAAOD,EAAMC,CAAG,EAAI,OAAOD,EAAMC,CAAG,EAAI,OAAOA,CAAG,CAC3D,CAwCA,IAAMC,GAAWC,GAAK,OAAO,QAAQ,GAAIA,CAAC,EASnC,SAASC,GAAcC,EAAKC,EAAQ,CACzC,OAAO,OAAO,OAAO,GAAID,EAAIC,CAAM,CAAC,CACtC,CASO,SAASC,GAAeF,EAAKC,EAAQ,CAC1C,IAAME,EAAIF,GAAU,EAChBG,EACJ,OAAI,OAAO,OAAO,GAAIJ,EAAIG,EAAI,CAAC,CAAC,EAAI,GAClCC,EAAIP,GAAS,CAACG,EAAIG,CAAC,CAAC,EAAKN,GAAS,CAACG,EAAIG,EAAI,CAAC,CAAC,GAAK,IAClDC,EAAI,EAAEA,EAAI,KAEVA,EAAIJ,EAAIG,CAAC,EAAKH,EAAIG,EAAI,CAAC,GAAK,IAEvBC,CACT,CASO,SAASC,GAAeL,EAAKC,EAAQ,CAC1C,IAAME,EAAIF,GAAU,EAChBG,EACJ,OAAI,OAAO,OAAO,GAAIJ,EAAIG,EAAI,CAAC,CAAC,EAAI,GAClCC,EAAIP,GAAS,CAACG,EAAIG,CAAC,CAAC,EACfN,GAAS,CAACG,EAAIG,EAAI,CAAC,CAAC,GAAK,IACzBN,GAAS,CAACG,EAAIG,EAAI,CAAC,CAAC,GAAK,KACzBN,GAAS,CAACG,EAAIG,EAAI,CAAC,CAAC,GAAK,KAC9BC,EAAI,EAAEA,EAAI,KAEVA,EAAIJ,EAAIG,CAAC,EACJH,EAAIG,EAAI,CAAC,GAAK,IACdH,EAAIG,EAAI,CAAC,GAAK,KACdH,EAAIG,EAAI,CAAC,GAAK,KAEdC,CACT,CC9LA,IAAME,GAAc,IAAI,YAAY,OAAO,EACrCC,GAAc,IAAI,YAOjB,SAASC,GAAWC,EAAK,CAC9B,OAAOH,GAAY,OAAOG,CAAG,CAC/B,CCTO,IAAMC,EAAa,EAWnB,SAASC,GAAUC,EAAQC,EAAO,CACvC,OAAQD,EAAOC,GAAS,CAAC,EAAI,GAAMA,EAAQ,KAAQ,CACrD,CAOO,SAASC,EAAWC,EAAKF,EAAO,CACrC,IAAMG,EAAMH,EAAQI,EAAUF,EAAKF,CAAK,EAClCK,EAASF,EAAMC,EAAUF,EAAKC,CAAG,EACjCG,EAAOC,EAAUL,EAAKG,CAAM,EASlC,MAAO,CAACL,EAAOQ,EAAMC,EAAW,OAAS,CACvC,GAAIT,EAAQM,EAAM,CAChB,IAAMI,EAAMH,EAAUL,EAAKG,EAASL,CAAK,EACzC,GAAIU,EAAK,OAAOF,EAAKN,EAAKC,EAAMO,CAAG,CACrC,CACA,OAAOD,CACT,CACF,CAQO,SAASE,EAAWT,EAAKU,EAAQ,CACtC,OAAOA,CACT,CAQO,SAASC,EAAYX,EAAKU,EAAQ,CACvC,MAAO,CAAC,CAACE,GAASZ,EAAKU,CAAM,CAC/B,CAQO,SAASE,GAASZ,EAAKU,EAAQ,CACpC,OAAOG,GAAUb,EAAKU,CAAM,GAAK,IAAM,EACzC,CAQO,SAASG,GAAUb,EAAKU,EAAQ,CACrC,OAAOV,EAAIU,CAAM,CACnB,CAQO,SAASL,EAAUL,EAAKU,EAAQ,CACrC,OAAOI,GAAWd,EAAKU,CAAM,GAAK,IAAM,EAC1C,CAQO,SAASI,GAAWd,EAAKU,EAAQ,CACtC,OAAOV,EAAIU,CAAM,EAAIV,EAAIU,EAAS,CAAC,GAAK,CAC1C,CAQO,SAASR,EAAUF,EAAKU,EAAQ,CACrC,OAAOV,EAAIU,CAAM,EACbV,EAAIU,EAAS,CAAC,GAAK,EACnBV,EAAIU,EAAS,CAAC,GAAK,GACnBV,EAAIU,EAAS,CAAC,GAAK,EACzB,CAQO,SAASK,GAAWf,EAAKU,EAAQ,CACtC,OAAOR,EAAUF,EAAKU,CAAM,IAAM,CACpC,CASO,SAASM,EAAUhB,EAAKU,EAAQ,CACrC,OAAOO,EAAS,OAAO,OACrB,GACA,OAAOF,GAAWf,EAAKU,CAAM,CAAC,GAC3B,OAAOK,GAAWf,EAAKU,EAASQ,CAAU,CAAC,GAAK,IACrD,CAAC,CACH,CASO,SAASC,EAAWnB,EAAKF,EAAO,CACrC,IAAIY,EAASZ,EAAQI,EAAUF,EAAKF,CAAK,EACnCsB,EAASlB,EAAUF,EAAKU,CAAM,EACpC,OAAAA,GAAUQ,EACHG,GAAWrB,EAAI,SAASU,EAAQA,EAASU,CAAM,CAAC,CACzD,CAWO,SAASE,EAAWtB,EAAKU,EAAQa,EAAQC,EAAS,CACvD,GAAI,CAACd,EAAQ,MAAO,CAAC,EAGrB,IAAMe,EAAOf,EAASR,EAAUF,EAAKU,CAAM,EAG3C,OAAO,MAAM,KACX,CAAE,OAAQR,EAAUF,EAAKyB,CAAI,CAAE,EAC/B,CAACC,EAAG,IAAMF,EAAQxB,EAAKyB,EAAOP,EAAa,EAAIK,CAAM,CACvD,CACF,CC1KO,IAAMI,GAAW,OAAO,UAAU,EAUlC,SAASC,GAAaC,EAAOC,EAAS,CAC3C,MAAMC,CAAU,CAKd,YAAYC,EAAO,CACjB,KAAKL,EAAQ,EAAIK,CACnB,CAKA,QAAS,CACP,OAAOC,GAAaJ,EAAOC,EAAS,KAAKH,EAAQ,CAAC,CACpD,CACF,CAGA,IAAMO,EAAQH,EAAU,UAExB,QAASI,EAAI,EAAGA,EAAIN,EAAM,OAAQ,EAAEM,EAAG,CAErC,GAAI,OAAO,OAAOD,EAAOL,EAAMM,CAAC,CAAC,EAAG,SAGpC,IAAMC,EAAQN,EAAQK,CAAC,EACvB,OAAO,eAAeD,EAAOL,EAAMM,CAAC,EAAG,CACrC,KAAM,CAAE,OAAOC,EAAM,GAAG,KAAKT,EAAQ,CAAC,CAAG,EACzC,WAAY,EACd,CAAC,CACH,CAEA,OAAOK,GAAS,IAAID,EAAUC,CAAK,CACrC,CAUO,SAASK,GAAcR,EAAOC,EAAS,CAC5C,OAAOE,GAASC,GAAaJ,EAAOC,EAASE,CAAK,CACpD,CASO,SAASC,GAAaJ,EAAOC,EAASE,EAAO,CAClD,IAAMM,EAAM,CAAC,EACb,QAASH,EAAI,EAAGA,EAAIN,EAAM,OAAQ,EAAEM,EAClCG,EAAIT,EAAMM,CAAC,CAAC,EAAIL,EAAQK,CAAC,EAAE,GAAGH,CAAK,EAErC,OAAOM,CACT,CC9DO,SAASC,GAAcC,EAAO,CACnC,OAAOA,aAAiBC,CAC1B,CAOO,IAAMC,EAAN,KAAY,CAqBjB,YAAY,CACV,OAAAC,EACA,UAAAC,EACA,KAAAC,EACA,SAAAC,EACA,OAAAC,EACA,QAAAC,EACA,MAAAC,EACA,SAAAC,CACF,EAAG,CACD,KAAK,OAASP,EACd,KAAK,UAAYC,EACjB,KAAK,KAAOC,EACZ,KAAK,SAAWC,EAChB,KAAK,OAASC,EACd,KAAK,QAAUC,EACf,KAAK,MAAQC,EACb,KAAK,SAAWC,GAKZ,CAACN,GAAa,CAAC,KAAK,YAEtB,KAAK,GAAKO,GAAS,KAAK,MAAMA,CAAK,EAEvC,CAKA,IAAK,OAAO,WAAW,GAAI,CACzB,MAAO,OACT,CAOA,GAAGA,EAAO,CACR,OAAO,KAAK,QAAQA,CAAK,EAAI,KAAK,MAAMA,CAAK,EAAI,IACnD,CAOA,QAAQA,EAAO,CACb,OAAOC,GAAU,KAAK,SAAUD,CAAK,CACvC,CASA,MAAMA,EAAO,CACX,OAAyB,KAAK,OAAOA,CAAK,CAC5C,CASA,MAAME,EAAOC,EAAK,CAChB,IAAM,EAAIA,EAAMD,EACVN,EAAS,MAAM,CAAC,EACtB,QAASQ,EAAI,EAAGA,EAAI,EAAG,EAAEA,EACvBR,EAAOQ,CAAC,EAAI,KAAK,GAAGF,EAAQE,CAAC,EAE/B,OAAOR,CACT,CAMA,EAAE,OAAO,QAAQ,GAAI,CACnB,QAASQ,EAAI,EAAGA,EAAI,KAAK,OAAQ,EAAEA,EACjC,MAAM,KAAK,GAAGA,CAAC,CAEnB,CACF,EAvGEC,EAPWd,EAOJ,YAAY,MA8Gd,IAAMD,EAAN,cAA0BC,CAAM,CAUrC,YAAYe,EAAS,CACnB,MAAMA,CAAO,EAGb,GAAM,CAAE,OAAAd,EAAQ,OAAAI,CAAO,EAAI,KAC3B,KAAK,OAASA,EAAO,SAAS,EAAGJ,CAAM,CACzC,CAUA,MAAMU,EAAOC,EAAK,CAEhB,OAAO,KAAK,UACR,MAAM,MAAMD,EAAOC,CAAG,EACtB,KAAK,OAAO,SAASD,EAAOC,CAAG,CACrC,CAMA,CAAC,OAAO,QAAQ,GAAI,CAClB,OAAO,KAAK,UACR,MAAM,OAAO,QAAQ,EAAE,EACM,KAAK,OAAO,OAAO,QAAQ,EAAE,CAChE,CACF,EAMaI,EAAN,cAA0BhB,CAAM,CAEvC,EADEc,EADWE,EACJ,YAAYC,GAQd,IAAMC,EAAN,cAAyBlB,CAAM,CAEtC,EADEc,EADWI,EACJ,YAAY,OAOd,IAAMC,GAAN,cAAwBD,CAAW,CAKxC,MAAMT,EAAO,CACX,OAAO,IACT,CACF,EAMaW,EAAN,cAAyBJ,CAAY,CAI1C,MAAMP,EAAO,CACX,OAAOY,EAAgC,KAAK,OAAOZ,CAAK,CAAE,CAC5D,CACF,EAMaa,GAAN,cAA2BN,CAAY,CAI5C,MAAMP,EAAO,CACX,IAAMc,EAA2B,KAAK,OAAOd,CAAK,EAC5Ce,GAAQD,EAAI,QAAW,GACvBE,GAAQF,EAAI,MAAU,KACtBG,EAAQ,QAASH,EAAI,QAAW,IACtC,OAAQC,EAAM,CACZ,IAAK,IAAM,OAAOE,GAAQD,EAAO,OAAO,IAAM,KAC9C,IAAK,GAAM,OAAOC,GAAQD,EAAO,eAAiBA,EAAO,EAC3D,CACA,OAAOC,EAAQ,IAAMF,EAAO,KAAQ,EAAIC,EAC1C,CACF,EAMaE,GAAN,cAAwBT,CAAW,CAIxC,MAAMT,EAAO,CACX,OAAOC,GAAqC,KAAK,OAASD,CAAK,CACjE,CACF,EAQamB,GAAN,cAAmCZ,CAAY,CACpD,YAAYD,EAAS,CACnB,MAAMA,CAAO,EACb,GAAM,CAAE,MAAAc,CAAM,EAAgC,KAAK,KACnD,KAAK,MAAQ,IAAMA,CACrB,CAIA,MAAMpB,EAAO,CACX,OAA6B,KAAK,OAAOA,CAAK,EAAK,KAAK,KAC1D,CACF,EAQaqB,GAAN,cAA2B9B,CAAM,CACtC,YAAYe,EAAS,CACnB,MAAMA,CAAO,EACb,GAAM,CAAE,SAAAgB,EAAU,MAAAF,CAAM,EAAgC,KAAK,KAC7D,KAAK,QAAUE,IAAa,GAAKC,GAC7BD,IAAa,IAAME,GACnBC,GACJ,KAAK,MAAQ,KAAO,OAAOL,CAAK,CAClC,CACF,EAQaM,GAAN,cAAiCL,EAAa,CAKnD,MAAMrB,EAAO,CACX,OAAO2B,GACL,KAAK,QAAuC,KAAK,OAAS3B,CAAK,EAC/D,KAAK,KACP,CACF,CACF,EAVEK,EADWqB,GACJ,YAAYlB,GAkBd,IAAMoB,GAAN,cAAiCP,EAAa,CAKnD,MAAMrB,EAAO,CACX,OAAO,KAAK,QAAuC,KAAK,OAASA,CAAK,CACxE,CACF,EAPEK,EADWuB,GACJ,YAAY,OAed,IAAMC,GAAN,cAAwBpB,CAAW,CAKxC,YAAYpB,EAAO,CACjB,MAAMA,CAAK,EACX,KAAK,OAASA,CAChB,CAKA,MAAMW,EAAO,CACX,OAAO,IAAI,KAAK,KAAK,OAAO,MAAMA,CAAK,CAAC,CAC1C,CACF,EAKa8B,GAAN,cAA2BvB,CAAY,CAK5C,MAAMP,EAAO,CAEX,MAAO,OAAkC,KAAK,OAAOA,CAAK,CAC5D,CACF,EAKa+B,GAA0BpB,EAK1BqB,GAAN,cAAmCrB,CAAW,CAInD,MAAMX,EAAO,CACX,OAAO,MAAM,MAAMA,CAAK,EAAI,GAC9B,CACF,EAKaiC,GAA4BtB,EAK5BuB,GAAN,cAAwCvB,CAAW,CAIxD,MAAMX,EAAO,CAEX,OAAO2B,GAA8B,KAAK,OAAO3B,CAAK,EAAI,KAAK,CACjE,CACF,EAKamC,GAAN,cAAuCxB,CAAW,CAIvD,MAAMX,EAAO,CAEX,OAAO2B,GAA8B,KAAK,OAAO3B,CAAK,EAAI,QAAQ,CACpE,CACF,EAMaoC,GAAN,cAAmC3B,CAAW,CAKnD,MAAMT,EAAO,CAEX,OAD0C,KAAK,OACjC,SAASA,GAAS,EAAIA,EAAQ,GAAM,CAAC,CACrD,CACF,EAMaqC,GAAN,cAAwC5B,CAAW,CAIxD,MAAMT,EAAO,CACX,IAAMJ,EAAoC,KAAK,OACzC0C,EAAOtC,GAAS,EACtB,OAAO,aAAa,GAClBuC,EAAU3C,EAAQ0C,CAAI,EACtBC,EAAU3C,EAAQ0C,EAAO,CAAC,EAC1BE,EAAU5C,EAAQ0C,EAAO,CAAC,CAC5B,CACF,CACF,EAEMG,GAAW,CAAC,CAAC,OAAA7C,EAAQ,QAAAC,CAAO,EAAGG,IAAUJ,EAAO,SAASC,EAAQG,CAAK,EAAGH,EAAQG,EAAQ,CAAC,CAAC,EAC3F0C,GAAW,CAAC,CAAC,OAAA9C,EAAQ,QAAAC,CAAO,EAAGG,IAAUJ,EAAO,SAASgB,EAASf,EAAQG,CAAK,CAAC,EAAGY,EAASf,EAAQG,EAAQ,CAAC,CAAC,CAAC,EAOxG2C,GAAN,cAA0BlC,CAAW,CAK1C,MAAMT,EAAO,CACX,OAAOyC,GAAS,KAAMzC,CAAK,CAC7B,CACF,EAQa4C,GAAN,cAA+BnC,CAAW,CAK/C,MAAMT,EAAO,CACX,OAAO0C,GAAS,KAAM1C,CAAK,CAC7B,CACF,EAMa6C,GAAN,cAAwBpC,CAAW,CAIxC,MAAMT,EAAO,CACX,OAAO8C,GAAWL,GAAS,KAAMzC,CAAK,CAAC,CACzC,CACF,EAOa+C,GAAN,cAA6BtC,CAAW,CAI7C,MAAMT,EAAO,CACX,OAAO8C,GAAWJ,GAAS,KAAM1C,CAAK,CAAC,CACzC,CACF,EAQagD,GAAN,cAAwBvC,CAAW,CAKxC,MAAMT,EAAO,CACX,IAAMH,EAAqC,KAAK,QAChD,OAAO,KAAK,SAAS,CAAC,EAAE,MAAMA,EAAQG,CAAK,EAAGH,EAAQG,EAAQ,CAAC,CAAC,CAClE,CACF,EASaiD,GAAN,cAA6BxC,CAAW,CAK7C,MAAMT,EAAO,CACX,IAAMH,EAAwC,KAAK,QACnD,OAAO,KAAK,SAAS,CAAC,EAAE,MAAMe,EAASf,EAAQG,CAAK,CAAC,EAAGY,EAASf,EAAQG,EAAQ,CAAC,CAAC,CAAC,CACtF,CACF,EAQakD,GAAN,cAA4BzC,CAAW,CAK5C,MAAMT,EAAO,CACX,IAAMmD,EAA2B,KAAK,QAAQnD,CAAK,EAC7CoD,EAAID,EAA2B,KAAK,MAAMnD,CAAK,EACrD,OAAO,KAAK,SAAS,CAAC,EAAE,MAAMmD,EAAGC,CAAC,CACpC,CACF,EASaC,GAAN,cAAiC5C,CAAW,CAKjD,MAAMT,EAAO,CACX,IAAMmD,EAA2B,KAAK,QAAQnD,CAAK,EAC7CoD,EAAID,EAA2B,KAAK,MAAMnD,CAAK,EACrD,OAAO,KAAK,SAAS,CAAC,EAAE,MAAMY,EAASuC,CAAC,EAAGvC,EAASwC,CAAC,CAAC,CACxD,CACF,EAOME,GAAN,cAAyB7C,CAAW,CAClC,YAAYH,EAAS,CACnB,MAAMA,CAAO,EAGb,KAAK,OAAS,KAAK,KAAK,MAC1B,CACF,EAOaiD,GAAN,cAA+BD,EAAW,CAK/C,MAAMtD,EAAO,CACX,GAAM,CAAE,OAAAwD,EAAQ,OAAA5D,CAAO,EAAI,KAC3B,OAAkCA,EAC/B,SAASI,EAAQwD,GAASxD,EAAQ,GAAKwD,CAAM,CAClD,CACF,EAOaC,GAAN,cAA6BH,EAAW,CAK7C,MAAMtD,EAAO,CACX,GAAM,CAAE,SAAAD,EAAU,OAAAyD,CAAO,EAAI,KAC7B,OAAOzD,EAAS,CAAC,EAAE,MAAMC,EAAQwD,GAASxD,EAAQ,GAAKwD,CAAM,CAC/D,CACF,EAKA,SAASE,GAAM,CAAE,SAAA3D,EAAU,QAAAF,CAAQ,EAAGG,EAAO,CAC3C,GAAM,CAAE2D,EAAMC,CAAK,EAAI7D,EAAS,CAAC,EAAE,SAC7BG,EAAQL,EAAQG,CAAK,EACrBG,EAAMN,EAAQG,EAAQ,CAAC,EACvB6D,EAAU,CAAC,EACjB,QAASzD,EAAIF,EAAOE,EAAID,EAAK,EAAEC,EAC7ByD,EAAQ,KAAK,CAACF,EAAK,GAAGvD,CAAC,EAAGwD,EAAK,GAAGxD,CAAC,CAAC,CAAC,EAEvC,OAAOyD,CACT,CAQO,IAAMC,GAAN,cAA4BrD,CAAW,CAM5C,MAAMT,EAAO,CACX,OAAgC0D,GAAM,KAAM1D,CAAK,CACnD,CACF,EAQa+D,GAAN,cAAuBtD,CAAW,CAMvC,MAAMT,EAAO,CACX,OAAO,IAAI,IAA6B0D,GAAM,KAAM1D,CAAK,CAAE,CAC7D,CACF,EAQagE,GAAN,cAA+BvD,CAAW,CAa/C,YAAY,CAAE,QAAAwD,EAAS,GAAG3D,CAAQ,EAAG,CACnC,MAAMA,CAAO,EAEb,KAAK,QAAU2D,EAGf,KAAK,QAAU,KAAK,KAAK,OAC3B,CAKA,MAAMjE,EAAOkE,EAASlE,EAAO,CAC3B,GAAM,CAAE,QAAAiE,EAAS,SAAAlE,EAAU,QAAAoE,CAAQ,EAAI,KACvC,OAAOpE,EAASoE,EAAQF,EAAQjE,CAAK,CAAC,CAAC,EAAE,GAAGkE,CAAM,CACpD,CACF,EAQaE,GAAN,cAA8BJ,EAAiB,CAIpD,MAAMhE,EAAO,CACX,OAAO,MAAM,MAAMA,EAA8B,KAAK,QAAQA,CAAK,CAAE,CACvE,CACF,EAOaqE,GAAN,cAA0B5D,CAAW,CAC1C,YAAYH,EAASgE,EAAUC,GAAe,CAC5C,MAAMjE,CAAO,EAGb,KAAK,MAAQ,KAAK,KAAK,SAAS,IAAIkE,GAASA,EAAM,IAAI,EACvD,KAAK,QAAUF,EAAQ,KAAK,MAAO,KAAK,QAAQ,CAClD,CAMA,MAAMtE,EAAO,CACX,OAAO,KAAK,QAAQA,CAAK,CAC3B,CACF,EAQayE,GAAN,cAA+BJ,EAAY,CAChD,YAAY/D,EAAS,CACnB,MAAMA,EAASoE,EAAY,CAC7B,CACF,EAOaC,GAAN,cAAiClE,CAAW,CAIjD,MAAMT,EAAO,CACX,GAAM,CAAE,CAAE,OAAQ4E,CAAK,EAAGhB,CAAK,EAAI,KAAK,SACxC,OAAOA,EAAK,GACViB,EAAmCD,EAAO5E,CAAK,CACjD,CACF,CACF,EAOa8E,GAAN,cAA8BrE,CAAW,CAQ9C,cAAcsE,EAAY,CACxB,YAAK,WAAaA,EAClB,KAAK,MAAQA,EAAW,MAAM,EACvB,IACT,CAKA,MAAM/E,EAAO,CACX,OAAO,KAAK,MAAM,KAAK,IAAIA,CAAK,CAAC,CACnC,CAMA,IAAIA,EAAO,CACT,OAA8B,KAAK,OAAOA,CAAK,CACjD,CACF,EAMMgF,GAAN,cAAwBvE,CAAW,CAWjC,YAAY,CAAE,KAAAwE,EAAM,GAAG3E,CAAQ,EAAG,CAChC,MAAMA,CAAO,EACb,KAAK,KAAO2E,CACd,CAOA,KAAKjF,EAAO,CACV,GAAM,CAAE,OAAAJ,EAAQ,KAAAqF,CAAK,EAAI,KACnBf,EAASlE,GAAS,EACpBE,EAAQgE,EAAS,EACjBgB,EAAiCtF,EAC/BJ,EAAS+C,EAAU2C,EAAKhB,CAAM,EACpC,OAAI1E,EAAS,KAEXU,EAAQqC,EAAU2C,EAAKhB,EAAS,EAAE,EAClCgB,EAAMD,EAAK1C,EAAU2C,EAAKhB,EAAS,CAAC,CAAC,GAEhCgB,EAAI,SAAShF,EAAOA,EAAQV,CAAM,CAC3C,CACF,EAOa2F,GAAN,cAA8BH,EAAU,CAI7C,MAAMhF,EAAO,CACX,OAAO,KAAK,KAAKA,CAAK,CACxB,CACF,EAMaoF,GAAN,cAA4BJ,EAAU,CAI3C,MAAMhF,EAAO,CACX,OAAO8C,GAAW,KAAK,KAAK9C,CAAK,CAAC,CACpC,CACF,EC92BO,SAASqF,GAAcC,EAAM,CAClC,IAAIC,EAAO,CAAC,EACZ,MAAO,CACL,IAAIC,EAAO,CAAE,OAAAD,EAAK,KAAKC,CAAK,EAAU,IAAM,EAC5C,MAAO,IAAMD,EAAO,CAAC,EACrB,KAAM,IAAM,IAAIE,EAAOF,EAAMD,CAAI,CACnC,CACF,CAUO,IAAMG,EAAN,KAAa,CAOlB,YAAYF,EAAMD,GAAOI,MAAAH,EAAK,CAAC,IAAN,YAAAG,EAAS,QAAM,CAMtC,KAAK,KAAOJ,EAMZ,KAAK,OAASC,EAAK,OAAO,CAACI,EAAG,IAAMA,EAAI,EAAE,OAAQ,CAAC,EAMnD,KAAK,UAAYJ,EAAK,OAAO,CAACI,EAAG,IAAMA,EAAI,EAAE,UAAW,CAAC,EAMzD,KAAK,KAAOJ,EAEZ,IAAMK,EAAIL,EAAK,OACTM,EAAU,IAAI,WAAWD,EAAI,CAAC,EACpC,GAAIA,IAAM,EAAG,CACX,GAAM,CAAEJ,CAAM,EAAID,EAClBM,EAAQ,CAAC,EAAIL,EAAM,OAEnB,KAAK,GAAKM,GAASN,EAAM,GAAGM,CAAK,CACnC,KACE,SAAS,EAAI,EAAGC,EAAI,EAAG,EAAIH,EAAG,EAAE,EAC9BC,EAAQ,EAAI,CAAC,EAAKE,GAAKR,EAAK,CAAC,EAAE,OAUnC,KAAK,QAAUM,CACjB,CAKA,IAAK,OAAO,WAAW,GAAI,CACzB,MAAO,QACT,CAMA,CAAC,OAAO,QAAQ,GAAI,CAClB,IAAMN,EAAO,KAAK,KAClB,OAAOA,EAAK,SAAW,EACnBA,EAAK,CAAC,EAAE,OAAO,QAAQ,EAAE,EACzBS,GAAgBT,CAAI,CAC1B,CAYA,GAAGO,EAAO,CA9GZ,IAAAJ,EAiHI,GAAM,CAAE,KAAAH,EAAM,QAAAM,CAAQ,EAAI,KACpBI,EAAIC,EAAOL,EAASC,CAAK,EAAI,EACnC,OAAOJ,EAAAH,EAAKU,CAAC,IAAN,YAAAP,EAAS,GAAGI,EAAQD,EAAQI,CAAC,EACtC,CAQA,IAAIH,EAAO,CACT,OAAO,KAAK,GAAGA,CAAK,CACtB,CAOA,SAAU,CArIZ,IAAAJ,EAsII,GAAM,CAAE,OAAAS,EAAQ,UAAAC,EAAW,KAAAb,CAAK,EAAI,KAC9Bc,EAAO,CAACD,GAAaE,GAAcf,EAAK,CAAC,CAAC,EAC1CK,EAAIL,EAAK,OAEf,GAAIc,GAAQT,IAAM,EAGhB,OAAOL,EAAK,CAAC,EAAE,OAIjB,IAAMgB,EAAY,CAACX,GAAKQ,EAAY,EAAI,OAEnCV,EAAAH,EAAK,CAAC,EAAE,YAAY,YAApB,KAAAG,EAAiCH,EAAK,CAAC,EAAE,OAAO,YAE/CiB,EAAQ,IAAID,EAAUJ,CAAM,EAClC,OAAOE,EAAOI,GAAUD,EAAOjB,CAAI,EAAImB,GAAaF,EAAOjB,CAAI,CACjE,CAMA,OAAQ,CA7JV,IAAAG,EA8JI,OAAOA,EAAA,KAAK,SAAL,KAAAA,EAAgB,KAAK,OAAS,KAAK,QAAQ,CACpD,CACF,EAEA,SAAUM,GAAgBT,EAAM,CAC9B,QAASU,EAAI,EAAGA,EAAIV,EAAK,OAAQ,EAAEU,EAAG,CACpC,IAAMU,EAAOpB,EAAKU,CAAC,EAAE,OAAO,QAAQ,EAAE,EACtC,QAASW,EAAOD,EAAK,KAAK,EAAG,CAACC,EAAK,KAAMA,EAAOD,EAAK,KAAK,EACxD,MAAMC,EAAK,KAEf,CACF,CAEA,SAASH,GAAUD,EAAOjB,EAAM,CAC9B,QAASU,EAAI,EAAGY,EAAS,EAAGZ,EAAIV,EAAK,OAAQ,EAAEU,EAAG,CAChD,GAAM,CAAE,OAAAa,CAAO,EAAIvB,EAAKU,CAAC,EACzBO,EAAM,IAAIM,EAAQD,CAAM,EACxBA,GAAUC,EAAO,MACnB,CACA,OAAON,CACT,CAEA,SAASE,GAAaF,EAAOjB,EAAM,CACjC,IAAIO,EAAQ,GACZ,QAASG,EAAI,EAAGA,EAAIV,EAAK,OAAQ,EAAEU,EAAG,CACpC,IAAMT,EAAQD,EAAKU,CAAC,EACpB,QAASc,EAAI,EAAGA,EAAIvB,EAAM,OAAQ,EAAEuB,EAClCP,EAAM,EAAEV,CAAK,EAAIN,EAAM,GAAGuB,CAAC,CAE/B,CACA,OAAOP,CACT,CC9KO,IAAMQ,GAAN,MAAMC,CAAM,CAQjB,YAAYC,EAAQC,EAAUC,EAAW,GAAO,CAC9C,IAAMC,EAAQH,EAAO,OAAO,IAAII,GAAKA,EAAE,IAAI,EAM3C,KAAK,OAASJ,EAKd,KAAK,MAAQG,EAKb,KAAK,SAAWF,EAKhB,KAAK,QAAUC,EAAWG,GAAeC,GAGzC,IAAMC,EAAM,CAAC,EASb,KAAK,WAAaC,GAAE,CAzDxB,IAAAC,EAyD2B,OAAAA,EAAAF,EAAIC,CAAC,IAAL,KAAAC,EACjBF,EAAIC,CAAC,EAAI,KAAK,QAAQL,EAAOF,EAAS,IAAIS,GAAKA,EAAE,KAAKF,CAAC,CAAC,CAAC,EACjE,CAKA,IAAK,OAAO,WAAW,GAAI,CACzB,MAAO,OACT,CAMA,IAAI,SAAU,CACZ,OAAO,KAAK,MAAM,MACpB,CAMA,IAAI,SAAU,CAhFhB,IAAAC,EAAAE,EAiFI,OAAOA,GAAAF,EAAA,KAAK,SAAS,CAAC,IAAf,YAAAA,EAAkB,SAAlB,KAAAE,EAA4B,CACrC,CAQA,WAAWC,EAAO,CAChB,OAAO,KAAK,SAASA,CAAK,CAC5B,CAQA,SAASC,EAAM,CACb,IAAMC,EAAI,KAAK,MAAM,UAAUC,GAAKA,IAAMF,CAAI,EAC9C,OAAOC,EAAI,GAAK,KAAK,SAASA,CAAC,EAAI,MACrC,CAUA,SAASE,EAASC,EAAK,CAAC,EAAG,CACzB,GAAM,CAAE,SAAAhB,EAAU,QAAAiB,EAAS,OAAAlB,CAAO,EAAI,KAChC,CAAE,OAAAmB,CAAO,EAAInB,EACnB,OAAO,IAAID,EACT,CACE,GAAGC,EACH,OAAQgB,EAAQ,IAAI,CAACF,EAAGM,IAAMC,GAAYF,EAAOL,CAAC,EAAGG,EAAGG,CAAC,CAAC,CAAC,CAC7D,EACAJ,EAAQ,IAAIF,GAAKb,EAASa,CAAC,CAAC,EAC5BI,IAAYb,EACd,CACF,CAWA,OAAOF,EAAOc,EAAI,CAChB,IAAMK,EAAyB,KAAK,MAC9BN,EAAUb,EAAM,IAAIU,GAAQS,EAAI,QAAQT,CAAI,CAAC,EACnD,OAAO,KAAK,SAASG,EAASC,CAAE,CAClC,CAMA,WAAY,CACV,GAAM,CAAE,SAAAhB,EAAU,MAAAE,CAAM,EAAI,KAGtBoB,EAAO,CAAC,EACd,OAAApB,EAAM,QAAQ,CAACU,EAAMC,IAAG,CAtJ5B,IAAAL,EAAAE,EAsJ+B,OAAAY,EAAKV,CAAI,GAAIF,GAAAF,EAAAR,EAASa,CAAC,IAAV,YAAAL,EAAa,YAAb,KAAAE,EAA0B,CAAC,EAAE,EAC9DY,CACT,CAMA,SAAU,CA9JZ,IAAAd,EAAAE,EA+JI,GAAM,CAAE,SAAAV,EAAU,WAAAuB,EAAY,QAAAC,CAAQ,EAAI,KACpCC,GAAOf,GAAAF,EAAAR,EAAS,CAAC,IAAV,YAAAQ,EAAa,OAAb,KAAAE,EAAqB,CAAC,EAC7BgB,EAAS,MAAMF,CAAO,EAC5B,QAASjB,EAAI,EAAGoB,EAAM,GAAIpB,EAAIkB,EAAK,OAAQ,EAAElB,EAAG,CAC9C,IAAMJ,EAAIoB,EAAWhB,CAAC,EACtB,QAASM,EAAI,EAAGA,EAAIY,EAAKlB,CAAC,EAAE,OAAQ,EAAEM,EACpCa,EAAO,EAAEC,CAAG,EAAIxB,EAAEU,CAAC,CAEvB,CACA,OAAOa,CACT,CAMA,EAAE,OAAO,QAAQ,GAAI,CA/KvB,IAAAlB,EAAAE,EAgLI,GAAM,CAAE,SAAAV,EAAU,WAAAuB,CAAW,EAAI,KAC3BE,GAAOf,GAAAF,EAAAR,EAAS,CAAC,IAAV,YAAAQ,EAAa,OAAb,KAAAE,EAAqB,CAAC,EACnC,QAASH,EAAI,EAAGA,EAAIkB,EAAK,OAAQ,EAAElB,EAAG,CACpC,IAAMJ,EAAIoB,EAAWhB,CAAC,EACtB,QAASM,EAAI,EAAGA,EAAIY,EAAKlB,CAAC,EAAE,OAAQ,EAAEM,EACpC,MAAMV,EAAEU,CAAC,CAEb,CACF,CAOA,GAAGF,EAAO,CACR,GAAM,CAAE,SAAAX,EAAU,WAAAuB,EAAY,QAAAC,CAAQ,EAAI,KAC1C,GAAIb,EAAQ,GAAKA,GAASa,EAAS,OAAO,KAC1C,GAAM,CAAC,CAAE,QAAAI,CAAQ,CAAC,EAAI5B,EAChBO,EAAIsB,EAAOD,EAASjB,CAAK,EAAI,EACnC,OAAOY,EAAWhB,CAAC,EAAEI,EAAQiB,EAAQrB,CAAC,CAAC,CACzC,CAQA,IAAII,EAAO,CACT,OAAO,KAAK,GAAGA,CAAK,CACtB,CACF,EAEA,SAASS,GAAYU,EAAOlB,EAAM,CAChC,OAAQA,GAAQ,MAAQA,IAASkB,EAAM,KACnC,CAAE,GAAGA,EAAO,KAAAlB,CAAK,EACjBkB,CACN,CC1MO,SAASC,GAAUC,EAAMC,EAAU,CAAC,EAAG,CAC5C,GAAM,CAAE,OAAAC,EAAQ,SAAAC,EAAU,KAAAC,EAAM,UAAAC,EAAW,KAAAC,CAAK,EAAuBN,EACjE,CAAE,UAAAO,EAAW,QAAAC,EAAS,cAAAC,EAAe,OAAAC,EAAQ,SAAAC,CAAS,EAAIV,EAEhE,OAAQC,EAAQ,CACd,KAAKU,EAAK,KAAM,OAAOC,GACvB,KAAKD,EAAK,KAAM,OAAOE,GACvB,KAAKF,EAAK,IACV,KAAKA,EAAK,KACV,KAAKA,EAAK,SACR,OAAOL,GAAaJ,EAAW,GAAKY,EAAcC,EACpD,KAAKJ,EAAK,MACR,OAAOP,EAAYU,EAAcE,GACnC,KAAKL,EAAK,KACR,OAAOM,GACLZ,IAASa,EAAS,IAAMC,GAAeC,GACvCb,GAAWc,EACb,EACF,KAAKV,EAAK,UACR,OAAOM,GACLZ,IAASiB,EAAS,OAASC,GACvBlB,IAASiB,EAAS,YAAcE,GAChCnB,IAASiB,EAAS,YAAcG,GAChCC,GACJnB,GAAWc,EACb,EACF,KAAKV,EAAK,QACR,OAAOT,IAAa,GACfM,EAAgBM,EAAca,GAC9BnB,EAAgBoB,GAAqBC,GAC5C,KAAKlB,EAAK,SACR,OAAON,IAASyB,EAAa,SAAWC,GACpC1B,IAASyB,EAAa,WAAahB,EACnCkB,GACN,KAAKrB,EAAK,gBAAiB,OAAOsB,GAClC,KAAKtB,EAAK,KAAM,OAAOuB,GACvB,KAAKvB,EAAK,UAAW,OAAOwB,GAC5B,KAAKxB,EAAK,OAAQ,OAAOyB,GACzB,KAAKzB,EAAK,YAAa,OAAO0B,GAC9B,KAAK1B,EAAK,WAAY,OAAO2B,GAC7B,KAAK3B,EAAK,SAAU,OAAO4B,GAC3B,KAAK5B,EAAK,KAAM,OAAO6B,GACvB,KAAK7B,EAAK,UAAW,OAAO8B,GAC5B,KAAK9B,EAAK,IAAK,OAAOF,EAASiC,GAAWC,GAC1C,KAAKhC,EAAK,SAAU,OAAOiC,GAC3B,KAAKjC,EAAK,cAAe,OAAOkC,GAChC,KAAKlC,EAAK,cAAe,OAAOmC,GAChC,KAAKnC,EAAK,OAAQ,OAAOD,EAAWqC,GAAmBC,GACvD,KAAKrC,EAAK,cAAe,OAAOsC,GAChC,KAAKtC,EAAK,WAAY,OAAOuC,GAC7B,KAAKvC,EAAK,MAAO,OAAOR,EAAOgD,GAAkBC,EACnD,CACA,MAAM,IAAI,MAAMC,EAAgBpD,CAAM,CAAC,CACzC,CAEA,SAASgB,GAAKqC,EAAWC,EAAc,CACrC,OAAOA,EACH,cAAwBA,CAAa,CACnC,YAAYvD,EAAS,CACnB,MAAM,IAAIsD,EAAUtD,CAAO,CAAC,CAC9B,CACF,EACAsD,CACN,CCnEO,SAASE,GAAYC,EAAKC,EAAO,CAItC,MAAO,CACL,OAAQC,EAAUF,EAAKC,CAAK,EAC5B,eAAgBE,EAAUH,EAAKC,EAAQ,CAAC,EACxC,WAAYC,EAAUF,EAAKC,EAAQ,EAAE,CACvC,CACF,CAQO,SAASG,GAAaJ,EAAKC,EAAO,CACvC,OAAOI,EAAWL,EAAKC,EAAO,GAAIF,EAAW,CAC/C,CCdO,SAASO,GAAkBC,EAAKC,EAAOC,EAAS,CAMrD,IAAMC,EAAMC,EAAWJ,EAAKC,CAAK,EACjC,GAAIE,EAAI,GAAIE,EAAY,CAAC,EACvB,MAAM,IAAI,MAAM,0CAA0C,EAK5D,IAAMC,EAASJ,EAAUK,EAAQ,GAAK,EAAI,EAE1C,MAAO,CACL,OAAQJ,EAAI,EAAGK,EAAW,CAAC,EAC3B,MAAOC,EAAWT,EAAKG,EAAI,EAAGE,CAAU,EAAG,GAAI,CAACL,EAAKU,KAAS,CAC5D,OAAQF,EAAUR,EAAKU,CAAG,EAC1B,UAAWF,EAAUR,EAAKU,EAAM,CAAC,CACnC,EAAE,EACF,QAASD,EAAWT,EAAKG,EAAI,EAAGE,CAAU,EAAG,GAAKC,EAAQ,CAACN,EAAKU,KAAS,CACvE,OAAQF,EAAUR,EAAKU,EAAMJ,CAAM,EACnC,OAAQE,EAAUR,EAAKU,EAAMJ,EAAS,CAAC,CACzC,EAAE,EACF,SAAUG,EAAWT,EAAKG,EAAI,GAAIE,CAAU,EAAG,EAAGG,CAAS,CAC7D,CACF,CC3BO,SAASG,GAAsBC,EAAKC,EAAOC,EAAS,CAIzD,IAAMC,EAAMC,EAAWJ,EAAKC,CAAK,EACjC,MAAO,CACL,GAAIE,EAAI,EAAGE,EAAW,CAAC,EACvB,KAAMF,EAAI,EAAG,CAACH,EAAKM,IAAQC,GAAkBP,EAAKM,EAAKJ,CAAO,CAAC,EAM/D,QAASC,EAAI,EAAGK,EAAa,EAAK,CACpC,CACF,CCZO,SAASC,GAAeC,EAAKC,EAAOC,EAAQC,EAAU,CAC3DC,EAAWF,EAAQG,EAAMC,CAAe,EACxC,IAAMC,EAAMC,EAAWR,EAAKC,CAAK,EAEjC,OAAQC,EAAQ,CAEd,KAAKG,EAAK,OAAQ,OAAOI,GAAO,EAChC,KAAKJ,EAAK,KAAM,OAAOK,GAAK,EAC5B,KAAKL,EAAK,YAAa,OAAOM,GAAY,EAC1C,KAAKN,EAAK,UAAW,OAAOO,GAAU,EACtC,KAAKP,EAAK,KAAM,OAAOQ,GAAKV,EAAS,CAAC,CAAC,EACvC,KAAKE,EAAK,SAAU,OAAOS,GAASX,EAAS,CAAC,CAAC,EAC/C,KAAKE,EAAK,UAAW,OAAOU,GAAUZ,EAAS,CAAC,CAAC,EACjD,KAAKE,EAAK,cAAe,OAAOW,GAAcb,EAAS,CAAC,CAAC,EACzD,KAAKE,EAAK,OAAQ,OAAOY,GAAOd,CAAQ,EACxC,KAAKE,EAAK,cAAe,OAAOa,GAAcf,EAAS,CAAC,EAAGA,EAAS,CAAC,CAAC,EAGtE,KAAKE,EAAK,IAAK,OAAOc,GAEpBZ,EAAI,EAAGa,EAAW,CAAC,EACnBb,EAAI,EAAGc,EAAa,EAAK,CAC3B,EACA,KAAKhB,EAAK,MAAO,OAAOiB,GAEtBf,EAAI,EAAGgB,EAAWC,EAAU,IAAI,CAClC,EACA,KAAKnB,EAAK,QAAS,OAAOoB,GACxBlB,EAAI,EAAGa,EAAW,CAAC,EACnBb,EAAI,EAAGa,EAAW,CAAC,EAEnBb,EAAI,EAAGa,EAAW,GAAG,CACvB,EACA,KAAKf,EAAK,KAAM,OAAOqB,GAErBnB,EAAI,EAAGgB,EAAWI,EAAS,WAAW,CACxC,EACA,KAAKtB,EAAK,KAAM,OAAOuB,GAErBrB,EAAI,EAAGgB,EAAWM,EAAS,WAAW,CACxC,EACA,KAAKxB,EAAK,UAAW,OAAOyB,GAE1BvB,EAAI,EAAGgB,EAAWM,EAAS,MAAM,EACjCtB,EAAI,EAAGwB,CAAU,CACnB,EACA,KAAK1B,EAAK,SAAU,OAAO2B,GAEzBzB,EAAI,EAAGgB,EAAWU,EAAa,UAAU,CAC3C,EACA,KAAK5B,EAAK,SAAU,OAAO6B,GAEzB3B,EAAI,EAAGgB,EAAWM,EAAS,WAAW,CACxC,EAEA,KAAKxB,EAAK,gBAAiB,OAAO8B,GAChC5B,EAAI,EAAGa,EAAW,CAAC,CACrB,EACA,KAAKf,EAAK,cAAe,OAAO+B,GAC9BjC,EAAS,CAAC,EACVI,EAAI,EAAGa,EAAW,CAAC,CACrB,EACA,KAAKf,EAAK,IAAK,OAAOgC,GACpB9B,EAAI,EAAGc,EAAa,EAAK,EACzBlB,EAAS,CAAC,CACZ,EAEA,KAAKE,EAAK,MAAO,OAAOiC,GAEtB/B,EAAI,EAAGgB,EAAWgB,EAAU,MAAM,EAClCpC,EACAqC,EAAWxC,EAAKO,EAAI,EAAGkC,CAAU,EAAG,EAAGrB,CAAS,CAClD,CACF,CAOA,MAAO,CAAE,OAAAlB,CAAO,CAClB,CCtFO,SAASwC,GAAeC,EAAKC,EAAO,CACzC,IAAMC,EAAUC,EAAWH,EAAKC,EAAO,EAAG,CAACD,EAAKI,IAAQ,CACtD,IAAMC,EAAMC,EAAWN,EAAKI,CAAG,EAC/B,MAAwC,CACtCC,EAAI,EAAGE,CAAU,EACjBF,EAAI,EAAGE,CAAU,CACnB,CACF,CAAC,EACD,OAAOL,EAAQ,OAAS,IAAI,IAAIA,CAAO,EAAI,IAC7C,CCJO,SAASM,GAAaC,EAAKC,EAAOC,EAAS,CAKhD,IAAMC,EAAMC,EAAWJ,EAAKC,CAAK,EACjC,MAAO,CACL,QAAAC,EACA,WAAwCC,EAAI,EAAGE,EAAW,CAAC,EAC3D,OAAQF,EAAI,EAAGG,GAAoB,CAAC,CAAC,EACrC,SAAUH,EAAI,EAAGI,EAAc,CACjC,CACF,CAKA,SAASD,GAAmBN,EAAKQ,EAAc,CAC7C,OAAOC,EAAWT,EAAKQ,EAAc,EAAGE,EAAW,CACrD,CAKA,SAASA,GAAYV,EAAKC,EAAO,CAQ/B,IAAME,EAAMC,EAAWJ,EAAKC,CAAK,EAC3BU,EAASR,EAAI,EAAGS,GAAWC,EAAK,IAAI,EACpCC,EAAaX,EAAI,GAAIY,EAAY,CAAC,EAClCC,EAAOb,EAAI,GAAIc,EAAgB,EAC/BC,EAAWf,EAAI,GAAI,CAACH,EAAKmB,IAAQC,GAAoBpB,EAAKmB,CAAG,CAAC,EAEhEE,EAAOC,GAAetB,EAAKc,EAAYH,EAAQO,CAAQ,EAC3D,OAAIF,IACFA,EAAK,WAAaK,EAClBA,EAAOL,GAGF,CACL,KAAMb,EAAI,EAAGoB,CAAU,EACvB,KAAAF,EACA,SAAUlB,EAAI,EAAGqB,EAAa,EAAK,EACnC,SAAUrB,EAAI,GAAII,EAAc,CAClC,CACF,CAKA,SAASa,GAAoBpB,EAAKyB,EAAa,CAC7C,IAAMP,EAAWT,EAAWT,EAAKyB,EAAa,EAAGf,EAAW,EAC5D,OAAOQ,EAAS,OAASA,EAAW,IACtC,CAOA,SAASD,GAAiBjB,EAAKC,EAAO,CACpC,GAAI,CAACA,EAAO,OAAO,KAKnB,IAAME,EAAMC,EAAWJ,EAAKC,CAAK,EACjC,OAAOyB,GACL,KACAvB,EAAI,EAAGwB,GAAWC,GAAM,CAAC,EACzBzB,EAAI,EAAGqB,EAAa,EAAK,EACzBrB,EAAI,EAAG0B,EAAW,CAAC,CACrB,CACF,CAQA,SAASF,GAAU3B,EAAKC,EAAO,CAC7B,OACEqB,GAAetB,EAAKC,EAAOY,EAAK,GAAG,CAEvC,CChGA,IAAMiB,GAAyB,CAACC,EAAUC,IACxC,oBAAoBD,CAAQ,kCAAkCC,CAAM,IAEhEC,GAA2B,CAACF,EAAUC,IAC1C,oBAAoBD,CAAQ,0CAA0CC,CAAM,IAExEE,GAAsBC,GAC1B,6BAA6BA,CAAI,KAAKC,GAAOC,EAAeF,CAAI,CAAC,IAU5D,SAASG,GAAcC,EAAKC,EAAO,CAExC,IAAIC,EAAiBC,EAAUH,EAAKC,CAAK,GAAK,EAU9C,GATAA,GAASG,EAKLF,IAAmB,KACrBA,EAAiBC,EAAUH,EAAKC,CAAK,GAAK,EAC1CA,GAASG,GAEPF,IAAmB,EAAG,OAAO,KAEjC,IAAMG,EAAOL,EAAI,SAASC,EAAOA,GAASC,CAAc,EACxD,GAAIG,EAAK,WAAaH,EACpB,MAAM,IAAI,MAAMX,GAAuBW,EAAgBG,EAAK,UAAU,CAAC,EAQzE,IAAMC,EAAMC,EAAWF,EAAM,CAAC,EACxBG,EACHF,EAAI,EAAGG,EAAWC,EAAQ,EAAE,EACzBd,EACHU,EAAI,EAAGK,GAAWb,EAAc,IAAI,EACjCc,EAASN,EAAI,EAAGO,EAAY,CAAC,EAC7BC,EAAaR,EAAI,GAAIS,EAAW,CAAC,EACnCC,EAEJ,GAAIJ,EAAQ,CAEV,IAAMK,EAAUrB,IAASE,EAAc,OAASoB,GAC5CtB,IAASE,EAAc,gBAAkBqB,GACzCvB,IAASE,EAAc,YAAcsB,GACrC,KACJ,GAAI,CAACH,EAAS,MAAM,IAAI,MAAMtB,GAAmBC,CAAI,CAAC,EAItD,GAHAoB,EAAUC,EAAQZ,EAAMO,EAAQJ,CAAO,EAGnCM,EAAa,EAAG,CAClB,IAAMO,EAAOrB,EAAI,SAASC,EAAOA,GAASa,CAAU,EACpD,GAAIO,EAAK,WAAaP,EACpB,MAAM,IAAI,MAAMpB,GAAyBoB,EAAYO,EAAK,UAAU,CAAC,EAGvEL,EAAQ,KAAOK,CACjB,MAAWzB,IAASE,EAAc,SAGhCkB,EAAQ,KAAO,IAAI,WAAW,CAAC,EAEnC,CAEA,MAAO,CAAE,QAAAR,EAAS,KAAAZ,EAAM,MAAAK,EAAO,QAAAe,CAAQ,CACzC,CC1DO,SAASM,GAAUC,EAAM,CAC9B,IAAMC,EAASC,GAAkBF,CAAI,EAAI,IAAI,WAAWA,CAAI,EAAIA,EAChE,OAAOC,aAAkB,YAAcE,GAAkBF,CAAM,EAC3DG,GAAcH,CAAM,EACpBI,GAAgBJ,CAAM,CAC5B,CAMA,SAASE,GAAkBG,EAAK,CAC9B,GAAI,CAACA,GAAOA,EAAI,OAAS,EAAG,MAAO,GACnC,QAASC,EAAI,EAAGA,EAAI,EAAG,EAAEA,EACvB,GAAIC,GAAMD,CAAC,IAAMD,EAAIC,CAAC,EAAG,MAAO,GAElC,MAAO,EACT,CAWO,SAASF,GAAgBL,EAAM,CACpC,IAAMS,EAAS,CAACT,CAAI,EAAE,KAAK,EAEvBU,EACEC,EAAU,CAAC,EACXC,EAAe,CAAC,EAGtB,QAAWN,KAAOG,EAAQ,CACxB,GAAI,EAAEH,aAAe,YACnB,MAAM,IAAI,MAAM,sCAAsC,EAExD,IAAIO,EAAS,EAGb,OAAa,CACX,IAAMC,EAAIC,GAAcT,EAAKO,CAAM,EACnC,GAAIC,IAAM,KAAM,MAEhB,GADAD,EAASC,EAAE,MACP,EAACA,EAAE,QACP,OAAQA,EAAE,KAAM,CACd,KAAKE,EAAc,OAEZN,IAAQA,EAASI,EAAE,SACxB,MACF,KAAKE,EAAc,YACjBL,EAAQ,KAAKG,EAAE,OAAO,EACtB,MACF,KAAKE,EAAc,gBACjBJ,EAAa,KAAKE,EAAE,OAAO,EAC3B,KACJ,CACF,CACF,CAEA,MACE,CAAE,OAAAJ,EAAQ,aAAAE,EAAc,QAAAD,EAAS,SAAU,IAAK,CAEpD,CASO,SAASP,GAAcJ,EAAM,CAElC,IAAMa,EAASb,EAAK,YAAcQ,GAAM,OAAS,GAC3CS,EAASC,EAAUlB,EAAMa,CAAM,EAQ/BM,EAAMC,EAAWpB,EAAMa,EAASI,CAAM,EACtCI,EACHF,EAAI,EAAGG,EAAWC,EAAQ,EAAE,EACzBC,EAAQL,EAAI,EAAGM,GAAc,CAAC,CAAC,EAC/BC,EAAOP,EAAI,GAAIM,GAAc,CAAC,CAAC,EAErC,MAAiC,CAC/B,OAAQN,EAAI,EAAG,CAACb,EAAKqB,IAAUC,GAAatB,EAAKqB,EAAON,CAAO,CAAC,EAChE,aAAcG,EAAM,IAAI,CAAC,CAAE,OAAAX,CAAO,IAAME,GAAcf,EAAMa,CAAM,EAAE,OAAO,EAC3E,QAASa,EAAK,IAAI,CAAC,CAAE,OAAAb,CAAO,IAAME,GAAcf,EAAMa,CAAM,EAAE,OAAO,EACrE,SAAUM,EAAI,GAAIU,EAAc,CAClC,CACF,CClGO,SAASC,GAAaC,EAAMC,EAAS,CAC1C,OAAOC,GAAYC,GAAUH,CAAI,EAAGC,CAAO,CAC7C,CAWO,SAASC,GAAYF,EAAMC,EAAU,CAAC,EAAG,CAC9C,GAAM,CAAE,OAAAG,EAAS,CAAE,OAAQ,CAAC,CAAE,EAAG,aAAAC,EAAc,QAAAC,CAAQ,EAAIN,EACrD,CAAE,QAAAO,EAAS,OAAAC,CAAO,EAAIJ,EACtBK,EAAgB,IAAI,IACpBC,EAAUC,GAAiBV,EAASM,EAASE,CAAa,EAG1DG,EAAkB,IAAI,IAC5BC,GAAkBT,EAAQU,GAAS,CACjC,IAAMC,EAAOD,EAAM,KACfC,EAAK,SAAWC,EAAK,YACvBJ,EAAgB,IAAIG,EAAK,GAAIA,EAAK,UAAU,CAEhD,CAAC,EAGD,IAAME,EAAQ,IAAI,IAClB,QAAWC,KAAQb,EAAc,CAC/B,GAAM,CAAE,GAAAc,EAAI,KAAAnB,EAAM,QAAAoB,EAAS,KAAAC,EAAK,EAAIH,EAC9BH,GAAOH,EAAgB,IAAIO,CAAE,EAC7BG,GAAQC,GAAMR,GAAML,EAAQ,CAAE,GAAGV,EAAM,KAAAqB,EAAK,CAAC,CAAC,EACpD,GAAKJ,EAAM,IAAIE,CAAE,EAKV,CACL,IAAMD,GAAOD,EAAM,IAAIE,CAAE,EACpBC,GAASF,GAAK,MAAM,EACzBA,GAAK,IAAII,EAAK,CAChB,KAToB,CAClB,GAAIF,EACF,MAAM,IAAI,MAAM,iDAAiD,EAEnEH,EAAM,IAAIE,EAAIK,GAAcT,EAAI,EAAE,IAAIO,EAAK,CAAC,CAC9C,CAKF,CACAL,EAAM,QAAQ,CAACQ,EAAOC,IAAQjB,EAAc,IAAIiB,EAAKD,EAAM,KAAK,CAAC,CAAC,EAGlE,IAAME,EAAOnB,EAAO,IAAIoB,GAAKJ,GAAcI,EAAE,IAAI,CAAC,EAClD,QAAWN,KAAShB,EAAS,CAC3B,IAAMuB,EAAMnB,EAAQY,CAAK,EACzBd,EAAO,QAAQ,CAACoB,EAAGE,IAAMH,EAAKG,CAAC,EAAE,IAAIP,GAAMK,EAAE,KAAMC,CAAG,CAAC,CAAC,CAC1D,CAEA,OAAO,IAAIE,GAAM3B,EAAQuB,EAAK,IAAIK,GAAKA,EAAE,KAAK,CAAC,EAAG/B,EAAQ,QAAQ,CACpE,CAOA,SAASY,GAAkBT,EAAQ6B,EAAS,CAC1C7B,EAAO,OAAO,QAAQ,SAAS8B,EAAWpB,EAAO,CA1FnD,IAAAqB,EAAAC,EAAAC,EA2FIJ,EAAQnB,CAAK,GAEbsB,GAAAD,EAAArB,EAAM,KAAK,aAAX,YAAAqB,EAAuB,WAAvB,MAAAC,EAAiC,QAAQF,IAEzCG,EAAAvB,EAAM,KAAK,WAAX,MAAAuB,EAAqB,QAAQH,EAC/B,CAAC,CACH,CAKA,SAASvB,GAAiBV,EAASM,EAASE,EAAe,CACzD,IAAM6B,EAAO,CACX,QAAA/B,EACA,QAAAN,EACA,WAAYkB,GAAMV,EAAc,IAAIU,CAAE,CACxC,EAMA,OAAOG,GAAS,CACd,GAAM,CAAE,OAAAiB,EAAQ,MAAAC,EAAO,QAAAC,EAAS,SAAAC,EAAU,KAAArB,CAAK,EAAIC,EAC/CqB,EAAY,GACZC,EAAc,GACdC,EAAgB,GACpB,MAAO,CACL,GAAGP,EACH,OAAAC,EACA,KAAM,IAAMC,EAAM,EAAEG,CAAS,EAC7B,OAASG,GAAc,CACrB,GAAM,CAAE,OAAAP,EAAQ,OAAAQ,CAAO,EAAIN,EAAQ,EAAEG,CAAW,EAChD,OAAOE,EACH,IAAIA,EAAUzB,EAAK,OAAQA,EAAK,WAAa0B,EAAQR,EAASO,EAAU,iBAAiB,EACzFzB,EAAK,SAAS0B,EAAQA,EAASR,CAAM,CAC3C,EACA,SAAU,IAAMG,EAAS,EAAEG,CAAa,EACxC,MAAMG,EAAU,CAAE,OAAOA,EAAS,IAAIpB,GAAKL,GAAMK,EAAE,KAAM,IAAI,CAAC,CAAG,CACnE,CACF,CACF,CAKA,SAASL,GAAMR,EAAMc,EAAK,CACxB,GAAM,CAAE,OAAAoB,CAAO,EAAIlC,EACb,CAAE,QAAAd,EAAS,KAAAiD,EAAM,OAAAC,EAAQ,SAAAT,EAAU,QAAAnC,CAAQ,EAAIsB,EAC/CuB,EAAYC,GAAUtC,EAAMd,CAAO,EAGnCqC,EAAO,CAAE,GAAGY,EAAK,EAAG,KAAAnC,CAAK,EAE/B,GAAIkC,IAAWjC,EAAK,KAElB,OAAO,IAAIoC,EAAU,CAAE,GAAGd,EAAM,UAAWA,EAAK,MAAO,CAAC,EAG1D,OAAQW,EAAQ,CAEd,KAAKjC,EAAK,KACV,KAAKA,EAAK,IACV,KAAKA,EAAK,KACV,KAAKA,EAAK,SACV,KAAKA,EAAK,MACV,KAAKA,EAAK,QACV,KAAKA,EAAK,KACV,KAAKA,EAAK,UACV,KAAKA,EAAK,SACV,KAAKA,EAAK,gBACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,OAAQA,EAAOpC,EAAK,MAAM,CAC5B,CAAC,EAGH,KAAKC,EAAK,KACV,KAAKA,EAAK,UACV,KAAKA,EAAK,OACV,KAAKA,EAAK,YACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,QAASA,EAAOpC,EAAK,OAAO,EAC5B,OAAQoC,EAAO,CACjB,CAAC,EAGH,KAAKnC,EAAK,WACV,KAAKA,EAAK,SACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,OAAQA,EAAO,EACf,KAAM,MAAM,KAAK,CAAE,OAAQT,EAAS,CAAE,EAAG,IAAMS,EAAO,CAAC,CACzD,CAAC,EAGH,KAAKnC,EAAK,KACV,KAAKA,EAAK,UACV,KAAKA,EAAK,IACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,QAASA,EAAOpC,EAAK,OAAO,EAC5B,SAAUc,EAAI,MAAMd,EAAK,QAAQ,CACnC,CAAC,EAGH,KAAKC,EAAK,SACV,KAAKA,EAAK,cACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,QAASA,EAAOpC,EAAK,OAAO,EAC5B,MAAOoC,EAAOpC,EAAK,OAAO,EAC1B,SAAUc,EAAI,MAAMd,EAAK,QAAQ,CACnC,CAAC,EAGH,KAAKC,EAAK,cACV,KAAKA,EAAK,OACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,SAAUtB,EAAI,MAAMd,EAAK,QAAQ,CACnC,CAAC,EAGH,KAAKC,EAAK,cACR,OAAO,IAAIoC,EAAU,CACnB,GAAGd,EACH,SAAUT,EAAI,MAAMd,EAAK,QAAQ,CACnC,CAAC,EAGH,KAAKC,EAAK,WAAY,CACpB,GAAM,CAAE,GAAAG,EAAI,QAAAmC,CAAQ,EAAIvC,EACxB,OAAO,IAAIqC,EAAU,CACnB,GAAGd,EACH,SAAUa,EAAO,EACjB,OAAQA,EAAOG,EAAQ,MAAM,CAC/B,CAAC,EAAE,cAAczB,EAAI,WAAWV,CAAE,CAAC,CACrC,CAGA,KAAKH,EAAK,MACR,OAAIT,EAAUgD,EAAQ,IACpBJ,EAAO,EAEF,IAAIC,EAAU,CACnB,GAAGd,EACH,QAASa,EAAOK,EAAS,EACzB,QAASzC,EAAK,OAAS0C,EAAU,OAAS,KAAON,EAAOpC,EAAK,OAAO,EACpE,SAAUc,EAAI,MAAMd,EAAK,QAAQ,CACnC,CAAC,EAIH,QACE,MAAM,IAAI,MAAM2C,EAAgBT,CAAM,CAAC,CAC3C,CACF,CCvPA,IAAMU,GAAiB,IAAI,YAAY,IAAI,WAAW,CAAC,EAAG,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,IAAM,ECFtE,IAAMC,GAAN,KAA4B,CAM/B,YAAYC,EAAuBC,EAAc,CAC7C,KAAK,UAAYD,EACjB,KAAK,MAAQC,CACjB,CAGA,IAAW,UAAwB,CAC/B,OAAO,KAAK,SAChB,CAGA,MAAa,OAAuB,CAChC,OAAO,KAAK,UAAU,WAAW,KAAK,KAAK,CAC/C,CAGO,UAAaC,EAAsD,CACtE,OAAOA,EAAS,KAAK,UAAW,KAAK,KAAK,CAC9C,CAKA,MAAa,MAAMC,EAA8B,CAC7C,KAAK,UAAU,OAAO,IAAI,CACtB,UAAW,IAAI,KACf,QACA,SACA,QACA,QACA,MAAOA,CACX,CAAC,EACD,IAAMC,EAAS,MAAM,KAAK,UAAU,SAAS,KAAK,MAAOD,CAAI,EAC7D,OAAOE,GAAaD,CAAM,CAC9B,CAMA,MAAa,KACTD,EACAG,EAA6B,GACK,CAClC,KAAK,UAAU,OAAO,IAAI,CACtB,UAAW,IAAI,KACf,QACA,SACA,QACA,QACA,MAAOH,CACX,CAAC,EACD,IAAII,EAAS,MAAM,KAAK,UAAU,kBAAkB,KAAK,MAAOJ,EAAMG,CAAiB,EACvF,KAAOC,GAAU,MAAM,CAEnB,GAAI,KAAK,UAAU,WAAW,EAAG,CAC7B,QAAQ,MAAM,oDAAoD,EAClE,MACJ,CACAA,EAAS,MAAM,KAAK,UAAU,iBAAiB,KAAK,KAAK,CAC7D,CACA,OAAO,IAAIC,GAA0B,KAAK,UAAW,KAAK,MAAOD,CAAM,CAC3E,CAGA,MAAa,YAA+B,CACxC,OAAO,MAAM,KAAK,UAAU,mBAAmB,KAAK,KAAK,CAC7D,CAGA,MAAa,cAAcE,EAAkC,CACzD,OAAO,MAAM,KAAK,UAAU,cAAc,KAAK,MAAOA,CAAK,CAC/D,CAGA,MAAa,QACTN,EAC+B,CAC/B,IAAMO,EAAO,MAAM,KAAK,UAAU,eAAe,KAAK,MAAOP,CAAI,EACjE,OAAO,IAAIQ,GAAuB,KAAK,UAAW,KAAK,MAAOD,CAAI,CACtE,CAGA,MAAa,yBAAyBN,EAAoBQ,EAA4C,CAClG,MAAM,KAAK,UAAU,yBAAyB,KAAK,MAAOR,EAAQQ,CAAO,CAC7E,CAEA,MAAa,kBAAkBT,EAAcS,EAA0C,CACnF,MAAM,KAAK,UAAU,kBAAkB,KAAK,MAAOT,EAAMS,CAAO,CACpE,CAEA,MAAa,mBAAmBT,EAAcS,EAA2C,CACrF,MAAM,KAAK,UAAU,mBAAmB,KAAK,MAAOT,EAAMS,CAAO,CACrE,CACJ,EAGaJ,GAAN,KAAqE,CAQxE,YACuBK,EACAZ,EACAM,EACrB,CAHqB,QAAAM,EACA,UAAAZ,EACA,YAAAM,EAEnB,KAAK,OAAS,GACd,KAAK,UAAY,GACjB,KAAK,UAAY,IACrB,CAEA,MAAM,MAA4C,CAC9C,GAAI,KAAK,OACL,YAAK,OAAS,GACP,CAAE,KAAM,GAAO,MAAO,KAAK,MAAO,EAE7C,GAAI,KAAK,UACL,MAAO,CAAE,KAAM,GAAM,MAAO,IAAK,EAErC,IAAIH,EAA4B,KAMhC,IALI,KAAK,WAAa,OAClBA,EAAS,MAAM,KAAK,UACpB,KAAK,UAAY,MAGdA,GAAU,MACbA,EAAS,MAAM,KAAK,GAAG,kBAAkB,KAAK,IAAI,EAGtD,YAAK,UAAYA,EAAO,QAAU,EAC7B,KAAK,YACN,KAAK,UAAY,KAAK,GAAG,kBAAkB,KAAK,IAAI,GAGjD,CACH,KAAM,KAAK,UACX,MAAOA,CACX,CACJ,CAEA,CAAC,OAAO,aAAa,GAAI,CACrB,OAAO,IACX,CACJ,EAGaO,GAAN,KAA6B,CAShC,YAAYX,EAAuBc,EAAsBC,EAAqB,CAC1E,KAAK,SAAWf,EAChB,KAAK,aAAec,EACpB,KAAK,YAAcC,CACvB,CAGA,MAAa,OAAQ,CACjB,MAAM,KAAK,SAAS,cAAc,KAAK,aAAc,KAAK,WAAW,CACzE,CAKA,MAAa,SAASC,EAA+B,CACjD,IAAMZ,EAAS,MAAM,KAAK,SAAS,YAAY,KAAK,aAAc,KAAK,YAAaY,CAAM,EAC1F,OAAOX,GAAaD,CAAM,CAC9B,CAMA,MAAa,QAAQY,EAAmD,CACpE,IAAMT,EAAS,MAAM,KAAK,SAAS,aAAa,KAAK,aAAc,KAAK,YAAaS,CAAM,EAC3F,OAAO,IAAIR,GAA0B,KAAK,SAAU,KAAK,aAAcD,CAAM,CACjF,CACJ,EC1LO,IAAKU,QACRA,EAAA,qBAAuB,uBACvBA,EAAA,eAAiB,iBACjBA,EAAA,wBAA0B,0BAC1BA,EAAA,wBAA0B,0BAC1BA,EAAA,QAAU,UACVA,EAAA,oBAAsB,sBACtBA,EAAA,kBAAoB,oBACpBA,EAAA,gBAAkB,kBAClBA,EAAA,WAAa,aACbA,EAAA,UAAY,YACZA,EAAA,WAAa,aACbA,EAAA,uBAAyB,yBACzBA,EAAA,oBAAsB,sBACtBA,EAAA,YAAc,cACdA,EAAA,kBAAoB,oBACpBA,EAAA,gBAAkB,kBAClBA,EAAA,YAAc,cACdA,EAAA,gBAAkB,kBAClBA,EAAA,6BAA+B,+BAC/BA,EAAA,qBAAuB,uBACvBA,EAAA,sBAAwB,wBACxBA,EAAA,YAAc,cACdA,EAAA,KAAO,OACPA,EAAA,KAAO,OACPA,EAAA,mBAAqB,qBACrBA,EAAA,qBAAuB,uBACvBA,EAAA,qBAAuB,uBACvBA,EAAA,kBAAoB,oBACpBA,EAAA,MAAQ,QACRA,EAAA,aAAe,eACfA,EAAA,UAAY,YACZA,EAAA,cAAgB,gBAChBA,EAAA,oBAAsB,sBACtBA,EAAA,SAAW,WAlCHA,QAAA,IAqCAC,QACRA,EAAA,gBAAkB,kBAClBA,EAAA,MAAQ,QACRA,EAAA,cAAgB,gBAChBA,EAAA,YAAc,cACdA,EAAA,WAAa,aACbA,EAAA,UAAY,YACZA,EAAA,gBAAkB,kBAClBA,EAAA,qBAAuB,uBACvBA,EAAA,IAAM,MACNA,EAAA,gBAAkB,kBAClBA,EAAA,GAAK,KACLA,EAAA,sBAAwB,wBACxBA,EAAA,WAAa,aACbA,EAAA,aAAe,eACfA,EAAA,mBAAqB,qBACrBA,EAAA,oBAAsB,sBACtBA,EAAA,4BAA8B,8BAC9BA,EAAA,gBAAkB,kBAClBA,EAAA,cAAgB,gBAChBA,EAAA,QAAU,UACVA,EAAA,YAAc,cACdA,EAAA,eAAiB,iBAtBTA,QAAA,IAwCCC,EAAN,KAA0B,CAO7B,YAAYC,EAASC,EAAS,CAH9B,qBAAuD,IAAM,CAAC,EAC9D,qBAAwC,IAAM,CAAC,EAG3C,KAAK,KAAOD,EACZ,KAAK,KAAOC,EACZ,KAAK,QAAU,IAAI,QACf,CAACC,EAA8CC,IAAoC,CAC/E,KAAK,gBAAkBD,EACvB,KAAK,gBAAkBC,CAC3B,CACJ,CACJ,CACJ,EC1GO,IAAMC,GAAkB,qBAClBC,GAAsB,mBAE5B,SAASC,GAAeC,EAAuB,CAClD,OAAOA,EAAK,OAAOF,EAAmB,EAAI,EAC9C,CAEO,SAASG,GAAgBC,EAAc,CAC1C,MAAO,CAAC,GAAGA,EAAK,SAASL,EAAe,CAAC,EAAE,IAAIM,GAASA,EAAM,CAAC,CAAC,CACpE,CCaA,IAAMC,GAAe,IAAI,YAEZC,GAAN,KAAiD,CA8BpD,YAAYC,EAAgBC,EAAwB,KAAM,CArB1D,KAAU,yBAAmE,CAAC,EAG9E,KAAU,qBAAuD,CAAC,EAKlE,KAAU,QAAyB,KAEnC,KAAU,uBAA+C,KAEzD,KAAU,wBAAqE,IAAM,CAAC,EAGtF,KAAU,eAAiB,EAE3B,KAAU,iBAAmD,IAAI,IAEjE,KAAU,QAAwB,CAAC,EAG/B,KAAK,QAAUD,EACf,KAAK,kBAAoB,KAAK,UAAU,KAAK,IAAI,EACjD,KAAK,gBAAkB,KAAK,QAAQ,KAAK,IAAI,EAC7C,KAAK,gBAAkB,KAAK,QAAQ,KAAK,IAAI,EACzCC,GAAU,MAAM,KAAK,OAAOA,CAAM,CAC1C,CAGA,IAAW,QAAiB,CACxB,OAAO,KAAK,OAChB,CAGA,IAAW,QAAuB,CAC9B,OAAO,KAAK,OAChB,CAGU,OAAOA,EAAsB,CACnC,KAAK,QAAUA,EACf,KAAK,QAAQ,iBAAiB,UAAW,KAAK,iBAAiB,EAC/D,KAAK,QAAQ,iBAAiB,QAAS,KAAK,eAAe,EAC3D,KAAK,QAAQ,iBAAiB,QAAS,KAAK,eAAe,EAC3D,KAAK,uBAAyB,IAAI,QAC9B,CAACC,EAAoDC,IAAqC,CACtF,KAAK,wBAA0BD,CACnC,CACJ,CACJ,CAGO,QAAe,CACb,KAAK,UACV,KAAK,QAAQ,oBAAoB,UAAW,KAAK,iBAAiB,EAClE,KAAK,QAAQ,oBAAoB,QAAS,KAAK,eAAe,EAC9D,KAAK,QAAQ,oBAAoB,QAAS,KAAK,eAAe,EAC9D,KAAK,QAAU,KACf,KAAK,wBAAwB,IAAI,EACjC,KAAK,uBAAyB,KAC9B,KAAK,wBAA0B,IAAM,CAAC,EAC1C,CAGA,MAAa,WAA2B,CAC/B,KAAK,UACV,KAAK,QAAQ,UAAU,EAEvB,KAAK,QAAU,KACf,KAAK,uBAAyB,KAC9B,KAAK,wBAA0B,IAAM,CAAC,EAC1C,CAGA,MAAgB,SACZE,EACAC,EAA0B,CAAC,EACK,CAChC,GAAI,CAAC,KAAK,QAAS,CACf,QAAQ,MAAM,sDAAwDD,EAAK,KAAO,IAAMA,EAAK,IAAI,EACjG,MACJ,CACA,IAAME,EAAM,KAAK,iBACjB,YAAK,iBAAiB,IAAIA,EAAKF,CAAI,EACnC,KAAK,QAAQ,YACT,CACI,UAAWE,EACX,KAAMF,EAAK,KACX,KAAMA,EAAK,IACf,EACAC,CACJ,EACQ,MAAMD,EAAK,OACvB,CAGU,UAAUG,EAA2B,CAlInD,IAAAC,EAoIQ,IAAMC,EAAWF,EAAM,KACvB,OAAQE,EAAS,KAAM,CAEnB,sBAAyC,CACrC,QAAWC,KAAK,KAAK,qBACjBA,EAAED,EAAS,IAAI,EAEnB,MACJ,CACA,UAA6B,CACzB,KAAK,QAAQ,IAAIA,EAAS,IAAI,EAC9B,MACJ,CAEA,2BAA8C,CAC1C,QAAWC,KAAK,KAAK,yBACjBA,EAAED,EAAS,IAAI,EAEnB,MACJ,CACJ,CAGA,IAAML,EAAO,KAAK,iBAAiB,IAAIK,EAAS,SAAS,EACzD,GAAI,CAACL,EAAM,CACP,QAAQ,KAAK,2BAA2BK,EAAS,SAAS,KAAKA,EAAS,KAAK,SAAS,CAAC,GAAG,EAC1F,MACJ,CAIA,GAHA,KAAK,iBAAiB,OAAOA,EAAS,SAAS,EAG3CA,EAAS,cAAkC,CAG3C,IAAME,EAAI,IAAI,MAAMF,EAAS,KAAK,OAAO,EACzCE,EAAE,KAAOF,EAAS,KAAK,MACnBD,EAAA,OAAO,yBAAyBG,EAAG,OAAO,IAA1C,MAAAH,EAA6C,WAC7CG,EAAE,MAAQF,EAAS,KAAK,OAE5BL,EAAK,gBAAgBO,CAAC,EACtB,MACJ,CAGA,OAAQP,EAAK,KAAM,CACf,qBACA,8BACA,8BACA,wBACA,iBACA,gBACA,iBACA,kBACA,mCACA,2BACA,4BACA,WACA,WACA,2BACA,2BACA,wBACA,YACI,GAAIK,EAAS,WAA+B,CACxCL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,kBAEI,GADA,KAAK,yBAA2B,CAAC,EAC7BA,EAAS,WAA+B,CACxCL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,sBACI,GAAIA,EAAS,mBAAuC,CAChDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,kBACI,GAAIA,EAAS,uBAA2C,CACpDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,wBACI,GAAIA,EAAS,sBAA0C,CACnDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,sBACI,GAAIA,EAAS,oBAAwC,CACjDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,eACI,GAAIA,EAAS,sBAA0C,CACnDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,0BACI,GAAIA,EAAS,oBAAwC,CACjDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,6BACI,GAAIA,EAAS,wBAA4C,CACrDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,cACI,GAAIA,EAAS,wBAA4C,CACrDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,mBACA,gBACI,GAAIA,EAAS,qBAAyC,CAClDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,oBACI,GAAIA,EAAS,4BAAgD,CACzDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,0BACI,GAAIA,EAAS,oCAAwD,CACjEL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,yBACI,GAAIA,EAAS,oCAAwD,CACjEL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,2BAEI,GADA,KAAK,yBAA2B,CAAC,EAC7BA,EAAS,gBAAoC,CAC7CL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,0BACI,GAAIA,EAAS,2BAA+C,CACxDL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,MACJ,sBACI,GAAIA,EAAS,8BAAkD,CAC3DL,EAAK,gBAAgBK,EAAS,IAAI,EAClC,MACJ,CACA,KACR,CACAL,EAAK,gBAAgB,IAAI,MAAM,6BAA6BK,EAAS,KAAK,SAAS,CAAC,EAAE,CAAC,CAC3F,CAGU,QAAQF,EAAyB,CACvC,QAAQ,MAAMA,CAAK,EACnB,QAAQ,MAAM,2BAA2BA,EAAM,OAAO,EAAE,EACxD,KAAK,iBAAiB,MAAM,CAChC,CAGU,SAAgB,CAEtB,GADA,KAAK,wBAAwB,IAAI,EAC7B,KAAK,iBAAiB,MAAQ,EAAG,CACjC,QAAQ,KAAK,0BAA0B,KAAK,iBAAiB,IAAI,mBAAmB,EACpF,MACJ,CACA,KAAK,iBAAiB,MAAM,CAChC,CAGO,YAAsB,CACzB,MAAO,CAAC,KAAK,OACjB,CAGA,MAAa,OAAuB,CAChC,IAAMH,EAAO,IAAIQ,UAAyE,IAAI,EAC9F,OAAO,MAAM,KAAK,SAASR,CAAI,CACnC,CAGA,MAAa,MAAqB,CAC9B,IAAMA,EAAO,IAAIQ,SAAuE,IAAI,EAC5F,MAAM,KAAK,SAASR,CAAI,CAC5B,CAEA,MAAa,SAASS,EAA6B,CAC/C,IAAMT,EAAO,IAAIQ,cAAmFC,CAAI,EACxG,OAAO,MAAM,KAAK,SAAST,CAAI,CACnC,CAEA,MAAa,UAAUU,EAAiC,CACpD,IAAMV,EAAO,IAAIQ,eAEbE,CACJ,EACA,OAAO,MAAM,KAAK,SAASV,CAAI,CACnC,CAEA,MAAa,YAA4B,CACrC,IAAMA,EAAO,IAAIQ,gBAAqF,IAAI,EAC1G,OAAO,MAAM,KAAK,SAASR,CAAI,CACnC,CAGA,MAAa,YACTW,EACAC,EAAkC,KAClCC,EAAsDC,GAAM,CAAC,EAChD,CACb,KAAK,yBAAyB,KAAKD,CAAQ,EAC3C,IAAMb,EAAO,IAAIQ,gBAEb,CAACG,EAAeC,CAAgB,CACpC,EACA,OAAO,MAAM,KAAK,SAASZ,CAAI,CACnC,CAGA,MAAa,YAA8B,CACvC,IAAMA,EAAO,IAAIQ,gBAAuF,IAAI,EAE5G,OADgB,MAAM,KAAK,SAASR,CAAI,CAE5C,CAGA,MAAa,iBAAmC,CAC5C,IAAMA,EAAO,IAAIQ,sBAEb,IACJ,EAEA,OADgB,MAAM,KAAK,SAASR,CAAI,CAE5C,CAGA,MAAa,KAAKe,EAAqC,CACnD,KAAK,QAAUA,EACf,IAAMf,EAAO,IAAIQ,SAA+EO,CAAM,EACtG,MAAM,KAAK,SAASf,CAAI,CAC5B,CAGA,MAAa,SAASgB,EAAqC,CACvD,IAAMhB,EAAO,IAAIQ,aAAyFQ,CAAI,EAE9G,OADe,MAAM,KAAK,SAAShB,CAAI,CAE3C,CAGA,MAAa,iBAAmC,CAC5C,IAAMA,EAAO,IAAIQ,YAAqF,IAAI,EAC1G,OAAO,MAAM,KAAK,SAASR,CAAI,CACnC,CAGA,MAAa,SAA0C,CACnD,IAAMiB,EAAM,MAAM,KAAK,gBAAgB,EACvC,OAAO,IAAIC,GAAsB,KAAMD,CAAG,CAC9C,CAGA,MAAa,WAAWE,EAAmC,CACvD,IAAMnB,EAAO,IAAIQ,eAEbW,CACJ,EACA,MAAM,KAAK,SAASnB,CAAI,CAC5B,CAGA,MAAa,SAASmB,EAAoBH,EAAmC,CACzE,GAAI,KAAK,uBAAuB,EAAG,CAC/B,IAAMI,EAAQ,MAAM,KAAK,wBAAwBJ,CAAI,EACrD,GAAI,CACA,OAAO,MAAM,KAAK,eAAeG,EAAMH,CAAI,CAC/C,QAAE,CACMI,EAAM,OAAS,GACf,MAAM,KAAK,UAAUA,CAAK,CAElC,CACJ,KACI,QAAO,MAAM,KAAK,eAAeD,EAAMH,CAAI,CAEnD,CAEA,MAAc,eAAeG,EAAoBH,EAAmC,CAChF,IAAMhB,EAAO,IAAIQ,cAEb,CAACW,EAAMH,CAAI,CACf,EACA,OAAO,MAAM,KAAK,SAAShB,CAAI,CACnC,CAGA,MAAa,kBACTmB,EACAH,EACAK,EAA6B,GACH,CAC1B,GAAI,KAAK,uBAAuB,EAAG,CAC/B,IAAMD,EAAQ,MAAM,KAAK,wBAAwBJ,CAAI,EACrD,GAAI,CACA,OAAO,MAAM,KAAK,wBAAwBG,EAAMH,EAAMK,CAAiB,CAC3E,QAAE,CACMD,EAAM,OAAS,GACf,MAAM,KAAK,UAAUA,CAAK,CAElC,CACJ,KACI,QAAO,MAAM,KAAK,wBAAwBD,EAAMH,EAAMK,CAAiB,CAE/E,CAEA,MAAc,wBACVF,EACAH,EACAK,EAA6B,GACH,CAC1B,IAAMrB,EAAO,IAAIQ,wBAIwB,CAACW,EAAMH,EAAMK,CAAiB,CAAC,EACxE,OAAO,MAAM,KAAK,SAASrB,CAAI,CACnC,CAGA,MAAa,iBAAiBmB,EAAgD,CAC1E,IAAMnB,EAAO,IAAIQ,uBAEbW,CACJ,EACA,OAAO,MAAM,KAAK,SAASnB,CAAI,CACnC,CAEA,MAAa,mBAAmBmB,EAAsC,CAClE,IAAMnB,EAAO,IAAIQ,yBAEbW,CACJ,EACA,OAAO,MAAM,KAAK,SAASnB,CAAI,CACnC,CAGA,MAAa,kBAAkBmB,EAAgD,CAC3E,IAAMnB,EAAO,IAAIQ,wBAEbW,CACJ,EACA,OAAO,MAAM,KAAK,SAASnB,CAAI,CACnC,CAGA,MAAa,cAAcmB,EAAcH,EAAiC,CACtE,IAAMhB,EAAO,IAAIQ,oBAEb,CAACW,EAAMH,CAAI,CACf,EACA,OAAO,MAAM,KAAK,SAAShB,CAAI,CACnC,CAGA,MAAa,eAAemB,EAAcH,EAA+B,CACrE,IAAMhB,EAAO,IAAIQ,oBAEb,CAACW,EAAMH,CAAI,CACf,EACA,OAAO,MAAM,KAAK,SAAShB,CAAI,CACnC,CAEA,MAAa,cAAcmB,EAAcG,EAAkC,CACvE,IAAMtB,EAAO,IAAIQ,mBAEb,CAACW,EAAMG,CAAS,CACpB,EACA,MAAM,KAAK,SAAStB,CAAI,CAC5B,CAEA,MAAa,YAAYmB,EAAcG,EAAmBC,EAAoC,CAC1F,IAAMvB,EAAO,IAAIQ,iBAEb,CAACW,EAAMG,EAAWC,CAAM,CAC5B,EACA,OAAO,MAAM,KAAK,SAASvB,CAAI,CACnC,CAEA,MAAa,aAAamB,EAAcG,EAAmBC,EAAoC,CAC3F,IAAMvB,EAAO,IAAIQ,kBAEb,CAACW,EAAMG,EAAWC,CAAM,CAC5B,EACA,OAAO,MAAM,KAAK,SAASvB,CAAI,CACnC,CAEA,MAAa,UAAUwB,EAAkC,CACrD,IAAMxB,EAAO,IAAIQ,oBAEbgB,CACJ,EACA,OAAO,MAAM,KAAK,SAASxB,CAAI,CACnC,CAEA,MAAa,iBAAiBS,EAAcO,EAA6B,CACrE,IAAMS,EAAS/B,GAAa,OAAOsB,CAAI,EACvC,MAAM,KAAK,mBAAmBP,EAAMgB,CAAM,CAC9C,CAEA,MAAa,gBACThB,EACAiB,EACAC,EACAC,EACa,CACTF,IAAQ,SACRA,EAAMjB,GAEV,IAAMT,EAAO,IAAIQ,sBAIsB,CAACC,EAAMiB,EAAKC,EAAOC,CAAQ,CAAC,EACnE,MAAM,KAAK,SAAS5B,CAAI,CAC5B,CAGA,MAAa,wBAAwBS,EAA6B,CAQlE,CAGA,MAAa,mBAAmBA,EAAcgB,EAAmC,CAC7E,IAAMzB,EAAO,IAAIQ,yBAEb,CAACC,EAAMgB,CAAM,CACjB,EACA,MAAM,KAAK,SAASzB,EAAM,CAACyB,EAAO,MAAM,CAAC,CAC7C,CAGA,MAAa,mBACThB,EACAoB,EACAC,EACAF,EACa,CACb,IAAM5B,EAAO,IAAIQ,yBAIyB,CAACC,EAAMoB,EAAQC,EAAUF,CAAQ,CAAC,EAC5E,MAAM,KAAK,SAAS5B,EAAM,CAAC,CAAC,CAChC,CAGA,MAAa,qBAAqBS,EAA6B,CAC3D,IAAMT,EAAO,IAAIQ,4BAEb,CAACC,CAAI,CACT,EACA,MAAM,KAAK,SAAST,EAAM,CAAC,CAAC,CAChC,CAGA,MAAa,sBAAsBS,EAAcsB,EAAgC,CAC7E,IAAM/B,EAAO,IAAIQ,4BAEb,CAACC,EAAMsB,CAAM,CACjB,EACA,MAAM,KAAK,SAAS/B,EAAM,CAAC,CAAC,CAChC,CAGA,MAAa,qBAAqBS,EAAuC,CACrE,IAAMT,EAAO,IAAIQ,2BAEbC,CACJ,EACA,OAAO,MAAM,KAAK,SAAST,EAAM,CAAC,CAAC,CACvC,CAGA,MAAa,iBAAiBS,EAAmC,CAC7D,IAAMT,EAAO,IAAIQ,wBAEbC,CACJ,EACA,OAAO,MAAM,KAAK,SAAST,CAAI,CACnC,CAGA,MAAa,eAAeS,EAAce,EAA6B,CACnE,IAAMxB,EAAO,IAAIQ,sBAEb,CAACC,EAAMe,CAAI,CACf,EACA,MAAM,KAAK,SAASxB,CAAI,CAC5B,CAGA,MAAa,yBACTmB,EACAM,EACAO,EACa,CACb,GAAIP,EAAO,QAAU,EAAG,OAExB,IAAMzB,EAAO,IAAIQ,iCAIiC,CAACW,EAAMM,EAAQO,CAAO,CAAC,EACzE,MAAM,KAAK,SAAShC,EAAM,CAACyB,EAAO,MAAM,CAAC,CAC7C,CAEA,MAAa,kBAAkBN,EAAoBK,EAAcQ,EAA0C,CAEvG,IAAMhC,EAAO,IAAIQ,yBAEb,CAACW,EAAMK,EAAMQ,CAAO,CACxB,EACA,MAAM,KAAK,SAAShC,CAAI,CAC5B,CAEA,MAAa,mBAAmBmB,EAAoBK,EAAcQ,EAA2C,CAEzG,IAAMhC,EAAO,IAAIQ,0BAEb,CAACW,EAAMK,EAAMQ,CAAO,CACxB,EACA,MAAM,KAAK,SAAShC,CAAI,CAC5B,CAEQ,wBAAkC,CAjrB9C,IAAAI,EAAA6B,EAkrBQ,OAAIC,IAAe9B,EAAA,KAAK,OAAO,OAAZ,KAAAA,EAAoB,EAAE,IAC9B6B,EAAA,KAAK,OAAO,OAAZ,YAAAA,EAAkB,eAAgB,OAEtC,EACX,CAEA,MAAc,wBAAwBjB,EAAc,CAChD,IAAMI,EAAQe,GAAgBnB,CAAI,EAC5BoB,EAAmB,CAAC,EAC1B,QAAWC,KAAQjB,EACf,GAAI,CACA,MAAM,KAAK,qBAAqBiB,CAAI,EACpCD,EAAO,KAAKC,CAAI,CACpB,OAAS9B,EAAG,CACR,cAAQ,MAAMA,CAAC,EACT,IAAI,MAAM,kBAAoB8B,CAAI,CAC5C,CAEJ,OAAOD,CACX,CACJ,ECjsBA,SAASE,IAAuD,CAC5D,IAAMC,EAAU,IAAI,YACpB,OAAQC,IACA,OAAO,kBAAsB,KAAeA,EAAK,kBAAkB,oBACnEA,EAAO,IAAI,WAAWA,CAAI,GAEvBD,EAAQ,OAAOC,CAAI,EAElC,CAEO,IAAMC,GAAaH,GAAmB,EAsBtC,IAAKI,QACRA,IAAA,OAAS,GAAT,SACAA,IAAA,QAAU,GAAV,UACAA,IAAA,mBAAqB,GAArB,qBACAA,IAAA,iBAAmB,GAAnB,mBACAA,IAAA,KAAO,GAAP,OACAA,IAAA,GAAK,GAAL,KANQA,QAAA,IChCL,IAAeC,GAAf,KAAuD,CAAvD,cAEH,KAAU,UAAmC,KAE7C,KAAU,eAAiB,EAYpB,IAAIC,EAA8B,CACrC,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAW,EACX,WACA,KAAMA,CACV,EACA,CAAC,CACL,CACJ,CAGU,OAAOC,EAAqC,CAClD,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,UACA,KAAM,IACV,EACA,CAAC,CACL,CACJ,CAGU,SAASA,EAA+BC,EAAgB,CAG9D,IAAMC,EAAW,CACb,KAAMD,EAAE,KACR,QAASA,EAAE,QACX,MAAOA,EAAE,OAAS,MACtB,EACA,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWD,EAAQ,UACnB,aACA,KAAME,CACV,EACA,CAAC,CACL,CAEJ,CAGA,MAAa,UAAUF,EAA8C,CAEjE,OAAQA,EAAQ,KAAM,CAClB,WACI,KAAK,OAAOA,CAAO,EACnB,OACJ,kBACQ,KAAK,WAAa,MAClB,KAAK,SAASA,EAAS,IAAI,MAAM,4BAA4B,CAAC,EAElE,GAAI,CACA,KAAK,UAAY,MAAM,KAAK,YAAYA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGG,GAAK,CAC3E,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWH,EAAQ,UACnB,4BACA,KAAMG,CACV,EACA,CAAC,CACL,CACJ,CAAC,EACD,KAAK,OAAOH,CAAO,CACvB,OAASC,EAAQ,CACb,QAAQ,IAAIA,CAAC,EACb,KAAK,UAAY,KACjB,KAAK,SAASD,EAASC,CAAC,CAC5B,CACA,OACJ,QACI,KACR,CAGA,GAAI,CAAC,KAAK,UACN,OAAO,KAAK,SAASD,EAAS,IAAI,MAAM,2BAA2B,CAAC,EAIxE,GAAI,CACA,OAAQA,EAAQ,KAAM,CAClB,kBACI,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,sBACA,KAAM,KAAK,UAAU,WAAW,CACpC,EACA,CAAC,CACL,EACA,MACJ,wBACI,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,qBACA,KAAM,KAAK,UAAU,gBAAgB,CACzC,EACA,CAAC,CACL,EACA,MACJ,YACI,KAAK,UAAU,MAAM,EACrB,KAAK,OAAOA,CAAO,EACnB,MAEJ,WAA6B,CACzB,IAAMI,EAAOJ,EAAQ,KAAK,KACtBI,GAAA,MAAAA,EAAM,WAAW,aACjB,MAAM,KAAK,UAAU,oBAAoBA,GAAyC,EAClFJ,EAAQ,KAAK,YAAc,IAE/B,KAAK,UAAU,KAAKA,EAAQ,IAAI,EAChC,KAAK,OAAOA,CAAO,EACnB,KACJ,CACA,gBACI,KAAK,UAAU,SAASA,EAAQ,IAAI,EACpC,KAAK,OAAOA,CAAO,EACnB,MACJ,iBACI,KAAK,UAAU,UAAUA,EAAQ,IAAI,EACrC,KAAK,OAAOA,CAAO,EACnB,MACJ,kBACI,KAAK,UAAU,WAAW,EAC1B,KAAK,OAAOA,CAAO,EACnB,MACJ,cAAgC,CAC5B,IAAMK,EAAO,KAAK,UAAU,QAAQ,EACpC,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWL,EAAQ,UACnB,uBACA,KAAMK,EAAK,UAAU,CAACC,EAAGC,IAAMA,CAAC,CACpC,EACA,CAAC,CACL,EACA,KACJ,CACA,iBACI,KAAK,UAAU,WAAWP,EAAQ,IAAI,EACtC,KAAK,OAAOA,CAAO,EACnB,MACJ,sBAAwC,CACpC,IAAMQ,EAAS,KAAK,UAAU,eAAeR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC7E,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,6BACA,KAAMQ,CACV,EACA,CAAC,CACL,EACA,KACJ,CACA,qBAAuC,CACnC,KAAK,UAAU,cAAcR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC7D,KAAK,OAAOA,CAAO,EACnB,KACJ,CACA,mBAAqC,CACjC,IAAMQ,EAAS,KAAK,UAAU,YAAYR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC3F,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,oBACA,KAAMQ,CACV,EACA,CAACA,EAAO,MAAM,CAClB,EACA,KACJ,CACA,gBAAkC,CAC9B,IAAMA,EAAS,KAAK,UAAU,SAASR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EACvE,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,oBACA,KAAMQ,CACV,EACA,CAACA,EAAO,MAAM,CAClB,EACA,KACJ,CACA,oBAAsC,CAClC,IAAMA,EAAS,KAAK,UAAU,aAAaR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC5F,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,2BACA,KAAMQ,CACV,EACA,CAACA,EAAO,MAAM,CAClB,EACA,KACJ,CACA,0BAA4C,CACxC,IAAMA,EAAS,KAAK,UAAU,kBAAkBR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC3FS,EAAW,CAAC,EACdD,GACAC,EAAS,KAAKD,EAAO,MAAM,EAE/B,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWR,EAAQ,UACnB,mCACA,KAAMQ,CACV,EACAC,CACJ,EACA,KACJ,CACA,yBAA2C,CACvC,IAAMD,EAAS,KAAK,UAAU,iBAAiBR,EAAQ,IAAI,EACrDS,EAAW,CAAC,EACdD,GACAC,EAAS,KAAKD,EAAO,MAAM,EAE/B,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWR,EAAQ,UACnB,mCACA,KAAMQ,CACV,EACAC,CACJ,EACA,KACJ,CACA,2BAA6C,CACzC,IAAMD,EAAS,KAAK,UAAU,mBAAmBR,EAAQ,IAAI,EAC7D,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,eACA,KAAMQ,CACV,EACA,CAAC,CACL,EACA,KACJ,CACA,0BAA4C,CACxC,IAAMA,EAAS,KAAK,UAAU,kBAAkBR,EAAQ,IAAI,EACtDS,EAAWD,EAAS,CAACA,EAAO,MAAM,EAAI,CAAC,EAC7C,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWR,EAAQ,UACnB,0BACA,KAAMQ,CACV,EACAC,CACJ,EACA,KACJ,CACA,sBAAwC,CACpC,IAAMD,EAAS,KAAK,UAAU,cAAcR,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC5E,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,mBACA,KAAMQ,CACV,EACA,CAAC,CACL,EACA,KACJ,CACA,sBAAwC,CACpC,IAAME,EAAQ,KAAK,UAAU,UAAUV,EAAQ,IAAI,EACnD,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,kBACA,KAAMU,CACV,EACA,CAAC,CACL,EACA,KACJ,CAEA,wBACI,KAAK,UAAU,gBAAgBV,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EACjG,KAAK,OAAOA,CAAO,EACnB,MAEJ,2BACI,KAAK,UAAU,mBAAmBA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAClE,KAAK,OAAOA,CAAO,EACnB,MAEJ,2BACI,MAAM,KAAK,UAAU,wBACjBA,EAAQ,KAAK,CAAC,EACdA,EAAQ,KAAK,CAAC,EACdA,EAAQ,KAAK,CAAC,EACdA,EAAQ,KAAK,CAAC,CAClB,EACA,KAAK,OAAOA,CAAO,EACnB,MAEJ,wBACI,KAAK,UAAU,eAAeA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAC9D,KAAK,OAAOA,CAAO,EACnB,MAEJ,0BAA4C,CACxC,IAAMW,EAAS,KAAK,UAAU,iBAAiBX,EAAQ,IAAI,EAC3D,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,mBACA,KAAMW,CACV,EACA,CAAC,CACL,EACA,KACJ,CACA,8BACI,KAAK,UAAU,sBAAsBX,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EACrE,KAAK,OAAOA,CAAO,EACnB,MAEJ,8BACI,MAAM,KAAK,UAAU,qBAAqBA,EAAQ,KAAK,CAAC,CAAC,EACzD,KAAK,OAAOA,CAAO,EACnB,MAEJ,6BAA+C,CAC3C,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,uBACA,KAAM,KAAK,UAAU,qBAAqBA,EAAQ,IAAI,CAC1D,EACA,CAAC,CACL,EACA,KACJ,CACA,mCAAqD,CACjD,KAAK,UAAU,yBAAyBA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EACzF,KAAK,OAAOA,CAAO,EACnB,KACJ,CACA,2BAA6C,CACzC,KAAK,UAAU,kBAAkBA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EAClF,KAAK,OAAOA,CAAO,EACnB,KACJ,CACA,4BAA8C,CAC1C,KAAK,UAAU,mBAAmBA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,EAAGA,EAAQ,KAAK,CAAC,CAAC,EACnF,KAAK,OAAOA,CAAO,EACnB,KACJ,CACA,eAAiC,CAC7B,IAAMQ,EAAS,KAAK,UAAU,SAASR,EAAQ,IAAI,EACnD,KAAK,YACD,CACI,UAAW,KAAK,iBAChB,UAAWA,EAAQ,UACnB,qBACA,KAAMQ,CACV,EACA,CAAC,CACL,EACA,KACJ,CACJ,CACJ,OAASP,EAAQ,CACb,eAAQ,IAAIA,CAAC,EACN,KAAK,SAASD,EAASC,CAAC,CACnC,CACJ,CACJ,EC9ZO,IAA+OW,GAAW,SAAS,YAAY,SAAS,IAAI,WAAW,CAAC,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,IAAI,GAAG,EAAE,EAAE,EAAE,CAAC,CAAC,EAAEC,GAAW,SAAS,YAAY,SAAS,IAAI,WAAW,CAAC,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC,EAAtgB,IAAu0DC,GAAK,SAAS,YAAY,SAAS,IAAI,WAAW,CAAC,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,GAAG,IAAI,GAAG,EAAE,CAAC,CAAC,EAA38D,IAA2oEC,GAAQ,KAAK,MAAMC,GAAG,CAAC,GAAG,CAAC,OAAmB,OAAO,eAApB,KAAqC,IAAI,iBAAgB,MAAM,YAAY,IAAI,kBAAkB,CAAC,CAAC,EAAE,YAAY,SAASA,CAAC,CAAC,MAAS,CAAC,MAAM,EAAE,CAAC,GAAG,IAAI,WAAW,CAAC,EAAE,GAAG,IAAI,IAAI,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,GAAG,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC,ECA96E,IAAAC,GAAA,CACI,KAAQ,sBACR,QAAW,SACX,YAAe,gCACf,QAAW,MACX,WAAc,CACV,KAAQ,MACR,IAAO,2CACX,EACA,SAAY,CACR,MACA,SACA,aACA,WACA,OACA,QACA,OACA,YACA,OACA,QACA,UACA,OACA,KACJ,EACA,aAAgB,CACZ,mBAAoB,SACpB,mBAAoB,SACpB,oBAAqB,SACrB,YAAa,SACb,cAAe,SACf,OAAU,SACV,WAAc,QAClB,EACA,gBAAmB,CACf,mBAAoB,SACpB,mBAAoB,SACpB,oBAAqB,WACrB,iBAAkB,SAClB,gBAAiB,KACjB,oBAAqB,KACrB,mCAAoC,UACpC,4BAA6B,UAC7B,QAAW,UACX,OAAU,UACV,wBAAyB,SACzB,sBAAuB,UACvB,KAAQ,UACR,QAAW,SACX,eAAgB,SAChB,wBAAyB,SACzB,YAAa,UACb,MAAS,SACT,wBAAyB,SACzB,iBAAkB,SAClB,yBAA0B,SAC1B,gBAAiB,SACjB,8BAA+B,SAC/B,yBAA0B,SAC1B,sBAAuB,UACvB,WAAY,SACZ,IAAO,UACP,SAAY,SACZ,UAAa,UACb,OAAU,SACV,OAAU,SACV,OAAU,SACV,QAAW,WACX,WAAc,SACd,sBAAuB,SACvB,aAAc,QAClB,EACA,QAAW,CACP,cAAe,qDACf,gBAAiB,uDACjB,KAAQ,UACR,OAAU,mCACV,OAAU,sBACV,YAAa,yFACb,kBAAmB,uGACnB,qBAAsB,6GACtB,eAAgB,wCAChB,cAAe,uCACf,iBAAkB,0CAClB,uBAAwB,gDACxB,eAAgB,oCAChB,qBAAsB,sCACtB,KAAQ,2CACR,gBAAiB,+EACjB,KAAQ,iBACZ,EACA,MAAS,CACL,OACA,gBACA,yCACA,kBACJ,EACA,KAAQ,0BACR,OAAU,0BACV,MAAS,2BACT,SAAY,0BACZ,MAAS,0BACT,YAAe,GACf,QAAW,CACP,GAAM,GACN,GAAM,GACN,KAAQ,GACR,WAAc,GACd,eAAkB,EACtB,EACA,QAAW,CACP,yBAA0B,yBAC1B,wBAAyB,wBACzB,yBAA0B,yBAC1B,wBAAyB,4BACzB,4BAA6B,4BAC7B,4BAA6B,4BAC7B,8CAA+C,8CAC/C,sCAAuC,sCACvC,qCAAsC,qCACtC,sCAAuC,sCACvC,qBAAsB,yBACtB,yBAA0B,yBAC1B,8BAA+B,kCAC/B,kCAAmC,kCACnC,mCAAoC,mCACpC,oCAAqC,oCACrC,aAAc,CACV,KAAQ,CACJ,MAAS,mCACT,QAAW,kCACX,OAAU,iCACd,EACA,MAAS,mCACT,OAAU,kCACV,QAAW,iCACf,EACA,IAAK,CACD,QAAW,CACP,MAAS,6BACT,OAAU,4BACV,QAAW,2BACf,EACA,KAAQ,CACJ,MAAS,0BACT,OAAU,yBACV,QAAW,wBACf,EACA,MAAS,6BACT,OAAU,4BACV,QAAW,2BACf,CACJ,CACJ,ECtJO,IAAMC,GAAeC,GAAO,KACtBC,GAAkBD,GAAO,QAEhCE,GAAgBF,GAAO,QAAQ,MAAM,GAAG,EACjCG,GAAwBD,GAAc,CAAC,EACvCE,GAAwBF,GAAc,CAAC,EACvCG,GAAwBH,GAAc,CAAC,ECQ7C,IAAMI,GAAS,IAAO,OAAO,UAAc,IAC5CC,GAAY,IAAOD,GAAO,EAAI,OAAS,UAAU,UAC1CE,GAAY,IAAMD,GAAU,EAAE,SAAS,SAAS,EAChDE,GAAW,IAAM,iCAAiC,KAAKF,GAAU,CAAC,EAuBxE,SAASG,IAAoC,CAChD,IAAMC,EAAoB,gCAAgCC,EAAY,IAAIC,EAAe,SACzF,MAAO,CACH,IAAK,CACD,WAAY,GAAGF,CAAiB,kBAChC,WAAY,GAAGA,CAAiB,8BACpC,EACA,GAAI,CACA,WAAY,GAAGA,CAAiB,iBAChC,WAAY,GAAGA,CAAiB,6BACpC,CAEJ,CACJ,CAiBA,IAAIG,GAAgC,KAChCC,GAAiC,KACjCC,GAA8B,KAC9BC,GAA2B,KAC3BC,GAAiC,KAOrC,eAAsBC,IAAiD,CACnE,OAAIL,IAAiB,OACjBA,GAAgB,OAAO,cAAiB,KAExCC,IAAkB,OAClBA,GAAiB,MAAYK,GAAW,GAExCJ,IAAe,OACfA,GAAc,MAAYK,GAAQ,GAElCJ,IAAY,OACZA,GAAW,MAAYK,GAAK,GAE5BJ,IAAkB,OAClBA,GAAiB,MAAYK,GAAW,GAErC,CACH,cAAeT,GACf,oBAAqBR,GAAO,GAAK,WAAW,qBAAuB,GACnE,eAAgBS,GAChB,SAAUE,GACV,YAAaD,GACb,eAAgBE,EACpB,CACJ,CAEA,eAAsBM,GAAaC,EAA+C,CAC9E,IAAMC,EAAW,MAAMP,GAAoB,EAC3C,GAAIO,EAAS,eAAgB,CACzB,GAAIA,EAAS,UAAYA,EAAS,aAAeA,EAAS,qBAAuBD,EAAQ,IACrF,MAAO,CACH,WAAYA,EAAQ,IAAI,WACxB,WAAYA,EAAQ,IAAI,WACxB,cAAeA,EAAQ,IAAI,aAC/B,EAEJ,GAAIA,EAAQ,GACR,MAAO,CACH,WAAYA,EAAQ,GAAG,WACvB,WAAYA,EAAQ,GAAG,WACvB,cAAe,IACnB,CAER,CACA,MAAO,CACH,WAAYA,EAAQ,IAAI,WACxB,WAAYA,EAAQ,IAAI,WACxB,cAAe,IACnB,CACJ,CCpIA,IAAAE,GAAmB,SAEnB,eAAsBC,GAAaC,EAAa,CAC5C,IAAMC,EAAU,IAAI,QAAQD,CAAG,EACzBE,EAAe,MAAM,MAAMD,CAAO,EAClCE,EAAY,IAAI,gBAAgB,MAAMD,EAAa,KAAK,CAAC,EAC/D,OAAO,IAAI,GAAAE,QAAOD,CAAS,CAC/B",
  "names": ["require_browser", "__commonJSMin", "exports", "module", "DuckDBAccessMode", "TokenType", "LogLevel", "LogTopic", "LogEvent", "LogOrigin", "VoidLogger", "_entry", "ConsoleLogger", "level", "entry", "getLogLevelLabel", "getLogEventLabel", "event", "getLogTopicLabel", "topic", "getLogOriginLabel", "origin", "StatusCode", "IsArrowBuffer", "status", "IsDuckDBWasmRetry", "MAGIC", "EOS", "Version", "MessageHeader", "Type", "Precision", "DateUnit", "TimeUnit", "IntervalUnit", "UnionMode", "uint8Array", "uint16Array", "uint32Array", "uint64Array", "int8Array", "int16Array", "int32Array", "int64Array", "float32Array", "float64Array", "isArrayBufferLike", "data", "intArrayType", "bitWidth", "signed", "i", "TypedArray", "bisect", "offsets", "index", "a", "b", "mid", "check", "value", "test", "message", "checkOneOf", "set", "keyFor", "object", "key", "val", "invalidDataType", "typeId", "keyFor", "Type", "field", "name", "type", "nullable", "metadata", "isField", "value", "isDataType", "asField", "defaultName", "defaultNullable", "check", "dictionary", "type", "indexType", "ordered", "id", "Type", "int32", "int", "bitWidth", "signed", "Type", "checkOneOf", "intArrayType", "int32", "int", "float", "precision", "Type", "checkOneOf", "Precision", "uint16Array", "float32Array", "float64Array", "binary", "Type", "int32Array", "utf8", "decimal", "precision", "scale", "bitWidth", "Type", "checkOneOf", "int32Array", "uint64Array", "date", "unit", "Type", "checkOneOf", "DateUnit", "int32Array", "int64Array", "time", "unit", "TimeUnit", "checkOneOf", "bitWidth", "Type", "int32Array", "int64Array", "timestamp", "unit", "TimeUnit", "timezone", "Type", "checkOneOf", "int64Array", "interval", "IntervalUnit", "int32Array", "list", "child", "asField", "struct", "children", "isField", "name", "type", "field", "union", "mode", "typeIds", "typeIdForValue", "v", "i", "UnionMode", "m", "id", "fixedSizeBinary", "stride", "fixedSizeList", "mapType", "keysSorted", "duration", "unit", "TimeUnit", "Type", "checkOneOf", "int64Array", "largeBinary", "largeUtf8", "largeList", "child", "asField", "runEndEncoded", "runsField", "valuesField", "check", "field", "listView", "child", "Type", "asField", "int32Array", "largeListView", "int64Array", "f64", "float64Array", "buf", "i64", "int64Array", "u32", "uint32Array", "i32", "int32Array", "u8", "uint8Array", "toNumber", "value", "divide", "num", "div", "asUint64", "v", "fromDecimal64", "buf", "offset", "fromDecimal128", "i", "x", "fromDecimal256", "textDecoder", "textEncoder", "decodeUtf8", "buf", "SIZEOF_INT", "decodeBit", "bitmap", "index", "readObject", "buf", "pos", "readInt32", "vtable", "size", "readInt16", "read", "fallback", "off", "readOffset", "offset", "readBoolean", "readInt8", "readUint8", "readUint16", "readUint32", "readInt64", "toNumber", "SIZEOF_INT", "readString", "length", "decodeUtf8", "readVector", "stride", "extract", "base", "_", "RowIndex", "proxyFactory", "names", "batches", "RowObject", "index", "structObject", "proto", "i", "batch", "objectFactory", "obj", "isDirectBatch", "batch", "DirectBatch", "Batch", "length", "nullCount", "type", "validity", "values", "offsets", "sizes", "children", "index", "decodeBit", "start", "end", "i", "__publicField", "options", "NumberBatch", "float64Array", "ArrayBatch", "NullBatch", "Int64Batch", "toNumber", "Float16Batch", "v", "expo", "sigf", "sign", "BoolBatch", "Decimal32NumberBatch", "scale", "DecimalBatch", "bitWidth", "fromDecimal64", "fromDecimal128", "fromDecimal256", "DecimalNumberBatch", "divide", "DecimalBigIntBatch", "DateBatch", "DateDayBatch", "DateDayMillisecondBatch", "TimestampSecondBatch", "TimestampMillisecondBatch", "TimestampMicrosecondBatch", "TimestampNanosecondBatch", "IntervalDayTimeBatch", "IntervalMonthDayNanoBatch", "base", "readInt32", "readInt64", "offset32", "offset64", "BinaryBatch", "LargeBinaryBatch", "Utf8Batch", "decodeUtf8", "LargeUtf8Batch", "ListBatch", "LargeListBatch", "ListViewBatch", "a", "b", "LargeListViewBatch", "FixedBatch", "FixedBinaryBatch", "stride", "FixedListBatch", "pairs", "keys", "vals", "entries", "MapEntryBatch", "MapBatch", "SparseUnionBatch", "typeIds", "offset", "typeMap", "DenseUnionBatch", "StructBatch", "factory", "objectFactory", "child", "StructProxyBatch", "proxyFactory", "RunEndEncodedBatch", "runs", "bisect", "DictionaryBatch", "dictionary", "ViewBatch", "data", "buf", "BinaryViewBatch", "Utf8ViewBatch", "columnBuilder", "type", "data", "batch", "Column", "_a", "m", "n", "offsets", "index", "s", "batchedIterator", "i", "bisect", "length", "nullCount", "copy", "isDirectBatch", "ArrayType", "array", "copyArray", "extractArray", "iter", "next", "offset", "values", "j", "Table", "_Table", "schema", "children", "useProxy", "names", "f", "proxyFactory", "objectFactory", "gen", "b", "_a", "c", "_b", "index", "name", "i", "x", "indices", "as", "factory", "fields", "j", "renameField", "all", "cols", "getFactory", "numRows", "data", "output", "row", "offsets", "bisect", "field", "batchType", "type", "options", "typeId", "bitWidth", "mode", "precision", "unit", "useBigInt", "useDate", "useDecimalInt", "useMap", "useProxy", "Type", "NullBatch", "BoolBatch", "DirectBatch", "Int64Batch", "Float16Batch", "wrap", "DateUnit", "DateDayBatch", "DateDayMillisecondBatch", "DateBatch", "TimeUnit", "TimestampSecondBatch", "TimestampMillisecondBatch", "TimestampMicrosecondBatch", "TimestampNanosecondBatch", "Decimal32NumberBatch", "DecimalBigIntBatch", "DecimalNumberBatch", "IntervalUnit", "IntervalDayTimeBatch", "IntervalMonthDayNanoBatch", "FixedBinaryBatch", "Utf8Batch", "LargeUtf8Batch", "BinaryBatch", "LargeBinaryBatch", "BinaryViewBatch", "Utf8ViewBatch", "ListBatch", "LargeListBatch", "MapBatch", "MapEntryBatch", "ListViewBatch", "LargeListViewBatch", "FixedListBatch", "StructProxyBatch", "StructBatch", "RunEndEncodedBatch", "DictionaryBatch", "DenseUnionBatch", "SparseUnionBatch", "invalidDataType", "BaseClass", "WrapperClass", "decodeBlock", "buf", "index", "readInt64", "readInt32", "decodeBlocks", "readVector", "decodeRecordBatch", "buf", "index", "version", "get", "readObject", "readOffset", "offset", "Version", "readInt64", "readVector", "pos", "decodeDictionaryBatch", "buf", "index", "version", "get", "readObject", "readInt64", "off", "decodeRecordBatch", "readBoolean", "decodeDataType", "buf", "index", "typeId", "children", "checkOneOf", "Type", "invalidDataType", "get", "readObject", "binary", "utf8", "largeBinary", "largeUtf8", "list", "listView", "largeList", "largeListView", "struct", "runEndEncoded", "int", "readInt32", "readBoolean", "float", "readInt16", "Precision", "decimal", "date", "DateUnit", "time", "TimeUnit", "timestamp", "readString", "interval", "IntervalUnit", "duration", "fixedSizeBinary", "fixedSizeList", "mapType", "union", "UnionMode", "readVector", "readOffset", "decodeMetadata", "buf", "index", "entries", "readVector", "pos", "get", "readObject", "readString", "decodeSchema", "buf", "index", "version", "get", "readObject", "readInt16", "decodeSchemaFields", "decodeMetadata", "fieldsOffset", "readVector", "decodeField", "typeId", "readUint8", "Type", "typeOffset", "readOffset", "dict", "decodeDictionary", "children", "off", "decodeFieldChildren", "type", "decodeDataType", "readString", "readBoolean", "fieldOffset", "dictionary", "decodeInt", "int32", "readInt64", "invalidMessageMetadata", "expected", "actual", "invalidMessageBodyLength", "invalidMessageType", "type", "keyFor", "MessageHeader", "decodeMessage", "buf", "index", "metadataLength", "readInt32", "SIZEOF_INT", "head", "get", "readObject", "version", "readInt16", "Version", "readUint8", "offset", "readOffset", "bodyLength", "readInt64", "content", "decoder", "decodeSchema", "decodeDictionaryBatch", "decodeRecordBatch", "body", "decodeIPC", "data", "source", "isArrayBufferLike", "isArrowFileFormat", "decodeIPCFile", "decodeIPCStream", "buf", "i", "MAGIC", "stream", "schema", "records", "dictionaries", "offset", "m", "decodeMessage", "MessageHeader", "length", "readInt32", "get", "readObject", "version", "readInt16", "Version", "dicts", "decodeBlocks", "recs", "index", "decodeSchema", "decodeMetadata", "tableFromIPC", "data", "options", "createTable", "decodeIPC", "schema", "dictionaries", "records", "version", "fields", "dictionaryMap", "context", "contextGenerator", "dictionaryTypes", "visitSchemaFields", "field", "type", "Type", "dicts", "dict", "id", "isDelta", "body", "batch", "visit", "columnBuilder", "value", "key", "cols", "f", "ctx", "i", "Table", "c", "visitor", "visitField", "_a", "_b", "_c", "base", "length", "nodes", "regions", "variadic", "nodeIndex", "bufferIndex", "variadicIndex", "ArrayType", "offset", "children", "typeId", "node", "buffer", "BatchType", "batchType", "indices", "Version", "int8Array", "UnionMode", "invalidDataType", "isLittleEndian", "AsyncDuckDBConnection", "bindings", "conn", "callback", "text", "buffer", "tableFromIPC", "allowStreamResult", "header", "AsyncResultStreamIterator", "query", "stmt", "AsyncPreparedStatement", "options", "db", "connectionId", "statementId", "params", "WorkerRequestType", "WorkerResponseType", "WorkerTask", "type", "data", "resolve", "reject", "REGEX_OPFS_FILE", "REGEX_OPFS_PROTOCOL", "isOPFSProtocol", "path", "searchOPFSFiles", "text", "match", "TEXT_ENCODER", "AsyncDuckDB", "logger", "worker", "resolve", "_reject", "task", "transfer", "mid", "event", "_a", "response", "p", "e", "WorkerTask", "name", "names", "mainModuleURL", "pthreadWorkerURL", "progress", "_p", "config", "text", "cid", "AsyncDuckDBConnection", "conn", "files", "allowStreamResult", "statement", "params", "path", "buffer", "url", "proto", "directIO", "handle", "protocol", "enable", "options", "_b", "isOPFSProtocol", "searchOPFSFiles", "result", "file", "TextDecoderWrapper", "decoder", "data", "decodeText", "DuckDBDataProtocol", "AsyncDuckDBDispatcher", "entry", "request", "e", "obj", "p", "path", "conn", "_", "c", "result", "transfer", "infos", "buffer", "bulkMemory", "exceptions", "simd", "threads", "e", "package_default", "PACKAGE_NAME", "package_default", "PACKAGE_VERSION", "VERSION_PARTS", "PACKAGE_VERSION_MAJOR", "PACKAGE_VERSION_MINOR", "PACKAGE_VERSION_PATCH", "isNode", "userAgent", "isFirefox", "isSafari", "getJsDelivrBundles", "jsdelivr_dist_url", "PACKAGE_NAME", "PACKAGE_VERSION", "bigInt64Array", "wasmExceptions", "wasmThreads", "wasmSIMD", "wasmBulkMemory", "getPlatformFeatures", "exceptions", "threads", "simd", "bulkMemory", "selectBundle", "bundles", "platform", "import_web_worker", "createWorker", "url", "request", "workerScript", "workerURL", "Worker"]
}
