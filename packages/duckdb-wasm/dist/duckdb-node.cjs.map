{
  "version": 3,
  "sources": ["../../../../../mods/data/yarn/berry/cache/@uwdata-flechette-npm-2.2.6-406e7c7544-10c0.zip/node_modules/@uwdata/flechette/dist/flechette.cjs", "../../../../../mods/data/yarn/berry/cache/web-worker-npm-1.2.0-ef71df710e-10c0.zip/node_modules/web-worker/cjs/node.js", "../src/targets/duckdb.ts", "../src/bindings/config.ts", "../src/bindings/tokens.ts", "../src/log.ts", "../src/status.ts", "../src/parallel/async_connection.ts", "../src/parallel/worker_request.ts", "../src/utils/opfs_util.ts", "../src/parallel/async_bindings.ts", "../src/bindings/runtime.ts", "../src/parallel/worker_dispatcher.ts", "../../../../../mods/data/yarn/berry/cache/wasm-feature-detect-npm-1.6.1-a6f6bca5d0-10c0.zip/node_modules/wasm-feature-detect/dist/esm/index.js", "../package.json", "../src/version.ts", "../src/platform.ts", "../src/worker.ts"],
  "sourcesContent": ["'use strict';\n\n/** Magic bytes 'ARROW1' indicating the Arrow 'file' format. */\nconst MAGIC = Uint8Array.of(65, 82, 82, 79, 87, 49);\n\n/** Bytes for an 'end of stream' message. */\nconst EOS = Uint8Array.of(255, 255, 255, 255, 0, 0, 0, 0);\n\n/**\n * Apache Arrow version.\n */\nconst Version = /** @type {const} */ ({\n  /** 0.1.0 (October 2016). */\n  V1: 0,\n  /** 0.2.0 (February 2017). Non-backwards compatible with V1. */\n  V2: 1,\n  /** 0.3.0 -> 0.7.1 (May - December 2017). Non-backwards compatible with V2. */\n  V3: 2,\n  /** >= 0.8.0 (December 2017). Non-backwards compatible with V3. */\n  V4: 3,\n  /**\n   * >= 1.0.0 (July 2020). Backwards compatible with V4 (V5 readers can read V4\n   * metadata and IPC messages). Implementations are recommended to provide a\n   * V4 compatibility mode with V5 format changes disabled.\n   *\n   * Incompatible changes between V4 and V5:\n   * - Union buffer layout has changed.\n   *   In V5, Unions don't have a validity bitmap buffer.\n   */\n  V5: 4\n});\n\n/**\n * Endianness of Arrow-encoded data.\n */\nconst Endianness = /** @type {const} */ ({\n  Little: 0,\n  Big: 1\n});\n\n/**\n * Message header type codes.\n */\nconst MessageHeader = /** @type {const} */ ({\n  NONE: 0,\n  /**\n   * A Schema describes the columns in a record batch.\n   */\n  Schema: 1,\n  /**\n   * For sending dictionary encoding information. Any Field can be\n   * dictionary-encoded, but in this case none of its children may be\n   * dictionary-encoded.\n   * There is one vector / column per dictionary, but that vector / column\n   * may be spread across multiple dictionary batches by using the isDelta\n   * flag.\n   */\n  DictionaryBatch: 2,\n  /**\n   * A data header describing the shared memory layout of a \"record\" or \"row\"\n   * batch. Some systems call this a \"row batch\" internally and others a \"record\n   * batch\".\n   */\n  RecordBatch: 3,\n  /**\n   * EXPERIMENTAL: Metadata for n-dimensional arrays, aka \"tensors\" or\n   * \"ndarrays\". Arrow implementations in general are not required to implement\n   * this type.\n   *\n   * Not currently supported by Flechette.\n   */\n  Tensor: 4,\n  /**\n   * EXPERIMENTAL: Metadata for n-dimensional sparse arrays, aka \"sparse\n   * tensors\". Arrow implementations in general are not required to implement\n   * this type.\n   *\n   * Not currently supported by Flechette.\n   */\n  SparseTensor: 5\n});\n\n/**\n * Field data type ids.\n * Only non-negative values ever occur in IPC flatbuffer binary data.\n */\nconst Type = /** @type {const} */ ({\n  /**\n   * Dictionary types compress data by using a set of integer indices to\n   * lookup potentially repeated vales in a separate dictionary of values.\n   *\n   * This type entry is provided for API convenience, it does not occur\n   * in actual Arrow IPC binary data.\n   */\n  Dictionary: -1,\n  /** No data type. Included for flatbuffer compatibility. */\n  NONE: 0,\n  /** Null values only. */\n  Null: 1,\n  /** Integers, either signed or unsigned, with 8, 16, 32, or 64 bit widths. */\n  Int: 2,\n  /** Floating point numbers with 16, 32, or 64 bit precision. */\n  Float: 3,\n  /** Opaque binary data. */\n  Binary: 4,\n  /** Unicode with UTF-8 encoding. */\n  Utf8: 5,\n  /** Booleans represented as 8 bit bytes. */\n  Bool: 6,\n  /**\n   * Exact decimal value represented as an integer value in two's complement.\n   * Currently only 128-bit (16-byte) and 256-bit (32-byte) integers are used.\n   * The representation uses the endianness indicated in the schema.\n   */\n  Decimal: 7,\n  /**\n   * Date is either a 32-bit or 64-bit signed integer type representing an\n   * elapsed time since UNIX epoch (1970-01-01), stored in either of two units:\n   * - Milliseconds (64 bits) indicating UNIX time elapsed since the epoch (no\n   * leap seconds), where the values are evenly divisible by 86400000\n   * - Days (32 bits) since the UNIX epoch\n   */\n  Date: 8,\n  /**\n   * Time is either a 32-bit or 64-bit signed integer type representing an\n   * elapsed time since midnight, stored in either of four units: seconds,\n   * milliseconds, microseconds or nanoseconds.\n   *\n   * The integer `bitWidth` depends on the `unit` and must be one of the following:\n   * - SECOND and MILLISECOND: 32 bits\n   * - MICROSECOND and NANOSECOND: 64 bits\n   *\n   * The allowed values are between 0 (inclusive) and 86400 (=24*60*60) seconds\n   * (exclusive), adjusted for the time unit (for example, up to 86400000\n   * exclusive for the MILLISECOND unit).\n   * This definition doesn't allow for leap seconds. Time values from\n   * measurements with leap seconds will need to be corrected when ingesting\n   * into Arrow (for example by replacing the value 86400 with 86399).\n   */\n  Time: 9,\n  /**\n   * Timestamp is a 64-bit signed integer representing an elapsed time since a\n   * fixed epoch, stored in either of four units: seconds, milliseconds,\n   * microseconds or nanoseconds, and is optionally annotated with a timezone.\n   *\n   * Timestamp values do not include any leap seconds (in other words, all\n   * days are considered 86400 seconds long).\n   *\n   * The timezone is an optional string for the name of a timezone, one of:\n   *\n   *  - As used in the Olson timezone database (the \"tz database\" or\n   *    \"tzdata\"), such as \"America/New_York\".\n   *  - An absolute timezone offset of the form \"+XX:XX\" or \"-XX:XX\",\n   *    such as \"+07:30\".\n   *\n   * Whether a timezone string is present indicates different semantics about\n   * the data.\n   */\n  Timestamp: 10,\n  /**\n   * A \"calendar\" interval which models types that don't necessarily\n   * have a precise duration without the context of a base timestamp (e.g.\n   * days can differ in length during day light savings time transitions).\n   * All integers in the units below are stored in the endianness indicated\n   * by the schema.\n   *\n   *  - YEAR_MONTH - Indicates the number of elapsed whole months, stored as\n   *    4-byte signed integers.\n   *  - DAY_TIME - Indicates the number of elapsed days and milliseconds (no\n   *    leap seconds), stored as 2 contiguous 32-bit signed integers (8-bytes\n   *    in total). Support of this IntervalUnit is not required for full arrow\n   *    compatibility.\n   *  - MONTH_DAY_NANO - A triple of the number of elapsed months, days, and\n   *    nanoseconds. The values are stored contiguously in 16-byte blocks.\n   *    Months and days are encoded as 32-bit signed integers and nanoseconds\n   *    is encoded as a 64-bit signed integer. Nanoseconds does not allow for\n   *    leap seconds. Each field is independent (e.g. there is no constraint\n   *    that nanoseconds have the same sign as days or that the quantity of\n   *    nanoseconds represents less than a day's worth of time).\n   */\n  Interval: 11,\n  /**\n   * List (vector) data supporting variably-sized lists.\n   * A list has a single child data type for list entries.\n   */\n  List: 12,\n  /**\n   * A struct consisting of multiple named child data types.\n   */\n  Struct: 13,\n  /**\n   * A union is a complex type with parallel child data types. By default ids\n   * in the type vector refer to the offsets in the children. Optionally\n   * typeIds provides an indirection between the child offset and the type id.\n   * For each child `typeIds[offset]` is the id used in the type vector.\n   */\n  Union: 14,\n  /**\n   * Binary data where each entry has the same fixed size.\n   */\n  FixedSizeBinary: 15,\n  /**\n   * List (vector) data where every list has the same fixed size.\n   * A list has a single child data type for list entries.\n   */\n  FixedSizeList: 16,\n  /**\n   * A Map is a logical nested type that is represented as\n   * List<entries: Struct<key: K, value: V>>\n   *\n   * In this layout, the keys and values are each respectively contiguous. We do\n   * not constrain the key and value types, so the application is responsible\n   * for ensuring that the keys are hashable and unique. Whether the keys are sorted\n   * may be set in the metadata for this field.\n   *\n   * In a field with Map type, the field has a child Struct field, which then\n   * has two children: key type and the second the value type. The names of the\n   * child fields may be respectively \"entries\", \"key\", and \"value\", but this is\n   * not enforced.\n   *\n   * Map\n   * ```text\n   *   - child[0] entries: Struct\n   *   - child[0] key: K\n   *   - child[1] value: V\n   *  ```\n   * Neither the \"entries\" field nor the \"key\" field may be nullable.\n   *\n   * The metadata is structured so that Arrow systems without special handling\n   * for Map can make Map an alias for List. The \"layout\" attribute for the Map\n   * field must have the same contents as a List.\n   */\n  Map: 17,\n  /**\n   * An absolute length of time unrelated to any calendar artifacts. For the\n   * purposes of Arrow implementations, adding this value to a Timestamp\n   * (\"t1\") naively (i.e. simply summing the two numbers) is acceptable even\n   * though in some cases the resulting Timestamp (t2) would not account for\n   * leap-seconds during the elapsed time between \"t1\" and \"t2\". Similarly,\n   * representing the difference between two Unix timestamp is acceptable, but\n   * would yield a value that is possibly a few seconds off from the true\n   * elapsed time.\n   *\n   * The resolution defaults to millisecond, but can be any of the other\n   * supported TimeUnit values as with Timestamp and Time types. This type is\n   * always represented as an 8-byte integer.\n   */\n  Duration: 18,\n  /**\n   * Same as Binary, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeBinary: 19,\n  /**\n   * Same as Utf8, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeUtf8: 20,\n  /**\n   * Same as List, but with 64-bit offsets, allowing representation of\n   * extremely large data values.\n   */\n  LargeList: 21,\n  /**\n   * Contains two child arrays, run_ends and values. The run_ends child array\n   * must be a 16/32/64-bit integer array which encodes the indices at which\n   * the run with the value in each corresponding index in the values child\n   * array ends. Like list/struct types, the value array can be of any type.\n   */\n  RunEndEncoded: 22,\n  /**\n   * Logically the same as Binary, but the internal representation uses a view\n   * struct that contains the string length and either the string's entire data\n   * inline (for small strings) or an inlined prefix, an index of another buffer,\n   * and an offset pointing to a slice in that buffer (for non-small strings).\n   *\n   * Since it uses a variable number of data buffers, each Field with this type\n   * must have a corresponding entry in `variadicBufferCounts`.\n   */\n  BinaryView: 23,\n  /**\n   * Logically the same as Utf8, but the internal representation uses a view\n   * struct that contains the string length and either the string's entire data\n   * inline (for small strings) or an inlined prefix, an index of another buffer,\n   * and an offset pointing to a slice in that buffer (for non-small strings).\n   *\n   * Since it uses a variable number of data buffers, each Field with this type\n   * must have a corresponding entry in `variadicBufferCounts`.\n   */\n  Utf8View: 24,\n  /**\n   * Represents the same logical types that List can, but contains offsets and\n   * sizes allowing for writes in any order and sharing of child values among\n   * list values.\n   */\n  ListView: 25,\n  /**\n   * Same as ListView, but with 64-bit offsets and sizes, allowing to represent\n   * extremely large data values.\n   */\n  LargeListView: 26\n});\n\n/**\n * Floating point number precision.\n */\nconst Precision = /** @type {const} */ ({\n  /** 16-bit floating point number. */\n  HALF: 0,\n  /** 32-bit floating point number. */\n  SINGLE: 1,\n  /** 64-bit floating point number. */\n  DOUBLE: 2\n});\n\n/**\n * Date units.\n */\nconst DateUnit = /** @type {const} */ ({\n  /* Days (as 32 bit int) since the UNIX epoch. */\n  DAY: 0,\n  /**\n   * Milliseconds (as 64 bit int) indicating UNIX time elapsed since the epoch\n   * (no leap seconds), with values evenly divisible by 86400000.\n   */\n  MILLISECOND: 1\n});\n\n/**\n * Time units.\n */\nconst TimeUnit = /** @type {const} */ ({\n  /** Seconds. */\n  SECOND: 0,\n  /** Milliseconds. */\n  MILLISECOND: 1,\n  /** Microseconds. */\n  MICROSECOND: 2,\n  /** Nanoseconds. */\n  NANOSECOND: 3\n});\n\n/**\n * Date/time interval units.\n */\nconst IntervalUnit = /** @type {const} */ ({\n  /**\n   * Indicates the number of elapsed whole months, stored as 4-byte signed\n   * integers.\n   */\n  YEAR_MONTH: 0,\n  /**\n   * Indicates the number of elapsed days and milliseconds (no leap seconds),\n   * stored as 2 contiguous 32-bit signed integers (8-bytes in total). Support\n   * of this IntervalUnit is not required for full arrow compatibility.\n   */\n  DAY_TIME: 1,\n  /**\n   * A triple of the number of elapsed months, days, and nanoseconds.\n   * The values are stored contiguously in 16-byte blocks. Months and days are\n   * encoded as 32-bit signed integers and nanoseconds is encoded as a 64-bit\n   * signed integer. Nanoseconds does not allow for leap seconds. Each field is\n   * independent (e.g. there is no constraint that nanoseconds have the same\n   * sign as days or that the quantity of nanoseconds represents less than a\n   * day's worth of time).\n   */\n  MONTH_DAY_NANO: 2\n});\n\n/**\n * Union type modes.\n */\nconst UnionMode = /** @type {const} */ ({\n  /** Sparse union layout with full arrays for each sub-type. */\n  Sparse: 0,\n  /** Dense union layout with offsets into value arrays. */\n  Dense: 1\n});\n\n/**\n * @import { Int64ArrayConstructor, IntArrayConstructor, IntegerArray, TypedArray } from '../types.js'\n */\nconst uint8Array = Uint8Array;\nconst uint16Array = Uint16Array;\nconst uint32Array = Uint32Array;\nconst uint64Array = BigUint64Array;\nconst int8Array = Int8Array;\nconst int16Array = Int16Array;\nconst int32Array = Int32Array;\nconst int64Array = BigInt64Array;\nconst float32Array = Float32Array;\nconst float64Array = Float64Array;\n\n/**\n * Check if an input value is an ArrayBuffer or SharedArrayBuffer.\n * @param {unknown} data\n * @returns {data is ArrayBufferLike}\n */\nfunction isArrayBufferLike(data) {\n  return data instanceof ArrayBuffer || (\n    typeof SharedArrayBuffer !== 'undefined' &&\n    data instanceof SharedArrayBuffer\n  );\n}\n\n/**\n * Return the appropriate typed array constructor for the given\n * integer type metadata.\n * @param {number} bitWidth The integer size in bits.\n * @param {boolean} signed Flag indicating if the integer is signed.\n * @returns {IntArrayConstructor}\n */\nfunction intArrayType(bitWidth, signed) {\n  const i = Math.log2(bitWidth) - 3;\n  return (\n    signed\n      ? [int8Array, int16Array, int32Array, int64Array]\n      : [uint8Array, uint16Array, uint32Array, uint64Array]\n  )[i];\n}\n\n/** Shared prototype for typed arrays. */\nconst TypedArray = Object.getPrototypeOf(Int8Array);\n\n/**\n * Check if a value is a typed array.\n * @param {*} value The value to check.\n * @returns {value is TypedArray}\n *  True if value is a typed array, false otherwise.\n */\nfunction isTypedArray(value) {\n  return value instanceof TypedArray;\n}\n\n/**\n * Check if a value is either a standard array or typed array.\n * @param {*} value The value to check.\n * @returns {value is (Array | TypedArray)}\n *  True if value is an array, false otherwise.\n */\nfunction isArray(value) {\n  return Array.isArray(value) || isTypedArray(value);\n}\n\n/**\n * Check if a value is an array type (constructor) for 64-bit integers,\n * one of BigInt64Array or BigUint64Array.\n * @param {*} value The value to check.\n * @returns {value is Int64ArrayConstructor}\n *  True if value is a 64-bit array type, false otherwise.\n */\nfunction isInt64ArrayType(value) {\n  return value === int64Array || value === uint64Array;\n}\n\n/**\n * Determine the correct index into an offset array for a given\n * full column row index. Assumes offset indices can be manipulated\n * as 32-bit signed integers.\n * @param {IntegerArray} offsets The offsets array.\n * @param {number} index The full column row index.\n */\nfunction bisect(offsets, index) {\n  let a = 0;\n  let b = offsets.length;\n  if (b <= 2147483648) { // 2 ** 31\n    // fast version, use unsigned bit shift\n    // array length fits within 32-bit signed integer\n    do {\n      const mid = (a + b) >>> 1;\n      if (offsets[mid] <= index) a = mid + 1;\n      else b = mid;\n    } while (a < b);\n  } else {\n    // slow version, use division and truncate\n    // array length exceeds 32-bit signed integer\n    do {\n      const mid = Math.trunc((a + b) / 2);\n      if (offsets[mid] <= index) a = mid + 1;\n      else b = mid;\n    } while (a < b);\n  }\n  return a;\n}\n\n/**\n * Compute a 64-bit aligned buffer size.\n * @param {number} length The starting size.\n * @param {number} bpe Bytes per element.\n * @returns {number} The aligned size.\n */\nfunction align64(length, bpe = 1) {\n  return (((length * bpe) + 7) & -8) / bpe;\n}\n\n/**\n * Return a 64-bit aligned version of the array.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} length The current array length.\n * @returns {T} The aligned array.\n */\nfunction align(array, length = array.length) {\n  const alignedLength = align64(length, array.BYTES_PER_ELEMENT);\n  return array.length > alignedLength ? /** @type {T} */ (array.subarray(0, alignedLength))\n    : array.length < alignedLength ? resize(array, alignedLength)\n    : array;\n}\n\n/**\n * Resize a typed array to exactly the specified length.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} newLength The new length.\n * @param {number} [offset] The offset at which to copy the old array.\n * @returns {T} The resized array.\n */\nfunction resize(array, newLength, offset = 0) {\n  // @ts-ignore\n  const newArray = new array.constructor(newLength);\n  newArray.set(array, offset);\n  return newArray;\n}\n\n/**\n * Grow a typed array to accommdate a minimum index. The array size is\n * doubled until it exceeds the minimum index.\n * @template {TypedArray} T\n * @param {T} array The array.\n * @param {number} index The minimum index.\n * @param {boolean} [shift] Flag to shift copied bytes to back of array.\n * @returns {T} The resized array.\n */\nfunction grow(array, index, shift) {\n  while (array.length <= index) {\n    array = resize(array, array.length << 1, shift ? array.length : 0);\n  }\n  return array;\n}\n\n/**\n * Check if a value is a Date instance\n * @param {*} value The value to check.\n * @returns {value is Date} True if value is a Date, false otherwise.\n */\nfunction isDate(value) {\n  return value instanceof Date;\n}\n\n/**\n * Check if a value is iterable.\n * @param {*} value The value to check.\n * @returns {value is Iterable} True if value is iterable, false otherwise.\n */\nfunction isIterable(value) {\n  return typeof value[Symbol.iterator] === 'function';\n}\n\n/**\n * Return the input value if it passes a test.\n * Otherwise throw an error using the given message generator.\n * @template T\n * @param {T} value The value to check.\n * @param {(value: T) => boolean} test The test function.\n * @param {(value: *) => string} message Message generator.\n * @returns {T} The input value.\n * @throws if the value does not pass the test\n */\nfunction check(value, test, message) {\n  if (test(value)) return value;\n  throw new Error(message(value));\n}\n\n/**\n * Return the input value if it exists in the provided set.\n * Otherwise throw an error using the given message generator.\n * @template T\n * @param {T} value The value to check.\n * @param {T[] | Record<string,T>} set The set of valid values.\n * @param {(value: *) => string} [message] Message generator.\n * @returns {T} The input value.\n * @throws if the value is not included in the set\n */\nfunction checkOneOf(value, set, message) {\n  set = Array.isArray(set) ? set : Object.values(set);\n  return check(\n    value,\n    (value) => set.includes(value),\n    message ?? (() => `${value} must be one of ${set}`)\n  );\n}\n\n/**\n * Return the first object key that pairs with the given value.\n * @param {Record<string,any>} object The object to search.\n * @param {any} value The value to lookup.\n * @returns {string} The first matching key, or '<Unknown>' if not found.\n */\nfunction keyFor(object, value) {\n  for (const [key, val] of Object.entries(object)) {\n    if (val === value) return key;\n  }\n  return '<Unknown>';\n}\n\n/**\n * @import { BinaryType, BinaryViewType, BoolType, DataType, DateType, DateUnit_, DecimalType, DictionaryType, DurationType, Field, FixedSizeBinaryType, FixedSizeListType, FloatType, IntBitWidth, IntervalType, IntervalUnit_, IntType, LargeBinaryType, LargeListType, LargeListViewType, LargeUtf8Type, ListType, ListViewType, MapType, NullType, Precision_, RunEndEncodedType, StructType, TimestampType, TimeType, TimeUnit_, UnionMode_, UnionType, Utf8Type, Utf8ViewType } from './types.js'\n */\n\n/**\n * @typedef {Field | DataType} FieldInput\n */\n\nconst invalidDataType = (typeId) =>\n  `Unsupported data type: \"${keyFor(Type, typeId)}\" (id ${typeId})`;\n\n/**\n * Return a new field instance for use in a schema or type definition. A field\n * represents a field name, data type, and additional metadata. Fields are used\n * to represent child types within nested types like List, Struct, and Union.\n * @param {string} name The field name.\n * @param {DataType} type The field data type.\n * @param {boolean} [nullable=true] Flag indicating if the field is nullable\n *  (default `true`).\n * @param {Map<string,string>|null} [metadata=null] Custom field metadata\n *  annotations (default `null`).\n * @returns {Field} The field instance.\n */\nconst field = (name, type, nullable = true, metadata = null) => ({\n  name,\n  type,\n  nullable,\n  metadata\n});\n\n/**\n * Checks if a value is a field instance.\n * @param {any} value\n * @returns {value is Field}\n */\nfunction isField(value) {\n  return Object.hasOwn(value, 'name') && isDataType(value.type)\n}\n\n/**\n * Checks if a value is a data type instance.\n * @param {any} value\n * @returns {value is DataType}\n */\nfunction isDataType(value) {\n  return typeof value?.typeId === 'number';\n}\n\n/**\n * Return a field instance from a field or data type input.\n * @param {FieldInput} value\n *  The value to map to a field.\n * @param {string} [defaultName] The default field name.\n * @param {boolean} [defaultNullable=true] The default nullable value.\n * @returns {Field} The field instance.\n */\nfunction asField(value, defaultName = '', defaultNullable = true) {\n  return isField(value)\n    ? value\n    : field(\n        defaultName,\n        check(value, isDataType, () => `Data type expected.`),\n        defaultNullable\n      );\n}\n\n/////\n\n/**\n * Return a basic type with only a type id.\n * @template {typeof Type[keyof typeof Type]} T\n * @param {T} typeId The type id.\n */\nconst basicType = (typeId) => ({ typeId });\n\n/**\n * Return a Dictionary data type instance.  A dictionary type consists of a\n * dictionary of values (which may be of any type) and corresponding integer\n * indices that reference those values. If values are repeated, a dictionary\n * encoding can provide substantial space savings. In the IPC format,\n * dictionary indices reside alongside other columns in a record batch, while\n * dictionary values are written to special dictionary batches, linked by a\n * unique dictionary *id*.\n * @param {DataType} type The data type of dictionary\n *  values.\n * @param {IntType} [indexType] The data type of\n *  dictionary indices. Must be an integer type (default `int32`).\n * @param {boolean} [ordered=false] Indicates if dictionary values are\n *  ordered (default `false`).\n * @param {number} [id=-1] The dictionary id. The default value (-1) indicates\n *  the dictionary applies to a single column only. Provide an explicit id in\n *  order to reuse a dictionary across columns when building, in which case\n *  different dictionaries *must* have different unique ids. All dictionary\n *  ids are later resolved (possibly to new values) upon IPC encoding.\n * @returns {DictionaryType}\n */\nconst dictionary = (type, indexType, ordered = false, id = -1) => ({\n  typeId: Type.Dictionary,\n  id,\n  dictionary: type,\n  indices: indexType || int32(),\n  ordered\n});\n\n/**\n * Return a Null data type instance. Null data requires no storage and all\n * extracted values are `null`.\n * @returns {NullType} The null data type.\n */\nconst nullType = () => basicType(Type.Null);\n\n/**\n * Return an Int data type instance.\n * @param {IntBitWidth} [bitWidth=32] The integer bit width.\n *  One of `8`, `16`, `32` (default), or `64`.\n * @param {boolean} [signed=true] Flag for signed or unsigned integers\n *  (default `true`).\n * @returns {IntType} The integer data type.\n */\nconst int = (bitWidth = 32, signed = true) => ({\n  typeId: Type.Int,\n  bitWidth: checkOneOf(bitWidth, [8, 16, 32, 64]),\n  signed,\n  values: intArrayType(bitWidth, signed)\n});\n/**\n * Return an Int data type instance for 8 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nconst int8 = () => int(8);\n/**\n * Return an Int data type instance for 16 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nconst int16 = () => int(16);\n/**\n * Return an Int data type instance for 32 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nconst int32 = () => int(32);\n/**\n * Return an Int data type instance for 64 bit signed integers.\n * @returns {IntType} The integer data type.\n */\nconst int64 = () => int(64);\n/**\n * Return an Int data type instance for 8 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nconst uint8 = () => int(8, false);\n/**\n * Return an Int data type instance for 16 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nconst uint16 = () => int(16, false);\n/**\n * Return an Int data type instance for 32 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nconst uint32 = () => int(32, false);\n/**\n * Return an Int data type instance for 64 bit unsigned integers.\n * @returns {IntType} The integer data type.\n */\nconst uint64 = () => int(64, false);\n\n/**\n * Return a Float data type instance for floating point numbers.\n * @param {Precision_} [precision=2] The floating point\n *  precision. One of `Precision.HALF` (16-bit), `Precision.SINGLE` (32-bit)\n *  or `Precision.DOUBLE` (64-bit, default).\n * @returns {FloatType} The floating point data type.\n */\nconst float = (precision = 2) => ({\n  typeId: Type.Float,\n  precision: checkOneOf(precision, Precision),\n  values: [uint16Array, float32Array, float64Array][precision]\n});\n/**\n * Return a Float data type instance for half-precision (16 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nconst float16 = () => float(Precision.HALF);\n/**\n * Return a Float data type instance for single-precision (32 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nconst float32 = () => float(Precision.SINGLE);\n/**\n * Return a Float data type instance for double-precision (64 bit) numbers.\n * @returns {FloatType} The floating point data type.\n */\nconst float64 = () => float(Precision.DOUBLE);\n\n/**\n * Return a Binary data type instance for variably-sized opaque binary data\n * with 32-bit offsets.\n * @returns {BinaryType} The binary data type.\n */\nconst binary = () => ({\n  typeId: Type.Binary,\n  offsets: int32Array\n});\n\n/**\n * Return a Utf8 data type instance for Unicode string data.\n * [UTF-8](https://en.wikipedia.org/wiki/UTF-8) code points are stored as\n * binary data.\n * @returns {Utf8Type} The utf8 data type.\n */\nconst utf8 = () => ({\n  typeId: Type.Utf8,\n  offsets: int32Array\n});\n\n/**\n * Return a Bool data type instance. Bool values are stored compactly in\n * bitmaps with eight values per byte.\n * @returns {BoolType} The bool data type.\n */\nconst bool = () => basicType(Type.Bool);\n\n/**\n * Return a Decimal data type instance. Decimal values are represented as 32,\n * 64, 128, or 256 bit integers in two's complement. Decimals are fixed point\n * numbers with a set *precision* (total number of decimal digits) and *scale*\n * (number of fractional digits). For example, the number `35.42` can be\n * represented as `3542` with *precision* \u2265 4 and *scale* = 2.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @param {32 | 64 | 128 | 256} [bitWidth] The decimal bit width.\n *  One of 32, 64, 128 (default), or 256.\n * @returns {DecimalType} The decimal data type.\n */\nconst decimal = (precision, scale, bitWidth = 128) => ({\n  typeId: Type.Decimal,\n  precision,\n  scale,\n  bitWidth: checkOneOf(bitWidth, [32, 64, 128, 256]),\n  values: bitWidth === 32 ? int32Array : uint64Array\n});\n/**\n * Return an Decimal data type instance with a bit width of 32.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nconst decimal32 = (precision, scale) => decimal(precision, scale, 32);\n/**\n * Return an Decimal data type instance with a bit width of 64.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nconst decimal64 = (precision, scale) => decimal(precision, scale, 64);\n/**\n * Return an Decimal data type instance with a bit width of 128.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nconst decimal128 = (precision, scale) => decimal(precision, scale, 128);\n/**\n * Return an Decimal data type instance with a bit width of 256.\n * @param {number} precision The decimal precision: the total number of\n *  decimal digits that can be represented.\n * @param {number} scale The number of fractional digits, beyond the\n *  decimal point.\n * @returns {DecimalType} The decimal data type.\n */\nconst decimal256 = (precision, scale) => decimal(precision, scale, 256);\n\n/**\n * Return a Date data type instance. Date values are 32-bit or 64-bit signed\n * integers representing elapsed time since the UNIX epoch (Jan 1, 1970 UTC),\n * either in units of days (32 bits) or milliseconds (64 bits, with values\n * evenly divisible by 86400000).\n * @param {DateUnit_} unit The date unit.\n *  One of `DateUnit.DAY` or `DateUnit.MILLISECOND`.\n * @returns {DateType} The date data type.\n */\nconst date = (unit) => ({\n  typeId: Type.Date,\n  unit: checkOneOf(unit, DateUnit),\n  values: unit === DateUnit.DAY ? int32Array : int64Array\n});\n/**\n * Return a Date data type instance with units of days.\n * @returns {DateType} The date data type.\n */\nconst dateDay = () => date(DateUnit.DAY);\n/**\n * Return a Date data type instance with units of milliseconds.\n * @returns {DateType} The date data type.\n */\nconst dateMillisecond = () => date(DateUnit.MILLISECOND);\n\n/**\n * Return a Time data type instance, stored in one of four *unit*s: seconds,\n * milliseconds, microseconds or nanoseconds. The integer *bitWidth* is\n * inferred from the *unit* and is 32 bits for seconds and milliseconds or\n * 64 bits for microseconds and nanoseconds. The allowed values are between 0\n * (inclusive) and 86400 (=24*60*60) seconds (exclusive), adjusted for the\n * time unit (for example, up to 86400000 exclusive for the\n * `DateUnit.MILLISECOND` unit.\n *\n * This definition doesn't allow for leap seconds. Time values from\n * measurements with leap seconds will need to be corrected when ingesting\n * into Arrow (for example by replacing the value 86400 with 86399).\n * @param {TimeUnit_} unit The time unit.\n *  One of `TimeUnit.SECOND`, `TimeUnit.MILLISECOND` (default),\n *  `TimeUnit.MICROSECOND`, or `TimeUnit.NANOSECOND`.\n * @returns {TimeType} The time data type.\n */\nconst time = (unit = TimeUnit.MILLISECOND) => {\n  unit = checkOneOf(unit, TimeUnit);\n  const bitWidth = unit === TimeUnit.SECOND || unit === TimeUnit.MILLISECOND ? 32 : 64;\n  return {\n    typeId: Type.Time,\n    unit,\n    bitWidth,\n    values: bitWidth === 32 ? int32Array : int64Array\n  };\n};\n/**\n * Return a Time data type instance, represented as seconds.\n * @returns {TimeType} The time data type.\n */\nconst timeSecond = () => time(TimeUnit.SECOND);\n/**\n * Return a Time data type instance, represented as milliseconds.\n * @returns {TimeType} The time data type.\n */\nconst timeMillisecond = () => time(TimeUnit.MILLISECOND);\n/**\n * Return a Time data type instance, represented as microseconds.\n * @returns {TimeType} The time data type.\n */\nconst timeMicrosecond = () => time(TimeUnit.MICROSECOND);\n/**\n * Return a Time data type instance, represented as nanoseconds.\n * @returns {TimeType} The time data type.\n */\nconst timeNanosecond = () => time(TimeUnit.NANOSECOND);\n\n/**\n * Return a Timestamp data type instance. Timestamp values are 64-bit signed\n * integers representing an elapsed time since a fixed epoch, stored in either\n * of four units: seconds, milliseconds, microseconds or nanoseconds, and are\n * optionally annotated with a timezone. Timestamp values do not include any\n * leap seconds (in other words, all days are considered 86400 seconds long).\n * @param {TimeUnit_} [unit] The time unit.\n *  One of `TimeUnit.SECOND`, `TimeUnit.MILLISECOND` (default),\n *  `TimeUnit.MICROSECOND`, or `TimeUnit.NANOSECOND`.\n * @param {string|null} [timezone=null] An optional string for the name of a\n *  timezone. If provided, the value should either be a string as used in the\n *  Olson timezone database (the \"tz database\" or \"tzdata\"), such as\n *  \"America/New_York\", or an absolute timezone offset of the form \"+XX:XX\" or\n *  \"-XX:XX\", such as \"+07:30\".Whether a timezone string is present indicates\n *  different semantics about the data.\n * @returns {TimestampType} The time data type.\n */\nconst timestamp = (unit = TimeUnit.MILLISECOND, timezone = null) => ({\n  typeId: Type.Timestamp,\n  unit: checkOneOf(unit, TimeUnit),\n  timezone,\n  values: int64Array\n});\n\n/**\n * Return an Interval type instance. Values represent calendar intervals stored\n * as integers for each date part. The supported *unit*s are year/moth,\n * day/time, and month/day/nanosecond intervals.\n *\n * `IntervalUnit.YEAR_MONTH` indicates the number of elapsed whole months,\n * stored as 32-bit signed integers.\n *\n * `IntervalUnit.DAY_TIME` indicates the number of elapsed days and\n * milliseconds (no leap seconds), stored as 2 contiguous 32-bit signed\n * integers (8-bytes in total).\n *\n * `IntervalUnit.MONTH_DAY_NANO` is a triple of the number of elapsed months,\n * days, and nanoseconds. The values are stored contiguously in 16-byte blocks.\n * Months and days are encoded as 32-bit signed integers and nanoseconds is\n * encoded as a 64-bit signed integer. Nanoseconds does not allow for leap\n * seconds. Each field is independent (e.g. there is no constraint that\n * nanoseconds have the same sign as days or that the quantity of nanoseconds\n * represents less than a day's worth of time).\n * @param {IntervalUnit_} unit  The interval unit.\n *  One of `IntervalUnit.YEAR_MONTH`, `IntervalUnit.DAY_TIME`, or\n *  `IntervalUnit.MONTH_DAY_NANO` (default).\n * @returns {IntervalType} The interval data type.\n */\nconst interval = (unit = IntervalUnit.MONTH_DAY_NANO) => ({\n  typeId: Type.Interval,\n  unit: checkOneOf(unit, IntervalUnit),\n  values: unit === IntervalUnit.MONTH_DAY_NANO ? undefined : int32Array\n});\n\n/**\n * Return a List data type instance, representing variably-sized lists\n * (arrays) with 32-bit offsets. A list has a single child data type for\n * list entries. Lists are represented using integer offsets that indicate\n * list extents within a single child array containing all list values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {ListType} The list data type.\n */\nconst list = (child) => ({\n  typeId: Type.List,\n  children: [ asField(child) ],\n  offsets: int32Array\n});\n\n/**\n * Return a Struct data type instance. A struct consists of multiple named\n * child data types. Struct values are stored as parallel child batches, one\n * per child type, and extracted to standard JavaScript objects.\n * @param {Field[] | Record<string, DataType>} children\n *  An array of property fields, or an object mapping property names to data\n *  types. If an object, the instantiated fields are assumed to be nullable\n *  and have no metadata.\n * @returns {StructType} The struct data type.\n */\nconst struct = (children) => ({\n  typeId: Type.Struct,\n  children: Array.isArray(children) && isField(children[0])\n    ? /** @type {Field[]} */ (children)\n    : Object.entries(children).map(([name, type]) => field(name, type))\n});\n\n/**\n * Return a Union type instance. A union is a complex type with parallel\n * *children* data types. Union values are stored in either a sparse\n * (`UnionMode.Sparse`) or dense (`UnionMode.Dense`) layout *mode*. In a\n * sparse layout, child types are stored in parallel arrays with the same\n * lengths, resulting in many unused, empty values. In a dense layout, child\n * types have variable lengths and an offsets array is used to index the\n * appropriate value.\n *\n * By default, ids in the type vector refer to the index in the children\n * array. Optionally, *typeIds* provide an indirection between the child\n * index and the type id. For each child, `typeIds[index]` is the id used\n * in the type vector. The *typeIdForValue* argument provides a lookup\n * function for mapping input data to the proper child type id, and is\n * required if using builder methods.\n * @param {UnionMode_} mode The union mode.\n *  One of `UnionMode.Sparse` or `UnionMode.Dense`.\n * @param {FieldInput[]} children The children fields or data types.\n *  Types are mapped to nullable fields with no metadata.\n * @param {number[]} [typeIds]  Children type ids, in the same order as the\n *  children types. Type ids provide a level of indirection over children\n *  types. If not provided, the children indices are used as the type ids.\n * @param {(value: any, index: number) => number} [typeIdForValue]\n *  A function that takes an arbitrary value and a row index and returns a\n *  correponding union type id. Required by builder methods.\n * @returns {UnionType} The union data type.\n */\nconst union = (mode, children, typeIds, typeIdForValue) => {\n  typeIds ??= children.map((v, i) => i);\n  return {\n    typeId: Type.Union,\n    mode: checkOneOf(mode, UnionMode),\n    typeIds,\n    typeMap: typeIds.reduce((m, id, i) => ((m[id] = i), m), {}),\n    children: children.map((v, i) => asField(v, `_${i}`)),\n    typeIdForValue,\n    offsets: int32Array,\n  };\n};\n\n/**\n * Create a FixedSizeBinary data type instance for opaque binary data where\n * each entry has the same fixed size.\n * @param {number} stride The fixed size in bytes.\n * @returns {FixedSizeBinaryType} The fixed size binary data type.\n */\nconst fixedSizeBinary = (stride) => ({\n  typeId: Type.FixedSizeBinary,\n  stride\n});\n\n/**\n * Return a FixedSizeList type instance for list (array) data where every list\n * has the same fixed size. A list has a single child data type for list\n * entries. Fixed size lists are represented as a single child array containing\n * all list values, indexed using the known stride.\n * @param {FieldInput} child The list item data type.\n * @param {number} stride The fixed list size.\n * @returns {FixedSizeListType} The fixed size list data type.\n */\nconst fixedSizeList = (child, stride) => ({\n  typeId: Type.FixedSizeList,\n  stride,\n  children: [ asField(child) ]\n});\n\n/**\n * Internal method to create a Map type instance.\n * @param {boolean} keysSorted Flag indicating if the map keys are sorted.\n * @param {Field} child The child fields.\n * @returns {MapType} The map data type.\n */\nconst mapType = (keysSorted, child) => ({\n  typeId: Type.Map,\n  keysSorted,\n  children: [child],\n  offsets: int32Array\n});\n\n/**\n * Return a Map data type instance representing collections of key-value pairs.\n * A Map is a logical nested type that is represented as a list of key-value\n * structs. The key and value types are not constrained, so the application is\n * responsible for ensuring that the keys are hashable and unique, and that\n * keys are properly sorted if *keysSorted* is `true`.\n * @param {FieldInput} keyField The map key field or data type.\n * @param {FieldInput} valueField The map value field or data type.\n * @param {boolean} [keysSorted=false] Flag indicating if the map keys are\n *  sorted (default `false`).\n * @returns {MapType} The map data type.\n */\nconst map = (keyField, valueField, keysSorted = false) => mapType(\n  keysSorted,\n  field(\n    'entries',\n    struct([ asField(keyField, 'key', false), asField(valueField, 'value') ]),\n    false\n  )\n);\n\n/**\n * Return a Duration data type instance. Durations represent an absolute length\n * of time unrelated to any calendar artifacts. The resolution defaults to\n * millisecond, but can be any of the other `TimeUnit` values. This type is\n * always represented as a 64-bit integer.\n * @param {TimeUnit_} unit\n * @returns {DurationType} The duration data type.\n */\nconst duration = (unit = TimeUnit.MILLISECOND) => ({\n  typeId: Type.Duration,\n  unit: checkOneOf(unit, TimeUnit),\n  values: int64Array\n});\n\n/**\n * Return a LargeBinary data type instance for variably-sized opaque binary\n * data with 64-bit offsets, allowing representation of extremely large data\n * values.\n * @returns {LargeBinaryType} The large binary data type.\n */\nconst largeBinary = () => ({\n  typeId: Type.LargeBinary,\n  offsets: int64Array\n});\n\n/**\n * Return a LargeUtf8 data type instance for Unicode string data of variable\n * length with 64-bit offsets, allowing representation of extremely large data\n * values. [UTF-8](https://en.wikipedia.org/wiki/UTF-8) code points are stored\n * as binary data.\n * @returns {LargeUtf8Type} The large utf8 data type.\n */\nconst largeUtf8 = () => ({\n  typeId: Type.LargeUtf8,\n  offsets: int64Array\n});\n\n/**\n * Return a LargeList data type instance, representing variably-sized lists\n * (arrays) with 64-bit offsets, allowing representation of extremely large\n * data values. A list has a single child data type for list entries. Lists\n * are represented using integer offsets that indicate list extents within a\n * single child array containing all list values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {LargeListType} The large list data type.\n */\nconst largeList = (child) => ({\n  typeId: Type.LargeList,\n  children: [ asField(child) ],\n  offsets: int64Array\n});\n\n/**\n * Return a RunEndEncoded data type instance, which compresses data by\n * representing consecutive repeated values as a run. This data type uses two\n * child arrays, `run_ends` and `values`. The `run_ends` child array must be\n * a 16, 32, or 64 bit integer array which encodes the indices at which the\n * run with the value in each corresponding index in the values child array\n * ends. Like list and struct types, the `values` array can be of any type.\n * @param {FieldInput} runsField The run-ends field or data type.\n * @param {FieldInput} valuesField The values field or data type.\n * @returns {RunEndEncodedType} The large list data type.\n */\nconst runEndEncoded = (runsField, valuesField) => ({\n  typeId: Type.RunEndEncoded,\n  children: [\n    check(\n      asField(runsField, 'run_ends'),\n      (field) => field.type.typeId === Type.Int,\n      () => 'Run-ends must have an integer type.'\n    ),\n    asField(valuesField, 'values')\n  ]\n});\n\n/**\n * Return a BinaryView data type instance. BinaryView data is logically the\n * same as the Binary type, but the internal representation uses a view struct\n * that contains the string length and either the string's entire data inline\n * (for small strings) or an inlined prefix, an index of another buffer, and an\n * offset pointing to a slice in that buffer (for non-small strings).\n *\n * Flechette can encode and decode BinaryView data; however, Flechette does\n * not currently support building BinaryView columns from JavaScript values.\n * @returns {BinaryViewType} The binary view data type.\n */\nconst binaryView = () => /** @type {BinaryViewType} */\n  (basicType(Type.BinaryView));\n\n/**\n * Return a Utf8View data type instance. Utf8View data is logically the same as\n * the Utf8 type, but the internal representation uses a view struct that\n * contains the string length and either the string's entire data inline (for\n * small strings) or an inlined prefix, an index of another buffer, and an\n * offset pointing to a slice in that buffer (for non-small strings).\n *\n * Flechette can encode and decode Utf8View data; however, Flechette does\n * not currently support building Utf8View columns from JavaScript values.\n * @returns {Utf8ViewType} The utf8 view data type.\n */\nconst utf8View = () => /** @type {Utf8ViewType} */\n  (basicType(Type.Utf8View));\n\n/**\n * Return a ListView data type instance, representing variably-sized lists\n * (arrays) with 32-bit offsets. ListView data represents the same logical\n * types that List can, but contains both offsets and sizes allowing for\n * writes in any order and sharing of child values among list values.\n *\n * Flechette can encode and decode ListView data; however, Flechette does not\n * currently support building ListView columns from JavaScript values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {ListViewType} The list view data type.\n */\nconst listView = (child) => ({\n  typeId: Type.ListView,\n  children: [ asField(child, 'value') ],\n  offsets: int32Array\n});\n\n/**\n * Return a LargeListView data type instance, representing variably-sized lists\n * (arrays) with 64-bit offsets, allowing representation of extremely large\n * data values. LargeListView data represents the same logical types that\n * LargeList can, but contains both offsets and sizes allowing for writes\n * in any order and sharing of child values among list values.\n *\n * Flechette can encode and decode LargeListView data; however, Flechette does\n * not currently support building LargeListView columns from JavaScript values.\n * @param {FieldInput} child The child (list item) field or data type.\n * @returns {LargeListViewType} The large list view data type.\n */\nconst largeListView = (child) => ({\n  typeId: Type.LargeListView,\n  children: [ asField(child, 'value') ],\n  offsets: int64Array\n});\n\n/**\n * @import { TimeUnit_, TypedArray } from '../types.js';\n */\n\n// typed arrays over a shared buffer to aid binary conversion\nconst f64 = new float64Array(2);\nconst buf = f64.buffer;\nconst i64 = new int64Array(buf);\nconst u32 = new uint32Array(buf);\nconst i32 = new int32Array(buf);\nconst u8 = new uint8Array(buf);\n\n/**\n * Return a value unchanged.\n * @template T\n * @param {T} value The value.\n * @returns {T} The value.\n */\nfunction identity(value) {\n  return value;\n}\n\n/**\n * Return a value coerced to a BigInt.\n * @param {*} value The value.\n * @returns {bigint} The BigInt value.\n */\nfunction toBigInt(value) {\n  return BigInt(value);\n}\n\n/**\n * Return an offset conversion method for the given data type.\n * @param {{ offsets: TypedArray}} type The array type.\n */\nfunction toOffset(type) {\n  return isInt64ArrayType(type) ? toBigInt : identity;\n}\n\n/**\n * Return the number of days from a millisecond timestamp.\n * @param {number} value The millisecond timestamp.\n * @returns {number} The number of days.\n */\nfunction toDateDay(value) {\n  return (value / 864e5) | 0;\n}\n\n/**\n * Return a timestamp conversion method for the given time unit.\n * @param {TimeUnit_} unit The time unit.\n * @returns {(value: number) => bigint} The conversion method.\n */\nfunction toTimestamp(unit) {\n  return unit === TimeUnit.SECOND ? value => toBigInt(value / 1e3)\n    : unit === TimeUnit.MILLISECOND ? toBigInt\n    : unit === TimeUnit.MICROSECOND ? value => toBigInt(value * 1e3)\n    : value => toBigInt(value * 1e6);\n}\n\n/**\n * Write month/day/nanosecond interval to a byte buffer.\n * @param {Array | Float64Array} interval The interval data.\n * @returns {Uint8Array} A byte buffer with the interval data.\n *  The returned buffer is reused across calls, and so should be\n *  copied to a target buffer immediately.\n */\nfunction toMonthDayNanoBytes([m, d, n]) {\n  i32[0] = m;\n  i32[1] = d;\n  i64[1] = toBigInt(n);\n  return u8;\n}\n\n/**\n * Coerce a bigint value to a number. Throws an error if the bigint value\n * lies outside the range of what a number can precisely represent.\n * @param {bigint} value The value to check and possibly convert.\n * @returns {number} The converted number value.\n */\nfunction toNumber(value) {\n  if (value > Number.MAX_SAFE_INTEGER || value < Number.MIN_SAFE_INTEGER) {\n    throw Error(`BigInt exceeds integer number representation: ${value}`);\n  }\n  return Number(value);\n}\n\n/**\n * Divide one BigInt value by another, and return the result as a number.\n * The division may involve unsafe integers and a loss of precision.\n * @param {bigint} num The numerator.\n * @param {bigint} div The divisor.\n * @returns {number} The result of the division as a floating point number.\n */\nfunction divide(num, div) {\n  return Number(num / div) + Number(num % div) / Number(div);\n}\n\n/**\n * Return a 32-bit decimal conversion method for the given decimal scale.\n * @param {number} scale The scale mapping fractional digits to integers.\n * @returns {(value: number|bigint) => number} A conversion method that maps\n *  floating point numbers to 32-bit decimals.\n */\nfunction toDecimal32(scale) {\n  return (value) => typeof value === 'bigint'\n    ? Number(value)\n    : Math.trunc(value * scale);\n}\n\n/**\n * Convert a floating point number or bigint to decimal bytes.\n * @param {number|bigint} value The number to encode. If a bigint, we assume\n *  it already represents the decimal in integer form with the correct scale.\n *  Otherwise, we assume a float that requires scaled integer conversion.\n * @param {BigUint64Array} buf The uint64 array to write to.\n * @param {number} offset The starting index offset into the array.\n * @param {number} stride The stride of an encoded decimal, in 64-bit steps.\n * @param {number} scale The scale mapping fractional digits to integers.\n */\nfunction toDecimal(value, buf, offset, stride, scale) {\n  const v = typeof value === 'bigint'\n    ? value\n    : toBigInt(Math.trunc(value * scale));\n  // assignment into uint64array performs needed truncation for us\n  buf[offset] = v;\n  if (stride > 1) {\n    buf[offset + 1] = (v >> 64n);\n    if (stride > 2) {\n      buf[offset + 2] = (v >> 128n);\n      buf[offset + 3] = (v >> 192n);\n    }\n  }\n}\n\n// helper method to extract uint64 values from bigints\nconst asUint64 = v => BigInt.asUintN(64, v);\n\n/**\n * Convert a 64-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nfunction fromDecimal64(buf, offset) {\n  return BigInt.asIntN(64, buf[offset]);\n}\n\n/**\n * Convert a 128-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nfunction fromDecimal128(buf, offset) {\n  const i = offset << 1;\n  let x;\n  if (BigInt.asIntN(64, buf[i + 1]) < 0) {\n    x = asUint64(~buf[i]) | (asUint64(~buf[i + 1]) << 64n);\n    x = -(x + 1n);\n  } else {\n    x = buf[i] | (buf[i + 1] << 64n);\n  }\n  return x;\n}\n\n/**\n * Convert a 256-bit decimal value to a bigint.\n * @param {BigUint64Array} buf The uint64 array containing the decimal bytes.\n * @param {number} offset The starting index offset into the array.\n * @returns {bigint} The converted decimal as a bigint, such that all\n *  fractional digits are scaled up to integers (for example, 1.12 -> 112).\n */\nfunction fromDecimal256(buf, offset) {\n  const i = offset << 2;\n  let x;\n  if (BigInt.asIntN(64, buf[i + 3]) < 0) {\n    x = asUint64(~buf[i])\n      | (asUint64(~buf[i + 1]) << 64n)\n      | (asUint64(~buf[i + 2]) << 128n)\n      | (asUint64(~buf[i + 3]) << 192n);\n    x = -(x + 1n);\n  } else {\n    x = buf[i]\n      | (buf[i + 1] << 64n)\n      | (buf[i + 2] << 128n)\n      | (buf[i + 3] << 192n);\n  }\n  return x;\n}\n\n/**\n * Convert a number to a 16-bit float as integer bytes..\n * Inspired by numpy's `npy_double_to_half`:\n * https://github.com/numpy/numpy/blob/5a5987291dc95376bb098be8d8e5391e89e77a2c/numpy/core/src/npymath/halffloat.c#L43\n * Adapted from https://github.com/apache/arrow/blob/main/js/src/util/math.ts\n * @param {number} value The 64-bit floating point number to convert.\n * @returns {number} The converted 16-bit integer.\n */\nfunction toFloat16(value) {\n  if (value !== value) return 0x7E00; // NaN\n  f64[0] = value;\n\n  // Magic numbers:\n  // 0x80000000 = 10000000 00000000 00000000 00000000 -- masks the 32nd bit\n  // 0x7ff00000 = 01111111 11110000 00000000 00000000 -- masks the 21st-31st bits\n  // 0x000fffff = 00000000 00001111 11111111 11111111 -- masks the 1st-20th bit\n  const sign = (u32[1] & 0x80000000) >> 16 & 0xFFFF;\n  let expo = (u32[1] & 0x7FF00000), sigf = 0x0000;\n\n  if (expo >= 0x40F00000) {\n    //\n    // If exponent overflowed, the float16 is either NaN or Infinity.\n    // Rules to propagate the sign bit: mantissa > 0 ? NaN : +/-Infinity\n    //\n    // Magic numbers:\n    // 0x40F00000 = 01000000 11110000 00000000 00000000 -- 6-bit exponent overflow\n    // 0x7C000000 = 01111100 00000000 00000000 00000000 -- masks the 27th-31st bits\n    //\n    // returns:\n    // qNaN, aka 32256 decimal, 0x7E00 hex, or 01111110 00000000 binary\n    // sNaN, aka 32000 decimal, 0x7D00 hex, or 01111101 00000000 binary\n    // +inf, aka 31744 decimal, 0x7C00 hex, or 01111100 00000000 binary\n    // -inf, aka 64512 decimal, 0xFC00 hex, or 11111100 00000000 binary\n    //\n    // If mantissa is greater than 23 bits, set to +Infinity like numpy\n    if (u32[0] > 0) {\n      expo = 0x7C00;\n    } else {\n      expo = (expo & 0x7C000000) >> 16;\n      sigf = (u32[1] & 0x000FFFFF) >> 10;\n    }\n  } else if (expo <= 0x3F000000) {\n    //\n    // If exponent underflowed, the float is either signed zero or subnormal.\n    //\n    // Magic numbers:\n    // 0x3F000000 = 00111111 00000000 00000000 00000000 -- 6-bit exponent underflow\n    //\n    sigf = 0x100000 + (u32[1] & 0x000FFFFF);\n    sigf = 0x100000 + (sigf << ((expo >> 20) - 998)) >> 21;\n    expo = 0;\n  } else {\n    //\n    // No overflow or underflow, rebase the exponent and round the mantissa\n    // Magic numbers:\n    // 0x200 = 00000010 00000000 -- masks off the 10th bit\n    //\n    // Ensure the first mantissa bit (the 10th one) is 1 and round\n    expo = (expo - 0x3F000000) >> 10;\n    sigf = ((u32[1] & 0x000FFFFF) + 0x200) >> 10;\n  }\n  return sign | expo | sigf & 0xFFFF;\n}\n\nconst textDecoder = new TextDecoder('utf-8');\nconst textEncoder = new TextEncoder();\n\n/**\n * Return a UTF-8 string decoded from a byte buffer.\n * @param {Uint8Array} buf The byte buffer.\n * @returns {string} The decoded string.\n */\nfunction decodeUtf8(buf) {\n  return textDecoder.decode(buf);\n}\n\n/**\n * Return a byte buffer encoded from a UTF-8 string.\n * @param {string } str The string to encode.\n * @returns {Uint8Array} The encoded byte buffer.\n */\nfunction encodeUtf8(str) {\n  return textEncoder.encode(str);\n}\n\n/**\n * Return a string-coercible key value that uniquely identifies a value.\n * @param {*} value The input value.\n * @returns {string} The key string.\n */\nfunction keyString(value) {\n  const val = typeof value !== 'object' || !value ? (value ?? null)\n    : isDate(value) ? +value\n    // @ts-ignore\n    : isArray(value) ? `[${value.map(keyString)}]`\n    : objectKey(value);\n  return `${val}`;\n}\n\nfunction objectKey(value) {\n  let s = '';\n  let i = -1;\n  for (const k in value) {\n    if (++i > 0) s += ',';\n    s += `\"${k}\":${keyString(value[k])}`;\n  }\n  return `{${s}}`;\n}\n\n/** The size in bytes of a 32-bit integer. */\nconst SIZEOF_INT = 4;\n\n/** The size in bytes of a 16-bit integer. */\nconst SIZEOF_SHORT = 2;\n\n/**\n * Return a boolean for a single bit in a bitmap.\n * @param {Uint8Array} bitmap The bitmap.\n * @param {number} index The bit index to read.\n * @returns {boolean} The boolean bitmap value.\n */\nfunction decodeBit(bitmap, index) {\n  return (bitmap[index >> 3] & 1 << (index % 8)) !== 0;\n}\n\n/**\n * Lookup helper for flatbuffer object (table) entries.\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} index The base index of the object.\n */\nfunction readObject(buf, index) {\n  const pos = index + readInt32(buf, index);\n  const vtable = pos - readInt32(buf, pos);\n  const size = readInt16(buf, vtable);\n  /**\n   * Retrieve a value from a flatbuffer table layout.\n   * @template T\n   * @param {number} index The table entry index.\n   * @param {(buf: Uint8Array, offset: number) => T} read Read function to invoke.\n   * @param {T} [fallback=null] The default fallback value.\n   * @returns {T}\n   */\n  return (index, read, fallback = null) => {\n    if (index < size) {\n      const off = readInt16(buf, vtable + index);\n      if (off) return read(buf, pos + off);\n    }\n    return fallback;\n  };\n}\n\n/**\n * Return a buffer offset value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readOffset(buf, offset) {\n  return offset;\n}\n\n/**\n * Return a boolean value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {boolean}\n */\nfunction readBoolean(buf, offset) {\n  return !!readInt8(buf, offset);\n}\n\n/**\n * Return a signed 8-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readInt8(buf, offset) {\n  return readUint8(buf, offset) << 24 >> 24;\n}\n\n/**\n * Return an unsigned 8-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readUint8(buf, offset) {\n  return buf[offset];\n}\n\n/**\n * Return a signed 16-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readInt16(buf, offset) {\n  return readUint16(buf, offset) << 16 >> 16;\n}\n\n/**\n * Return an unsigned 16-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readUint16(buf, offset) {\n  return buf[offset] | buf[offset + 1] << 8;\n}\n\n/**\n * Return a signed 32-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readInt32(buf, offset) {\n  return buf[offset]\n    | buf[offset + 1] << 8\n    | buf[offset + 2] << 16\n    | buf[offset + 3] << 24;\n}\n\n/**\n * Return an unsigned 32-bit integer value.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readUint32(buf, offset) {\n  return readInt32(buf, offset) >>> 0;\n}\n\n/**\n * Return a signed 64-bit integer value coerced to a JS number.\n * Throws an error if the value exceeds what a JS number can represent.\n * @param {Uint8Array} buf\n * @param {number} offset\n * @returns {number}\n */\nfunction readInt64(buf, offset) {\n  return toNumber(BigInt.asIntN(\n    64,\n    BigInt(readUint32(buf, offset)) +\n      (BigInt(readUint32(buf, offset + SIZEOF_INT)) << 32n)\n  ));\n}\n\n/**\n * Create a JavaScript string from UTF-8 data stored inside the FlatBuffer.\n * This allocates a new string and converts to wide chars upon each access.\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} index The index of the string entry.\n * @returns {string} The decoded string.\n */\nfunction readString(buf, index) {\n  let offset = index + readInt32(buf, index); // get the string offset\n  const length = readInt32(buf, offset);  // get the string length\n  offset += SIZEOF_INT; // skip length value\n  return decodeUtf8(buf.subarray(offset, offset + length));\n}\n\n/**\n * Extract a flatbuffer vector to an array.\n * @template T\n * @param {Uint8Array} buf The byte buffer.\n * @param {number} offset The offset location of the vector.\n * @param {number} stride The stride between vector entries.\n * @param {(buf: Uint8Array, pos: number) => T} extract Vector entry extraction function.\n * @returns {T[]} The extracted vector entries.\n */\nfunction readVector(buf, offset, stride, extract) {\n  if (!offset) return [];\n\n  // get base position by adding offset delta\n  const base = offset + readInt32(buf, offset);\n\n  // read vector size, extract entries\n  return Array.from(\n    { length: readInt32(buf, base) },\n    (_, i) => extract(buf, base + SIZEOF_INT + i * stride)\n  );\n}\n\n/**\n * @import { Batch } from '../batch.js';\n */\n\n/**\n * Symbol for the row index value of a struct object proxy.\n */\nconst RowIndex = Symbol('rowIndex');\n\n/**\n * Returns a row proxy object factory. The resulting method takes a\n * batch-level row index as input and returns an object that proxies\n * access to underlying batches.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @returns {(index: number) => Record<string, any>}\n */\nfunction proxyFactory(names, batches) {\n  class RowObject {\n    /**\n     * Create a new proxy row object representing a struct or table row.\n     * @param {number} index The record batch row index.\n     */\n    constructor(index) {\n      this[RowIndex] = index;\n    }\n\n    /**\n     * Return a JSON-compatible object representation.\n     */\n    toJSON() {\n      return structObject(names, batches, this[RowIndex]);\n    }\n  }\n  // prototype for row proxy objects\n  const proto = RowObject.prototype;\n\n  for (let i = 0; i < names.length; ++i) {\n    // skip duplicated column names\n    if (Object.hasOwn(proto, names[i])) continue;\n\n    // add a getter method for the current batch\n    const batch = batches[i];\n    Object.defineProperty(proto, names[i], {\n      get() { return batch.at(this[RowIndex]); },\n      enumerable: true\n    });\n  }\n\n  return index => new RowObject(index);\n}\n\n/**\n * Returns a row object factory. The resulting method takes a\n * batch-level row index as input and returns an object whose property\n * values have been extracted from the batches.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @returns {(index: number) => Record<string, any>}\n */\nfunction objectFactory(names, batches) {\n  return index => structObject(names, batches, index);\n}\n\n/**\n * Return a vanilla object representing a struct (row object) type.\n * @param {string[]} names The column (property) names\n * @param {Batch[]} batches The value batches.\n * @param {number} index The record batch row index.\n * @returns {Record<string, any>}\n */\nfunction structObject(names, batches, index) {\n  const obj = {};\n  for (let i = 0; i < names.length; ++i) {\n    obj[names[i]] = batches[i].at(index);\n  }\n  return obj;\n}\n\n/**\n * @import { Column } from './column.js'\n * @import { DataType, DecimalType, IntegerArray, OffsetArray, TypedArray, TypedArrayConstructor, ValueArray } from './types.js'\n */\n\n/**\n * Check if the input is a batch that supports direct access to\n * binary data in the form of typed arrays.\n * @param {Batch<any>?} batch The data batch to check.\n * @returns {boolean} True if a direct batch, false otherwise.\n */\nfunction isDirectBatch(batch) {\n  return batch instanceof DirectBatch;\n}\n\n/**\n * Column values from a single record batch.\n * A column may contain multiple batches.\n * @template T\n */\nclass Batch {\n  /**\n   * The array type to use when extracting data from the batch.\n   * A null value indicates that the array type should match\n   * the type of the batch's values array.\n   * @type {ArrayConstructor | TypedArrayConstructor | null}\n   */\n  static ArrayType = null;\n\n  /**\n   * Create a new column batch.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {TypedArray} [options.values] Values buffer\n   * @param {OffsetArray} [options.offsets] Offsets buffer\n   * @param {OffsetArray} [options.sizes] Sizes buffer\n   * @param {Batch[]} [options.children] Children batches\n   */\n  constructor({\n    length,\n    nullCount,\n    type,\n    validity,\n    values,\n    offsets,\n    sizes,\n    children\n  }) {\n    this.length = length;\n    this.nullCount = nullCount;\n    this.type = type;\n    this.validity = validity;\n    this.values = values;\n    this.offsets = offsets;\n    this.sizes = sizes;\n    this.children = children;\n\n    // optimize access if this batch has no null values\n    // some types (like union) may have null values in\n    // child batches, but no top-level validity buffer\n    if (!nullCount || !this.validity) {\n      /** @type {(index: number) => T | null} */\n      this.at = index => this.value(index);\n    }\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Batch';\n  }\n\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {T | null} The value.\n   */\n  at(index) {\n    return this.isValid(index) ? this.value(index) : null;\n  }\n\n  /**\n   * Check if a value at the given index is valid (non-null).\n   * @param {number} index The value index.\n   * @returns {boolean} True if valid, false otherwise.\n   */\n  isValid(index) {\n    return decodeBit(this.validity, index);\n  }\n\n  /**\n   * Return the value at the given index. This method does not check the\n   * validity bitmap and is intended primarily for internal use. In most\n   * cases, callers should use the `at()` method instead.\n   * @param {number} index The value index\n   * @returns {T} The value, ignoring the validity bitmap.\n   */\n  value(index) {\n    return /** @type {T} */ (this.values[index]);\n  }\n\n  /**\n   * Extract an array of values within the given index range. Unlike\n   * Array.slice, all arguments are required and may not be negative indices.\n   * @param {number} start The starting index, inclusive\n   * @param {number} end The ending index, exclusive\n   * @returns {ValueArray<T?>} The slice of values\n   */\n  slice(start, end) {\n    const n = end - start;\n    const values = Array(n);\n    for (let i = 0; i < n; ++i) {\n      values[i] = this.at(start + i);\n    }\n    return values;\n  }\n\n  /**\n   * Return an iterator over the values in this batch.\n   * @returns {Iterator<T?>}\n   */\n  *[Symbol.iterator]() {\n    for (let i = 0; i < this.length; ++i) {\n      yield this.at(i);\n    }\n  }\n}\n\n/**\n * A batch whose value buffer can be used directly, without transformation.\n * @template T\n * @extends {Batch<T>}\n */\nclass DirectBatch extends Batch {\n  /**\n   * Create a new column batch with direct value array access.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {TypedArray} options.values Values buffer\n   */\n  constructor(options) {\n    super(options);\n    // underlying buffers may be padded, exceeding the logical batch length\n    // we trim the values array so we can safely access it directly\n    const { length, values } = this;\n    this.values = values.subarray(0, length);\n  }\n\n  /**\n   * Extract an array of values within the given index range. Unlike\n   * Array.slice, all arguments are required and may not be negative indices.\n   * When feasible, a zero-copy subarray of a typed array is returned.\n   * @param {number} start The starting index, inclusive\n   * @param {number} end The ending index, exclusive\n   * @returns {ValueArray<T?>} The slice of values\n   */\n  slice(start, end) {\n    // @ts-ignore\n    return this.nullCount\n      ? super.slice(start, end)\n      : this.values.subarray(start, end);\n  }\n\n  /**\n   * Return an iterator over the values in this batch.\n   * @returns {Iterator<T?>}\n   */\n  [Symbol.iterator]() {\n    return this.nullCount\n      ? super[Symbol.iterator]()\n      : /** @type {Iterator<T?>} */ (this.values[Symbol.iterator]());\n  }\n}\n\n/**\n * A batch whose values are transformed to 64-bit numbers.\n * @extends {Batch<number>}\n */\nclass NumberBatch extends Batch {\n  static ArrayType = float64Array;\n}\n\n/**\n * A batch whose values should be returned in a standard array.\n * @template T\n * @extends {Batch<T>}\n */\nclass ArrayBatch extends Batch {\n  static ArrayType = Array;\n}\n\n/**\n * A batch of null values only.\n * @extends {ArrayBatch<null>}\n */\nclass NullBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {null}\n   */\n  value(index) { // eslint-disable-line no-unused-vars\n    return null;\n  }\n}\n\n/**\n * A batch that coerces BigInt values to 64-bit numbers.\n * @extends {NumberBatch}\n */\nclass Int64Batch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return toNumber(/** @type {bigint} */ (this.values[index]));\n  }\n}\n\n/**\n * A batch of 16-bit floating point numbers, accessed as unsigned\n * 16-bit ints and transformed to 64-bit numbers.\n */\nclass Float16Batch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    const v = /** @type {number} */ (this.values[index]);\n    const expo = (v & 0x7C00) >> 10;\n    const sigf = (v & 0x03FF) / 1024;\n    const sign = (-1) ** ((v & 0x8000) >> 15);\n    switch (expo) {\n      case 0x1F: return sign * (sigf ? Number.NaN : 1 / 0);\n      case 0x00: return sign * (sigf ? 6.103515625e-5 * sigf : 0);\n    }\n    return sign * (2 ** (expo - 15)) * (1 + sigf);\n  }\n}\n\n/**\n * A batch of boolean values stored as a bitmap.\n * @extends {ArrayBatch<boolean>}\n */\nclass BoolBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return decodeBit(/** @type {Uint8Array} */ (this.values), index);\n  }\n}\n\n/**\n * A batch of 32-bit decimal numbers, returned as converted 64-bit floating\n * point numbers. Number coercion may be lossy if the decimal precision can\n * not be represented in a 64-bit floating point format.\n * @extends {NumberBatch}\n */\nclass Decimal32NumberBatch extends NumberBatch {\n  constructor(options) {\n    super(options);\n    const { scale } = /** @type {DecimalType} */ (this.type);\n    this.scale = 10 ** scale;\n  }\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return /** @type {number} */(this.values[index]) / this.scale;\n  }\n}\n\n/**\n * An abstract class for a batch of 64-, 128- or 256-bit decimal numbers,\n * accessed in strided BigUint64Arrays.\n * @template T\n * @extends {Batch<T>}\n */\nclass DecimalBatch extends Batch {\n  constructor(options) {\n    super(options);\n    const { bitWidth, scale } = /** @type {DecimalType} */ (this.type);\n    this.decimal = bitWidth === 64 ? fromDecimal64\n      : bitWidth === 128 ? fromDecimal128\n      : fromDecimal256;\n    this.scale = 10n ** BigInt(scale);\n  }\n}\n\n/**\n * A batch of 64-, 128- or 256-bit decimal numbers, returned as converted\n * 64-bit floating point numbers. Number coercion may be lossy if the decimal\n * precision can not be represented in a 64-bit floating point format.\n * @extends {DecimalBatch<number>}\n */\nclass DecimalNumberBatch extends DecimalBatch {\n  static ArrayType = float64Array;\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return divide(\n      this.decimal(/** @type {BigUint64Array} */ (this.values), index),\n      this.scale\n    );\n  }\n}\n\n/**\n * A batch of 64-, 128- or 256-bit decimal numbers, returned as scaled\n * bigint values, such that all fractional digits have been shifted\n * to integer places by the decimal type scale factor.\n * @extends {DecimalBatch<bigint>}\n */\nclass DecimalBigIntBatch extends DecimalBatch {\n  static ArrayType = Array;\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return this.decimal(/** @type {BigUint64Array} */ (this.values), index);\n  }\n}\n\n/**\n * A batch of date or timestamp values that are coerced to UNIX epoch timestamps\n * and returned as JS Date objects. This batch wraps a source batch that provides\n * timestamp values.\n * @extends {ArrayBatch<Date>}\n */\nclass DateBatch extends ArrayBatch {\n  /**\n   * Create a new date batch.\n   * @param {Batch<number>} batch A batch of timestamp values.\n   */\n  constructor(batch) {\n    super(batch);\n    this.source = batch;\n  }\n\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return new Date(this.source.value(index));\n  }\n}\n\n/**\n * A batch of dates as day counts, coerced to timestamp numbers.\n */\nclass DateDayBatch extends NumberBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {number}\n   */\n  value(index) {\n    // epoch days to milliseconds\n    return 86400000 * /** @type {number} */ (this.values[index]);\n  }\n}\n\n/**\n * A batch of dates as millisecond timestamps, coerced to numbers.\n */\nconst DateDayMillisecondBatch = Int64Batch;\n\n/**\n * A batch of timestaps in seconds, coerced to millisecond numbers.\n */\nclass TimestampSecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    return super.value(index) * 1e3; // seconds to milliseconds\n  }\n}\n\n/**\n * A batch of timestaps in milliseconds, coerced to numbers.\n */\nconst TimestampMillisecondBatch = Int64Batch;\n\n/**\n * A batch of timestaps in microseconds, coerced to millisecond numbers.\n */\nclass TimestampMicrosecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    // microseconds to milliseconds\n    return divide(/** @type {bigint} */ (this.values[index]), 1000n);\n  }\n}\n\n/**\n * A batch of timestaps in nanoseconds, coerced to millisecond numbers.\n */\nclass TimestampNanosecondBatch extends Int64Batch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    // nanoseconds to milliseconds\n    return divide(/** @type {bigint} */ (this.values[index]), 1000000n);\n  }\n}\n\n/**\n * A batch of day/time intervals, returned as two-element 32-bit int arrays.\n * @extends {ArrayBatch<Int32Array>}\n */\nclass IntervalDayTimeBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   * @returns {Int32Array}\n   */\n  value(index) {\n    const values = /** @type {Int32Array} */ (this.values);\n    return values.subarray(index << 1, (index + 1) << 1);\n  }\n}\n\n/**\n * A batch of month/day/nanosecond intervals, returned as three-element arrays.\n * @extends {ArrayBatch<Float64Array>}\n */\nclass IntervalMonthDayNanoBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index\n   */\n  value(index) {\n    const values = /** @type {Uint8Array} */ (this.values);\n    const base = index << 4;\n    return Float64Array.of(\n      readInt32(values, base),\n      readInt32(values, base + 4),\n      readInt64(values, base + 8)\n    );\n  }\n}\n\nconst offset32 = ({values, offsets}, index) => values.subarray(offsets[index], offsets[index + 1]);\nconst offset64 = ({values, offsets}, index) => values.subarray(toNumber(offsets[index]), toNumber(offsets[index + 1]));\n\n/**\n * A batch of binary blobs with variable offsets, returned as byte buffers of\n * unsigned 8-bit integers. The offsets are 32-bit ints.\n * @extends {ArrayBatch<Uint8Array>}\n */\nclass BinaryBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    return offset32(this, index);\n  }\n}\n\n/**\n * A batch of binary blobs with variable offsets, returned as byte buffers of\n * unsigned 8-bit integers. The offsets are 64-bit ints. Value extraction will\n * fail if an offset exceeds `Number.MAX_SAFE_INTEGER`.\n * @extends {ArrayBatch<Uint8Array>}\n */\nclass LargeBinaryBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    return offset64(this, index);\n  }\n}\n\n/**\n * A batch of UTF-8 strings with variable offsets. The offsets are 32-bit ints.\n * @extends {ArrayBatch<string>}\n */\nclass Utf8Batch extends ArrayBatch {\n  /**\n   * @param {number} index\n   */\n  value(index) {\n    return decodeUtf8(offset32(this, index));\n  }\n}\n\n/**\n * A batch of UTF-8 strings with variable offsets. The offsets are 64-bit ints.\n * Value extraction will fail if an offset exceeds `Number.MAX_SAFE_INTEGER`.\n * @extends {ArrayBatch<string>}\n */\nclass LargeUtf8Batch extends ArrayBatch {\n  /**\n   * @param {number} index\n   */\n  value(index) {\n    return decodeUtf8(offset64(this, index));\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets are\n * 32-bit ints.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nclass ListBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const offsets = /** @type {Int32Array} */ (this.offsets);\n    return this.children[0].slice(offsets[index], offsets[index + 1]);\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets are\n * 64-bit ints. Value extraction will fail if an offset exceeds\n * `Number.MAX_SAFE_INTEGER`.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nclass LargeListBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const offsets = /** @type {BigInt64Array} */ (this.offsets);\n    return this.children[0].slice(toNumber(offsets[index]), toNumber(offsets[index + 1]));\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets and\n * sizes are 32-bit ints.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nclass ListViewBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const a = /** @type {number} */ (this.offsets[index]);\n    const b = a + /** @type {number} */ (this.sizes[index]);\n    return this.children[0].slice(a, b);\n  }\n}\n\n/**\n * A batch of list (array) values of variable length. The list offsets and\n * sizes are 64-bit ints. Value extraction will fail if an offset or size\n * exceeds `Number.MAX_SAFE_INTEGER`.\n * @template V\n * @extends {ArrayBatch<ValueArray<V>>}\n */\nclass LargeListViewBatch extends ArrayBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const a = /** @type {bigint} */ (this.offsets[index]);\n    const b = a + /** @type {bigint} */ (this.sizes[index]);\n    return this.children[0].slice(toNumber(a), toNumber(b));\n  }\n}\n\n/**\n * A batch with a fixed stride.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass FixedBatch extends ArrayBatch {\n  constructor(options) {\n    super(options);\n    /** @type {number} */\n    // @ts-ignore\n    this.stride = this.type.stride;\n  }\n}\n\n/**\n * A batch of binary blobs of fixed size, returned as byte buffers of unsigned\n * 8-bit integers.\n * @extends {FixedBatch<Uint8Array>}\n */\nclass FixedBinaryBatch extends FixedBatch {\n  /**\n   * @param {number} index\n   * @returns {Uint8Array}\n   */\n  value(index) {\n    const { stride, values } = this;\n    return /** @type {Uint8Array} */ (values)\n      .subarray(index * stride, (index + 1) * stride);\n  }\n}\n\n/**\n * A batch of list (array) values of fixed length.\n * @template V\n * @extends {FixedBatch<ValueArray<V>>}\n */\nclass FixedListBatch extends FixedBatch {\n  /**\n   * @param {number} index\n   * @returns {ValueArray<V>}\n   */\n  value(index) {\n    const { children, stride } = this;\n    return children[0].slice(index * stride, (index + 1) * stride);\n  }\n}\n\n/**\n * Extract Map key-value pairs from parallel child batches.\n */\nfunction pairs({ children, offsets }, index) {\n  const [ keys, vals ] = children[0].children;\n  const start = offsets[index];\n  const end = offsets[index + 1];\n  const entries = [];\n  for (let i = start; i < end; ++i) {\n    entries.push([keys.at(i), vals.at(i)]);\n  }\n  return entries;\n}\n\n/**\n * A batch of map (key, value) values. The map is represented as a list of\n * key-value structs.\n * @template K, V\n * @extends {ArrayBatch<[K, V][]>}\n */\nclass MapEntryBatch extends ArrayBatch {\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {[K, V][]} The map entries as an array of [key, value] arrays.\n   */\n  value(index) {\n    return /** @type {[K, V][]} */ (pairs(this, index));\n  }\n}\n\n/**\n * A batch of map (key, value) values. The map is represented as a list of\n * key-value structs.\n * @template K, V\n * @extends {ArrayBatch<Map<K, V>>}\n */\nclass MapBatch extends ArrayBatch {\n  /**\n   * Return the value at the given index.\n   * @param {number} index The value index.\n   * @returns {Map<K, V>} The map value.\n   */\n  value(index) {\n    return new Map(/** @type {[K, V][]} */ (pairs(this, index)));\n  }\n}\n\n/**\n * A batch of union-type values with a sparse layout, enabling direct\n * lookup from the child value batches.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass SparseUnionBatch extends ArrayBatch {\n  /**\n   * Create a new column batch.\n   * @param {object} options\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {Int32Array} [options.offsets] Offsets buffer\n   * @param {Batch[]} options.children Children batches\n   * @param {Int8Array} options.typeIds Union type ids buffer\n   * @param {Record<string, number>} options.map A typeId to children index map\n   */\n  constructor({ typeIds, ...options }) {\n    super(options);\n    /** @type {Int8Array} */\n    this.typeIds = typeIds;\n    /** @type {Record<string, number>} */\n    // @ts-ignore\n    this.typeMap = this.type.typeMap;\n  }\n\n  /**\n   * @param {number} index The value index.\n   */\n  value(index, offset = index) {\n    const { typeIds, children, typeMap } = this;\n    return children[typeMap[typeIds[index]]].at(offset);\n  }\n}\n\n/**\n * A batch of union-type values with a dense layout, reqiring offset\n * lookups from the child value batches.\n * @template T\n * @extends {SparseUnionBatch<T>}\n */\nclass DenseUnionBatch extends SparseUnionBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return super.value(index, /** @type {number} */ (this.offsets[index]));\n  }\n}\n\n/**\n * A batch of struct values, containing a set of named properties.\n * Struct property values are extracted and returned as JS objects.\n * @extends {ArrayBatch<Record<string, any>>}\n */\nclass StructBatch extends ArrayBatch {\n  constructor(options, factory = objectFactory) {\n    super(options);\n    /** @type {string[]} */\n    // @ts-ignore\n    this.names = this.type.children.map(child => child.name);\n    this.factory = factory(this.names, this.children);\n  }\n\n  /**\n   * @param {number} index The value index.\n   * @returns {Record<string, any>}\n   */\n  value(index) {\n    return this.factory(index);\n  }\n}\n\n/**\n * A batch of struct values, containing a set of named properties.\n * Structs are returned as proxy objects that extract data directly\n * from underlying Arrow batches.\n * @extends {StructBatch}\n */\nclass StructProxyBatch extends StructBatch {\n  constructor(options) {\n    super(options, proxyFactory);\n  }\n}\n\n/**\n * A batch of run-end-encoded values.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass RunEndEncodedBatch extends ArrayBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    const [ { values: runs }, vals ] = this.children;\n    return vals.at(\n      bisect(/** @type {IntegerArray} */(runs), index)\n    );\n  }\n}\n\n/**\n * A batch of dictionary-encoded values.\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass DictionaryBatch extends ArrayBatch {\n  /**\n   * Register the backing dictionary. Dictionaries are added\n   * after batch creation as the complete dictionary may not\n   * be finished across multiple record batches.\n   * @param {Column<T>} dictionary\n   * The dictionary of column values.\n   */\n  setDictionary(dictionary) {\n    this.dictionary = dictionary;\n    this.cache = dictionary.cache();\n    return this;\n  }\n\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return this.cache[this.key(index)];\n  }\n\n  /**\n   * @param {number} index The value index.\n   * @returns {number} The dictionary key\n   */\n  key(index) {\n    return /** @type {number} */ (this.values[index]);\n  }\n}\n\n/**\n * @template T\n * @extends {ArrayBatch<T>}\n */\nclass ViewBatch extends ArrayBatch {\n  /**\n   * Create a new view batch.\n   * @param {object} options Batch options.\n   * @param {number} options.length The length of the batch\n   * @param {number} options.nullCount The null value count\n   * @param {DataType} options.type The data type.\n   * @param {Uint8Array} [options.validity] Validity bitmap buffer\n   * @param {Uint8Array} options.values Values buffer\n   * @param {Uint8Array[]} options.data View data buffers\n   */\n  constructor({ data, ...options }) {\n    super(options);\n    this.data = data;\n  }\n\n  /**\n   * Get the binary data at the provided index.\n   * @param {number} index The value index.\n   * @returns {Uint8Array}\n   */\n  view(index) {\n    const { values, data } = this;\n    const offset = index << 4; // each entry is 16 bytes\n    let start = offset + 4;\n    let buf = /** @type {Uint8Array} */ (values);\n    const length = readInt32(buf, offset);\n    if (length > 12) {\n      // longer strings are in a data buffer\n      start = readInt32(buf, offset + 12);\n      buf = data[readInt32(buf, offset + 8)];\n    }\n    return buf.subarray(start, start + length);\n  }\n}\n\n/**\n * A batch of binary blobs from variable data buffers, returned as byte\n * buffers of unsigned 8-bit integers.\n * @extends {ViewBatch<Uint8Array>}\n */\nclass BinaryViewBatch extends ViewBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return this.view(index);\n  }\n}\n\n/**\n * A batch of UTF-8 strings from variable data buffers.\n * @extends {ViewBatch<string>}\n */\nclass Utf8ViewBatch extends ViewBatch {\n  /**\n   * @param {number} index The value index.\n   */\n  value(index) {\n    return decodeUtf8(this.view(index));\n  }\n}\n\n/**\n * @import { Batch } from './batch.js'\n * @import { DataType, ValueArray } from './types.js'\n */\n\n/**\n * Build up a column from batches.\n */\nfunction columnBuilder(type) {\n  let data = [];\n  return {\n    add(batch) { data.push(batch); return this; },\n    clear: () => data = [],\n    done: () => new Column(data, type)\n  };\n}\n\n/**\n * A data column. A column provides a view over one or more value batches,\n * each drawn from an Arrow record batch. This class supports random access\n * to column values by integer index; however, extracting arrays using\n * `toArray()` or iterating over values (`for (const value of column) {...}`)\n * provide more efficient ways for bulk access or scanning.\n * @template T\n */\nclass Column {\n  /**\n   * Create a new column instance.\n   * @param {Batch<T>[]} data The value batches.\n   * @param {DataType} [type] The column data type.\n   *  If not specified, the type is extracted from the batches.\n   */\n  constructor(data, type = data[0]?.type) {\n    /**\n     * The column data type.\n     * @type {DataType}\n     * @readonly\n     */\n    this.type = type;\n    /**\n     * The column length.\n     * @type {number}\n     * @readonly\n     */\n    this.length = data.reduce((m, c) => m + c.length, 0);\n    /**\n     * The count of null values in the column.\n     * @type {number}\n     * @readonly\n     */\n    this.nullCount = data.reduce((m, c) => m + c.nullCount, 0);\n    /**\n     * An array of column data batches.\n     * @type {readonly Batch<T>[]}\n     * @readonly\n     */\n    this.data = data;\n\n    const n = data.length;\n    const offsets = new Int32Array(n + 1);\n    if (n === 1) {\n      const [ batch ] = data;\n      offsets[1] = batch.length;\n      // optimize access to single batch\n      this.at = index => batch.at(index);\n    } else {\n      for (let i = 0, s = 0; i < n; ++i) {\n        offsets[i + 1] = (s += data[i].length);\n      }\n    }\n\n    /**\n     * Index offsets for data batches.\n     * Used to map a column row index to a batch-specific index.\n     * @type {Int32Array}\n     * @readonly\n     */\n    this.offsets = offsets;\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Column';\n  }\n\n  /**\n   * Return an iterator over the values in this column.\n   * @returns {Iterator<T?>}\n   */\n  [Symbol.iterator]() {\n    const data = this.data;\n    return data.length === 1\n      ? data[0][Symbol.iterator]()\n      : batchedIterator(data);\n  }\n\n  /**\n   * Return the column value at the given index. If a column has multiple\n   * batches, this method performs binary search over the batch lengths to\n   * determine the batch from which to retrieve the value. The search makes\n   * lookup less efficient than a standard array access. If making a full\n   * scan of a column, consider extracting arrays via `toArray()` or using an\n   * iterator (`for (const value of column) {...}`).\n   * @param {number} index The row index.\n   * @returns {T | null} The value.\n   */\n  at(index) {\n    // NOTE: if there is only one batch, this method is replaced with an\n    // optimized version in the Column constructor.\n    const { data, offsets } = this;\n    const i = bisect(offsets, index) - 1;\n    return data[i]?.at(index - offsets[i]); // undefined if out of range\n  }\n\n  /**\n   * Return the column value at the given index. This method is the same as\n   * `at()` and is provided for better compatibility with Apache Arrow JS.\n   * @param {number} index The row index.\n   * @returns {T | null} The value.\n   */\n  get(index) {\n    return this.at(index);\n  }\n\n  /**\n   * Extract column values into a single array instance. When possible,\n   * a zero-copy subarray of the input Arrow data is returned.\n   * @returns {ValueArray<T?>}\n   */\n  toArray() {\n    const { length, nullCount, data } = this;\n    const copy = !nullCount && isDirectBatch(data[0]);\n    const n = data.length;\n\n    if (copy && n === 1) {\n      // use batch array directly\n      // @ts-ignore\n      return data[0].values;\n    }\n\n    // determine output array type\n    const ArrayType = !n || nullCount > 0 ? Array\n      // @ts-ignore\n      : (data[0].constructor.ArrayType ?? data[0].values.constructor);\n\n    const array = new ArrayType(length);\n    return copy ? copyArray(array, data) : extractArray(array, data);\n  }\n\n  /**\n   * Return an array of cached column values.\n   * Used internally to accelerate dictionary types.\n   */\n  cache() {\n    return this._cache ?? (this._cache = this.toArray());\n  }\n}\n\nfunction *batchedIterator(data) {\n  for (let i = 0; i < data.length; ++i) {\n    const iter = data[i][Symbol.iterator]();\n    for (let next = iter.next(); !next.done; next = iter.next()) {\n      yield next.value;\n    }\n  }\n}\n\nfunction copyArray(array, data) {\n  for (let i = 0, offset = 0; i < data.length; ++i) {\n    const { values } = data[i];\n    array.set(values, offset);\n    offset += values.length;\n  }\n  return array;\n}\n\nfunction extractArray(array, data) {\n  let index = -1;\n  for (let i = 0; i < data.length; ++i) {\n    const batch = data[i];\n    for (let j = 0; j < batch.length; ++j) {\n      array[++index] = batch.at(j);\n    }\n  }\n  return array;\n}\n\n/**\n * @import { Column } from './column.js'\n * @import { Schema, StructFactory, TypeMap, ValueArray } from './types.js'\n */\n\n/**\n * A table consists of a collection of named columns (or 'children').\n * To work with table data directly in JavaScript, use `toColumns()`\n * to extract an object that maps column names to extracted value arrays,\n * or `toArray()` to extract an array of row objects. For random access\n * by row index, use `getChild()` to access data for a specific column.\n * @template {TypeMap} [T=TypeMap]\n */\nclass Table {\n  /**\n   * Create a new table with the given schema and columns (children).\n   * @param {Schema} schema The table schema.\n   * @param {Column[]} children The table columns.\n   * @param {boolean} [useProxy=false] Flag indicating if row proxy\n   *  objects should be used to represent table rows (default `false`).\n   */\n  constructor(schema, children, useProxy = false) {\n    const names = schema.fields.map(f => f.name);\n\n    /**\n     * @type {Schema}\n     * @readonly\n     */\n    this.schema = schema;\n    /**\n     * @type {(keyof T)[]}\n     * @readonly\n     */\n    this.names = names;\n    /**\n     * @type {Column[]}\n     * @readonly\n     */\n    this.children = children;\n    /**\n     * @type {StructFactory}\n     * @readonly\n     */\n    this.factory = useProxy ? proxyFactory : objectFactory;\n\n    // lazily created row object generators\n    const gen = [];\n\n    /**\n     * Returns a row object generator for the given batch index.\n     * @private\n     * @readonly\n     * @param {number} b The batch index.\n     * @returns {(index: number) => { [P in keyof T]: T[P] }}\n     */\n    this.getFactory = b => gen[b]\n      ?? (gen[b] = this.factory(names, children.map(c => c.data[b])));\n  }\n\n  /**\n   * Provide an informative object string tag.\n   */\n  get [Symbol.toStringTag]() {\n    return 'Table';\n  }\n\n  /**\n   * The number of columns in this table.\n   * @return {number} The number of columns.\n   */\n  get numCols() {\n    return this.names.length;\n  }\n\n  /**\n   * The number of rows in this table.\n   * @return {number} The number of rows.\n   */\n  get numRows() {\n    return this.children[0]?.length ?? 0;\n  }\n\n  /**\n   * Return the child column at the given index position.\n   * @template {T[keyof T]} R\n   * @param {number} index The column index.\n   * @returns {Column<R>}\n   */\n  getChildAt(index) {\n    return this.children[index];\n  }\n\n  /**\n   * Return the first child column with the given name.\n   * @template {keyof T} P\n   * @param {P} name The column name.\n   * @returns {Column<T[P]>}\n   */\n  getChild(name) {\n    const i = this.names.findIndex(x => x === name);\n    return i > -1 ? this.children[i] : undefined;\n  }\n\n  /**\n   * Construct a new table containing only columns at the specified indices.\n   * The order of columns in the new table matches the order of input indices.\n   * @template {T[keyof T]} V\n   * @param {number[]} indices The indices of columns to keep.\n   * @param {string[]} [as] Optional new names for selected columns.\n   * @returns {Table<{ [key: string]: V }>} A new table with selected columns.\n   */\n  selectAt(indices, as = []) {\n    const { children, factory, schema } = this;\n    const { fields } = schema;\n    return new Table(\n      {\n        ...schema,\n        fields: indices.map((i, j) => renameField(fields[i], as[j]))\n      },\n      indices.map(i => children[i]),\n      factory === proxyFactory\n    );\n  }\n\n  /**\n   * Construct a new table containing only columns with the specified names.\n   * If columns have duplicate names, the first (with lowest index) is used.\n   * The order of columns in the new table matches the order of input names.\n   * @template {keyof T} K\n   * @param {K[]} names Names of columns to keep.\n   * @param {string[]} [as] Optional new names for selected columns.\n   * @returns A new table with columns matching the specified names.\n   */\n  select(names, as) {\n    const all = /** @type {K[]} */(this.names);\n    const indices = names.map(name => all.indexOf(name));\n    return this.selectAt(indices, as);\n  }\n\n  /**\n   * Return an object mapping column names to extracted value arrays.\n   * @returns {{ [P in keyof T]: ValueArray<T[P]> }}\n   */\n  toColumns() {\n    const { children, names } = this;\n    /** @type {{ [P in keyof T]: ValueArray<T[P]> }} */\n    // @ts-expect-error assign to empty object\n    const cols = {};\n    names.forEach((name, i) => cols[name] = children[i]?.toArray() ?? [] );\n    return cols;\n  }\n\n  /**\n   * Return an array of objects representing the rows of this table.\n   * @returns {{ [P in keyof T]: T[P] }[]}\n   */\n  toArray() {\n    const { children, getFactory, numRows } = this;\n    const data = children[0]?.data ?? [];\n    const output = Array(numRows);\n    for (let b = 0, row = -1; b < data.length; ++b) {\n      const f = getFactory(b);\n      for (let i = 0; i < data[b].length; ++i) {\n        output[++row] = f(i);\n      }\n    }\n    return output;\n  }\n\n  /**\n   * Return an iterator over objects representing the rows of this table.\n   * @returns {Generator<{ [P in keyof T]: T[P] }, any, any>}\n   */\n  *[Symbol.iterator]() {\n    const { children, getFactory } = this;\n    const data = children[0]?.data ?? [];\n    for (let b = 0; b < data.length; ++b) {\n      const f = getFactory(b);\n      for (let i = 0; i < data[b].length; ++i) {\n        yield f(i);\n      }\n    }\n  }\n\n  /**\n   * Return a row object for the given index.\n   * @param {number} index The row index.\n   * @returns {{ [P in keyof T]: T[P] }} The row object.\n   */\n  at(index) {\n    const { children, getFactory, numRows } = this;\n    if (index < 0 || index >= numRows) return null;\n    const [{ offsets }] = children;\n    const b = bisect(offsets, index) - 1;\n    return getFactory(b)(index - offsets[b]);\n  }\n\n  /**\n   * Return a row object for the given index. This method is the same as\n   * `at()` and is provided for better compatibility with Apache Arrow JS.\n   * @param {number} index The row index.\n   * @returns {{ [P in keyof T]: T[P] }} The row object.\n   */\n  get(index) {\n    return this.at(index);\n  }\n}\n\nfunction renameField(field, name) {\n  return (name != null && name !== field.name)\n    ? { ...field, name }\n    : field;\n}\n\n/**\n * @import { DataType, ExtractionOptions } from './types.js';\n */\n\n/**\n * Return a batch constructor for the given data type and extraction options.\n * @param {DataType} type The data type.\n * @param {ExtractionOptions} options The extraction options.\n */\nfunction batchType(type, options = {}) {\n  const { typeId, bitWidth, mode, precision, unit } = /** @type {any} */(type);\n  const { useBigInt, useDate, useDecimalInt, useMap, useProxy } = options;\n\n  switch (typeId) {\n    case Type.Null: return NullBatch;\n    case Type.Bool: return BoolBatch;\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n      return useBigInt || bitWidth < 64 ? DirectBatch : Int64Batch;\n    case Type.Float:\n      return precision ? DirectBatch : Float16Batch;\n    case Type.Date:\n      return wrap(\n        unit === DateUnit.DAY ? DateDayBatch : DateDayMillisecondBatch,\n        useDate && DateBatch\n      );\n    case Type.Timestamp:\n      return wrap(\n        unit === TimeUnit.SECOND ? TimestampSecondBatch\n          : unit === TimeUnit.MILLISECOND ? TimestampMillisecondBatch\n          : unit === TimeUnit.MICROSECOND ? TimestampMicrosecondBatch\n          : TimestampNanosecondBatch,\n        useDate && DateBatch\n      );\n    case Type.Decimal:\n      return bitWidth === 32\n        ? (useDecimalInt ? DirectBatch : Decimal32NumberBatch)\n        : (useDecimalInt ? DecimalBigIntBatch : DecimalNumberBatch);\n    case Type.Interval:\n      return unit === IntervalUnit.DAY_TIME ? IntervalDayTimeBatch\n        : unit === IntervalUnit.YEAR_MONTH ? DirectBatch\n        : IntervalMonthDayNanoBatch;\n    case Type.FixedSizeBinary: return FixedBinaryBatch;\n    case Type.Utf8: return Utf8Batch;\n    case Type.LargeUtf8: return LargeUtf8Batch;\n    case Type.Binary: return BinaryBatch;\n    case Type.LargeBinary: return LargeBinaryBatch;\n    case Type.BinaryView: return BinaryViewBatch;\n    case Type.Utf8View: return Utf8ViewBatch;\n    case Type.List: return ListBatch;\n    case Type.LargeList: return LargeListBatch;\n    case Type.Map: return useMap ? MapBatch : MapEntryBatch;\n    case Type.ListView: return ListViewBatch;\n    case Type.LargeListView: return LargeListViewBatch;\n    case Type.FixedSizeList: return FixedListBatch;\n    case Type.Struct: return useProxy ? StructProxyBatch : StructBatch;\n    case Type.RunEndEncoded: return RunEndEncodedBatch;\n    case Type.Dictionary: return DictionaryBatch;\n    case Type.Union: return mode ? DenseUnionBatch : SparseUnionBatch;\n  }\n  throw new Error(invalidDataType(typeId));\n}\n\nfunction wrap(BaseClass, WrapperClass) {\n  return WrapperClass\n    ? class WrapBatch extends WrapperClass {\n        constructor(options) {\n          super(new BaseClass(options));\n        }\n      }\n    : BaseClass;\n}\n\n/**\n * Decode a block that points to messages within an Arrow 'file' format.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns The file block.\n */\nfunction decodeBlock(buf, index) {\n  //  0: offset\n  //  8: metadataLength\n  // 16: bodyLength\n  return {\n    offset: readInt64(buf, index),\n    metadataLength: readInt32(buf, index + 8),\n    bodyLength: readInt64(buf, index + 16)\n  }\n}\n\n/**\n * Decode a vector of blocks.\n * @param {Uint8Array} buf\n * @param {number} index\n * @returns An array of file blocks.\n */\nfunction decodeBlocks(buf, index) {\n  return readVector(buf, index, 24, decodeBlock);\n}\n\n/**\n * @import { RecordBatch, Version_ } from '../types.js'\n */\n\n/**\n * Decode a record batch.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {RecordBatch} The record batch\n */\nfunction decodeRecordBatch(buf, index, version) {\n  //  4: length\n  //  6: nodes\n  //  8: buffers\n  // 10: compression (not supported)\n  // 12: variadicBuffers (buffer counts for view-typed fields)\n  const get = readObject(buf, index);\n  if (get(10, readOffset, 0)) {\n    throw new Error('Record batch compression not implemented');\n  }\n\n  // If an Arrow buffer was written before version 4,\n  // advance 8 bytes to skip the now-removed page_id field\n  const offset = version < Version.V4 ? 8 : 0;\n\n  return {\n    length: get(4, readInt64, 0),\n    nodes: readVector(buf, get(6, readOffset), 16, (buf, pos) => ({\n      length: readInt64(buf, pos),\n      nullCount: readInt64(buf, pos + 8)\n    })),\n    regions: readVector(buf, get(8, readOffset), 16 + offset, (buf, pos) => ({\n      offset: readInt64(buf, pos + offset),\n      length: readInt64(buf, pos + offset + 8)\n    })),\n    variadic: readVector(buf, get(12, readOffset), 8, readInt64)\n  };\n}\n\n/**\n * @import { DictionaryBatch, Version_ } from '../types.js'\n */\n\n/**\n * Decode a dictionary batch.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {DictionaryBatch} The dictionary batch\n */\nfunction decodeDictionaryBatch(buf, index, version) {\n  //  4: id\n  //  6: data\n  //  8: isDelta\n  const get = readObject(buf, index);\n  return {\n    id: get(4, readInt64, 0),\n    data: get(6, (buf, off) => decodeRecordBatch(buf, off, version)),\n    /**\n     * If isDelta is true the values in the dictionary are to be appended to a\n     * dictionary with the indicated id. If isDelta is false this dictionary\n     * should replace the existing dictionary.\n     */\n    isDelta: get(8, readBoolean, false)\n  };\n}\n\n/**\n * @import { DataType, Field } from '../types.js'\n */\n\n/**\n * Decode a data type definition for a field.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data.\n * @param {number} index The starting index in the byte buffer.\n * @param {number} typeId The data type id.\n * @param {Field[]} [children] A list of parsed child fields.\n * @returns {DataType} The data type.\n */\nfunction decodeDataType(buf, index, typeId, children) {\n  checkOneOf(typeId, Type, invalidDataType);\n  const get = readObject(buf, index);\n\n  switch (typeId) {\n    // types without flatbuffer objects\n    case Type.Binary: return binary();\n    case Type.Utf8: return utf8();\n    case Type.LargeBinary: return largeBinary();\n    case Type.LargeUtf8: return largeUtf8();\n    case Type.List: return list(children[0]);\n    case Type.ListView: return listView(children[0]);\n    case Type.LargeList: return largeList(children[0]);\n    case Type.LargeListView: return largeListView(children[0]);\n    case Type.Struct: return struct(children);\n    case Type.RunEndEncoded: return runEndEncoded(children[0], children[1]);\n\n    // types with flatbuffer objects\n    case Type.Int: return int(\n      // @ts-ignore\n      get(4, readInt32, 0), // bitwidth\n      get(6, readBoolean, false) // signed\n    );\n    case Type.Float: return float(\n      // @ts-ignore\n      get(4, readInt16, Precision.HALF) // precision\n    );\n    case Type.Decimal: return decimal(\n      get(4, readInt32, 0), // precision\n      get(6, readInt32, 0), // scale\n      // @ts-ignore\n      get(8, readInt32, 128) // bitwidth\n    );\n    case Type.Date: return date(\n      // @ts-ignore\n      get(4, readInt16, DateUnit.MILLISECOND) // unit\n    );\n    case Type.Time: return time(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.MILLISECOND) // unit\n    );\n    case Type.Timestamp: return timestamp(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.SECOND), // unit\n      get(6, readString) // timezone\n    );\n    case Type.Interval: return interval(\n      // @ts-ignore\n      get(4, readInt16, IntervalUnit.YEAR_MONTH) // unit\n    );\n    case Type.Duration: return duration(\n      // @ts-ignore\n      get(4, readInt16, TimeUnit.MILLISECOND) // unit\n    );\n\n    case Type.FixedSizeBinary: return fixedSizeBinary(\n      get(4, readInt32, 0) // stride\n    );\n    case Type.FixedSizeList: return fixedSizeList(\n      children[0],\n      get(4, readInt32, 0), // stride\n    );\n    case Type.Map: return mapType(\n      get(4, readBoolean, false), // keysSorted\n      children[0]\n    );\n\n    case Type.Union: return union(\n      // @ts-ignore\n      get(4, readInt16, UnionMode.Sparse), // mode\n      children,\n      readVector(buf, get(6, readOffset), 4, readInt32) // type ids\n    );\n  }\n  // case Type.NONE:\n  // case Type.Null:\n  // case Type.Bool:\n  // case Type.BinaryView:\n  // case Type.Utf8View:\n  // @ts-ignore\n  return { typeId };\n}\n\n/**\n * @import { Metadata } from '../types.js'\n */\n\n/**\n * Decode custom metadata consisting of key-value string pairs.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns {Metadata | null} The custom metadata map\n */\nfunction decodeMetadata(buf, index) {\n  const entries = readVector(buf, index, 4, (buf, pos) => {\n    const get = readObject(buf, pos);\n    return /** @type {[string, string]} */ ([\n      get(4, readString), // 4: key (string)\n      get(6, readString)  // 6: key (string)\n    ]);\n  });\n  return entries.length ? new Map(entries) : null;\n}\n\n/**\n * @import { DictionaryType, Endianness_, Field, IntType, Schema, Version_ } from '../types.js'\n */\n\n/**\n * Decode a table schema describing the fields and their data types.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @param {Version_} version Arrow version value\n * @returns {Schema} The schema\n */\nfunction decodeSchema(buf, index, version) {\n  //  4: endianness (int16)\n  //  6: fields (vector)\n  //  8: metadata (vector)\n  // 10: features (int64[])\n  const get = readObject(buf, index);\n  return {\n    version,\n    endianness: /** @type {Endianness_} */ (get(4, readInt16, 0)),\n    fields: get(6, decodeSchemaFields, []),\n    metadata: get(8, decodeMetadata)\n  };\n}\n\n/**\n * @returns {Field[] | null}\n */\nfunction decodeSchemaFields(buf, fieldsOffset) {\n  return readVector(buf, fieldsOffset, 4, decodeField);\n}\n\n/**\n * @returns {Field}\n */\nfunction decodeField(buf, index) {\n  //  4: name (string)\n  //  6: nullable (bool)\n  //  8: type id (uint8)\n  // 10: type (union)\n  // 12: dictionary (table)\n  // 14: children (vector)\n  // 16: metadata (vector)\n  const get = readObject(buf, index);\n  const typeId = get(8, readUint8, Type.NONE);\n  const typeOffset = get(10, readOffset, 0);\n  const dict = get(12, decodeDictionary);\n  const children = get(14, (buf, off) => decodeFieldChildren(buf, off));\n\n  let type = decodeDataType(buf, typeOffset, typeId, children);\n  if (dict) {\n    dict.dictionary = type;\n    type = dict;\n  }\n\n  return {\n    name: get(4, readString),\n    type,\n    nullable: get(6, readBoolean, false),\n    metadata: get(16, decodeMetadata)\n  };\n}\n\n/**\n * @returns {Field[] | null}\n */\nfunction decodeFieldChildren(buf, fieldOffset) {\n  const children = readVector(buf, fieldOffset, 4, decodeField);\n  return children.length ? children : null;\n}\n\n/**\n * @param {Uint8Array} buf\n * @param {number} index\n * @returns {DictionaryType}\n */\nfunction decodeDictionary(buf, index) {\n  if (!index) return null;\n  //  4: id (int64)\n  //  6: indexType (Int type)\n  //  8: isOrdered (boolean)\n  // 10: kind (int16) currently only dense array is supported\n  const get = readObject(buf, index);\n  return dictionary(\n    null, // data type will be populated by caller\n    get(6, decodeInt, int32()), // index type\n    get(8, readBoolean, false), // ordered\n    get(4, readInt64, 0), // id\n  );\n}\n\n/**\n * Decode an integer data type.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data.\n * @param {number} index The starting index in the byte buffer.\n * @returns {IntType}\n */\nfunction decodeInt(buf, index) {\n  return /** @type {IntType} */ (\n    decodeDataType(buf, index, Type.Int)\n  );\n}\n\n/**\n * @import { Message, MessageHeader_, Version_ } from '../types.js'\n */\n\nconst invalidMessageMetadata = (expected, actual) =>\n  `Expected to read ${expected} metadata bytes, but only read ${actual}.`;\n\nconst invalidMessageBodyLength = (expected, actual) =>\n  `Expected to read ${expected} bytes for message body, but only read ${actual}.`;\n\nconst invalidMessageType = (type) =>\n  `Unsupported message type: ${type} (${keyFor(MessageHeader, type)})`;\n\n/**\n * A \"message\" contains a block of Apache Arrow data, such as a schema,\n * record batch, or dictionary batch. This message decodes a single\n * message, returning its associated metadata and content.\n * @param {Uint8Array} buf A byte buffer of binary Arrow IPC data\n * @param {number} index The starting index in the byte buffer\n * @returns {Message} The decoded message.\n */\nfunction decodeMessage(buf, index) {\n  // get message start\n  let metadataLength = readInt32(buf, index) || 0;\n  index += SIZEOF_INT;\n\n  // ARROW-6313: If the first 4 bytes are continuation indicator (-1), read\n  // the next 4 for the 32-bit metadata length. Otherwise, assume this is a\n  // pre-v0.15 message, where the first 4 bytes are the metadata length.\n  if (metadataLength === -1) {\n    metadataLength = readInt32(buf, index) || 0;\n    index += SIZEOF_INT;\n  }\n  if (metadataLength === 0) return null;\n\n  const head = buf.subarray(index, index += metadataLength);\n  if (head.byteLength < metadataLength) {\n    throw new Error(invalidMessageMetadata(metadataLength, head.byteLength));\n  }\n\n  // decode message metadata\n  //  4: version\n  //  6: headerType\n  //  8: headerIndex\n  // 10: bodyLength\n  const get = readObject(head, 0);\n  const version = /** @type {Version_} */\n    (get(4, readInt16, Version.V1));\n  const type = /** @type {MessageHeader_} */\n    (get(6, readUint8, MessageHeader.NONE));\n  const offset = get(8, readOffset, 0);\n  const bodyLength = get(10, readInt64, 0);\n  let content;\n\n  if (offset) {\n    // decode message header\n    const decoder = type === MessageHeader.Schema ? decodeSchema\n      : type === MessageHeader.DictionaryBatch ? decodeDictionaryBatch\n      : type === MessageHeader.RecordBatch ? decodeRecordBatch\n      : null;\n    if (!decoder) throw new Error(invalidMessageType(type));\n    content = decoder(head, offset, version);\n\n    // extract message body\n    if (bodyLength > 0) {\n      const body = buf.subarray(index, index += bodyLength);\n      if (body.byteLength < bodyLength) {\n        throw new Error(invalidMessageBodyLength(bodyLength, body.byteLength));\n      }\n      // @ts-ignore\n      content.body = body;\n    } else if (type !== MessageHeader.Schema) {\n      // table-from-ipc.js buffer accessor requires body to exist, even for empty batches\n      // @ts-ignore\n      content.body = new Uint8Array(0);\n    }\n  }\n\n  return { version, type, index, content };\n}\n\n/**\n * @import { ArrowData, Version_ } from '../types.js'\n */\n\n/**\n * Decode [Apache Arrow IPC data][1] and return parsed schema, record batch,\n * and dictionary batch definitions. The input binary data may be either\n * an `ArrayBuffer` or `Uint8Array`. For Arrow data in the IPC 'stream' format,\n * an array of `Uint8Array` instances is also supported.\n *\n * This method stops short of generating views over field buffers. Use the\n * `createData()` method on the result to enable column data access.\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#serialization-and-interprocess-communication-ipc\n * @param {ArrayBufferLike | Uint8Array | Uint8Array[]} data\n *  The source byte buffer, or an array of buffers. If an array, each byte\n *  array may contain one or more self-contained messages. Messages may NOT\n *  span multiple byte arrays.\n * @returns {import('../types.js').ArrowData}\n */\nfunction decodeIPC(data) {\n  const source = isArrayBufferLike(data) ? new Uint8Array(data) : data;\n  return source instanceof Uint8Array && isArrowFileFormat(source)\n    ? decodeIPCFile(source)\n    : decodeIPCStream(source);\n}\n\n/**\n * @param {Uint8Array} buf\n * @returns {boolean}\n */\nfunction isArrowFileFormat(buf) {\n  if (!buf || buf.length < 4) return false;\n  for (let i = 0; i < 6; ++i) {\n    if (MAGIC[i] !== buf[i]) return false;\n  }\n  return true;\n}\n\n/**\n * Decode data in the [Arrow IPC 'stream' format][1].\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format\n * @param {Uint8Array | Uint8Array[]} data The source byte buffer, or an\n *  array of buffers. If an array, each byte array may contain one or more\n *  self-contained messages. Messages may NOT span multiple byte arrays.\n * @returns {ArrowData}\n */\nfunction decodeIPCStream(data) {\n  const stream = [data].flat();\n\n  let schema;\n  const records = [];\n  const dictionaries = [];\n\n  // consume each message in the stream\n  for (const buf of stream) {\n    if (!(buf instanceof Uint8Array)) {\n      throw new Error(`IPC data batch was not a Uint8Array.`);\n    }\n    let offset = 0;\n\n    // decode all messages in current buffer\n    while (true) {\n      const m = decodeMessage(buf, offset);\n      if (m === null) break; // end of messages\n      offset = m.index;\n      if (!m.content) continue;\n      switch (m.type) {\n        case MessageHeader.Schema:\n          // ignore repeated schema messages\n          if (!schema) schema = m.content;\n          break;\n        case MessageHeader.RecordBatch:\n          records.push(m.content);\n          break;\n        case MessageHeader.DictionaryBatch:\n          dictionaries.push(m.content);\n          break;\n      }\n    }\n  }\n\n  return /** @type {ArrowData} */ (\n    { schema, dictionaries, records, metadata: null }\n  );\n}\n\n/**\n * Decode data in the [Arrow IPC 'file' format][1].\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#ipc-file-format\n * @param {Uint8Array} data The source byte buffer.\n * @returns {ArrowData}\n */\nfunction decodeIPCFile(data) {\n  // find footer location\n  const offset = data.byteLength - (MAGIC.length + 4);\n  const length = readInt32(data, offset);\n\n  // decode file footer\n  //  4: version\n  //  6: schema\n  //  8: dictionaries (vector)\n  // 10: batches (vector)\n  // 12: metadata\n  const get = readObject(data, offset - length);\n  const version = /** @type {Version_} */\n    (get(4, readInt16, Version.V1));\n  const dicts = get(8, decodeBlocks, []);\n  const recs = get(10, decodeBlocks, []);\n\n  return /** @type {ArrowData} */ ({\n    schema: get(6, (buf, index) => decodeSchema(buf, index, version)),\n    dictionaries: dicts.map(({ offset }) => decodeMessage(data, offset).content),\n    records: recs.map(({ offset }) => decodeMessage(data, offset).content),\n    metadata: get(12, decodeMetadata)\n  });\n}\n\n/**\n * @import { ArrowData, ExtractionOptions, Field, RecordBatch, Schema } from '../types.js'\n */\n\n/**\n * Decode [Apache Arrow IPC data][1] and return a new Table. The input binary\n * data may be either an `ArrayBuffer` or `Uint8Array`. For Arrow data in the\n * [IPC 'stream' format][2], an array of `Uint8Array` values is also supported.\n *\n * [1]: https://arrow.apache.org/docs/format/Columnar.html#serialization-and-interprocess-communication-ipc\n * [2]: https://arrow.apache.org/docs/format/Columnar.html#ipc-streaming-format\n * @param {ArrayBufferLike | Uint8Array | Uint8Array[]} data\n *  The source byte buffer, or an array of buffers. If an array, each byte\n *  array may contain one or more self-contained messages. Messages may NOT\n *  span multiple byte arrays.\n * @param {ExtractionOptions} [options]\n *  Options for controlling how values are transformed when extracted\n *  from an Arrow binary representation.\n * @returns {Table} A Table instance.\n */\nfunction tableFromIPC(data, options) {\n  return createTable(decodeIPC(data), options);\n}\n\n/**\n * Create a table from parsed IPC data.\n * @param {ArrowData} data\n *  The IPC data, as returned by parseIPC.\n * @param {ExtractionOptions} [options]\n *  Options for controlling how values are transformed when extracted\n *  from am Arrow binary representation.\n * @returns {Table} A Table instance.\n */\nfunction createTable(data, options = {}) {\n  const { schema = { fields: [] }, dictionaries, records } = data;\n  const { version, fields } = schema;\n  const dictionaryMap = new Map;\n  const context = contextGenerator(options, version, dictionaryMap);\n\n  // build dictionary type map\n  const dictionaryTypes = new Map;\n  visitSchemaFields(schema, field => {\n    const type = field.type;\n    if (type.typeId === Type.Dictionary) {\n      dictionaryTypes.set(type.id, type.dictionary);\n    }\n  });\n\n  // decode dictionaries, build dictionary column map\n  const dicts = new Map;\n  for (const dict of dictionaries) {\n    const { id, data, isDelta, body } = dict;\n    const type = dictionaryTypes.get(id);\n    const batch = visit$1(type, context({ ...data, body }));\n    if (!dicts.has(id)) {\n      if (isDelta) {\n        throw new Error('Delta update can not be first dictionary batch.');\n      }\n      dicts.set(id, columnBuilder(type).add(batch));\n    } else {\n      const dict = dicts.get(id);\n      if (!isDelta) dict.clear();\n      dict.add(batch);\n    }\n  }\n  dicts.forEach((value, key) => dictionaryMap.set(key, value.done()));\n\n  // decode column fields\n  const cols = fields.map(f => columnBuilder(f.type));\n  for (const batch of records) {\n    const ctx = context(batch);\n    fields.forEach((f, i) => cols[i].add(visit$1(f.type, ctx)));\n  }\n\n  return new Table(schema, cols.map(c => c.done()), options.useProxy);\n}\n\n/**\n * Visit all fields within a schema.\n * @param {Schema} schema\n * @param {(field: Field) => void} visitor\n */\nfunction visitSchemaFields(schema, visitor) {\n  schema.fields.forEach(function visitField(field) {\n    visitor(field);\n    // @ts-ignore\n    field.type.dictionary?.children?.forEach(visitField);\n    // @ts-ignore\n    field.type.children?.forEach(visitField);\n  });\n}\n\n/**\n * Context object generator for field visitation and buffer definition.\n */\nfunction contextGenerator(options, version, dictionaryMap) {\n  const base = {\n    version,\n    options,\n    dictionary: id => dictionaryMap.get(id),\n  };\n\n  /**\n   * Return a context generator.\n   * @param {RecordBatch} batch\n   */\n  return batch => {\n    const { length, nodes, regions, variadic, body } = batch;\n    let nodeIndex = -1;\n    let bufferIndex = -1;\n    let variadicIndex = -1;\n    return {\n      ...base,\n      length,\n      node: () => nodes[++nodeIndex],\n      buffer: (ArrayType) => {\n        const { length, offset } = regions[++bufferIndex];\n        return ArrayType\n          ? new ArrayType(body.buffer, body.byteOffset + offset, length / ArrayType.BYTES_PER_ELEMENT)\n          : body.subarray(offset, offset + length)\n      },\n      variadic: () => variadic[++variadicIndex],\n      visit(children) { return children.map(f => visit$1(f.type, this)); }\n    };\n  };\n}\n\n/**\n * Visit a field, instantiating views of buffer regions.\n */\nfunction visit$1(type, ctx) {\n  const { typeId } = type;\n  const { options, node, buffer, variadic, version } = ctx;\n  const BatchType = batchType(type, options);\n\n  // extract the next { length, nullCount } field node - ALL fields have field nodes\n  const base = { ...node(), type };\n\n  if (typeId === Type.Null) {\n    // null fields have field nodes but no data buffers\n    return new BatchType({ ...base, nullCount: base.length });\n  }\n\n  switch (typeId) {\n    // validity and data value buffers\n    case Type.Bool:\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n    case Type.Float:\n    case Type.Decimal:\n    case Type.Date:\n    case Type.Timestamp:\n    case Type.Interval:\n    case Type.FixedSizeBinary:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(type.values)\n      });\n\n    // validity, offset, and value buffers\n    case Type.Utf8:\n    case Type.LargeUtf8:\n    case Type.Binary:\n    case Type.LargeBinary:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        values: buffer()\n      });\n\n    // views with variadic buffers\n    case Type.BinaryView:\n    case Type.Utf8View:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(), // views buffer\n        data: Array.from({ length: variadic() }, () => buffer()) // data buffers\n      });\n\n    // validity, offset, and list child\n    case Type.List:\n    case Type.LargeList:\n    case Type.Map:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n\n    // validity, offset, size, and list child\n    case Type.ListView:\n    case Type.LargeListView:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        offsets: buffer(type.offsets),\n        sizes: buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n\n    // validity and children\n    case Type.FixedSizeList:\n    case Type.Struct:\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        children: ctx.visit(type.children)\n      });\n\n    // children only\n    case Type.RunEndEncoded:\n      return new BatchType({\n        ...base,\n        children: ctx.visit(type.children)\n      });\n\n    // dictionary\n    case Type.Dictionary: {\n      const { id, indices } = type;\n      return new BatchType({\n        ...base,\n        validity: buffer(),\n        values: buffer(indices.values),\n      }).setDictionary(ctx.dictionary(id));\n    }\n\n    // union\n    case Type.Union: {\n      if (version < Version.V5) {\n        buffer(); // skip unused null bitmap\n      }\n      return new BatchType({\n        ...base,\n        typeIds: buffer(int8Array),\n        offsets: type.mode === UnionMode.Sparse ? null : buffer(type.offsets),\n        children: ctx.visit(type.children)\n      });\n    }\n\n    // unsupported type\n    default:\n      throw new Error(invalidDataType(typeId));\n  }\n}\n\n/**\n * @import { Sink } from './sink.js';\n */\n\nfunction writeInt32(buf, index, value) {\n  buf[index] = value;\n  buf[index + 1] = value >> 8;\n  buf[index + 2] = value >> 16;\n  buf[index + 3] = value >> 24;\n}\n\nconst INIT_SIZE = 1024;\n\n/** Flatbuffer binary builder. */\nclass Builder {\n  /**\n   * Create a new builder instance.\n   * @param {Sink} sink The byte consumer.\n   */\n  constructor(sink) {\n    /**\n     * Sink that consumes built byte buffers;\n     * @type {Sink}\n     */\n    this.sink = sink;\n    /**\n     * Minimum alignment encountered so far.\n     * @type {number}\n     */\n    this.minalign = 1;\n    /**\n     * Current byte buffer.\n     * @type {Uint8Array}\n     */\n    this.buf = new Uint8Array(INIT_SIZE);\n    /**\n     * Remaining space in the current buffer.\n     * @type {number}\n     */\n    this.space = INIT_SIZE;\n    /**\n     * List of offsets of all vtables. Used to find and\n     * reuse tables upon duplicated table field schemas.\n     * @type {number[]}\n     */\n    this.vtables = [];\n    /**\n     * Total bytes written to sink thus far.\n     */\n    this.outputBytes = 0;\n  }\n\n  /**\n   * Returns the flatbuffer offset, relative to the end of the current buffer.\n   * @returns {number} Offset relative to the end of the buffer.\n   */\n  offset() {\n    return this.buf.length - this.space;\n  }\n\n  /**\n   * Write a flatbuffer int8 value at the current buffer position\n   * and advance the internal cursor.\n   * @param {number} value\n   */\n  writeInt8(value) {\n    this.buf[this.space -= 1] = value;\n  }\n\n  /**\n   * Write a flatbuffer int16 value at the current buffer position\n   * and advance the internal cursor.\n   * @param {number} value\n   */\n  writeInt16(value) {\n    this.buf[this.space -= 2] = value;\n    this.buf[this.space + 1] = value >> 8;\n  }\n\n  /**\n   * Write a flatbuffer int32 value at the current buffer position\n   * and advance the internal cursor.\n   * @param {number} value\n   */\n  writeInt32(value) {\n    writeInt32(this.buf, this.space -= 4, value);\n  }\n\n  /**\n   * Write a flatbuffer int64 value at the current buffer position\n   * and advance the internal cursor.\n   * @param {number} value\n   */\n  writeInt64(value) {\n    const v = BigInt(value);\n    this.writeInt32(Number(BigInt.asIntN(32, v >> BigInt(32))));\n    this.writeInt32(Number(BigInt.asIntN(32, v)));\n  }\n\n  /**\n   * Add a flatbuffer int8 value, properly aligned,\n   * @param value The int8 value to add the buffer.\n   */\n  addInt8(value) {\n    prep(this, 1, 0);\n    this.writeInt8(value);\n  }\n\n  /**\n   * Add a flatbuffer int16 value, properly aligned,\n   * @param value The int16 value to add the buffer.\n   */\n  addInt16(value) {\n    prep(this, 2, 0);\n    this.writeInt16(value);\n  }\n\n  /**\n   * Add a flatbuffer int32 value, properly aligned,\n   * @param value The int32 value to add the buffer.\n   */\n  addInt32(value) {\n    prep(this, 4, 0);\n    this.writeInt32(value);\n  }\n\n  /**\n   * Add a flatbuffer int64 values, properly aligned.\n   * @param value The int64 value to add the buffer.\n   */\n  addInt64(value) {\n    prep(this, 8, 0);\n    this.writeInt64(value);\n  }\n\n  /**\n   * Add a flatbuffer offset, relative to where it will be written.\n   * @param {number} offset The offset to add.\n   */\n  addOffset(offset) {\n    prep(this, SIZEOF_INT, 0); // Ensure alignment is already done.\n    this.writeInt32(this.offset() - offset + SIZEOF_INT);\n  }\n\n  /**\n   * Add a flatbuffer object (vtable).\n   * @param {number} numFields The maximum number of fields\n   *  this object may include.\n   * @param {(tableBuilder: ReturnType<objectBuilder>) => void} [addFields]\n   *  A callback function that writes all fields using an object builder.\n   * @returns {number} The object offset.\n   */\n  addObject(numFields, addFields) {\n    const b = objectBuilder(this, numFields);\n    addFields?.(b);\n    return b.finish();\n  }\n\n  /**\n   * Add a flatbuffer vector (list).\n   * @template T\n   * @param {T[]} items An array of items to write.\n   * @param {number} itemSize The size in bytes of a serialized item.\n   * @param {number} alignment The desired byte alignment value.\n   * @param {(builder: this, item: T) => void} writeItem A callback\n   *  function that writes a vector item to this builder.\n   * @returns {number} The vector offset.\n   */\n  addVector(items, itemSize, alignment, writeItem) {\n    const n = items?.length;\n    if (!n) return 0;\n    prep(this, SIZEOF_INT, itemSize * n);\n    prep(this, alignment, itemSize * n); // Just in case alignment > int.\n    for (let i = n; --i >= 0;) {\n      writeItem(this, items[i]);\n    }\n    this.writeInt32(n);\n    return this.offset();\n  }\n\n  /**\n   * Convenience method for writing a vector of byte buffer offsets.\n   * @param {number[]} offsets\n   * @returns {number} The vector offset.\n   */\n  addOffsetVector(offsets) {\n    return this.addVector(offsets, 4, 4, (b, off) => b.addOffset(off));\n  }\n\n  /**\n   * Add a flatbuffer UTF-8 string.\n   * @param {string} s The string to encode.\n   * @return {number} The string offset.\n   */\n  addString(s) {\n    if (s == null) return 0;\n    const utf8 = encodeUtf8(s);\n    const n = utf8.length;\n    this.addInt8(0); // string null terminator\n    prep(this, SIZEOF_INT, n);\n    this.buf.set(utf8, this.space -= n);\n    this.writeInt32(n);\n    return this.offset();\n  }\n\n  /**\n   * Finish the current flatbuffer by adding a root offset.\n   * @param {number} rootOffset The root offset.\n   */\n  finish(rootOffset) {\n    prep(this, this.minalign, SIZEOF_INT);\n    this.addOffset(rootOffset);\n  }\n\n  /**\n   * Flush the current flatbuffer byte buffer content to the sink,\n   * and reset the flatbuffer builder state.\n   */\n  flush() {\n    const { buf, sink } = this;\n    const bytes = buf.subarray(this.space, buf.length);\n    sink.write(bytes);\n    this.outputBytes += bytes.byteLength;\n    this.minalign = 1;\n    this.vtables = [];\n    this.buf = new Uint8Array(INIT_SIZE);\n    this.space = INIT_SIZE;\n  }\n\n  /**\n   * Add a byte buffer directly to the builder sink. This method bypasses\n   * any unflushed flatbuffer state and leaves it unchanged, writing the\n   * buffer to the sink *before* the flatbuffer.\n   * The buffer will be padded for 64-bit (8-byte) alignment as needed.\n   * @param {Uint8Array} buffer The buffer to add.\n   * @returns {number} The total byte count of the buffer and padding.\n   */\n  addBuffer(buffer) {\n    const size = buffer.byteLength;\n    if (!size) return 0;\n    this.sink.write(buffer);\n    this.outputBytes += size;\n    const pad = ((size + 7) & -8) - size;\n    this.addPadding(pad);\n    return size + pad;\n  }\n\n  /**\n   * Write padding bytes directly to the builder sink. This method bypasses\n   * any unflushed flatbuffer state and leaves it unchanged, writing the\n   * padding bytes to the sink *before* the flatbuffer.\n   * @param {number} byteCount The number of padding bytes.\n   */\n  addPadding(byteCount) {\n    if (byteCount > 0) {\n      this.sink.write(new Uint8Array(byteCount));\n      this.outputBytes += byteCount;\n    }\n  }\n}\n\n/**\n * Prepare to write an element of `size` after `additionalBytes` have been\n * written, e.g. if we write a string, we need to align such the int length\n * field is aligned to 4 bytes, and the string data follows it directly. If all\n * we need to do is alignment, `additionalBytes` will be 0.\n * @param {Builder} builder The builder to prep.\n * @param {number} size The size of the new element to write.\n * @param {number} additionalBytes Additional padding size.\n */\nfunction prep(builder, size, additionalBytes) {\n  let { buf, space, minalign } = builder;\n\n  // track the biggest thing we've ever aligned to\n  if (size > minalign) {\n    builder.minalign = size;\n  }\n\n  // find alignment needed so that `size` aligns after `additionalBytes`\n  const bufSize = buf.length;\n  const used = bufSize - space + additionalBytes;\n  const alignSize = (~used + 1) & (size - 1);\n\n  // reallocate the buffer if needed\n  buf = grow(buf, used + alignSize + size - 1, true);\n  space += buf.length - bufSize;\n\n  // add padding\n  for (let i = 0; i < alignSize; ++i) {\n    buf[--space] = 0;\n  }\n\n  // update builder state\n  builder.buf = buf;\n  builder.space = space;\n}\n\n/**\n * Returns a builder object for flatbuffer objects (vtables).\n * @param {Builder} builder The underlying flatbuffer builder.\n * @param {number} numFields The expected number of fields, not\n *  including the standard size fields.\n */\nfunction objectBuilder(builder, numFields) {\n  /** @type {number[]} */\n  const vtable = Array(numFields).fill(0);\n  const startOffset = builder.offset();\n\n  function slot(index) {\n    vtable[index] = builder.offset();\n  }\n\n  return {\n    /**\n     * Add an int8-valued table field.\n     * @param {number} index\n     * @param {number} value\n     * @param {number} defaultValue\n     */\n    addInt8(index, value, defaultValue) {\n      if (value != defaultValue) {\n        builder.addInt8(value);\n        slot(index);\n      }\n    },\n\n    /**\n     * Add an int16-valued table field.\n     * @param {number} index\n     * @param {number} value\n     * @param {number} defaultValue\n     */\n    addInt16(index, value, defaultValue) {\n      if (value != defaultValue) {\n        builder.addInt16(value);\n        slot(index);\n      }\n    },\n\n    /**\n     * Add an int32-valued table field.\n     * @param {number} index\n     * @param {number} value\n     * @param {number} defaultValue\n     */\n    addInt32(index, value, defaultValue) {\n      if (value != defaultValue) {\n        builder.addInt32(value);\n        slot(index);\n      }\n    },\n\n    /**\n     * Add an int64-valued table field.\n     * @param {number} index\n     * @param {number} value\n     * @param {number} defaultValue\n     */\n    addInt64(index, value, defaultValue) {\n      if (value != defaultValue) {\n        builder.addInt64(value);\n        slot(index);\n      }\n    },\n\n    /**\n     * Add a buffer offset-valued table field.\n     * @param {number} index\n     * @param {number} value\n     * @param {number} defaultValue\n     */\n    addOffset(index, value, defaultValue) {\n      if (value != defaultValue) {\n        builder.addOffset(value);\n        slot(index);\n      }\n    },\n\n    /**\n     * Write the vtable to the buffer and return the table offset.\n     * @returns {number} The buffer offset to the vtable.\n     */\n    finish() {\n      // add offset entry, will overwrite later with actual offset\n      builder.addInt32(0);\n      const vtableOffset = builder.offset();\n\n      // trim zero-valued fields (indicating default value)\n      let i = numFields;\n      while (--i >= 0 && vtable[i] === 0) {} // eslint-disable-line no-empty\n      const size = i + 1;\n\n      // Write out the current vtable.\n      for (; i >= 0; --i) {\n        // Offset relative to the start of the table.\n        builder.addInt16(vtable[i] ? (vtableOffset - vtable[i]) : 0);\n      }\n\n      const standardFields = 2; // size fields\n      builder.addInt16(vtableOffset - startOffset);\n      const len = (size + standardFields) * SIZEOF_SHORT;\n      builder.addInt16(len);\n\n      // Search for an existing vtable that matches the current one.\n      let existingTable = 0;\n      const { buf, vtables, space: vt1 } = builder;\n    outer_loop:\n      for (i = 0; i < vtables.length; ++i) {\n        const vt2 = buf.length - vtables[i];\n        if (len == readInt16(buf, vt2)) {\n          for (let j = SIZEOF_SHORT; j < len; j += SIZEOF_SHORT) {\n            if (readInt16(buf, vt1 + j) != readInt16(buf, vt2 + j)) {\n              continue outer_loop;\n            }\n          }\n          existingTable = vtables[i];\n          break;\n        }\n      }\n\n      if (existingTable) {\n        // Found a match: remove the current vtable.\n        // Point table to existing vtable.\n        builder.space = buf.length - vtableOffset;\n        writeInt32(buf, builder.space, existingTable - vtableOffset);\n      } else {\n        // No match: add the location of the current vtable to the vtables list.\n        // Point table to current vtable.\n        const off = builder.offset();\n        vtables.push(off);\n        writeInt32(buf, buf.length - vtableOffset, off - vtableOffset);\n      }\n\n      return vtableOffset;\n    }\n  }\n}\n\n/**\n * @import { RecordBatch } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\n/**\n * @param {Builder} builder\n * @param {RecordBatch} batch\n * @returns {number}\n */\nfunction encodeRecordBatch(builder, batch) {\n  const { nodes, regions, variadic } = batch;\n  const nodeVector = builder.addVector(nodes, 16, 8,\n    (builder, node) => {\n      builder.writeInt64(node.nullCount);\n      builder.writeInt64(node.length);\n      return builder.offset();\n    }\n  );\n  const regionVector = builder.addVector(regions, 16, 8,\n    (builder, region) => {\n      builder.writeInt64(region.length);\n      builder.writeInt64(region.offset);\n      return builder.offset();\n    }\n  );\n  const variadicVector = builder.addVector(variadic, 8, 8,\n    (builder, count) => builder.addInt64(count)\n  );\n  return builder.addObject(5, b => {\n    b.addInt64(0, nodes[0].length, 0);\n    b.addOffset(1, nodeVector, 0);\n    b.addOffset(2, regionVector, 0);\n    // NOT SUPPORTED: 3, compression offset\n    b.addOffset(4, variadicVector, 0);\n  });\n}\n\n/**\n * @import { DictionaryBatch } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\n/**\n * @param {Builder} builder\n * @param {DictionaryBatch} dictionaryBatch\n * @returns {number}\n */\nfunction encodeDictionaryBatch(builder, dictionaryBatch) {\n  const dataOffset = encodeRecordBatch(builder, dictionaryBatch.data);\n  return builder.addObject(3, b => {\n    b.addInt64(0, dictionaryBatch.id, 0);\n    b.addOffset(1, dataOffset, 0);\n    b.addInt8(2, +dictionaryBatch.isDelta, 0);\n  });\n}\n\n/**\n * @import { Builder } from './builder.js';\n */\n\n/**\n * @param {Builder} builder\n * @param {Map<string, string>} metadata\n * @returns {number}\n */\nfunction encodeMetadata(builder, metadata) {\n  return metadata?.size > 0\n     ? builder.addOffsetVector(Array.from(metadata, ([k, v]) => {\n        const key = builder.addString(`${k}`);\n        const val = builder.addString(`${v}`);\n        return builder.addObject(2, b => {\n          b.addOffset(0, key, 0);\n          b.addOffset(1, val, 0);\n        });\n      }))\n    : 0;\n}\n\n/**\n * @import { DataType } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\n/**\n * Encode a data type into a flatbuffer.\n * @param {Builder} builder\n * @param {DataType} type\n * @returns {number} The offset at which the data type is written.\n */\nfunction encodeDataType(builder, type) {\n  const typeId = checkOneOf(type.typeId, Type, invalidDataType);\n\n  switch (typeId) {\n    case Type.Dictionary:\n      return encodeDictionary(builder, type);\n    case Type.Int:\n      return encodeInt(builder, type);\n    case Type.Float:\n      return encodeFloat(builder, type);\n    case Type.Decimal:\n      return encodeDecimal(builder, type);\n    case Type.Date:\n      return encodeDate(builder, type);\n    case Type.Time:\n      return encodeTime(builder, type);\n    case Type.Timestamp:\n      return encodeTimestamp(builder, type);\n    case Type.Interval:\n      return encodeInterval(builder, type);\n    case Type.Duration:\n      return encodeDuration(builder, type);\n    case Type.FixedSizeBinary:\n    case Type.FixedSizeList:\n      return encodeFixedSize(builder, type);\n    case Type.Map:\n      return encodeMap(builder, type);\n    case Type.Union:\n      return encodeUnion(builder, type);\n  }\n  // case Type.Null:\n  // case Type.Binary:\n  // case Type.LargeBinary:\n  // case Type.BinaryView:\n  // case Type.Bool:\n  // case Type.Utf8:\n  // case Type.Utf8View:\n  // case Type.LargeUtf8:\n  // case Type.List:\n  // case Type.ListView:\n  // case Type.LargeList:\n  // case Type.LargeListView:\n  // case Type.RunEndEncoded:\n  // case Type.Struct:\n  return builder.addObject(0);\n}\n\nfunction encodeDate(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt16(0, type.unit, DateUnit.MILLISECOND);\n  });\n}\n\nfunction encodeDecimal(builder, type) {\n  return builder.addObject(3, b => {\n    b.addInt32(0, type.precision, 0);\n    b.addInt32(1, type.scale, 0);\n    b.addInt32(2, type.bitWidth, 128);\n  });\n}\n\nfunction encodeDuration(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt16(0, type.unit, TimeUnit.MILLISECOND);\n  });\n}\n\nfunction encodeFixedSize(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt32(0, type.stride, 0);\n  });\n}\n\nfunction encodeFloat(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt16(0, type.precision, Precision.HALF);\n  });\n}\n\nfunction encodeInt(builder, type) {\n  return builder.addObject(2, b => {\n    b.addInt32(0, type.bitWidth, 0);\n    b.addInt8(1, +type.signed, 0);\n  });\n}\n\nfunction encodeInterval(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt16(0, type.unit, IntervalUnit.YEAR_MONTH);\n  });\n}\n\nfunction encodeMap(builder, type) {\n  return builder.addObject(1, b => {\n    b.addInt8(0, +type.keysSorted, 0);\n  });\n}\n\nfunction encodeTime(builder, type) {\n  return builder.addObject(2, b => {\n    b.addInt16(0, type.unit, TimeUnit.MILLISECOND);\n    b.addInt32(1, type.bitWidth, 32);\n  });\n}\n\nfunction encodeTimestamp(builder, type) {\n  const timezoneOffset = builder.addString(type.timezone);\n  return builder.addObject(2, b => {\n    b.addInt16(0, type.unit, TimeUnit.SECOND);\n    b.addOffset(1, timezoneOffset, 0);\n  });\n}\n\nfunction encodeUnion(builder, type) {\n  const typeIdsOffset = builder.addVector(\n    type.typeIds, 4, 4,\n    (builder, value) => builder.addInt32(value)\n  );\n  return builder.addObject(2, b => {\n    b.addInt16(0, type.mode, UnionMode.Sparse);\n    b.addOffset(1, typeIdsOffset, 0);\n  });\n}\n\nfunction encodeDictionary(builder, type) {\n  // The Arrow spec uses signed 32-bit integers as the default index type.\n  // However, multiple 3rd party tools fail on a null (default) index type,\n  // so we always encode the index data type explicitly here.\n  return builder.addObject(4, b => {\n    b.addInt64(0, type.id, 0);\n    b.addOffset(1, encodeDataType(builder, type.indices), 0);\n    b.addInt8(2, +type.ordered, 0);\n    // NOT SUPPORTED: 3, dictionaryKind (defaults to dense array)\n  });\n}\n\n/**\n * @import { DictionaryType, Field, Schema } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\nconst isLittleEndian = new Uint16Array(new Uint8Array([1, 0]).buffer)[0] === 1;\n\n/**\n * @param {Builder} builder\n * @param {Schema} schema\n * @returns {number}\n */\nfunction encodeSchema(builder, schema) {\n  const { fields, metadata } = schema;\n  const fieldOffsets = fields.map(f => encodeField(builder, f));\n  const fieldsVectorOffset = builder.addOffsetVector(fieldOffsets);\n  const metadataOffset = encodeMetadata(builder, metadata);\n  return builder.addObject(4, b => {\n    b.addInt16(0, +(!isLittleEndian), 0);\n    b.addOffset(1, fieldsVectorOffset, 0);\n    b.addOffset(2, metadataOffset, 0);\n    // NOT SUPPORTED: 3, features\n  });\n}\n\n/**\n * @param {Builder} builder\n * @param {Field} field\n * @returns {number}\n */\nfunction encodeField(builder, field) {\n  const { name, nullable, type, metadata } = field;\n  let { typeId } = type;\n\n  // encode field data type\n  let typeOffset = 0;\n  let dictionaryOffset = 0;\n  if (typeId !== Type.Dictionary) {\n    typeOffset = encodeDataType(builder, type);\n  } else {\n    const dict = /** @type {DictionaryType} */ (type).dictionary;\n    typeId = dict.typeId;\n    dictionaryOffset = encodeDataType(builder, type);\n    typeOffset = encodeDataType(builder, dict);\n  }\n\n  // encode children, metadata, name, and field object\n  // @ts-ignore\n  const childOffsets = (type.children || []).map(f => encodeField(builder, f));\n  const childrenVectorOffset = builder.addOffsetVector(childOffsets);\n  const metadataOffset = encodeMetadata(builder, metadata);\n  const nameOffset = builder.addString(name);\n  return builder.addObject(7, b => {\n    b.addOffset(0, nameOffset, 0);\n    b.addInt8(1, +nullable, 0);\n    b.addInt8(2, typeId, Type.NONE);\n    b.addOffset(3, typeOffset, 0);\n    b.addOffset(4, dictionaryOffset, 0);\n    b.addOffset(5, childrenVectorOffset, 0);\n    b.addOffset(6, metadataOffset, 0);\n  });\n}\n\n/**\n * @import { Block, Schema } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\n/**\n * Write a file footer.\n * @param {Builder} builder The binary builder.\n * @param {Schema} schema The table schema.\n * @param {Block[]} dictBlocks Dictionary batch file blocks.\n * @param {Block[]} recordBlocks Record batch file blocks.\n * @param {Map<string,string> | null} metadata File-level metadata.\n */\nfunction writeFooter(builder, schema, dictBlocks, recordBlocks, metadata) {\n  // encode footer flatbuffer\n  const metadataOffset = encodeMetadata(builder, metadata);\n  const recsOffset = builder.addVector(recordBlocks, 24, 8, encodeBlock);\n  const dictsOffset = builder.addVector(dictBlocks, 24, 8, encodeBlock);\n  const schemaOffset = encodeSchema(builder, schema);\n  builder.finish(\n    builder.addObject(5, b => {\n      b.addInt16(0, Version.V5, Version.V1);\n      b.addOffset(1, schemaOffset, 0);\n      b.addOffset(2, dictsOffset, 0);\n      b.addOffset(3, recsOffset, 0);\n      b.addOffset(4, metadataOffset, 0);\n    })\n  );\n  const size = builder.offset();\n\n  // add eos with continuation indicator\n  builder.addInt32(0);\n  builder.addInt32(-1);\n\n  // write builder contents\n  builder.flush();\n\n  // write file tail\n  builder.sink.write(new Uint8Array(Int32Array.of(size).buffer));\n  builder.sink.write(MAGIC);\n}\n\n/**\n * Encode a file pointer block.\n * @param {Builder} builder\n * @param {Block} block\n * @returns {number} the current block offset\n */\nfunction encodeBlock(builder, { offset, metadataLength, bodyLength }) {\n  builder.writeInt64(bodyLength);\n  builder.writeInt32(0);\n  builder.writeInt32(metadataLength);\n  builder.writeInt64(offset);\n  return builder.offset();\n}\n\n/**\n * @import { Block, MessageHeader_ } from '../types.js';\n * @import { Builder } from './builder.js';\n */\n\n/**\n * Write an IPC message to the builder sink.\n * @param {Builder} builder\n * @param {MessageHeader_} headerType\n * @param {number} headerOffset\n * @param {number} bodyLength\n * @param {Block[]} [blocks]\n */\nfunction writeMessage(builder, headerType, headerOffset, bodyLength, blocks) {\n  builder.finish(\n    builder.addObject(5, b => {\n      b.addInt16(0, Version.V5, Version.V1);\n      b.addInt8(1, headerType, MessageHeader.NONE);\n      b.addOffset(2, headerOffset, 0);\n      b.addInt64(3, bodyLength, 0);\n      // NOT SUPPORTED: 4, message-level metadata\n    })\n  );\n\n  const prefixSize = 8; // continuation indicator + message size\n  const messageSize = builder.offset();\n  const alignedSize = (messageSize + prefixSize + 7) & -8;\n\n  // track blocks for file footer\n  blocks?.push({\n    offset: builder.outputBytes,\n    metadataLength: alignedSize,\n    bodyLength\n  });\n\n  // write size prefix (including padding)\n  builder.addInt32(alignedSize - prefixSize);\n\n  // write the stream continuation indicator\n  builder.addInt32(-1);\n\n  // flush the builder content\n  builder.flush();\n\n  // add alignment padding as needed\n  builder.addPadding(alignedSize - messageSize - prefixSize);\n}\n\nclass Sink {\n  /**\n   * Write bytes to this sink.\n   * @param {Uint8Array} bytes The byte buffer to write.\n   */\n  write(bytes) { // eslint-disable-line no-unused-vars\n  }\n\n  /**\n   * Write padding bytes (zeroes) to this sink.\n   * @param {number} byteCount The number of padding bytes.\n   */\n  pad(byteCount) {\n    this.write(new Uint8Array(byteCount));\n  }\n\n  /**\n   * @returns {Uint8Array | null}\n   */\n  finish() {\n    return null;\n  }\n}\n\nclass MemorySink extends Sink {\n  /**\n   * A sink that collects bytes in memory.\n   */\n  constructor() {\n    super();\n    this.buffers = [];\n  }\n\n  /**\n   * Write bytes\n   * @param {Uint8Array} bytes\n   */\n  write(bytes) {\n    this.buffers.push(bytes);\n  }\n\n  /**\n   * @returns {Uint8Array}\n   */\n  finish() {\n    const bufs = this.buffers;\n    const size = bufs.reduce((sum, b) => sum + b.byteLength, 0);\n    const buf = new Uint8Array(size);\n    for (let i = 0, off = 0; i < bufs.length; ++i) {\n      buf.set(bufs[i], off);\n      off += bufs[i].byteLength;\n    }\n    return buf;\n  }\n}\n\n/**\n * @import { Sink } from './sink.js';\n */\n\nconst STREAM = 'stream';\nconst FILE = 'file';\n\n/**\n * Encode assembled data into Arrow IPC binary format.\n * @param {any} data Assembled table data.\n * @param {object} options Encoding options.\n * @param {Sink} [options.sink] IPC byte consumer.\n * @param {'stream' | 'file'} [options.format] Arrow stream or file format.\n * @returns {Sink} The sink that was passed in.\n */\nfunction encodeIPC(data, { sink, format = STREAM } = {}) {\n  if (format !== STREAM && format !== FILE) {\n    throw new Error(`Unrecognized Arrow IPC format: ${format}`);\n  }\n  const { schema, dictionaries = [], records = [], metadata } = data;\n  const builder = new Builder(sink || new MemorySink());\n  const file = format === FILE;\n  const dictBlocks = [];\n  const recordBlocks = [];\n\n  if (file) {\n    builder.addBuffer(MAGIC);\n  }\n\n  // both stream and file start with the schema\n  if (schema) {\n    writeMessage(\n      builder,\n      MessageHeader.Schema,\n      encodeSchema(builder, schema),\n      0\n    );\n  }\n\n  // write dictionary messages\n  for (const dict of dictionaries) {\n    const { data } = dict;\n    writeMessage(\n      builder,\n      MessageHeader.DictionaryBatch,\n      encodeDictionaryBatch(builder, dict),\n      data.byteLength,\n      dictBlocks\n    );\n    writeBuffers(builder, data.buffers);\n  }\n\n  // write record batch messages\n  for (const batch of records) {\n    writeMessage(\n      builder,\n      MessageHeader.RecordBatch,\n      encodeRecordBatch(builder, batch),\n      batch.byteLength,\n      recordBlocks\n    );\n    writeBuffers(builder, batch.buffers);\n  }\n\n  // both stream and file include end-of-stream message\n  builder.addBuffer(EOS);\n\n  if (file) {\n    writeFooter(builder, schema, dictBlocks, recordBlocks, metadata);\n  }\n\n  return builder.sink;\n}\n\n/**\n * Write byte buffers to the builder sink.\n * Buffers are aligned to 64 bits (8 bytes) as needed.\n * @param {Builder} builder\n * @param {Uint8Array[]} buffers\n */\nfunction writeBuffers(builder, buffers) {\n  for (let i = 0; i < buffers.length; ++i) {\n    builder.addBuffer(buffers[i]); // handles alignment for us\n  }\n}\n\n/**\n * @import { Batch, DictionaryBatch } from '../batch.js'\n * @import { Column } from '../column.js'\n * @import { Table } from '../table.js'\n * @import { DataType, RecordBatch, Schema, TypedArray } from '../types.js'\n * @import { Sink } from './sink.js';\n */\n\n/**\n * Encode an Arrow table into Arrow IPC binary format.\n * @param {Table} table The Arrow table to encode.\n * @param {object} options Encoding options.\n * @param {Sink} [options.sink] IPC byte consumer.\n * @param {'stream' | 'file'} [options.format] Arrow stream or file format.\n * @returns {Uint8Array | null} The generated bytes (for an in-memory sink)\n *  or null (if using a sink that writes bytes elsewhere).\n */\nfunction tableToIPC(table, options) {\n  // accept a format string option for Arrow-JS compatibility\n  if (typeof options === 'string') {\n    options = { format: options };\n  }\n\n  const columns = table.children;\n  checkBatchLengths(columns);\n\n  const { dictionaries, idMap } = assembleDictionaryBatches(columns);\n  const records = assembleRecordBatches(columns);\n  const schema = assembleSchema(table.schema, idMap);\n  const data = { schema, dictionaries, records };\n  return encodeIPC(data, options).finish();\n}\n\nfunction checkBatchLengths(columns) {\n  const n = columns[0]?.data.map(d => d.length);\n  columns.forEach(({ data }) => {\n    if (data.length !== n.length || data.some((b, i) => b.length !== n[i])) {\n      throw new Error('Columns have inconsistent batch sizes.');\n    }\n  });\n}\n\n/**\n * Create a new assembly context.\n */\nfunction assembleContext() {\n  let byteLength = 0;\n  const nodes = [];\n  const regions = [];\n  const buffers = [];\n  const variadic = [];\n  return {\n    /**\n     * @param {number} length\n     * @param {number} nullCount\n     */\n    node(length, nullCount) {\n      nodes.push({ length, nullCount });\n    },\n    /**\n     * @param {TypedArray} b\n     */\n    buffer(b) {\n      const size = b.byteLength;\n      const length = ((size + 7) & -8);\n      regions.push({ offset: byteLength, length });\n      byteLength += length;\n      buffers.push(new Uint8Array(b.buffer, b.byteOffset, size));\n    },\n    /**\n     * @param {number} length\n     */\n    variadic(length) {\n      variadic.push(length);\n    },\n    /**\n     * @param {DataType} type\n     * @param {Batch} batch\n     */\n    children(type, batch) {\n      // @ts-ignore\n      type.children.forEach((field, index) => {\n        visit(field.type, batch.children[index], this);\n      });\n    },\n    /**\n     * @returns {RecordBatch}\n     */\n    done() {\n      return { byteLength, nodes, regions, variadic, buffers };\n    }\n  };\n}\n\n/**\n * Assemble dictionary batches and their unique ids.\n * @param {Column[]} columns The table columns.\n * @returns {{\n *    dictionaries: DictionaryBatch[],\n *    idMap: Map<DataType, number>\n *  }}\n *  The assembled dictionary batches and a map from dictionary column\n *  instances to dictionary ids.\n */\nfunction assembleDictionaryBatches(columns) {\n  const dictionaries = [];\n  const dictMap = new Map;\n  const idMap = new Map;\n  let id = -1;\n\n  // track dictionaries, key by dictionary column, assign ids\n  const visitor = dictionaryColumn => {\n    if (!dictMap.has(dictionaryColumn)) {\n      dictMap.set(dictionaryColumn, ++id);\n      for (let i = 0; i < dictionaryColumn.data.length; ++i) {\n        dictionaries.push({\n          id,\n          isDelta: i > 0,\n          data: assembleRecordBatch([dictionaryColumn], i)\n        });\n      }\n      idMap.set(dictionaryColumn.type, id);\n    } else {\n      idMap.set(dictionaryColumn.type, dictMap.get(dictionaryColumn));\n    }\n  };\n\n  // recurse through column batches to find dictionaries\n  // it is sufficient to visit the first batch only,\n  // as all batches have the same dictionary column\n  columns.forEach(col => visitDictionaries(col.data[0], visitor));\n\n  return { dictionaries, idMap };\n}\n\n/**\n * Traverse column batches to visit dictionary columns.\n * @param {Batch} batch\n * @param {(column: Column) => void} visitor\n */\nfunction visitDictionaries(batch, visitor) {\n  if (batch?.type.typeId === Type.Dictionary) {\n    // @ts-ignore - batch has type DictionaryBatch\n    const dictionary = batch.dictionary;\n    visitor(dictionary);\n    visitDictionaries(dictionary.data[0], visitor);\n  }\n  batch?.children?.forEach(child => visitDictionaries(child, visitor));\n}\n\n/**\n * Assemble a schema with resolved dictionary ids.\n * @param {Schema} schema The schema.\n * @param {Map<DataType, number>} idMap A map\n *  from dictionary value types to dictionary ids.\n * @returns {Schema} A new schema with resolved\n *  dictionary ids. If there are no dictionaries, the input schema is\n *  returned unchanged.\n */\nfunction assembleSchema(schema, idMap) {\n  // early exit if no dictionaries\n  if (!idMap.size) return schema;\n\n  const visit = type => {\n    if (type.typeId === Type.Dictionary) {\n      type.id = idMap.get(type.dictionary); // lookup and set id\n      visitDictType(type);\n    }\n    if (type.children) {\n      (type.children = type.children.slice()).forEach(visitFields);\n    }\n  };\n\n  // visit a field in a field array\n  const visitFields = (field, index, array) => {\n    const type = { ...field.type };\n    array[index] = { ...field, type };\n    visit(type);\n  };\n\n  // visit a dictionary values type\n  const visitDictType = (parentType) => {\n    const type = { ...parentType.dictionary };\n    parentType.dictionary = type;\n    visit(type);\n  };\n\n  schema = { ...schema, fields: schema.fields.slice() };\n  schema.fields.forEach(visitFields);\n  return schema;\n}\n\n/**\n * Assemble record batches with marshalled buffers.\n * @param {Column[]} columns The table columns.\n * @returns {RecordBatch[]} The assembled record batches.\n */\nfunction assembleRecordBatches(columns) {\n  return (columns[0]?.data || [])\n    .map((_, index) => assembleRecordBatch(columns, index));\n}\n\n/**\n * Assemble a record batch with marshalled buffers.\n * @param {Column[]} columns The table columns.\n * @param {number} batchIndex The batch index.\n * @returns {RecordBatch} The assembled record batch.\n */\nfunction assembleRecordBatch(columns, batchIndex = 0) {\n  const ctx = assembleContext();\n  columns.forEach(column => {\n    visit(column.type, column.data[batchIndex], ctx);\n  });\n  return ctx.done();\n}\n\n/**\n * Visit a column batch, assembling buffer data.\n * @param {DataType} type The data type.\n * @param {Batch} batch The column batch.\n * @param {ReturnType<assembleContext>} ctx The assembly context.\n */\nfunction visit(type, batch, ctx) {\n  const { typeId } = type;\n\n  // record field node info - ALL fields need field nodes, including nulls\n  ctx.node(batch.length, batch.nullCount);\n\n  // null fields have field nodes but no data buffers\n  if (typeId === Type.Null) return;\n\n  switch (typeId) {\n    // validity and value buffers\n    // backing dictionaries handled elsewhere\n    case Type.Bool:\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n    case Type.Float:\n    case Type.Date:\n    case Type.Timestamp:\n    case Type.Decimal:\n    case Type.Interval:\n    case Type.FixedSizeBinary:\n    case Type.Dictionary: // dict key values\n      ctx.buffer(batch.validity);\n      ctx.buffer(batch.values);\n      return;\n\n    // validity, offset, and value buffers\n    case Type.Utf8:\n    case Type.LargeUtf8:\n    case Type.Binary:\n    case Type.LargeBinary:\n      ctx.buffer(batch.validity);\n      ctx.buffer(batch.offsets);\n      ctx.buffer(batch.values);\n      return;\n\n    // views with variadic buffers\n    case Type.BinaryView:\n    case Type.Utf8View:\n      ctx.buffer(batch.validity);\n      ctx.buffer(batch.values);\n      // @ts-ignore\n      ctx.variadic(batch.data.length);\n      // @ts-ignore\n      batch.data.forEach(b => ctx.buffer(b));\n      return;\n\n    // validity, offset, and list child\n    case Type.List:\n    case Type.LargeList:\n    case Type.Map:\n      ctx.buffer(batch.validity);\n      ctx.buffer(batch.offsets);\n      ctx.children(type, batch);\n      return;\n\n    // validity, offset, size, and list child\n    case Type.ListView:\n    case Type.LargeListView:\n      ctx.buffer(batch.validity);\n      ctx.buffer(batch.offsets);\n      ctx.buffer(batch.sizes);\n      ctx.children(type, batch);\n      return;\n\n    // validity and children\n    case Type.FixedSizeList:\n    case Type.Struct:\n      ctx.buffer(batch.validity);\n      ctx.children(type, batch);\n      return;\n\n    // children only\n    case Type.RunEndEncoded:\n      ctx.children(type, batch);\n      return;\n\n    // union\n    case Type.Union: {\n      // @ts-ignore\n      ctx.buffer(batch.typeIds);\n      if (type.mode === UnionMode.Dense) {\n        ctx.buffer(batch.offsets);\n      }\n      ctx.children(type, batch);\n      return;\n    }\n\n    // unsupported type\n    default:\n      throw new Error(invalidDataType(typeId));\n  }\n}\n\n/**\n * @import { TypedArray, TypedArrayConstructor } from '../types.js'\n */\n\n/**\n * Create a new resizable buffer instance.\n * @param {TypedArrayConstructor} [arrayType]\n *  The array type.\n * @returns {Buffer} The buffer.\n */\nfunction buffer(arrayType) {\n  return new Buffer(arrayType);\n}\n\n/**\n * Resizable byte buffer.\n */\nclass Buffer {\n  /**\n   * Create a new resizable buffer instance.\n   * @param {TypedArrayConstructor} arrayType\n   */\n  constructor(arrayType = uint8Array) {\n    this.buf = new arrayType(512);\n  }\n  /**\n   * Return the underlying data as a 64-bit aligned array of minimum size.\n   * @param {number} size The desired minimum array size.\n   * @returns {TypedArray} The 64-bit aligned array.\n   */\n  array(size) {\n    return align(this.buf, size);\n  }\n  /**\n   * Prepare for writes to the given index, resizing as necessary.\n   * @param {number} index The array index to prepare to write to.\n   */\n  prep(index) {\n    if (index >= this.buf.length) {\n      this.buf = grow(this.buf, index);\n    }\n  }\n  /**\n   * Return the value at the given index.\n   * @param {number} index The array index.\n   */\n  get(index) {\n    return this.buf[index];\n  }\n  /**\n   * Set a value at the given index.\n   * @param {number | bigint} value The value to set.\n   * @param {number} index The index to write to.\n   */\n  set(value, index) {\n    this.prep(index);\n    this.buf[index] = value;\n  }\n  /**\n   * Write a byte array at the given index. The method should be called\n   * only when the underlying buffer is of type Uint8Array.\n   * @param {Uint8Array} bytes The byte array.\n   * @param {number} index The starting index to write to.\n   */\n  write(bytes, index) {\n    this.prep(index + bytes.length);\n    /** @type {Uint8Array} */ (this.buf).set(bytes, index);\n  }\n}\n\n/**\n * Create a new resizable bitmap instance.\n * @returns {Bitmap} The bitmap buffer.\n */\nfunction bitmap() {\n  return new Bitmap();\n}\n\n/**\n * Resizable bitmap buffer.\n */\nclass Bitmap extends Buffer {\n  /**\n   * Set a bit to true at the given bitmap index.\n   * @param {number} index The index to write to.\n   */\n  set(index) {\n    const i = index >> 3;\n    this.prep(i);\n    /** @type {Uint8Array} */ (this.buf)[i] |= (1 << (index % 8));\n  }\n}\n\n/**\n * @import { Batch } from '../../batch.js'\n */\n\n/**\n * Abstract class for building a column data batch.\n */\nclass BatchBuilder {\n  constructor(type, ctx) {\n    this.type = type;\n    this.ctx = ctx;\n    this.batchClass = ctx.batchType(type);\n  }\n\n  /**\n   * Initialize the builder state.\n   * @returns {this} This builder.\n   */\n  init() {\n    this.index = -1;\n    return this;\n  }\n\n  /**\n   * Write a value to the builder.\n   * @param {*} value\n   * @param {number} index\n   * @returns {boolean | void}\n   */\n  set(value, index) {\n    this.index = index;\n    return false;\n  }\n\n  /**\n   * Returns a batch constructor options object.\n   * Used internally to marshal batch data.\n   * @returns {Record<string, any>}\n   */\n  done() {\n    return null;\n  }\n\n  /**\n   * Returns a completed batch and reinitializes the builder state.\n   * @returns {Batch}\n   */\n  batch() {\n    const b = new this.batchClass(this.done());\n    this.init();\n    return b;\n  }\n}\n\n/**\n * Builder for validity bitmaps within batches.\n */\nclass ValidityBuilder extends BatchBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n  }\n\n  init() {\n    this.nullCount = 0;\n    this.validity = bitmap();\n    return super.init();\n  }\n\n  /**\n   * @param {*} value\n   * @param {number} index\n   * @returns {boolean | void}\n   */\n  set(value, index) {\n    this.index = index;\n    const isValid = value != null;\n    if (isValid) {\n      this.validity.set(index);\n    } else {\n      this.nullCount++;\n    }\n    return isValid;\n  }\n\n  done() {\n    const { index, nullCount, type, validity } = this;\n    return {\n      length: index + 1,\n      nullCount,\n      type,\n      validity: nullCount\n        ? validity.array((index >> 3) + 1)\n        : new uint8Array(0)\n    };\n  }\n}\n\n/**\n * @import { builderContext } from '../builder.js'\n * @import { DictionaryType, ExtractionOptions } from '../../types.js'\n */\n\n/**\n * Create a context object for managing dictionary builders.\n */\nfunction dictionaryContext() {\n  const idMap = new Map;\n  const dicts = new Set;\n  return {\n    /**\n     * Get a dictionary values builder for the given dictionary type.\n     * @param {DictionaryType} type\n     *  The dictionary type.\n     * @param {*} ctx The builder context.\n     * @returns {ReturnType<dictionaryValues>}\n     */\n    get(type, ctx) {\n      // if a dictionary has a non-negative id, assume it was set\n      // intentionally and track it for potential reuse across columns\n      // otherwise the dictionary is used for a single column only\n      const id = type.id;\n      if (id >= 0 && idMap.has(id)) {\n        return idMap.get(id);\n      } else {\n        const dict = dictionaryValues(type, ctx);\n        if (id >= 0) idMap.set(id, dict);\n        dicts.add(dict);\n        return dict;\n      }\n    },\n    /**\n     * Finish building dictionary values columns and assign them to\n     * their corresponding dictionary batches.\n     * @param {ExtractionOptions} options\n     */\n    finish(options) {\n      dicts.forEach(dict => dict.finish(options));\n    }\n  };\n}\n\n/**\n * Builder helper for creating dictionary values.\n * @param {DictionaryType} type\n *  The dictionary data type.\n * @param {ReturnType<builderContext>} ctx\n *  The builder context.\n */\nfunction dictionaryValues(type, ctx) {\n  const keys = Object.create(null);\n  const values = ctx.builder(type.dictionary);\n  const batches = [];\n\n  values.init();\n  let index = -1;\n\n  return {\n    type,\n    values,\n\n    add(batch) {\n      batches.push(batch);\n      return batch;\n    },\n\n    key(value) {\n      const v = keyString(value);\n      let k = keys[v];\n      if (k === undefined) {\n        keys[v] = k = ++index;\n        values.set(value, k);\n      }\n      return k;\n    },\n\n    finish(options) {\n      const valueType = type.dictionary;\n      const batch = new (batchType(valueType, options))(values.done());\n      const dictionary = new Column([batch]);\n      batches.forEach(batch => batch.setDictionary(dictionary));\n    }\n  };\n}\n\n/**\n * Builder for dictionary-typed data batches.\n */\nclass DictionaryBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.dict = ctx.dictionary(type);\n  }\n\n  init() {\n    this.values = buffer(this.type.indices.values);\n    return super.init();\n  }\n\n  set(value, index) {\n    if (super.set(value, index)) {\n      this.values.set(this.dict.key(value), index);\n    }\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      values: this.values.array(this.index + 1)\n    };\n  }\n\n  batch() {\n    // register batch with dictionary\n    // batch will be updated when the dictionary is finished\n    return this.dict.add(super.batch());\n  }\n}\n\n/**\n * @import { DataType, IntType, UnionType } from '../types.js'\n */\n\n/**\n * Infer the data type for a given input array.\n * @param {(visitor: (value: any) => void) => void} visit\n *  A function that applies a callback to successive data values.\n * @returns {DataType} The data type.\n */\nfunction inferType(visit) {\n  const profile = profiler();\n  visit(value => profile.add(value));\n  return profile.type();\n}\n\nfunction profiler() {\n  let length = 0;\n  let nullCount = 0;\n  let boolCount = 0;\n  let numberCount = 0;\n  let intCount = 0;\n  let bigintCount = 0;\n  let dateCount = 0;\n  let dayCount = 0;\n  let stringCount = 0;\n  let arrayCount = 0;\n  let structCount = 0;\n  let min = Infinity;\n  let max = -Infinity;\n  let minLength = Infinity;\n  let maxLength = -Infinity;\n  let minBigInt;\n  let maxBigInt;\n  let arrayProfile;\n  let structProfiles = {};\n\n  return {\n    add(value) {\n      length++;\n      if (value == null) {\n        nullCount++;\n        return;\n      }\n      switch (typeof value) {\n        case 'string':\n          stringCount++;\n          break;\n        case 'number':\n          numberCount++;\n          if (value < min) min = value;\n          if (value > max) max = value;\n          if (Number.isInteger(value)) intCount++;\n          break;\n        case 'bigint':\n          bigintCount++;\n          if (minBigInt === undefined) {\n            minBigInt = maxBigInt = value;\n          } else {\n            if (value < minBigInt) minBigInt = value;\n            if (value > maxBigInt) maxBigInt = value;\n          }\n          break;\n        case 'boolean':\n          boolCount++;\n          break;\n        case 'object':\n          if (value instanceof Date) {\n            dateCount++;\n            // 1 day = 1000ms * 60s * 60min * 24hr = 86400000\n            if ((+value % 864e5) === 0) dayCount++;\n          } else if (isArray(value)) {\n            arrayCount++;\n            const len = value.length;\n            if (len < minLength) minLength = len;\n            if (len > maxLength) maxLength = len;\n            arrayProfile ??= profiler();\n            value.forEach(arrayProfile.add);\n          } else {\n            structCount++;\n            for (const key in value) {\n              const fieldProfiler = structProfiles[key]\n                ?? (structProfiles[key] = profiler());\n              fieldProfiler.add(value[key]);\n            }\n          }\n      }\n    },\n    type() {\n      const valid = length - nullCount;\n      return valid === 0 ? nullType()\n        : intCount === valid ? intType(min, max)\n        : numberCount === valid ? float64()\n        : bigintCount === valid ? bigintType(minBigInt, maxBigInt)\n        : boolCount === valid ? bool()\n        : dayCount === valid ? dateDay()\n        : dateCount === valid ? timestamp()\n        : stringCount === valid ? dictionary(utf8())\n        : arrayCount === valid ? arrayType(arrayProfile.type(), minLength, maxLength)\n        : structCount === valid ? struct(\n            Object.entries(structProfiles).map(_ => field(_[0], _[1].type()))\n          )\n        : unionType();\n    }\n  };\n}\n\n/**\n * Return a list or fixed list type.\n * @param {DataType} type The child data type.\n * @param {number} minLength The minumum list length.\n * @param {number} maxLength The maximum list length.\n * @returns {DataType} The data type.\n */\nfunction arrayType(type, minLength, maxLength) {\n  return maxLength === minLength\n    ? fixedSizeList(type, minLength)\n    : list(type);\n}\n\n/**\n * @param {number} min\n * @param {number} max\n * @returns {DataType}\n */\nfunction intType(min, max) {\n  const v = Math.max(Math.abs(min) - 1, max);\n  return v < (1 << 7) ? int8()\n    : v < (1 << 15) ? int16()\n    : v < (2 ** 31) ? int32()\n    : float64();\n}\n\n/**\n * @param {bigint} min\n * @param {bigint} max\n * @returns {IntType}\n */\nfunction bigintType(min, max) {\n  const v = -min > max ? -min - 1n : max;\n  if (v >= 2 ** 63) {\n    throw new Error(`BigInt exceeds 64 bits: ${v}`);\n  }\n  return int64();\n}\n\n/**\n * @returns {UnionType}\n */\nfunction unionType() {\n  throw new Error('Mixed types detected, please define a union type.');\n}\n\n/**\n * Builder for batches of binary-typed data.\n */\nclass BinaryBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.toOffset = toOffset(type.offsets);\n  }\n\n  init() {\n    this.offsets = buffer(this.type.offsets);\n    this.values = buffer();\n    this.pos = 0;\n    return super.init();\n  }\n\n  set(value, index) {\n    const { offsets, values, toOffset } = this;\n    if (super.set(value, index)) {\n      values.write(value, this.pos);\n      this.pos += value.length;\n    }\n    offsets.set(toOffset(this.pos), index + 1);\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      offsets: this.offsets.array(this.index + 2),\n      values: this.values.array(this.pos + 1)\n    };\n  }\n}\n\n/**\n * Builder for batches of bool-typed data.\n */\nclass BoolBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n  }\n\n  init() {\n    this.values = bitmap();\n    return super.init();\n  }\n\n  set(value, index) {\n    super.set(value, index);\n    if (value) this.values.set(index);\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      values: this.values.array((this.index >> 3) + 1)\n    }\n  }\n}\n\n/**\n * Builder for batches of decimal-typed data (64-bits or more).\n */\nclass DecimalBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.scale = 10 ** type.scale;\n    this.stride = type.bitWidth >> 6;\n  }\n\n  init() {\n    this.values = buffer(this.type.values);\n    return super.init();\n  }\n\n  set(value, index) {\n    const { scale, stride, values } = this;\n    if (super.set(value, index)) {\n      values.prep((index + 1) * stride);\n      // @ts-ignore\n      toDecimal(value, values.buf, index * stride, stride, scale);\n    }\n  }\n\n  done() {\n    const { index, stride, values } = this;\n    return {\n      ...super.done(),\n      values: values.array((index + 1) * stride)\n    };\n  }\n}\n\n/**\n * Builder for fixed-size-binary-typed data batches.\n */\nclass FixedSizeBinaryBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.stride = type.stride;\n  }\n\n  init() {\n    this.values = buffer();\n    return super.init();\n  }\n\n  set(value, index) {\n    if (super.set(value, index)) {\n      this.values.write(value, index * this.stride);\n    }\n  }\n\n  done() {\n    const { stride, values } = this;\n    return {\n      ...super.done(),\n      values: values.array(stride * (this.index + 1))\n    };\n  }\n}\n\n/**\n * Builder for fixed-size-list-typed data batches.\n */\nclass FixedSizeListBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.child = ctx.builder(this.type.children[0].type);\n    this.stride = type.stride;\n  }\n\n  init() {\n    this.child.init();\n    return super.init();\n  }\n\n  set(value, index) {\n    const { child, stride } = this;\n    const base = index * stride;\n    if (super.set(value, index)) {\n      for (let i = 0; i < stride; ++i) {\n        child.set(value[i], base + i);\n      }\n    } else {\n      child.index = base + stride;\n    }\n  }\n\n  done() {\n    const { child } = this;\n    return {\n      ...super.done(),\n      children: [ child.batch() ]\n    };\n  }\n}\n\n/**\n * Builder for day/time interval-typed data batches.\n */\nclass IntervalDayTimeBuilder extends ValidityBuilder {\n  init() {\n    this.values = buffer(this.type.values);\n    return super.init();\n  }\n\n  set(value, index) {\n    if (super.set(value, index)) {\n      const i = index << 1;\n      this.values.set(value[0], i);\n      this.values.set(value[1], i + 1);\n    }\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      values: this.values.array((this.index + 1) << 1)\n    }\n  }\n}\n\n/**\n * Builder for month/day/nano interval-typed data batches.\n */\nclass IntervalMonthDayNanoBuilder extends ValidityBuilder {\n  init() {\n    this.values = buffer();\n    return super.init();\n  }\n\n  set(value, index) {\n    if (super.set(value, index)) {\n      this.values.write(toMonthDayNanoBytes(value), index << 4);\n    }\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      values: this.values.array((this.index + 1) << 4)\n    }\n  }\n}\n\n/**\n * Abstract class for building list data batches.\n */\nclass AbstractListBuilder extends ValidityBuilder {\n  constructor(type, ctx, child) {\n    super(type, ctx);\n    this.child = child;\n  }\n\n  init() {\n    this.child.init();\n    const offsetType = this.type.offsets;\n    this.offsets = buffer(offsetType);\n    this.toOffset = toOffset(offsetType);\n    this.pos = 0;\n    return super.init();\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      offsets: this.offsets.array(this.index + 2),\n      children: [ this.child.batch() ]\n    };\n  }\n}\n\n/**\n * Builder for list-typed data batches.\n */\nclass ListBuilder extends AbstractListBuilder {\n  constructor(type, ctx) {\n    super(type, ctx, ctx.builder(type.children[0].type));\n  }\n\n  set(value, index) {\n    const { child, offsets, toOffset } = this;\n    if (super.set(value, index)) {\n      value.forEach(v => child.set(v, this.pos++));\n    }\n    offsets.set(toOffset(this.pos), index + 1);\n  }\n}\n\n/**\n * Abstract class for building list-typed data batches.\n */\nclass AbstractStructBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.children = type.children.map(c => ctx.builder(c.type));\n  }\n\n  init() {\n    this.children.forEach(c => c.init());\n    return super.init();\n  }\n\n  done() {\n    const { children } = this;\n    children.forEach(c => c.index = this.index);\n    return {\n      ...super.done(),\n      children: children.map(c => c.batch())\n    };\n  }\n}\n\n/**\n * Builder for struct-typed data batches.\n */\nclass StructBuilder extends AbstractStructBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.setters = this.children.map((child, i) => {\n      const name = type.children[i].name;\n      return (value, index) => child.set(value?.[name], index);\n    });\n  }\n\n  set(value, index) {\n    super.set(value, index);\n    const setters = this.setters;\n    for (let i = 0; i < setters.length; ++i) {\n      setters[i](value, index);\n    }\n  }\n}\n\n/**\n * Builder for map-typed data batches.\n */\nclass MapBuilder extends AbstractListBuilder {\n  constructor(type, ctx) {\n    super(type, ctx, new MapStructBuilder(type.children[0].type, ctx));\n  }\n\n  set(value, index) {\n    const { child, offsets, toOffset } = this;\n    if (super.set(value, index)) {\n      for (const keyValuePair of value) {\n        child.set(keyValuePair, this.pos++);\n      }\n    }\n    offsets.set(toOffset(this.pos), index + 1);\n  }\n}\n\n/**\n * Builder for key-value struct batches within a map.\n */\nclass MapStructBuilder extends AbstractStructBuilder {\n  set(value, index) {\n    super.set(value, index);\n    const [key, val] = this.children;\n    key.set(value[0], index);\n    val.set(value[1], index);\n  }\n}\n\nconst NO_VALUE = {}; // empty object that fails strict equality\n\n/**\n * Builder for run-end-encoded-typed data batches.\n */\nclass RunEndEncodedBuilder extends BatchBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.children = type.children.map(c => ctx.builder(c.type));\n  }\n\n  init() {\n    this.pos = 0;\n    this.key = null;\n    this.value = NO_VALUE;\n    this.children.forEach(c => c.init());\n    return super.init();\n  }\n\n  next() {\n    const [runs, vals] = this.children;\n    runs.set(this.index + 1, this.pos);\n    vals.set(this.value, this.pos++);\n  }\n\n  set(value, index) {\n    // perform fast strict equality test\n    if (value !== this.value) {\n      // if no match, fallback to key string test\n      const key = keyString(value);\n      if (key !== this.key) {\n        // if key doesn't match, write prior run and update\n        if (this.key) this.next();\n        this.key = key;\n        this.value = value;\n      }\n    }\n    this.index = index;\n  }\n\n  done() {\n    this.next();\n    const { children, index, type } = this;\n    return {\n      length: index + 1,\n      nullCount: 0,\n      type,\n      children: children.map(c => c.batch())\n    };\n  }\n}\n\n/**\n * Abstract class for building union-typed data batches.\n */\nclass AbstractUnionBuilder extends BatchBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.children = type.children.map(c => ctx.builder(c.type));\n    this.typeMap = type.typeMap;\n    this.lookup = type.typeIdForValue;\n  }\n\n  init() {\n    this.nullCount = 0;\n    this.typeIds = buffer(int8Array);\n    this.children.forEach(c => c.init());\n    return super.init();\n  }\n\n  set(value, index) {\n    const { children, lookup, typeMap, typeIds } = this;\n    this.index = index;\n    const typeId = lookup(value, index);\n    const child = children[typeMap[typeId]];\n    typeIds.set(typeId, index);\n    if (value == null) ++this.nullCount;\n    // @ts-ignore\n    this.update(value, index, child);\n  }\n\n  done() {\n    const { children, nullCount, type, typeIds } = this;\n    const length = this.index + 1;\n    return {\n      length,\n      nullCount,\n      type,\n      typeIds: typeIds.array(length),\n      children: children.map(c => c.batch())\n    };\n  }\n}\n\n/**\n * Builder for sparse union-typed data batches.\n */\nclass SparseUnionBuilder extends AbstractUnionBuilder {\n  update(value, index, child) {\n    // update selected child with value\n    // then set all other children to null\n    child.set(value, index);\n    this.children.forEach(c => { if (c !== child) c.set(null, index); });\n  }\n}\n\n/**\n * Builder for dense union-typed data batches.\n */\nclass DenseUnionBuilder extends AbstractUnionBuilder {\n  init() {\n    this.offsets = buffer(this.type.offsets);\n    return super.init();\n  }\n\n  update(value, index, child) {\n    const offset = child.index + 1;\n    child.set(value, offset);\n    this.offsets.set(offset, index);\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      offsets: this.offsets.array(this.index + 1)\n    };\n  }\n}\n\n/**\n * Builder for utf8-typed data batches.\n */\nclass Utf8Builder extends BinaryBuilder {\n  set(value, index) {\n    super.set(value && encodeUtf8(value), index);\n  }\n}\n\n/**\n * Builder for data batches that can be accessed directly as typed arrays.\n */\nclass DirectBuilder extends ValidityBuilder {\n  constructor(type, ctx) {\n    super(type, ctx);\n    this.values = buffer(type.values);\n  }\n\n  init() {\n    this.values = buffer(this.type.values);\n    return super.init();\n  }\n\n  /**\n   * @param {*} value\n   * @param {number} index\n   * @returns {boolean | void}\n   */\n  set(value, index) {\n    if (super.set(value, index)) {\n      this.values.set(value, index);\n    }\n  }\n\n  done() {\n    return {\n      ...super.done(),\n      values: this.values.array(this.index + 1)\n    };\n  }\n}\n\n/**\n * Builder for int64/uint64 data batches written as bigints.\n */\nclass Int64Builder extends DirectBuilder {\n  set(value, index) {\n    super.set(value == null ? value : toBigInt(value), index);\n  }\n}\n\n/**\n * Builder for data batches whose values must pass through a transform\n * function prior to be written to a backing buffer.\n */\nclass TransformBuilder extends DirectBuilder {\n  constructor(type, ctx, transform) {\n    super(type, ctx);\n    this.transform = transform;\n  }\n  set(value, index) {\n    super.set(value == null ? value : this.transform(value), index);\n  }\n}\n\n/**\n * @import { DataType, ExtractionOptions } from '../types.js'\n * @import { BatchBuilder } from './builders/batch.js'\n */\n\n/**\n * Create a context object for shared builder state.\n * @param {ExtractionOptions} [options]  Batch extraction options.\n* @param {ReturnType<dictionaryContext>} [dictionaries]\n *  Context object for tracking dictionaries.\n */\nfunction builderContext(\n  options = {},\n  dictionaries = dictionaryContext()\n) {\n  return {\n    batchType: type => batchType(type, options),\n    builder(type) { return builder(type, this); },\n    dictionary(type) { return dictionaries.get(type, this); },\n    finish: () => dictionaries.finish(options)\n  };\n}\n\n/**\n * Returns a batch builder for the given type and builder context.\n * @param {DataType} type A data type.\n * @param {ReturnType<builderContext>} [ctx] A builder context.\n * @returns {BatchBuilder}\n */\nfunction builder(type, ctx = builderContext()) {\n  const { typeId } = type;\n  switch (typeId) {\n    case Type.Int:\n    case Type.Time:\n    case Type.Duration:\n      return isInt64ArrayType(type.values)\n        ? new Int64Builder(type, ctx)\n        : new DirectBuilder(type, ctx);\n    case Type.Float:\n      return type.precision\n        ? new DirectBuilder(type, ctx)\n        : new TransformBuilder(type, ctx, toFloat16)\n    case Type.Binary:\n    case Type.LargeBinary:\n      return new BinaryBuilder(type, ctx);\n    case Type.Utf8:\n    case Type.LargeUtf8:\n      return new Utf8Builder(type, ctx);\n    case Type.Bool:\n      return new BoolBuilder(type, ctx);\n    case Type.Decimal:\n      return type.bitWidth === 32\n        ? new TransformBuilder(type, ctx, toDecimal32(type.scale))\n        : new DecimalBuilder(type, ctx);\n    case Type.Date:\n      return new TransformBuilder(type, ctx, type.unit ? toBigInt : toDateDay);\n    case Type.Timestamp:\n      return new TransformBuilder(type, ctx, toTimestamp(type.unit));\n    case Type.Interval:\n      switch (type.unit) {\n        case IntervalUnit.DAY_TIME:\n          return new IntervalDayTimeBuilder(type, ctx);\n        case IntervalUnit.MONTH_DAY_NANO:\n          return new IntervalMonthDayNanoBuilder(type, ctx);\n      }\n      // case IntervalUnit.YEAR_MONTH:\n      return new DirectBuilder(type, ctx);\n    case Type.List:\n    case Type.LargeList:\n      return new ListBuilder(type, ctx);\n    case Type.Struct:\n      return new StructBuilder(type, ctx);\n    case Type.Union:\n      return type.mode\n        ? new DenseUnionBuilder(type, ctx)\n        : new SparseUnionBuilder(type, ctx);\n    case Type.FixedSizeBinary:\n      return new FixedSizeBinaryBuilder(type, ctx);\n    case Type.FixedSizeList:\n      return new FixedSizeListBuilder(type, ctx);\n    case Type.Map:\n      return new MapBuilder(type, ctx);\n    case Type.RunEndEncoded:\n      return new RunEndEncodedBuilder(type, ctx);\n\n    case Type.Dictionary:\n      return new DictionaryBuilder(type, ctx);\n  }\n  // case Type.BinaryView:\n  // case Type.Utf8View:\n  // case Type.ListView:\n  // case Type.LargeListView:\n  throw new Error(invalidDataType(typeId));\n}\n\n/**\n * @import { ColumnBuilderOptions, DataType, NullType } from '../types.js'\n * @import { dictionaryContext } from './builders/dictionary.js'\n */\n\n/**\n * Create a new column by iterating over provided values.\n * @template T\n * @param {Iterable | ((callback: (value: any) => void) => void)} values\n *  Either an iterable object or a visitor function that applies a callback\n *  to successive data values (akin to Array.forEach).\n * @param {DataType} [type] The data type.\n * @param {ColumnBuilderOptions} [options]\n *  Builder options for the generated column.\n * @param {ReturnType<dictionaryContext>} [dicts]\n *  Dictionary context object, for internal use only.\n * @returns {Column<T>} The generated column.\n */\nfunction columnFromValues(values, type, options = {}, dicts) {\n  const visit = isIterable(values)\n    ? callback => { for (const value of values) callback(value); }\n    : values;\n\n  type ??= inferType(visit);\n  const { maxBatchRows = Infinity, ...opt } = options;\n  let data;\n\n  if (type.typeId === Type.Null) {\n    let length = 0;\n    visit(() => ++length);\n    data = nullBatches(type, length, maxBatchRows);\n  } else {\n    const ctx = builderContext(opt, dicts);\n    const b = builder(type, ctx).init();\n    const next = b => data.push(b.batch());\n    data = [];\n\n    let row = 0;\n    visit(value => {\n      b.set(value, row++);\n      if (row >= maxBatchRows) {\n        next(b);\n        row = 0;\n      }\n    });\n    if (row) next(b);\n\n    // resolve dictionaries\n    ctx.finish();\n  }\n\n  return new Column(data, type);\n}\n\n/**\n * Create null batches with the given batch size limit.\n * @param {NullType} type The null data type.\n * @param {number} length The total column length.\n * @param {number} limit The maximum batch size.\n * @returns {NullBatch[]} The null batches.\n */\nfunction nullBatches(type, length, limit) {\n  const data = [];\n  const batch = length => new NullBatch({ length, nullCount: length, type });\n  const numBatches = Math.floor(length / limit);\n  for (let i = 0; i < numBatches; ++i) {\n    data.push(batch(limit));\n  }\n  const rem = length % limit;\n  if (rem) data.push(batch(rem));\n  return data;\n}\n\n/**\n * @import { ColumnBuilderOptions, DataType, TypedArray, TypedArrayConstructor } from '../types.js'\n * @import { dictionaryContext } from './builders/dictionary.js'\n */\n\n/**\n * Create a new column from a provided data array.\n * @template T\n * @param {Array | TypedArray} array The input data.\n * @param {DataType} [type] The data type.\n *  If not specified, type inference is attempted.\n * @param {ColumnBuilderOptions} [options]\n *  Builder options for the generated column.\n * @param {ReturnType<dictionaryContext>} [dicts]\n *  Builder context object, for internal use only.\n * @returns {Column<T>} The generated column.\n */\nfunction columnFromArray(array, type, options = {}, dicts) {\n  return !type && isTypedArray(array)\n    ? columnFromTypedArray(array, options)\n    : columnFromValues(v => array.forEach(v), type, options, dicts);\n}\n\n/**\n * Create a new column from a typed array input.\n * @template T\n * @param {TypedArray} values The input data.\n * @param {ColumnBuilderOptions} options\n *  Builder options for the generated column.\n * @returns {Column<T>} The generated column.\n */\nfunction columnFromTypedArray(values, { maxBatchRows, useBigInt }) {\n  const arrayType = /** @type {TypedArrayConstructor} */ (\n    values.constructor\n  );\n  const type = typeForTypedArray(arrayType);\n  const length = values.length;\n  const limit = Math.min(maxBatchRows || Infinity, length);\n  const numBatches = Math.floor(length / limit);\n\n  const batches = [];\n  const batchType = isInt64ArrayType(arrayType) && !useBigInt ? Int64Batch : DirectBatch;\n  const add = (start, end) => batches.push(new batchType({\n    length: end - start,\n    nullCount: 0,\n    type,\n    validity: new uint8Array(0),\n    values: values.subarray(start, end)\n  }));\n\n  let idx = 0;\n  for (let i = 0; i < numBatches; ++i) add(idx, idx += limit);\n  if (idx < length) add(idx, length);\n\n  return new Column(batches);\n}\n\n/**\n * Return an Arrow data type for a given typed array type.\n * @param {TypedArrayConstructor} arrayType The typed array type.\n * @returns {DataType} The data type.\n */\nfunction typeForTypedArray(arrayType) {\n  switch (arrayType) {\n    case float32Array: return float32();\n    case float64Array: return float64();\n    case int8Array: return int8();\n    case int16Array: return int16();\n    case int32Array: return int32();\n    case int64Array: return int64();\n    case uint8Array: return uint8();\n    case uint16Array: return uint16();\n    case uint32Array: return uint32();\n    case uint64Array: return uint64();\n  }\n}\n\n/**\n * @import { Column } from '../column.js'\n */\n\n/**\n * Create a new table from a collection of columns. Columns are assumed\n * to have the same record batch sizes.\n * @param {[string, Column][] | Record<string, Column>} data The columns,\n *  as an object with name keys, or an array of [name, column] pairs.\n * @param {boolean} [useProxy] Flag indicating if row proxy\n *  objects should be used to represent table rows (default `false`).\n * @returns {Table} The new table.\n */\nfunction tableFromColumns(data, useProxy) {\n  const fields = [];\n  const entries = Array.isArray(data) ? data : Object.entries(data);\n  const length = entries[0]?.[1].length;\n\n  const columns = entries.map(([name, col]) => {\n    if (col.length !== length) {\n      throw new Error('All columns must have the same length.');\n    }\n    fields.push(field(name, col.type));\n    return col;\n  });\n\n  const schema = {\n    version: Version.V5,\n    endianness: Endianness.Little,\n    fields,\n    metadata: null\n  };\n\n  return new Table(schema, columns, useProxy);\n}\n\n/**\n * @import { Column } from '../column.js'\n * @import { TableBuilderOptions, TypedArray } from '../types.js'\n * @import { Table } from '../table.js'\n */\n\n/**\n * Create a new table from the provided arrays.\n * @param {[string, Array | TypedArray][]\n *  | Record<string, Array | TypedArray>} data\n *  The input data as a collection of named arrays.\n * @param {TableBuilderOptions} options\n *  Table builder options, including an optional type map.\n * @returns {Table} The new table.\n */\nfunction tableFromArrays(data, options = {}) {\n  const { types = {}, ...opt } = options;\n  const dicts = dictionaryContext();\n  const entries = Array.isArray(data) ? data : Object.entries(data);\n  const columns = entries.map(([name, array]) =>\n    /** @type {[string, Column]} */ (\n    [ name, columnFromArray(array, types[name], opt, dicts)]\n  ));\n  return tableFromColumns(columns, options.useProxy);\n}\n\nexports.Batch = Batch;\nexports.Column = Column;\nexports.DateUnit = DateUnit;\nexports.Endianness = Endianness;\nexports.IntervalUnit = IntervalUnit;\nexports.Precision = Precision;\nexports.RowIndex = RowIndex;\nexports.Table = Table;\nexports.TimeUnit = TimeUnit;\nexports.Type = Type;\nexports.UnionMode = UnionMode;\nexports.Version = Version;\nexports.batchType = batchType;\nexports.binary = binary;\nexports.binaryView = binaryView;\nexports.bool = bool;\nexports.columnFromArray = columnFromArray;\nexports.columnFromValues = columnFromValues;\nexports.date = date;\nexports.dateDay = dateDay;\nexports.dateMillisecond = dateMillisecond;\nexports.decimal = decimal;\nexports.decimal128 = decimal128;\nexports.decimal256 = decimal256;\nexports.decimal32 = decimal32;\nexports.decimal64 = decimal64;\nexports.dictionary = dictionary;\nexports.dictionaryContext = dictionaryContext;\nexports.duration = duration;\nexports.field = field;\nexports.fixedSizeBinary = fixedSizeBinary;\nexports.fixedSizeList = fixedSizeList;\nexports.float = float;\nexports.float16 = float16;\nexports.float32 = float32;\nexports.float64 = float64;\nexports.int = int;\nexports.int16 = int16;\nexports.int32 = int32;\nexports.int64 = int64;\nexports.int8 = int8;\nexports.interval = interval;\nexports.largeBinary = largeBinary;\nexports.largeList = largeList;\nexports.largeListView = largeListView;\nexports.largeUtf8 = largeUtf8;\nexports.list = list;\nexports.listView = listView;\nexports.map = map;\nexports.nullType = nullType;\nexports.runEndEncoded = runEndEncoded;\nexports.struct = struct;\nexports.tableFromArrays = tableFromArrays;\nexports.tableFromColumns = tableFromColumns;\nexports.tableFromIPC = tableFromIPC;\nexports.tableToIPC = tableToIPC;\nexports.time = time;\nexports.timeMicrosecond = timeMicrosecond;\nexports.timeMillisecond = timeMillisecond;\nexports.timeNanosecond = timeNanosecond;\nexports.timeSecond = timeSecond;\nexports.timestamp = timestamp;\nexports.uint16 = uint16;\nexports.uint32 = uint32;\nexports.uint64 = uint64;\nexports.uint8 = uint8;\nexports.union = union;\nexports.utf8 = utf8;\nexports.utf8View = utf8View;\n", "/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst URL = require('url');\n\nconst VM = require('vm');\n\nconst threads = require('worker_threads');\n\nconst WORKER = Symbol.for('worker');\nconst EVENTS = Symbol.for('events');\n\nclass EventTarget {\n  constructor() {\n    Object.defineProperty(this, EVENTS, {\n      value: new Map()\n    });\n  }\n\n  dispatchEvent(event) {\n    event.target = event.currentTarget = this;\n\n    if (this['on' + event.type]) {\n      try {\n        this['on' + event.type](event);\n      } catch (err) {\n        console.error(err);\n      }\n    }\n\n    const list = this[EVENTS].get(event.type);\n    if (list == null) return;\n    list.forEach(handler => {\n      try {\n        handler.call(this, event);\n      } catch (err) {\n        console.error(err);\n      }\n    });\n  }\n\n  addEventListener(type, fn) {\n    let events = this[EVENTS].get(type);\n    if (!events) this[EVENTS].set(type, events = []);\n    events.push(fn);\n  }\n\n  removeEventListener(type, fn) {\n    let events = this[EVENTS].get(type);\n\n    if (events) {\n      const index = events.indexOf(fn);\n      if (index !== -1) events.splice(index, 1);\n    }\n  }\n\n}\n\nfunction Event(type, target) {\n  this.type = type;\n  this.timeStamp = Date.now();\n  this.target = this.currentTarget = this.data = null;\n} // this module is used self-referentially on both sides of the\n// thread boundary, but behaves differently in each context.\n\n\nmodule.exports = threads.isMainThread ? mainThread() : workerThread();\nconst baseUrl = URL.pathToFileURL(process.cwd() + '/');\n\nfunction mainThread() {\n  /**\n   * A web-compatible Worker implementation atop Node's worker_threads.\n   *  - uses DOM-style events (Event.data, Event.type, etc)\n   *  - supports event handler properties (worker.onmessage)\n   *  - Worker() constructor accepts a module URL\n   *  - accepts the {type:'module'} option\n   *  - emulates WorkerGlobalScope within the worker\n   * @param {string} url  The URL or module specifier to load\n   * @param {object} [options]  Worker construction options\n   * @param {string} [options.name]  Available as `self.name` within the Worker\n   * @param {string} [options.type=\"classic\"]  Pass \"module\" to create a Module Worker.\n   */\n  class Worker extends EventTarget {\n    constructor(url, options) {\n      super();\n      const {\n        name,\n        type\n      } = options || {};\n      url += '';\n      let mod;\n\n      if (/^data:/.test(url)) {\n        mod = url;\n      } else {\n        mod = URL.fileURLToPath(new URL.URL(url, baseUrl));\n      }\n\n      const worker = new threads.Worker(__filename, {\n        workerData: {\n          mod,\n          name,\n          type\n        }\n      });\n      Object.defineProperty(this, WORKER, {\n        value: worker\n      });\n      worker.on('message', data => {\n        const event = new Event('message');\n        event.data = data;\n        this.dispatchEvent(event);\n      });\n      worker.on('error', error => {\n        error.type = 'error';\n        this.dispatchEvent(error);\n      });\n      worker.on('exit', () => {\n        this.dispatchEvent(new Event('close'));\n      });\n    }\n\n    postMessage(data, transferList) {\n      this[WORKER].postMessage(data, transferList);\n    }\n\n    terminate() {\n      this[WORKER].terminate();\n    }\n\n  }\n\n  Worker.prototype.onmessage = Worker.prototype.onerror = Worker.prototype.onclose = null;\n  return Worker;\n}\n\nfunction workerThread() {\n  let {\n    mod,\n    name,\n    type\n  } = threads.workerData; // turn global into a mock WorkerGlobalScope\n\n  const self = global.self = global; // enqueue messages to dispatch after modules are loaded\n\n  let q = [];\n\n  function flush() {\n    const buffered = q;\n    q = null;\n    buffered.forEach(event => {\n      self.dispatchEvent(event);\n    });\n  }\n\n  threads.parentPort.on('message', data => {\n    const event = new Event('message');\n    event.data = data;\n    if (q == null) self.dispatchEvent(event);else q.push(event);\n  });\n  threads.parentPort.on('error', err => {\n    err.type = 'Error';\n    self.dispatchEvent(err);\n  });\n\n  class WorkerGlobalScope extends EventTarget {\n    postMessage(data, transferList) {\n      threads.parentPort.postMessage(data, transferList);\n    } // Emulates https://developer.mozilla.org/en-US/docs/Web/API/DedicatedWorkerGlobalScope/close\n\n\n    close() {\n      process.exit();\n    }\n\n  }\n\n  let proto = Object.getPrototypeOf(global);\n  delete proto.constructor;\n  Object.defineProperties(WorkerGlobalScope.prototype, proto);\n  proto = Object.setPrototypeOf(global, new WorkerGlobalScope());\n  ['postMessage', 'addEventListener', 'removeEventListener', 'dispatchEvent'].forEach(fn => {\n    proto[fn] = proto[fn].bind(global);\n  });\n  global.name = name;\n  const isDataUrl = /^data:/.test(mod);\n\n  if (type === 'module') {\n    import(mod).catch(err => {\n      if (isDataUrl && err.message === 'Not supported') {\n        console.warn('Worker(): Importing data: URLs requires Node 12.10+. Falling back to classic worker.');\n        return evaluateDataUrl(mod, name);\n      }\n\n      console.error(err);\n    }).then(flush);\n  } else {\n    try {\n      if (/^data:/.test(mod)) {\n        evaluateDataUrl(mod, name);\n      } else {\n        require(mod);\n      }\n    } catch (err) {\n      console.error(err);\n    }\n\n    Promise.resolve().then(flush);\n  }\n}\n\nfunction evaluateDataUrl(url, name) {\n  const {\n    data\n  } = parseDataUrl(url);\n  return VM.runInThisContext(data, {\n    filename: 'worker.<' + (name || 'data:') + '>'\n  });\n}\n\nfunction parseDataUrl(url) {\n  let [m, type, encoding, data] = url.match(/^data: *([^;,]*)(?: *; *([^,]*))? *,(.*)$/) || [];\n  if (!m) throw Error('Invalid Data URL.');\n  if (encoding) switch (encoding.toLowerCase()) {\n    case 'base64':\n      data = Buffer.from(data, 'base64').toString();\n      break;\n\n    default:\n      throw Error('Unknown Data URL encoding \"' + encoding + '\"');\n  }\n  return {\n    type,\n    data\n  };\n}", "export * from '../bindings/config';\nexport * from '../bindings/tokens';\nexport * from '../log';\nexport * from '../status';\nexport * from '../parallel';\nexport * from '../platform';\nexport * from '../version';\nexport * from '../worker';\n\nexport { InstantiationProgress, InstantiationProgressHandler, DuckDBDataProtocol, WebFile } from '../bindings';\n", "export interface DuckDBQueryConfig {\n    /**\n     * The polling interval for queries\n     */\n    queryPollingInterval?: number;\n    /**\n     * Cast BigInt to Double?\n     */\n    castBigIntToDouble?: boolean;\n    /**\n     * Cast Timestamp to Date64?\n     */\n    castTimestampToDate?: boolean;\n    /**\n     * Cast Timestamp to Date64?\n     */\n    castDurationToTime64?: boolean;\n    /**\n     * Cast Decimal to Double?\n     */\n    castDecimalToDouble?: boolean;\n}\n\nexport interface DuckDBFilesystemConfig {\n    reliableHeadRequests?: boolean;\n    /**\n     * Allow falling back to full HTTP reads if the server does not support range requests.\n     */\n    allowFullHTTPReads?: boolean;\n    /**\n     * Force use of full HTTP reads, suppressing range requests.\n     */\n    forceFullHTTPReads?: boolean;\n}\n\nexport interface DuckDBOPFSConfig {\n    /**\n     * Defines how `opfs://` files are handled during SQL execution.\n     * - \"auto\": Automatically register `opfs://` files and drop them after execution.\n     * - \"manual\": Files must be manually registered and dropped.\n     */\n    fileHandling?: 'auto' | 'manual';\n}\n\nexport enum DuckDBAccessMode {\n    UNDEFINED = 0,\n    AUTOMATIC = 1,\n    READ_ONLY = 2,\n    READ_WRITE = 3,\n}\n\nexport interface DuckDBConfig {\n    /**\n     * The database path\n     */\n    path?: string;\n    /**\n     * The access mode\n     */\n    accessMode?: DuckDBAccessMode;\n    /**\n     * The maximum number of threads.\n     * Note that this will only work with cross-origin isolated sites since it requires SharedArrayBuffers.\n     */\n    maximumThreads?: number;\n    /**\n     * The direct io flag\n     */\n    useDirectIO?: boolean;\n    /**\n     * The query config\n     */\n    query?: DuckDBQueryConfig;\n    /**\n     * The filesystem config\n     */\n    filesystem?: DuckDBFilesystemConfig;\n    /**\n     * Whether to allow unsigned extensions\n     */\n    allowUnsignedExtensions?: boolean;\n    /**\n     * Whether to use alternate Arrow conversion that preserves full range and precision of data.\n     */\n    arrowLosslessConversion?: boolean;\n    /**\n     * Custom user agent string\n     */\n    customUserAgent?: string;\n    /**\n     * Authentication token for HTTP requests.\n     * Will be sent as \"Authorization: Bearer <token>\" header with all HTTP requests.\n     */\n    authToken?: string;\n    /**\n     * opfs string\n     */\n    opfs?: DuckDBOPFSConfig;\n}\n", "export enum TokenType {\n    IDENTIFIER = 0,\n    NUMERIC_CONSTANT = 1,\n    STRING_CONSTANT = 2,\n    OPERATOR = 3,\n    KEYWORD = 4,\n    COMMENT = 5,\n}\n\nexport interface ScriptTokens {\n    offsets: number[];\n    types: TokenType[];\n}\n", "export enum LogLevel {\n    NONE = 0,\n    DEBUG = 1,\n    INFO = 2,\n    WARNING = 3,\n    ERROR = 4,\n}\n\nexport enum LogTopic {\n    NONE = 0,\n    CONNECT = 1,\n    DISCONNECT = 2,\n    OPEN = 3,\n    QUERY = 4,\n    INSTANTIATE = 5,\n}\n\nexport enum LogEvent {\n    NONE = 0,\n    OK = 1,\n    ERROR = 2,\n    START = 3,\n    RUN = 4,\n    CAPTURE = 5,\n}\n\nexport enum LogOrigin {\n    NONE = 0,\n    WEB_WORKER = 1,\n    NODE_WORKER = 2,\n    BINDINGS = 3,\n    ASYNC_DUCKDB = 4,\n}\n\nexport type LogEntry<O, T, E, V> = {\n    readonly timestamp: Date;\n    readonly level: LogLevel;\n    readonly origin: O;\n    readonly topic: T;\n    readonly event: E;\n    readonly value: V;\n};\n\nexport type ProgressEntry = {\n    readonly status: string;\n    readonly percentage: string;\n    readonly repetitions: string;\n};\n\n/** An execution progress handler */\nexport type ExecutionProgressHandler = (p: ProgressEntry) => void;\n\nexport type LogEntryVariant =\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.INSTANTIATE, LogEvent.ERROR, string>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.START, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.QUERY, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.CONNECT, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.CONNECT, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.DISCONNECT, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.DISCONNECT, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.START, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.OK, void>\n    | LogEntry<LogOrigin.BINDINGS, LogTopic.OPEN, LogEvent.ERROR, void>\n    | LogEntry<LogOrigin.ASYNC_DUCKDB, LogTopic.QUERY, LogEvent.RUN, string>;\n\nexport interface Logger {\n    log(entry: LogEntryVariant): void;\n}\n\nexport class VoidLogger implements Logger {\n    public log(_entry: LogEntryVariant): void {}\n}\n\nexport class ConsoleLogger implements Logger {\n    constructor(protected level: LogLevel = LogLevel.INFO) {}\n    public log(entry: LogEntryVariant): void {\n        if (entry.level >= this.level) {\n            console.log(entry);\n        }\n    }\n}\n\nexport function getLogLevelLabel(level: LogLevel): string {\n    switch (level) {\n        case LogLevel.NONE:\n            return 'NONE';\n        case LogLevel.DEBUG:\n            return 'DEBUG';\n        case LogLevel.INFO:\n            return 'INFO';\n        case LogLevel.WARNING:\n            return 'WARNING';\n        case LogLevel.ERROR:\n            return 'ERROR';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogEventLabel(event: LogEvent): string {\n    switch (event) {\n        case LogEvent.NONE:\n            return 'NONE';\n        case LogEvent.OK:\n            return 'OK';\n        case LogEvent.ERROR:\n            return 'ERROR';\n        case LogEvent.START:\n            return 'START';\n        case LogEvent.RUN:\n            return 'RUN';\n        case LogEvent.CAPTURE:\n            return 'CAPTURE';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogTopicLabel(topic: LogTopic): string {\n    switch (topic) {\n        case LogTopic.CONNECT:\n            return 'CONNECT';\n        case LogTopic.DISCONNECT:\n            return 'DISCONNECT';\n        case LogTopic.INSTANTIATE:\n            return 'INSTANTIATE';\n        case LogTopic.OPEN:\n            return 'OPEN';\n        case LogTopic.QUERY:\n            return 'QUERY';\n        default:\n            return '?';\n    }\n}\n\nexport function getLogOriginLabel(origin: LogOrigin): string {\n    switch (origin) {\n        case LogOrigin.NONE:\n            return 'NONE';\n        case LogOrigin.WEB_WORKER:\n            return 'WEB WORKER';\n        case LogOrigin.NODE_WORKER:\n            return 'NODE WORKER';\n        case LogOrigin.BINDINGS:\n            return 'DUCKDB BINDINGS';\n        case LogOrigin.ASYNC_DUCKDB:\n            return 'DUCKDB';\n        default:\n            return '?';\n    }\n}\n", "export enum StatusCode {\n    SUCCESS = 0,\n    MAX_ARROW_ERROR = 255,\n    DUCKDB_WASM_RETRY = 256,\n}\n\nexport function IsArrowBuffer(status: StatusCode): boolean {\n    return status <= StatusCode.MAX_ARROW_ERROR;\n}\n\nexport function IsDuckDBWasmRetry(status: StatusCode): boolean {\n    return status === StatusCode.DUCKDB_WASM_RETRY;\n}\n", "import { AsyncDuckDB } from './async_bindings';\nimport { LogLevel, LogTopic, LogOrigin, LogEvent } from '../log';\nimport { ArrowInsertOptions, CSVInsertOptions, JSONInsertOptions } from '../bindings/insert_options';\nimport { tableFromIPC, Table } from '@uwdata/flechette';\n\n/** A thin helper to memoize the connection id */\nexport class AsyncDuckDBConnection {\n    /** The async duckdb */\n    protected readonly _bindings: AsyncDuckDB;\n    /** The conn handle */\n    protected readonly _conn: number;\n\n    constructor(bindings: AsyncDuckDB, conn: number) {\n        this._bindings = bindings;\n        this._conn = conn;\n    }\n\n    /** Access the database bindings */\n    public get bindings(): AsyncDuckDB {\n        return this._bindings;\n    }\n\n    /** Disconnect from the database */\n    public async close(): Promise<void> {\n        return this._bindings.disconnect(this._conn);\n    }\n\n    /** Brave souls may use this function to consume the underlying connection id */\n    public useUnsafe<R>(callback: (bindings: AsyncDuckDB, conn: number) => R) {\n        return callback(this._bindings, this._conn);\n    }\n\n    /** \n     * Run a query and return Arrow IPC table\n     */\n    public async query(text: string): Promise<Table> {\n        this._bindings.logger.log({\n            timestamp: new Date(),\n            level: LogLevel.INFO,\n            origin: LogOrigin.ASYNC_DUCKDB,\n            topic: LogTopic.QUERY,\n            event: LogEvent.RUN,\n            value: text,\n        });\n        const buffer = await this._bindings.runQuery(this._conn, text);\n        return tableFromIPC(buffer);\n    }\n\n    /** \n     * Send a query and return async iterable of Arrow IPC buffers\n     * Use with arrow library of choice (e.g., @uwdata/flechette, apache-arrow)\n     */\n    public async send(\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<AsyncIterable<Uint8Array>> {\n        this._bindings.logger.log({\n            timestamp: new Date(),\n            level: LogLevel.INFO,\n            origin: LogOrigin.ASYNC_DUCKDB,\n            topic: LogTopic.QUERY,\n            event: LogEvent.RUN,\n            value: text,\n        });\n        let header = await this._bindings.startPendingQuery(this._conn, text, allowStreamResult);\n        while (header == null) {\n            // Avoid infinite loop on detached state\n            if (this._bindings.isDetached()) {\n                console.error('cannot send a message since the worker is not set!');\n                return undefined as any;\n            }\n            header = await this._bindings.pollPendingQuery(this._conn);\n        }\n        return new AsyncResultStreamIterator(this._bindings, this._conn, header);\n    }\n\n    /** Cancel a query that was sent earlier */\n    public async cancelSent(): Promise<boolean> {\n        return await this._bindings.cancelPendingQuery(this._conn);\n    }\n\n    /** Get table names */\n    public async getTableNames(query: string): Promise<string[]> {\n        return await this._bindings.getTableNames(this._conn, query);\n    }\n\n    /** Create a prepared statement */\n    public async prepare(\n        text: string,\n    ): Promise<AsyncPreparedStatement> {\n        const stmt = await this._bindings.createPrepared(this._conn, text);\n        return new AsyncPreparedStatement(this._bindings, this._conn, stmt);\n    }\n\n    /** Insert an arrow table from an ipc stream */\n    public async insertArrowFromIPCStream(buffer: Uint8Array, options: ArrowInsertOptions): Promise<void> {\n        await this._bindings.insertArrowFromIPCStream(this._conn, buffer, options);\n    }\n    /** Insert csv file from path */\n    public async insertCSVFromPath(text: string, options: CSVInsertOptions): Promise<void> {\n        await this._bindings.insertCSVFromPath(this._conn, text, options);\n    }\n    /** Insert json file from path */\n    public async insertJSONFromPath(text: string, options: JSONInsertOptions): Promise<void> {\n        await this._bindings.insertJSONFromPath(this._conn, text, options);\n    }\n}\n\n/** An async result stream iterator */\nexport class AsyncResultStreamIterator implements AsyncIterable<Uint8Array> {\n    /** First chunk? */\n    protected _first: boolean;\n    /** Reached end of stream? */\n    protected _depleted: boolean;\n    /** In-flight */\n    protected _inFlight: Promise<Uint8Array | null> | null;\n\n    constructor(\n        protected readonly db: AsyncDuckDB,\n        protected readonly conn: number,\n        protected readonly header: Uint8Array,\n    ) {\n        this._first = true;\n        this._depleted = false;\n        this._inFlight = null;\n    }\n\n    async next(): Promise<IteratorResult<Uint8Array>> {\n        if (this._first) {\n            this._first = false;\n            return { done: false, value: this.header };\n        }\n        if (this._depleted) {\n            return { done: true, value: null };\n        }\n        let buffer: Uint8Array | null = null;\n        if (this._inFlight != null) {\n            buffer = await this._inFlight;\n            this._inFlight = null;\n        }\n\n        while (buffer == null) {\n            buffer = await this.db.fetchQueryResults(this.conn);\n        }\n\n        this._depleted = buffer.length == 0;\n        if (!this._depleted) {\n            this._inFlight = this.db.fetchQueryResults(this.conn);\n        }\n\n        return {\n            done: this._depleted,\n            value: buffer,\n        };\n    }\n\n    [Symbol.asyncIterator]() {\n        return this;\n    }\n}\n\n/** A thin helper to bind the prepared statement id */\nexport class AsyncPreparedStatement {\n    /** The bindings */\n    protected readonly bindings: AsyncDuckDB;\n    /** The connection id */\n    protected readonly connectionId: number;\n    /** The statement id */\n    protected readonly statementId: number;\n\n    /** Constructor */\n    constructor(bindings: AsyncDuckDB, connectionId: number, statementId: number) {\n        this.bindings = bindings;\n        this.connectionId = connectionId;\n        this.statementId = statementId;\n    }\n\n    /** Close a prepared statement */\n    public async close() {\n        await this.bindings.closePrepared(this.connectionId, this.statementId);\n    }\n\n    /** \n     * Run a prepared statement and return Arrow IPC table\n     */\n    public async query(...params: any[]): Promise<Table> {\n        const buffer = await this.bindings.runPrepared(this.connectionId, this.statementId, params);\n        return tableFromIPC(buffer);\n    }\n\n    /** \n     * Send a prepared statement and return async iterable of Arrow IPC buffers\n     * Use with arrow library of choice (e.g., @uwdata/flechette, apache-arrow)\n     */\n    public async send(...params: any[]): Promise<AsyncIterable<Uint8Array>> {\n        const header = await this.bindings.sendPrepared(this.connectionId, this.statementId, params);\n        return new AsyncResultStreamIterator(this.bindings, this.connectionId, header);\n    }\n}\n", "import { CSVInsertOptions, JSONInsertOptions, ArrowInsertOptions } from '../bindings/insert_options';\nimport { LogEntryVariant, ProgressEntry } from '../log';\nimport { ScriptTokens } from '../bindings/tokens';\nimport { FileStatistics } from '../bindings/file_stats';\nimport { DuckDBConfig } from '../bindings/config';\nimport { WebFile } from '../bindings/web_file';\nimport { InstantiationProgress } from '../bindings/progress';\nimport { DuckDBDataProtocol } from '../bindings';\n\nexport type ConnectionID = number;\nexport type StatementID = number;\n\nexport enum WorkerRequestType {\n    CANCEL_PENDING_QUERY = 'CANCEL_PENDING_QUERY',\n    CLOSE_PREPARED = 'CLOSE_PREPARED',\n    COLLECT_FILE_STATISTICS = 'COLLECT_FILE_STATISTICS',\n    REGISTER_OPFS_FILE_NAME = 'REGISTER_OPFS_FILE_NAME',\n    CONNECT = 'CONNECT',\n    COPY_FILE_TO_BUFFER = 'COPY_FILE_TO_BUFFER',\n    COPY_FILE_TO_PATH = 'COPY_FILE_TO_PATH',\n    CREATE_PREPARED = 'CREATE_PREPARED',\n    DISCONNECT = 'DISCONNECT',\n    DROP_FILE = 'DROP_FILE',\n    DROP_FILES = 'DROP_FILES',\n    EXPORT_FILE_STATISTICS = 'EXPORT_FILE_STATISTICS',\n    FETCH_QUERY_RESULTS = 'FETCH_QUERY_RESULTS',\n    FLUSH_FILES = 'FLUSH_FILES',\n    GET_FEATURE_FLAGS = 'GET_FEATURE_FLAGS',\n    GET_TABLE_NAMES = 'GET_TABLE_NAMES',\n    GET_VERSION = 'GET_VERSION',\n    GLOB_FILE_INFOS = 'GLOB_FILE_INFOS',\n    INSERT_ARROW_FROM_IPC_STREAM = 'INSERT_ARROW_FROM_IPC_STREAM',\n    INSERT_CSV_FROM_PATH = 'IMPORT_CSV_FROM_PATH',\n    INSERT_JSON_FROM_PATH = 'IMPORT_JSON_FROM_PATH',\n    INSTANTIATE = 'INSTANTIATE',\n    OPEN = 'OPEN',\n    PING = 'PING',\n    POLL_PENDING_QUERY = 'POLL_PENDING_QUERY',\n    REGISTER_FILE_BUFFER = 'REGISTER_FILE_BUFFER',\n    REGISTER_FILE_HANDLE = 'REGISTER_FILE_HANDLE',\n    REGISTER_FILE_URL = 'REGISTER_FILE_URL',\n    RESET = 'RESET',\n    RUN_PREPARED = 'RUN_PREPARED',\n    RUN_QUERY = 'RUN_QUERY',\n    SEND_PREPARED = 'SEND_PREPARED',\n    START_PENDING_QUERY = 'START_PENDING_QUERY',\n    TOKENIZE = 'TOKENIZE',\n}\n\nexport enum WorkerResponseType {\n    CONNECTION_INFO = 'CONNECTION_INFO',\n    ERROR = 'ERROR',\n    FEATURE_FLAGS = 'FEATURE_FLAGS',\n    FILE_BUFFER = 'FILE_BUFFER',\n    FILE_INFOS = 'FILE_INFOS',\n    FILE_SIZE = 'FILE_SIZE',\n    FILE_STATISTICS = 'FILE_STATISTICS',\n    INSTANTIATE_PROGRESS = 'INSTANTIATE_PROGRESS',\n    LOG = 'LOG',\n    PROGRESS_UPDATE = 'PROGRESS_UPDATE',\n    OK = 'OK',\n    PREPARED_STATEMENT_ID = 'PREPARED_STATEMENT_ID',\n    QUERY_PLAN = 'QUERY_PLAN',\n    QUERY_RESULT = 'QUERY_RESULT',\n    QUERY_RESULT_CHUNK = 'QUERY_RESULT_CHUNK',\n    QUERY_RESULT_HEADER = 'QUERY_RESULT_HEADER',\n    QUERY_RESULT_HEADER_OR_NULL = 'QUERY_RESULT_HEADER_OR_NULL',\n    REGISTERED_FILE = 'REGISTERED_FILE',\n    SCRIPT_TOKENS = 'SCRIPT_TOKENS',\n    SUCCESS = 'SUCCESS',\n    TABLE_NAMES = 'TABLE_NAMES',\n    VERSION_STRING = 'VERSION_STRING',\n}\n\nexport type WorkerRequest<T, P> = {\n    readonly messageId: number;\n    readonly type: T;\n    readonly data: P;\n};\n\nexport type WorkerResponse<T, P> = {\n    readonly messageId: number;\n    readonly requestId: number;\n    readonly type: T;\n    readonly data: P;\n};\n\nexport type WorkerTaskReturnType<T extends WorkerTaskVariant> = T extends WorkerTask<any, any, infer P> ? P : never;\n\nexport class WorkerTask<T, D, P> {\n    readonly type: T;\n    readonly data: D;\n    promise: Promise<P>;\n    promiseResolver: (value: P | PromiseLike<P>) => void = () => {};\n    promiseRejecter: (value: any) => void = () => {};\n\n    constructor(type: T, data: D) {\n        this.type = type;\n        this.data = data;\n        this.promise = new Promise<P>(\n            (resolve: (value: P | PromiseLike<P>) => void, reject: (reason?: void) => void) => {\n                this.promiseResolver = resolve;\n                this.promiseRejecter = reject;\n            },\n        );\n    }\n}\n\nexport type WorkerRequestVariant =\n    | WorkerRequest<WorkerRequestType.CLOSE_PREPARED, [ConnectionID, StatementID]>\n    | WorkerRequest<WorkerRequestType.CANCEL_PENDING_QUERY, number>\n    | WorkerRequest<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean]>\n    | WorkerRequest<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string]>\n    | WorkerRequest<WorkerRequestType.CONNECT, null>\n    | WorkerRequest<WorkerRequestType.COPY_FILE_TO_BUFFER, string>\n    | WorkerRequest<WorkerRequestType.COPY_FILE_TO_PATH, [string, string]>\n    | WorkerRequest<WorkerRequestType.CREATE_PREPARED, [ConnectionID, string]>\n    | WorkerRequest<WorkerRequestType.DISCONNECT, number>\n    | WorkerRequest<WorkerRequestType.DROP_FILE, string>\n    | WorkerRequest<WorkerRequestType.DROP_FILES, string[] | undefined>\n    | WorkerRequest<WorkerRequestType.EXPORT_FILE_STATISTICS, string>\n    | WorkerRequest<WorkerRequestType.FETCH_QUERY_RESULTS, number>\n    | WorkerRequest<WorkerRequestType.FLUSH_FILES, null>\n    | WorkerRequest<WorkerRequestType.GET_FEATURE_FLAGS, null>\n    | WorkerRequest<WorkerRequestType.GET_TABLE_NAMES, [number, string]>\n    | WorkerRequest<WorkerRequestType.GET_VERSION, null>\n    | WorkerRequest<WorkerRequestType.GLOB_FILE_INFOS, string>\n    | WorkerRequest<\n          WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n          [number, Uint8Array, ArrowInsertOptions | undefined]\n      >\n    | WorkerRequest<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions]>\n    | WorkerRequest<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions]>\n    | WorkerRequest<WorkerRequestType.INSTANTIATE, [string, string | null]>\n    | WorkerRequest<WorkerRequestType.OPEN, DuckDBConfig>\n    | WorkerRequest<WorkerRequestType.PING, null>\n    | WorkerRequest<WorkerRequestType.POLL_PENDING_QUERY, number>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array]>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_HANDLE, [string, any, DuckDBDataProtocol, boolean]>\n    | WorkerRequest<WorkerRequestType.REGISTER_FILE_URL, [string, string, DuckDBDataProtocol, boolean]>\n    | WorkerRequest<WorkerRequestType.RESET, null>\n    | WorkerRequest<WorkerRequestType.RUN_PREPARED, [number, number, any[]]>\n    | WorkerRequest<WorkerRequestType.RUN_QUERY, [number, string]>\n    | WorkerRequest<WorkerRequestType.SEND_PREPARED, [number, number, any[]]>\n    | WorkerRequest<WorkerRequestType.START_PENDING_QUERY, [number, string, boolean]>\n    | WorkerRequest<WorkerRequestType.TOKENIZE, string>;\n\nexport type WorkerResponseVariant =\n    | WorkerResponse<WorkerResponseType.CONNECTION_INFO, number>\n    | WorkerResponse<WorkerResponseType.ERROR, any>\n    | WorkerResponse<WorkerResponseType.FEATURE_FLAGS, number>\n    | WorkerResponse<WorkerResponseType.FILE_BUFFER, Uint8Array>\n    | WorkerResponse<WorkerResponseType.FILE_INFOS, WebFile[]>\n    | WorkerResponse<WorkerResponseType.FILE_SIZE, number>\n    | WorkerResponse<WorkerResponseType.FILE_STATISTICS, FileStatistics>\n    | WorkerResponse<WorkerResponseType.INSTANTIATE_PROGRESS, InstantiationProgress>\n    | WorkerResponse<WorkerResponseType.LOG, LogEntryVariant>\n    | WorkerResponse<WorkerResponseType.PROGRESS_UPDATE, ProgressEntry>\n    | WorkerResponse<WorkerResponseType.OK, null>\n    | WorkerResponse<WorkerResponseType.PREPARED_STATEMENT_ID, number>\n    | WorkerResponse<WorkerResponseType.QUERY_PLAN, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_CHUNK, Uint8Array | null>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_HEADER, Uint8Array>\n    | WorkerResponse<WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL, Uint8Array | null>\n    | WorkerResponse<WorkerResponseType.SCRIPT_TOKENS, ScriptTokens>\n    | WorkerResponse<WorkerResponseType.SUCCESS, boolean>\n    | WorkerResponse<WorkerResponseType.TABLE_NAMES, string[]>\n    | WorkerResponse<WorkerResponseType.VERSION_STRING, string>;\n\nexport type WorkerTaskVariant =\n    | WorkerTask<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean], null>\n    | WorkerTask<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string], null>\n    | WorkerTask<WorkerRequestType.CLOSE_PREPARED, [number, number], null>\n    | WorkerTask<WorkerRequestType.CONNECT, null, ConnectionID>\n    | WorkerTask<WorkerRequestType.COPY_FILE_TO_BUFFER, string, Uint8Array>\n    | WorkerTask<WorkerRequestType.COPY_FILE_TO_PATH, [string, string], null>\n    | WorkerTask<WorkerRequestType.CREATE_PREPARED, [number, string], number>\n    | WorkerTask<WorkerRequestType.DISCONNECT, ConnectionID, null>\n    | WorkerTask<WorkerRequestType.DROP_FILE, string, null>\n    | WorkerTask<WorkerRequestType.DROP_FILES, string[] | undefined, null>\n    | WorkerTask<WorkerRequestType.EXPORT_FILE_STATISTICS, string, FileStatistics>\n    | WorkerTask<WorkerRequestType.FETCH_QUERY_RESULTS, ConnectionID, Uint8Array | null>\n    | WorkerTask<WorkerRequestType.FLUSH_FILES, null, null>\n    | WorkerTask<WorkerRequestType.GET_FEATURE_FLAGS, null, number>\n    | WorkerTask<WorkerRequestType.GET_TABLE_NAMES, [number, string], string[]>\n    | WorkerTask<WorkerRequestType.GET_VERSION, null, string>\n    | WorkerTask<\n          WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n          [number, Uint8Array, ArrowInsertOptions | undefined],\n          null\n      >\n    | WorkerTask<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions], null>\n    | WorkerTask<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions], null>\n    | WorkerTask<WorkerRequestType.INSTANTIATE, [string, string | null], null>\n    | WorkerTask<WorkerRequestType.OPEN, DuckDBConfig, null>\n    | WorkerTask<WorkerRequestType.PING, null, null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_HANDLE, [string, any, DuckDBDataProtocol, boolean], null>\n    | WorkerTask<WorkerRequestType.REGISTER_FILE_URL, [string, string, DuckDBDataProtocol, boolean], null>\n    | WorkerTask<WorkerRequestType.GLOB_FILE_INFOS, string, WebFile[]>\n    | WorkerTask<WorkerRequestType.RESET, null, null>\n    | WorkerTask<WorkerRequestType.RUN_PREPARED, [number, number, any[]], Uint8Array>\n    | WorkerTask<WorkerRequestType.RUN_QUERY, [ConnectionID, string], Uint8Array>\n    | WorkerTask<WorkerRequestType.SEND_PREPARED, [number, number, any[]], Uint8Array>\n    | WorkerTask<WorkerRequestType.START_PENDING_QUERY, [ConnectionID, string, boolean], Uint8Array | null>\n    | WorkerTask<WorkerRequestType.POLL_PENDING_QUERY, ConnectionID, Uint8Array | null>\n    | WorkerTask<WorkerRequestType.CANCEL_PENDING_QUERY, ConnectionID, boolean>\n    | WorkerTask<WorkerRequestType.TOKENIZE, string, ScriptTokens>;\n", "export const REGEX_OPFS_FILE = /'(opfs:\\/\\/\\S*?)'/g;\nexport const REGEX_OPFS_PROTOCOL = /(opfs:\\/\\/\\S*?)/g;\n\nexport function isOPFSProtocol(path: string): boolean {\n    return path.search(REGEX_OPFS_PROTOCOL) > -1;\n}\n\nexport function searchOPFSFiles(text: string) {\n    return [...text.matchAll(REGEX_OPFS_FILE)].map(match => match[1]);\n}", "import {\n    WorkerRequestType,\n    WorkerResponseType,\n    WorkerResponseVariant,\n    WorkerTaskVariant,\n    WorkerTask,\n    ConnectionID,\n    WorkerTaskReturnType,\n} from './worker_request';\nimport { AsyncDuckDBBindings } from './async_bindings_interface';\nimport { Logger } from '../log';\nimport { AsyncDuckDBConnection } from './async_connection';\nimport { CSVInsertOptions, JSONInsertOptions, ArrowInsertOptions } from '../bindings/insert_options';\nimport { ScriptTokens } from '../bindings/tokens';\nimport { FileStatistics } from '../bindings/file_stats';\nimport { DuckDBConfig } from '../bindings/config';\nimport { InstantiationProgress } from '../bindings/progress';\nimport { WebFile } from '../bindings/web_file';\nimport { DuckDBDataProtocol } from '../bindings';\nimport { searchOPFSFiles, isOPFSProtocol } from '../utils/opfs_util';\nimport { ProgressEntry } from '../log';\n\nconst TEXT_ENCODER = new TextEncoder();\n\nexport class AsyncDuckDB implements AsyncDuckDBBindings {\n    /** The message handler */\n    protected readonly _onMessageHandler: (event: MessageEvent) => void;\n    /** The error handler */\n    protected readonly _onErrorHandler: (event: ErrorEvent) => void;\n    /** The close handler */\n    protected readonly _onCloseHandler: () => void;\n\n    /** Instantiate the module */\n    protected _onInstantiationProgress: ((p: InstantiationProgress) => void)[] = [];\n\n    /** Progress callbacks */\n    protected _onExecutionProgress: ((p: ProgressEntry) => void)[] = [];\n\n    /** The logger */\n    protected readonly _logger: Logger;\n    /** The worker */\n    protected _worker: Worker | null = null;\n    /** The promise for the worker shutdown */\n    protected _workerShutdownPromise: Promise<null> | null = null;\n    /** Make the worker as terminated */\n    protected _workerShutdownResolver: (value: PromiseLike<null> | null) => void = () => {};\n\n    /** The next message id */\n    protected _nextMessageId = 0;\n    /** The pending requests */\n    protected _pendingRequests: Map<number, WorkerTaskVariant> = new Map();\n    /** The DuckDBConfig */\n    protected _config: DuckDBConfig = {};\n\n    constructor(logger: Logger, worker: Worker | null = null) {\n        this._logger = logger;\n        this._onMessageHandler = this.onMessage.bind(this);\n        this._onErrorHandler = this.onError.bind(this);\n        this._onCloseHandler = this.onClose.bind(this);\n        if (worker != null) this.attach(worker);\n    }\n\n    /** Get the logger */\n    public get logger(): Logger {\n        return this._logger;\n    }\n\n    /** Get the logger */\n    public get config(): DuckDBConfig {\n        return this._config;\n    }\n\n    /** Attach to worker */\n    protected attach(worker: Worker): void {\n        this._worker = worker;\n        this._worker.addEventListener('message', this._onMessageHandler);\n        this._worker.addEventListener('error', this._onErrorHandler);\n        this._worker.addEventListener('close', this._onCloseHandler);\n        this._workerShutdownPromise = new Promise<null>(\n            (resolve: (value: PromiseLike<null> | null) => void, _reject: (reason?: void) => void) => {\n                this._workerShutdownResolver = resolve;\n            },\n        );\n    }\n\n    /** Detach from worker */\n    public detach(): void {\n        if (!this._worker) return;\n        this._worker.removeEventListener('message', this._onMessageHandler);\n        this._worker.removeEventListener('error', this._onErrorHandler);\n        this._worker.removeEventListener('close', this._onCloseHandler);\n        this._worker = null;\n        this._workerShutdownResolver(null);\n        this._workerShutdownPromise = null;\n        this._workerShutdownResolver = () => {};\n    }\n\n    /** Kill the worker */\n    public async terminate(): Promise<void> {\n        if (!this._worker) return;\n        this._worker.terminate();\n        //await this._workerShutdownPromise; TODO deadlocking in karma?\n        this._worker = null;\n        this._workerShutdownPromise = null;\n        this._workerShutdownResolver = () => {};\n    }\n\n    /** Post a task */\n    protected async postTask<W extends WorkerTaskVariant>(\n        task: W,\n        transfer: ArrayBuffer[] = [],\n    ): Promise<WorkerTaskReturnType<W>> {\n        if (!this._worker) {\n            console.error('cannot send a message since the worker is not set!:' + task.type + ',' + task.data);\n            return undefined as any;\n        }\n        const mid = this._nextMessageId++;\n        this._pendingRequests.set(mid, task);\n        this._worker.postMessage(\n            {\n                messageId: mid,\n                type: task.type,\n                data: task.data,\n            },\n            transfer,\n        );\n        return (await task.promise) as WorkerTaskReturnType<W>;\n    }\n\n    /** Received a message */\n    protected onMessage(event: MessageEvent): void {\n        // Unassociated responses?\n        const response = event.data as WorkerResponseVariant;\n        switch (response.type) {\n            // Request failed?\n            case WorkerResponseType.PROGRESS_UPDATE: {\n                for (const p of this._onExecutionProgress) {\n                    p(response.data);\n                }\n                return;\n            }\n            case WorkerResponseType.LOG: {\n                this._logger.log(response.data);\n                return;\n            }\n            // Call progress callback\n            case WorkerResponseType.INSTANTIATE_PROGRESS: {\n                for (const p of this._onInstantiationProgress) {\n                    p(response.data);\n                }\n                return;\n            }\n        }\n\n        // Get associated task\n        const task = this._pendingRequests.get(response.requestId);\n        if (!task) {\n            console.warn(`unassociated response: [${response.requestId}, ${response.type.toString()}]`);\n            return;\n        }\n        this._pendingRequests.delete(response.requestId);\n\n        // Request failed?\n        if (response.type == WorkerResponseType.ERROR) {\n            // Workaround for Firefox not being able to perform structured-clone on Native Errors\n            // https://bugzilla.mozilla.org/show_bug.cgi?id=1556604\n            const e = new Error(response.data.message);\n            e.name = response.data.name;\n            if (Object.getOwnPropertyDescriptor(e, 'stack')?.writable) {\n                e.stack = response.data.stack;\n            }\n            task.promiseRejecter(e);\n            return;\n        }\n\n        // Otherwise differentiate between the tasks first\n        switch (task.type) {\n            case WorkerRequestType.CLOSE_PREPARED:\n            case WorkerRequestType.COLLECT_FILE_STATISTICS:\n            case WorkerRequestType.REGISTER_OPFS_FILE_NAME:\n            case WorkerRequestType.COPY_FILE_TO_PATH:\n            case WorkerRequestType.DISCONNECT:\n            case WorkerRequestType.DROP_FILE:\n            case WorkerRequestType.DROP_FILES:\n            case WorkerRequestType.FLUSH_FILES:\n            case WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM:\n            case WorkerRequestType.INSERT_CSV_FROM_PATH:\n            case WorkerRequestType.INSERT_JSON_FROM_PATH:\n            case WorkerRequestType.OPEN:\n            case WorkerRequestType.PING:\n            case WorkerRequestType.REGISTER_FILE_BUFFER:\n            case WorkerRequestType.REGISTER_FILE_HANDLE:\n            case WorkerRequestType.REGISTER_FILE_URL:\n            case WorkerRequestType.RESET:\n                if (response.type == WorkerResponseType.OK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.INSTANTIATE:\n                this._onInstantiationProgress = [];\n                if (response.type == WorkerResponseType.OK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GLOB_FILE_INFOS:\n                if (response.type == WorkerResponseType.FILE_INFOS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_VERSION:\n                if (response.type == WorkerResponseType.VERSION_STRING) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_FEATURE_FLAGS:\n                if (response.type == WorkerResponseType.FEATURE_FLAGS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.GET_TABLE_NAMES:\n                if (response.type == WorkerResponseType.TABLE_NAMES) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.TOKENIZE:\n                if (response.type == WorkerResponseType.SCRIPT_TOKENS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.COPY_FILE_TO_BUFFER:\n                if (response.type == WorkerResponseType.FILE_BUFFER) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.EXPORT_FILE_STATISTICS:\n                if (response.type == WorkerResponseType.FILE_STATISTICS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CONNECT:\n                if (response.type == WorkerResponseType.CONNECTION_INFO) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.RUN_PREPARED:\n            case WorkerRequestType.RUN_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.SEND_PREPARED:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.START_PENDING_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.POLL_PENDING_QUERY:\n                if (response.type == WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CANCEL_PENDING_QUERY:\n                this._onInstantiationProgress = [];\n                if (response.type == WorkerResponseType.SUCCESS) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.FETCH_QUERY_RESULTS:\n                if (response.type == WorkerResponseType.QUERY_RESULT_CHUNK) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n            case WorkerRequestType.CREATE_PREPARED:\n                if (response.type == WorkerResponseType.PREPARED_STATEMENT_ID) {\n                    task.promiseResolver(response.data);\n                    return;\n                }\n                break;\n        }\n        task.promiseRejecter(new Error(`unexpected response type: ${response.type.toString()}`));\n    }\n\n    /** Received an error */\n    protected onError(event: ErrorEvent): void {\n        console.error(event);\n        console.error(`error in duckdb worker: ${event.message}`);\n        this._pendingRequests.clear();\n    }\n\n    /** The worker was closed */\n    protected onClose(): void {\n        this._workerShutdownResolver(null);\n        if (this._pendingRequests.size != 0) {\n            console.warn(`worker terminated with ${this._pendingRequests.size} pending requests`);\n            return;\n        }\n        this._pendingRequests.clear();\n    }\n\n    /** Is in detached state, no worker defined */\n    public isDetached(): boolean {\n        return !this._worker;\n    }\n\n    /** Reset the duckdb */\n    public async reset(): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.RESET, null, null>(WorkerRequestType.RESET, null);\n        return await this.postTask(task);\n    }\n\n    /** Ping the worker thread */\n    public async ping(): Promise<any> {\n        const task = new WorkerTask<WorkerRequestType.PING, null, null>(WorkerRequestType.PING, null);\n        await this.postTask(task);\n    }\n    /** Try to drop a file */\n    public async dropFile(name: string): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.DROP_FILE, string, null>(WorkerRequestType.DROP_FILE, name);\n        return await this.postTask(task);\n    }\n    /** Try to drop files */\n    public async dropFiles(names?: string[]): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.DROP_FILES, string[] | undefined, null>(\n            WorkerRequestType.DROP_FILES,\n            names,\n        );\n        return await this.postTask(task);\n    }\n    /** Flush all files */\n    public async flushFiles(): Promise<null> {\n        const task = new WorkerTask<WorkerRequestType.FLUSH_FILES, null, null>(WorkerRequestType.FLUSH_FILES, null);\n        return await this.postTask(task);\n    }\n\n    /** Open the database */\n    public async instantiate(\n        mainModuleURL: string,\n        pthreadWorkerURL: string | null = null,\n        progress: (progress: InstantiationProgress) => void = _p => {},\n    ): Promise<null> {\n        this._onInstantiationProgress.push(progress);\n        const task = new WorkerTask<WorkerRequestType.INSTANTIATE, [string, string | null], null>(\n            WorkerRequestType.INSTANTIATE,\n            [mainModuleURL, pthreadWorkerURL],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Get the version */\n    public async getVersion(): Promise<string> {\n        const task = new WorkerTask<WorkerRequestType.GET_VERSION, null, string>(WorkerRequestType.GET_VERSION, null);\n        const version = await this.postTask(task);\n        return version;\n    }\n\n    /** Get the feature flags */\n    public async getFeatureFlags(): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.GET_FEATURE_FLAGS, null, number>(\n            WorkerRequestType.GET_FEATURE_FLAGS,\n            null,\n        );\n        const feature = await this.postTask(task);\n        return feature;\n    }\n\n    /** Open a new database */\n    public async open(config: DuckDBConfig): Promise<void> {\n        this._config = config;\n        const task = new WorkerTask<WorkerRequestType.OPEN, DuckDBConfig, null>(WorkerRequestType.OPEN, config);\n        await this.postTask(task);\n    }\n\n    /** Tokenize a script text */\n    public async tokenize(text: string): Promise<ScriptTokens> {\n        const task = new WorkerTask<WorkerRequestType.TOKENIZE, string, ScriptTokens>(WorkerRequestType.TOKENIZE, text);\n        const tokens = await this.postTask(task);\n        return tokens;\n    }\n\n    /** Connect to the database */\n    public async connectInternal(): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.CONNECT, null, ConnectionID>(WorkerRequestType.CONNECT, null);\n        return await this.postTask(task);\n    }\n\n    /** Connect to the database */\n    public async connect(): Promise<AsyncDuckDBConnection> {\n        const cid = await this.connectInternal();\n        return new AsyncDuckDBConnection(this, cid);\n    }\n\n    /** Disconnect from the database */\n    public async disconnect(conn: ConnectionID): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.DISCONNECT, ConnectionID, null>(\n            WorkerRequestType.DISCONNECT,\n            conn,\n        );\n        await this.postTask(task);\n    }\n\n    /** Run a query */\n    public async runQuery(conn: ConnectionID, text: string): Promise<Uint8Array> {\n        if (this.shouldOPFSFileHandling()) {\n            const files = await this.registerOPFSFileFromSQL(text);\n            try {\n                return await this._runQueryAsync(conn, text);\n            } finally {\n                if (files.length > 0) {\n                    await this.dropFiles(files);\n                }\n            }\n        } else {\n            return await this._runQueryAsync(conn, text);\n        }\n    }\n\n    private async _runQueryAsync(conn: ConnectionID, text: string): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.RUN_QUERY, [ConnectionID, string], Uint8Array>(\n            WorkerRequestType.RUN_QUERY,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Start a pending query */\n    public async startPendingQuery(\n        conn: ConnectionID,\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<Uint8Array | null> {\n        if (this.shouldOPFSFileHandling()) {\n            const files = await this.registerOPFSFileFromSQL(text);\n            try {\n                return await this._startPendingQueryAsync(conn, text, allowStreamResult);\n            } finally {\n                if (files.length > 0) {\n                    await this.dropFiles(files);\n                }\n            }\n        } else {\n            return await this._startPendingQueryAsync(conn, text, allowStreamResult);\n        }\n    }\n\n    private async _startPendingQueryAsync(\n        conn: ConnectionID,\n        text: string,\n        allowStreamResult: boolean = false,\n    ): Promise<Uint8Array | null> {\n        const task = new WorkerTask<\n            WorkerRequestType.START_PENDING_QUERY,\n            [ConnectionID, string, boolean],\n            Uint8Array | null\n        >(WorkerRequestType.START_PENDING_QUERY, [conn, text, allowStreamResult]);\n        return await this.postTask(task);\n    }\n\n    /** Poll a pending query */\n    public async pollPendingQuery(conn: ConnectionID): Promise<Uint8Array | null> {\n        const task = new WorkerTask<WorkerRequestType.POLL_PENDING_QUERY, ConnectionID, Uint8Array | null>(\n            WorkerRequestType.POLL_PENDING_QUERY,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n    /** Cancel a pending query */\n    public async cancelPendingQuery(conn: ConnectionID): Promise<boolean> {\n        const task = new WorkerTask<WorkerRequestType.CANCEL_PENDING_QUERY, ConnectionID, boolean>(\n            WorkerRequestType.CANCEL_PENDING_QUERY,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Fetch query results */\n    public async fetchQueryResults(conn: ConnectionID): Promise<Uint8Array | null> {\n        const task = new WorkerTask<WorkerRequestType.FETCH_QUERY_RESULTS, ConnectionID, Uint8Array | null>(\n            WorkerRequestType.FETCH_QUERY_RESULTS,\n            conn,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Get table names */\n    public async getTableNames(conn: number, text: string): Promise<string[]> {\n        const task = new WorkerTask<WorkerRequestType.GET_TABLE_NAMES, [number, string], string[]>(\n            WorkerRequestType.GET_TABLE_NAMES,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n\n    /** Prepare a statement and return its identifier */\n    public async createPrepared(conn: number, text: string): Promise<number> {\n        const task = new WorkerTask<WorkerRequestType.CREATE_PREPARED, [number, string], number>(\n            WorkerRequestType.CREATE_PREPARED,\n            [conn, text],\n        );\n        return await this.postTask(task);\n    }\n    /** Close a prepared statement */\n    public async closePrepared(conn: number, statement: number): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.CLOSE_PREPARED, [number, number], null>(\n            WorkerRequestType.CLOSE_PREPARED,\n            [conn, statement],\n        );\n        await this.postTask(task);\n    }\n    /** Execute a prepared statement and return the full result */\n    public async runPrepared(conn: number, statement: number, params: any[]): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.RUN_PREPARED, [ConnectionID, number, any[]], Uint8Array>(\n            WorkerRequestType.RUN_PREPARED,\n            [conn, statement, params],\n        );\n        return await this.postTask(task);\n    }\n    /** Execute a prepared statement and stream the result */\n    public async sendPrepared(conn: number, statement: number, params: any[]): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.SEND_PREPARED, [ConnectionID, number, any[]], Uint8Array>(\n            WorkerRequestType.SEND_PREPARED,\n            [conn, statement, params],\n        );\n        return await this.postTask(task);\n    }\n    /** Glob file infos */\n    public async globFiles(path: string): Promise<WebFile[]> {\n        const task = new WorkerTask<WorkerRequestType.GLOB_FILE_INFOS, string, WebFile[]>(\n            WorkerRequestType.GLOB_FILE_INFOS,\n            path,\n        );\n        return await this.postTask(task);\n    }\n    /** Register file text */\n    public async registerFileText(name: string, text: string): Promise<void> {\n        const buffer = TEXT_ENCODER.encode(text);\n        await this.registerFileBuffer(name, buffer);\n    }\n    /** Register a file path. */\n    public async registerFileURL(\n        name: string,\n        url: string,\n        proto: DuckDBDataProtocol,\n        directIO: boolean,\n    ): Promise<void> {\n        if (url === undefined) {\n            url = name;\n        }\n        const task = new WorkerTask<\n            WorkerRequestType.REGISTER_FILE_URL,\n            [string, string, DuckDBDataProtocol, boolean],\n            null\n        >(WorkerRequestType.REGISTER_FILE_URL, [name, url, proto, directIO]);\n        await this.postTask(task);\n    }\n\n    /** Register an empty file buffer. */\n    public async registerEmptyFileBuffer(name: string): Promise<void> {\n        /*\n        const task = new WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>(\n            WorkerRequestType.REGISTER_FILE_BUFFER,\n            [name, new Uint8Array()],\n        );\n        await this.postTask(task);\n*/\n    }\n\n    /** Register a file buffer. */\n    public async registerFileBuffer(name: string, buffer: Uint8Array): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.REGISTER_FILE_BUFFER, [string, Uint8Array], null>(\n            WorkerRequestType.REGISTER_FILE_BUFFER,\n            [name, buffer],\n        );\n        await this.postTask(task, [buffer.buffer]);\n    }\n\n    /** Register a file handle. */\n    public async registerFileHandle<HandleType>(\n        name: string,\n        handle: HandleType,\n        protocol: DuckDBDataProtocol,\n        directIO: boolean,\n    ): Promise<void> {\n        const task = new WorkerTask<\n            WorkerRequestType.REGISTER_FILE_HANDLE,\n            [string, any, DuckDBDataProtocol, boolean],\n            null\n        >(WorkerRequestType.REGISTER_FILE_HANDLE, [name, handle, protocol, directIO]);\n        await this.postTask(task, []);\n    }\n\n    /** Enable file statistics */\n    public async registerOPFSFileName(name: string): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.REGISTER_OPFS_FILE_NAME, [string], null>(\n            WorkerRequestType.REGISTER_OPFS_FILE_NAME,\n            [name],\n        );\n        await this.postTask(task, []);\n    }\n\n    /** Enable file statistics */\n    public async collectFileStatistics(name: string, enable: boolean): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.COLLECT_FILE_STATISTICS, [string, boolean], null>(\n            WorkerRequestType.COLLECT_FILE_STATISTICS,\n            [name, enable],\n        );\n        await this.postTask(task, []);\n    }\n\n    /** Export file statistics */\n    public async exportFileStatistics(name: string): Promise<FileStatistics> {\n        const task = new WorkerTask<WorkerRequestType.EXPORT_FILE_STATISTICS, string, FileStatistics>(\n            WorkerRequestType.EXPORT_FILE_STATISTICS,\n            name,\n        );\n        return await this.postTask(task, []);\n    }\n\n    /** Copy a file to a buffer. */\n    public async copyFileToBuffer(name: string): Promise<Uint8Array> {\n        const task = new WorkerTask<WorkerRequestType.COPY_FILE_TO_BUFFER, string, Uint8Array>(\n            WorkerRequestType.COPY_FILE_TO_BUFFER,\n            name,\n        );\n        return await this.postTask(task);\n    }\n\n    /** Copy a file to a path. */\n    public async copyFileToPath(name: string, path: string): Promise<void> {\n        const task = new WorkerTask<WorkerRequestType.COPY_FILE_TO_PATH, [string, string], null>(\n            WorkerRequestType.COPY_FILE_TO_PATH,\n            [name, path],\n        );\n        await this.postTask(task);\n    }\n\n    /** Insert arrow from an ipc stream */\n    public async insertArrowFromIPCStream(\n        conn: ConnectionID,\n        buffer: Uint8Array,\n        options?: ArrowInsertOptions,\n    ): Promise<void> {\n        if (buffer.length == 0) return;\n        // Pass to the worker\n        const task = new WorkerTask<\n            WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM,\n            [number, Uint8Array, ArrowInsertOptions | undefined],\n            null\n        >(WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM, [conn, buffer, options]);\n        await this.postTask(task, [buffer.buffer]);\n    }\n    /** Insert a csv file */\n    public async insertCSVFromPath(conn: ConnectionID, path: string, options: CSVInsertOptions): Promise<void> {\n        // Pass to the worker\n        const task = new WorkerTask<WorkerRequestType.INSERT_CSV_FROM_PATH, [number, string, CSVInsertOptions], null>(\n            WorkerRequestType.INSERT_CSV_FROM_PATH,\n            [conn, path, options],\n        );\n        await this.postTask(task);\n    }\n    /** Insert a json file */\n    public async insertJSONFromPath(conn: ConnectionID, path: string, options: JSONInsertOptions): Promise<void> {\n        // Pass to the worker\n        const task = new WorkerTask<WorkerRequestType.INSERT_JSON_FROM_PATH, [number, string, JSONInsertOptions], null>(\n            WorkerRequestType.INSERT_JSON_FROM_PATH,\n            [conn, path, options],\n        );\n        await this.postTask(task);\n    }\n\n    private shouldOPFSFileHandling(): boolean {\n        if (isOPFSProtocol(this.config.path ?? '')) {\n            return this.config.opfs?.fileHandling == 'auto';\n        }\n        return false;\n    }\n\n    private async registerOPFSFileFromSQL(text: string) {\n        const files = searchOPFSFiles(text);\n        const result: string[] = [];\n        for (const file of files) {\n            try {\n                await this.registerOPFSFileName(file);\n                result.push(file);\n            } catch (e) {\n                console.error(e);\n                throw new Error('File Not found:' + file);\n            }\n        }\n        return result;\n    }\n}\n", "import { DuckDBModule } from './duckdb_module';\nimport { UDFFunction } from './udf_function';\nimport * as udf_rt from './udf_runtime';\n\n/** Wrapper for TextDecoder to support shared array buffers */\nfunction TextDecoderWrapper(): (input?: BufferSource) => string {\n    const decoder = new TextDecoder();\n    return (data: any) => {\n        if (typeof SharedArrayBuffer !== 'undefined' && data.buffer instanceof SharedArrayBuffer) {\n            data = new Uint8Array(data);\n        }\n        return decoder.decode(data);\n    };\n}\n/** Helper to decode text */\nexport const decodeText = TextDecoderWrapper();\n\n/** Copy a buffer */\nexport function failWith(mod: DuckDBModule, msg: string): void {\n    console.error(`FAIL WITH: ${msg}`);\n    mod.ccall('duckdb_web_fail_with', null, ['string'], [msg]);\n}\n\n/** Copy a buffer */\nexport function copyBuffer(mod: DuckDBModule, begin: number, length: number): Uint8Array {\n    const buffer = mod.HEAPU8.subarray(begin, begin + length);\n    const copy = new Uint8Array(new ArrayBuffer(buffer.byteLength));\n    copy.set(buffer);\n    return copy;\n}\n\n/** Decode a string */\nexport function readString(mod: DuckDBModule, begin: number, length: number): string {\n    return decodeText(mod.HEAPU8.subarray(begin, begin + length));\n}\n\n/** The data protocol */\nexport enum DuckDBDataProtocol {\n    BUFFER = 0,\n    NODE_FS = 1,\n    BROWSER_FILEREADER = 2,\n    BROWSER_FSACCESS = 3,\n    HTTP = 4,\n    S3 = 5,\n}\n\n/** File flags for opening files*/\nexport enum FileFlags {\n    //! Open file with read access\n    FILE_FLAGS_READ = 1 << 0,\n    //! Open file with write access\n    FILE_FLAGS_WRITE = 1 << 1,\n    //! Use direct IO when reading/writing to the file\n    FILE_FLAGS_DIRECT_IO = 1 << 2,\n    //! Create file if not exists, can only be used together with WRITE\n    FILE_FLAGS_FILE_CREATE = 1 << 3,\n    //! Always create a new file. If a file exists, the file is truncated. Cannot be used together with CREATE.\n    FILE_FLAGS_FILE_CREATE_NEW = 1 << 4,\n    //! Open file in append mode\n    FILE_FLAGS_APPEND = 1 << 5,\n    FILE_FLAGS_PRIVATE = 1 << 6,\n    FILE_FLAGS_NULL_IF_NOT_EXISTS = 1 << 7,\n    FILE_FLAGS_PARALLEL_ACCESS = 1 << 8,\n    FILE_FLAGS_EXCLUSIVE_CREATE = 1 << 9,\n    FILE_FLAGS_NULL_IF_EXISTS = 1 << 10,\n}\n\n/** Configuration for the AWS S3 Filesystem */\nexport interface S3Config {\n    region?: string;\n    endpoint?: string;\n    accessKeyId?: string;\n    secretAccessKey?: string;\n    sessionToken?: string;\n}\n\n/** An info for a file registered with DuckDB */\nexport interface DuckDBFileInfo {\n    cacheEpoch: number;\n    fileId: number;\n    fileName: string;\n    dataProtocol: DuckDBDataProtocol;\n    dataUrl: string | null;\n    reliableHeadRequests?: boolean;\n    allowFullHttpReads?: boolean;\n    forceFullHttpReads?: boolean;\n    bearerToken?: string;\n    s3Config?: S3Config;\n}\n\n/** Global info for all files registered with DuckDB */\nexport interface DuckDBGlobalFileInfo {\n    cacheEpoch: number;\n    reliableHeadRequests?: boolean;\n    allowFullHttpReads?: boolean;\n    forceFullHttpReads?: boolean;\n    bearerToken?: string;\n    s3Config?: S3Config;\n}\n\nexport interface PreparedDBFileHandle {\n    path: string;\n    handle: any;\n    fromCached: boolean;\n}\n\n/** Call a function with packed response buffer */\nexport function callSRet(\n    mod: DuckDBModule,\n    funcName: string,\n    argTypes: Array<Emscripten.JSType>,\n    args: Array<any>,\n): [number, number, number] {\n    const stackPointer = mod.stackSave();\n\n    // Allocate the packed response buffer\n    const response = mod.stackAlloc(3 * 8);\n    argTypes.unshift('number');\n    args.unshift(response);\n\n    // Do the call\n    mod.ccall(funcName, null, argTypes, args);\n\n    // Read the response\n    const status = mod.HEAPF64[(response >> 3) + 0];\n    const data = mod.HEAPF64[(response >> 3) + 1];\n    const dataSize = mod.HEAPF64[(response >> 3) + 2];\n\n    // Restore the stack\n    mod.stackRestore(stackPointer);\n    return [status, data, dataSize];\n}\n\n/** Drop response buffers */\nexport function dropResponseBuffers(mod: DuckDBModule): void {\n    mod.ccall('duckdb_web_clear_response', null, [], []);\n}\n\n/** The duckdb runtime */\nexport interface DuckDBRuntime {\n    _files?: Map<string, any>;\n    _udfFunctions: Map<number, UDFFunction>;\n\n    // Test a platform feature\n    testPlatformFeature(mod: DuckDBModule, feature: number): boolean;\n\n    // File APIs with dedicated file identifier\n    getDefaultDataProtocol(mod: DuckDBModule): number;\n    openFile(mod: DuckDBModule, fileId: number, flags: FileFlags): void;\n    syncFile(mod: DuckDBModule, fileId: number): void;\n    closeFile(mod: DuckDBModule, fileId: number): void;\n    dropFile(mod: DuckDBModule, fileNamePtr: number, fileNameLen: number): void;\n    getLastFileModificationTime(mod: DuckDBModule, fileId: number): number;\n    truncateFile(mod: DuckDBModule, fileId: number, newSize: number): void;\n    readFile(mod: DuckDBModule, fileId: number, buffer: number, bytes: number, location: number): number;\n    writeFile(mod: DuckDBModule, fileId: number, buffer: number, bytes: number, location: number): number;\n\n    // File APIs with path parameter\n    removeDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    checkDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    createDirectory(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    listDirectoryEntries(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    glob(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n    moveFile(mod: DuckDBModule, fromPtr: number, fromLen: number, toPtr: number, toLen: number): void;\n    checkFile(mod: DuckDBModule, pathPtr: number, pathLen: number): boolean;\n    removeFile(mod: DuckDBModule, pathPtr: number, pathLen: number): void;\n\n    // Prepare a file handle that could only be acquired aschronously\n    prepareFileHandle?: (path: string, protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n    prepareFileHandles?: (path: string[], protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n    prepareDBFileHandle?: (path: string, protocol: DuckDBDataProtocol) => Promise<PreparedDBFileHandle[]>;\n\n    // Internal API - experimental\n    progressUpdate(final: number, percentage: number, iteration: number): void;\n\n    // Call a scalar UDF function\n    callScalarUDF(\n        mod: DuckDBModule,\n        response: number,\n        funcId: number,\n        descPtr: number,\n        descSize: number,\n        ptrsPtr: number,\n        ptrsSize: number,\n    ): void;\n}\n\nexport const DEFAULT_RUNTIME: DuckDBRuntime = {\n    _udfFunctions: new Map(),\n\n    testPlatformFeature: (_mod: DuckDBModule, _feature: number): boolean => false,\n    getDefaultDataProtocol: (_mod: DuckDBModule): number => DuckDBDataProtocol.BUFFER,\n    openFile: (_mod: DuckDBModule, _fileId: number, flags: FileFlags): void => {},\n    syncFile: (_mod: DuckDBModule, _fileId: number): void => {},\n    closeFile: (_mod: DuckDBModule, _fileId: number): void => {},\n    dropFile: (_mod: DuckDBModule, _fileNamePtr: number, _fileNameLen: number): void => {},\n    getLastFileModificationTime: (_mod: DuckDBModule, _fileId: number): number => {\n        return 0;\n    },\n    progressUpdate: (_final: number, _percentage: number, _iteration: number): void => {\n        return;\n    },\n    truncateFile: (_mod: DuckDBModule, _fileId: number, _newSize: number): void => {},\n    readFile: (_mod: DuckDBModule, _fileId: number, _buffer: number, _bytes: number, _location: number): number => {\n        return 0;\n    },\n    writeFile: (_mod: DuckDBModule, _fileId: number, _buffer: number, _bytes: number, _location: number): number => {\n        return 0;\n    },\n\n    removeDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    checkDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    createDirectory: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    listDirectoryEntries: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    glob: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    moveFile: (_mod: DuckDBModule, _fromPtr: number, _fromLen: number, _toPtr: number, _toLen: number): void => {},\n    checkFile: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): boolean => {\n        return false;\n    },\n    removeFile: (_mod: DuckDBModule, _pathPtr: number, _pathLen: number): void => {},\n    callScalarUDF: (\n        mod: DuckDBModule,\n        response: number,\n        funcId: number,\n        descPtr: number,\n        descSize: number,\n        ptrsPtr: number,\n        ptrsSize: number,\n    ): void => {\n        udf_rt.callScalarUDF(DEFAULT_RUNTIME, mod, response, funcId, descPtr, descSize, ptrsPtr, ptrsSize);\n    },\n};\n", "import { DuckDBBindings, DuckDBDataProtocol } from '../bindings';\nimport { WorkerResponseVariant, WorkerRequestVariant, WorkerRequestType, WorkerResponseType } from './worker_request';\nimport { Logger, LogEntryVariant } from '../log';\nimport { InstantiationProgress } from '../bindings/progress';\n\nexport abstract class AsyncDuckDBDispatcher implements Logger {\n    /** The bindings */\n    protected _bindings: DuckDBBindings | null = null;\n    /** The next message id */\n    protected _nextMessageId = 0;\n\n    /** Instantiate the wasm module */\n    protected abstract instantiate(\n        mainModule: string,\n        pthreadWorker: string | null,\n        progress: (p: InstantiationProgress) => void,\n    ): Promise<DuckDBBindings>;\n    /** Post a response to the main thread */\n    protected abstract postMessage(response: WorkerResponseVariant, transfer: ArrayBuffer[]): void;\n\n    /** Send log entry to the main thread */\n    public log(entry: LogEntryVariant): void {\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: 0,\n                type: WorkerResponseType.LOG,\n                data: entry,\n            },\n            [],\n        );\n    }\n\n    /** Send plain OK without further data */\n    protected sendOK(request: WorkerRequestVariant): void {\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: request.messageId,\n                type: WorkerResponseType.OK,\n                data: null,\n            },\n            [],\n        );\n    }\n\n    /** Fail with an error */\n    protected failWith(request: WorkerRequestVariant, e: Error): void {\n        // Workaround for Firefox not being able to perform structured-clone on Native Errors\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=1556604\n        const obj: any = {\n            name: e.name,\n            message: e.message,\n            stack: e.stack || undefined,\n        };\n        this.postMessage(\n            {\n                messageId: this._nextMessageId++,\n                requestId: request.messageId,\n                type: WorkerResponseType.ERROR,\n                data: obj,\n            },\n            [],\n        );\n        return;\n    }\n\n    /** Process a request from the main thread */\n    public async onMessage(request: WorkerRequestVariant): Promise<void> {\n        // First process those requests that don't need bindings\n        switch (request.type) {\n            case WorkerRequestType.PING:\n                this.sendOK(request);\n                return;\n            case WorkerRequestType.INSTANTIATE:\n                if (this._bindings != null) {\n                    this.failWith(request, new Error('duckdb already initialized'));\n                }\n                try {\n                    this._bindings = await this.instantiate(request.data[0], request.data[1], p => {\n                        this.postMessage(\n                            {\n                                messageId: this._nextMessageId++,\n                                requestId: request.messageId,\n                                type: WorkerResponseType.INSTANTIATE_PROGRESS,\n                                data: p,\n                            },\n                            [],\n                        );\n                    });\n                    this.sendOK(request);\n                } catch (e: any) {\n                    console.log(e);\n                    this._bindings = null;\n                    this.failWith(request, e);\n                }\n                return;\n            default:\n                break;\n        }\n\n        // Bindings not initialized?\n        if (!this._bindings) {\n            return this.failWith(request, new Error('duckdb is not initialized'));\n        }\n\n        // Catch every exception and forward it as error message to the main thread\n        try {\n            switch (request.type) {\n                case WorkerRequestType.GET_VERSION:\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.VERSION_STRING,\n                            data: this._bindings.getVersion(),\n                        },\n                        [],\n                    );\n                    break;\n                case WorkerRequestType.GET_FEATURE_FLAGS:\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FEATURE_FLAGS,\n                            data: this._bindings.getFeatureFlags(),\n                        },\n                        [],\n                    );\n                    break;\n                case WorkerRequestType.RESET:\n                    this._bindings.reset();\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.OPEN: {\n                    const path = request.data.path;\n                    if (path?.startsWith('opfs://')) {\n                        await this._bindings.prepareDBFileHandle(path, DuckDBDataProtocol.BROWSER_FSACCESS);\n                        request.data.useDirectIO = true;\n                    }\n                    this._bindings.open(request.data);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.DROP_FILE:\n                    this._bindings.dropFile(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.DROP_FILES:\n                    this._bindings.dropFiles(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.FLUSH_FILES:\n                    this._bindings.flushFiles();\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.CONNECT: {\n                    const conn = this._bindings.connect();\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.CONNECTION_INFO,\n                            data: conn.useUnsafe((_, c) => c),\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.DISCONNECT:\n                    this._bindings.disconnect(request.data);\n                    this.sendOK(request);\n                    break;\n                case WorkerRequestType.CREATE_PREPARED: {\n                    const result = this._bindings.createPrepared(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.PREPARED_STATEMENT_ID,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.CLOSE_PREPARED: {\n                    this._bindings.closePrepared(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.RUN_PREPARED: {\n                    const result = this._bindings.runPrepared(request.data[0], request.data[1], request.data[2]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.RUN_QUERY: {\n                    const result = this._bindings.runQuery(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.SEND_PREPARED: {\n                    const result = this._bindings.sendPrepared(request.data[0], request.data[1], request.data[2]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER,\n                            data: result,\n                        },\n                        [result.buffer],\n                    );\n                    break;\n                }\n                case WorkerRequestType.START_PENDING_QUERY: {\n                    const result = this._bindings.startPendingQuery(request.data[0], request.data[1], request.data[2]);\n                    const transfer = [];\n                    if (result) {\n                        transfer.push(result.buffer);\n                    }\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.POLL_PENDING_QUERY: {\n                    const result = this._bindings.pollPendingQuery(request.data);\n                    const transfer = [];\n                    if (result) {\n                        transfer.push(result.buffer);\n                    }\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_HEADER_OR_NULL,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.CANCEL_PENDING_QUERY: {\n                    const result = this._bindings.cancelPendingQuery(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.SUCCESS,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.FETCH_QUERY_RESULTS: {\n                    const result = this._bindings.fetchQueryResults(request.data);\n                    const transfer = result ? [result.buffer] : [];\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.QUERY_RESULT_CHUNK,\n                            data: result,\n                        },\n                        transfer,\n                    );\n                    break;\n                }\n                case WorkerRequestType.GET_TABLE_NAMES: {\n                    const result = this._bindings.getTableNames(request.data[0], request.data[1]);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.TABLE_NAMES,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.GLOB_FILE_INFOS: {\n                    const infos = this._bindings.globFiles(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_INFOS,\n                            data: infos,\n                        },\n                        [],\n                    );\n                    break;\n                }\n\n                case WorkerRequestType.REGISTER_FILE_URL:\n                    this._bindings.registerFileURL(request.data[0], request.data[1], request.data[2], request.data[3]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_FILE_BUFFER:\n                    this._bindings.registerFileBuffer(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_FILE_HANDLE:\n                    await this._bindings.registerFileHandleAsync(\n                        request.data[0],\n                        request.data[1],\n                        request.data[2],\n                        request.data[3],\n                    );\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.COPY_FILE_TO_PATH:\n                    this._bindings.copyFileToPath(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.COPY_FILE_TO_BUFFER: {\n                    const buffer = this._bindings.copyFileToBuffer(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_BUFFER,\n                            data: buffer,\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.COLLECT_FILE_STATISTICS:\n                    this._bindings.collectFileStatistics(request.data[0], request.data[1]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.REGISTER_OPFS_FILE_NAME:\n                    await this._bindings.registerOPFSFileName(request.data[0]);\n                    this.sendOK(request);\n                    break;\n\n                case WorkerRequestType.EXPORT_FILE_STATISTICS: {\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.FILE_STATISTICS,\n                            data: this._bindings.exportFileStatistics(request.data),\n                        },\n                        [],\n                    );\n                    break;\n                }\n                case WorkerRequestType.INSERT_ARROW_FROM_IPC_STREAM: {\n                    this._bindings.insertArrowFromIPCStream(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.INSERT_CSV_FROM_PATH: {\n                    this._bindings.insertCSVFromPath(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.INSERT_JSON_FROM_PATH: {\n                    this._bindings.insertJSONFromPath(request.data[0], request.data[1], request.data[2]);\n                    this.sendOK(request);\n                    break;\n                }\n                case WorkerRequestType.TOKENIZE: {\n                    const result = this._bindings.tokenize(request.data);\n                    this.postMessage(\n                        {\n                            messageId: this._nextMessageId++,\n                            requestId: request.messageId,\n                            type: WorkerResponseType.SCRIPT_TOKENS,\n                            data: result,\n                        },\n                        [],\n                    );\n                    break;\n                }\n            }\n        } catch (e: any) {\n            console.log(e);\n            return this.failWith(request, e);\n        }\n    }\n}\n", "export const bigInt=()=>(async e=>{try{return(await WebAssembly.instantiate(e)).instance.exports.b(BigInt(0))===BigInt(0)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,126,1,126,3,2,1,0,7,5,1,1,98,0,0,10,6,1,4,0,32,0,11])),bulkMemory=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),exceptions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),extendedConst=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,0,1,11,9,1,0,65,1,65,2,106,11,0])),gc=()=>(async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,95,1,120,0])))(),jspi=()=>(async()=>\"Suspender\"in WebAssembly)(),memory64=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,5,3,1,4,1])),multiMemory=()=>(async()=>{try{return new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,5,5,2,0,0,0,0])),!0}catch(e){return!1}})(),multiValue=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,0,2,127,127,3,2,1,0,10,8,1,6,0,65,0,65,0,11])),mutableGlobals=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,2,8,1,1,97,1,98,3,127,1,6,6,1,127,1,65,0,11,7,5,1,1,97,3,1])),referenceTypes=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,7,1,5,0,208,112,26,11])),relaxedSimd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,15,1,13,0,65,1,253,15,65,2,253,15,253,128,2,11])),saturatedFloatToInt=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,12,1,10,0,67,0,0,0,0,252,0,26,11])),signExtensions=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,65,0,192,26,11])),simd=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),streamingCompilation=()=>(async()=>\"compileStreaming\"in WebAssembly)(),tailCall=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,6,1,4,0,18,0,11])),threads=()=>(async e=>{try{return\"undefined\"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch(e){return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),typeReflection=()=>(async()=>\"Function\"in WebAssembly)();\n", "{\n    \"name\": \"@duckdb/duckdb-wasm\",\n    \"version\": \"1.11.0\",\n    \"description\": \"DuckDB powered by WebAssembly\",\n    \"license\": \"MIT\",\n    \"repository\": {\n        \"type\": \"git\",\n        \"url\": \"https://github.com/duckdb/duckdb-wasm.git\"\n    },\n    \"keywords\": [\n        \"sql\",\n        \"duckdb\",\n        \"relational\",\n        \"database\",\n        \"data\",\n        \"query\",\n        \"wasm\",\n        \"analytics\",\n        \"olap\",\n        \"arrow\",\n        \"parquet\",\n        \"json\",\n        \"csv\"\n    ],\n    \"dependencies\": {\n        \"@nodelib/fs.stat\": \"^4.0.0\",\n        \"@nodelib/fs.walk\": \"^3.0.1\",\n        \"@uwdata/flechette\": \"latest\",\n        \"fast-glob\": \"^3.3.3\",\n        \"glob-parent\": \"^6.0.2\",\n        \"merge2\": \"^1.4.1\",\n        \"micromatch\": \"^4.0.8\"\n    },\n    \"devDependencies\": {\n        \"@nodelib/fs.stat\": \"^4.0.0\",\n        \"@nodelib/fs.walk\": \"^3.0.1\",\n        \"@types/emscripten\": \"^1.39.10\",\n        \"@types/jasmine\": \"^5.1.4\",\n        \"@types/merge2\": \"^1\",\n        \"@types/micromatch\": \"^4\",\n        \"@typescript-eslint/eslint-plugin\": \"^6.21.0\",\n        \"@typescript-eslint/parser\": \"^6.21.0\",\n        \"esbuild\": \"^0.20.2\",\n        \"eslint\": \"^8.57.0\",\n        \"eslint-plugin-jasmine\": \"^4.1.3\",\n        \"eslint-plugin-react\": \"^7.34.0\",\n        \"glob\": \"^13.0.0\",\n        \"jasmine\": \"^5.1.0\",\n        \"jasmine-core\": \"^5.1.2\",\n        \"jasmine-spec-reporter\": \"^7.0.0\",\n        \"js-sha256\": \"^0.11.1\",\n        \"karma\": \"^6.4.2\",\n        \"karma-chrome-launcher\": \"^3.2.0\",\n        \"karma-coverage\": \"^2.2.1\",\n        \"karma-firefox-launcher\": \"^2.1.3\",\n        \"karma-jasmine\": \"^5.1.0\",\n        \"karma-jasmine-html-reporter\": \"^2.1.0\",\n        \"karma-sourcemap-loader\": \"^0.4.0\",\n        \"karma-spec-reporter\": \"^0.0.36\",\n        \"make-dir\": \"^4.0.0\",\n        \"nyc\": \"^15.1.0\",\n        \"prettier\": \"^3.2.5\",\n        \"puppeteer\": \"^22.8.0\",\n        \"rimraf\": \"^3.0.2\",\n        \"s3rver\": \"^3.7.1\",\n        \"semver\": \"^7.6.0\",\n        \"typedoc\": \"^0.25.13\",\n        \"typescript\": \"^5.3.3\",\n        \"wasm-feature-detect\": \"^1.6.1\",\n        \"web-worker\": \"^1.2.0\"\n    },\n    \"scripts\": {\n        \"build:debug\": \"node bundle.mjs debug && tsc --emitDeclarationOnly\",\n        \"build:release\": \"node bundle.mjs release && tsc --emitDeclarationOnly\",\n        \"docs\": \"typedoc\",\n        \"format\": \"prettier --write \\\"**/*.+(js|ts)\\\"\",\n        \"report\": \"node ./coverage.mjs\",\n        \"test:node\": \"node --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:node:debug\": \"node --inspect-brk --enable-source-maps ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:node:coverage\": \"nyc -r json --report-dir ./coverage/node node ../../node_modules/jasmine/bin/jasmine ./dist/tests-node.cjs\",\n        \"test:firefox\": \"karma start ./karma/tests-firefox.cjs\",\n        \"test:chrome\": \"karma start ./karma/tests-chrome.cjs\",\n        \"test:chrome:eh\": \"karma start ./karma/tests-chrome-eh.cjs\",\n        \"test:chrome:coverage\": \"karma start ./karma/tests-chrome-coverage.cjs\",\n        \"test:browser\": \"karma start ./karma/tests-all.cjs\",\n        \"test:browser:debug\": \"karma start ./karma/tests-debug.cjs\",\n        \"test\": \"npm run test:chrome && npm run test:node\",\n        \"test:coverage\": \"npm run test:chrome:coverage && npm run test:node:coverage && npm run report\",\n        \"lint\": \"eslint src test\"\n    },\n    \"files\": [\n        \"dist\",\n        \"!dist/tests-*\",\n        \"!dist/duckdb-browser-mvp.worker.js.map\",\n        \"!dist/types/test\"\n    ],\n    \"main\": \"dist/duckdb-browser.cjs\",\n    \"module\": \"dist/duckdb-browser.mjs\",\n    \"types\": \"dist/duckdb-browser.d.ts\",\n    \"jsdelivr\": \"dist/duckdb-browser.cjs\",\n    \"unpkg\": \"dist/duckdb-browser.mjs\",\n    \"sideEffects\": false,\n    \"browser\": {\n        \"fs\": false,\n        \"os\": false,\n        \"path\": false,\n        \"perf_hooks\": false,\n        \"worker_threads\": false\n    },\n    \"exports\": {\n        \"./dist/duckdb-mvp.wasm\": \"./dist/duckdb-mvp.wasm\",\n        \"./dist/duckdb-eh.wasm\": \"./dist/duckdb-eh.wasm\",\n        \"./dist/duckdb-coi.wasm\": \"./dist/duckdb-coi.wasm\",\n        \"./dist/duckdb-browser\": \"./dist/duckdb-browser.mjs\",\n        \"./dist/duckdb-browser.cjs\": \"./dist/duckdb-browser.cjs\",\n        \"./dist/duckdb-browser.mjs\": \"./dist/duckdb-browser.mjs\",\n        \"./dist/duckdb-browser-coi.pthread.worker.js\": \"./dist/duckdb-browser-coi.pthread.worker.js\",\n        \"./dist/duckdb-browser-coi.worker.js\": \"./dist/duckdb-browser-coi.worker.js\",\n        \"./dist/duckdb-browser-eh.worker.js\": \"./dist/duckdb-browser-eh.worker.js\",\n        \"./dist/duckdb-browser-mvp.worker.js\": \"./dist/duckdb-browser-mvp.worker.js\",\n        \"./dist/duckdb-node\": \"./dist/duckdb-node.cjs\",\n        \"./dist/duckdb-node.cjs\": \"./dist/duckdb-node.cjs\",\n        \"./dist/duckdb-node-blocking\": \"./dist/duckdb-node-blocking.cjs\",\n        \"./dist/duckdb-node-blocking.cjs\": \"./dist/duckdb-node-blocking.cjs\",\n        \"./dist/duckdb-node-eh.worker.cjs\": \"./dist/duckdb-node-eh.worker.cjs\",\n        \"./dist/duckdb-node-mvp.worker.cjs\": \"./dist/duckdb-node-mvp.worker.cjs\",\n        \"./blocking\": {\n            \"node\": {\n                \"types\": \"./dist/duckdb-node-blocking.d.ts\",\n                \"require\": \"./dist/duckdb-node-blocking.cjs\",\n                \"import\": \"./dist/duckdb-node-blocking.cjs\"\n            },\n            \"types\": \"./dist/duckdb-node-blocking.d.ts\",\n            \"import\": \"./dist/duckdb-node-blocking.mjs\",\n            \"require\": \"./dist/duckdb-node-blocking.cjs\"\n        },\n        \".\": {\n            \"browser\": {\n                \"types\": \"./dist/duckdb-browser.d.ts\",\n                \"import\": \"./dist/duckdb-browser.mjs\",\n                \"require\": \"./dist/duckdb-browser.cjs\"\n            },\n            \"node\": {\n                \"types\": \"./dist/duckdb-node.d.ts\",\n                \"import\": \"./dist/duckdb-node.cjs\",\n                \"require\": \"./dist/duckdb-node.cjs\"\n            },\n            \"types\": \"./dist/duckdb-browser.d.ts\",\n            \"import\": \"./dist/duckdb-browser.mjs\",\n            \"require\": \"./dist/duckdb-browser.cjs\"\n        }\n    }\n}\n", "import config from '../package.json';\n\nexport const PACKAGE_NAME = config.name;\nexport const PACKAGE_VERSION = config.version;\n\nconst VERSION_PARTS = config.version.split('.');\nexport const PACKAGE_VERSION_MAJOR = VERSION_PARTS[0];\nexport const PACKAGE_VERSION_MINOR = VERSION_PARTS[1];\nexport const PACKAGE_VERSION_PATCH = VERSION_PARTS[2];\n", "import * as check from 'wasm-feature-detect';\nimport { PACKAGE_NAME, PACKAGE_VERSION } from './version';\n\n// Platform check taken from here:\n// https://github.com/xtermjs/xterm.js/blob/master/src/common/Platform.ts#L21\n\ninterface INavigator {\n    userAgent: string;\n    language: string;\n    platform: string;\n}\n\n// We're declaring a navigator global here as we expect it in all runtimes (node and browser), but\n// we want this module to live in common.\ndeclare const navigator: INavigator;\n\nexport const isNode = () => (typeof navigator === 'undefined' ? true : false);\nconst userAgent = () => (isNode() ? 'node' : navigator.userAgent);\nexport const isFirefox = () => userAgent().includes('Firefox');\nexport const isSafari = () => /^((?!chrome|android).)*safari/i.test(userAgent());\n\n/** Bundles have different characteristics:\n * - MVP: minimum viable product (uses features from first stable version of WebAssembly standard)\n * - EH: exception handling\n * - COI: cross origin isolation\n */\nexport interface DuckDBBundles {\n    mvp: {\n        mainModule: string;\n        mainWorker: string;\n    };\n    eh?: {\n        mainModule: string;\n        mainWorker: string;\n    };\n    coi?: {\n        mainModule: string;\n        mainWorker: string;\n        pthreadWorker: string;\n    };\n}\n\nexport function getJsDelivrBundles(): DuckDBBundles {\n    const jsdelivr_dist_url = `https://cdn.jsdelivr.net/npm/${PACKAGE_NAME}@${PACKAGE_VERSION}/dist/`;\n    return {\n        mvp: {\n            mainModule: `${jsdelivr_dist_url}duckdb-mvp.wasm`,\n            mainWorker: `${jsdelivr_dist_url}duckdb-browser-mvp.worker.js`,\n        },\n        eh: {\n            mainModule: `${jsdelivr_dist_url}duckdb-eh.wasm`,\n            mainWorker: `${jsdelivr_dist_url}duckdb-browser-eh.worker.js`,\n        },\n        // COI is still experimental, let the user opt in explicitly\n    };\n}\n\nexport interface DuckDBBundle {\n    mainModule: string;\n    mainWorker: string | null;\n    pthreadWorker: string | null;\n}\n\nexport interface PlatformFeatures {\n    bigInt64Array: boolean;\n    crossOriginIsolated: boolean;\n    wasmExceptions: boolean;\n    wasmSIMD: boolean;\n    wasmBulkMemory: boolean;\n    wasmThreads: boolean;\n}\n\nlet bigInt64Array: boolean | null = null;\nlet wasmExceptions: boolean | null = null;\nlet wasmThreads: boolean | null = null;\nlet wasmSIMD: boolean | null = null;\nlet wasmBulkMemory: boolean | null = null;\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\ndeclare namespace globalThis {\n    let crossOriginIsolated: boolean;\n}\n\nexport async function getPlatformFeatures(): Promise<PlatformFeatures> {\n    if (bigInt64Array == null) {\n        bigInt64Array = typeof BigInt64Array != 'undefined';\n    }\n    if (wasmExceptions == null) {\n        wasmExceptions = await check.exceptions();\n    }\n    if (wasmThreads == null) {\n        wasmThreads = await check.threads();\n    }\n    if (wasmSIMD == null) {\n        wasmSIMD = await check.simd();\n    }\n    if (wasmBulkMemory == null) {\n        wasmBulkMemory = await check.bulkMemory();\n    }\n    return {\n        bigInt64Array: bigInt64Array!,\n        crossOriginIsolated: isNode() || globalThis.crossOriginIsolated || false,\n        wasmExceptions: wasmExceptions!,\n        wasmSIMD: wasmSIMD!,\n        wasmThreads: wasmThreads!,\n        wasmBulkMemory: wasmBulkMemory!,\n    };\n}\n\nexport async function selectBundle(bundles: DuckDBBundles): Promise<DuckDBBundle> {\n    const platform = await getPlatformFeatures();\n    if (platform.wasmExceptions) {\n        if (platform.wasmSIMD && platform.wasmThreads && platform.crossOriginIsolated && bundles.coi) {\n            return {\n                mainModule: bundles.coi.mainModule,\n                mainWorker: bundles.coi.mainWorker,\n                pthreadWorker: bundles.coi.pthreadWorker,\n            };\n        }\n        if (bundles.eh) {\n            return {\n                mainModule: bundles.eh.mainModule,\n                mainWorker: bundles.eh.mainWorker,\n                pthreadWorker: null,\n            };\n        }\n    }\n    return {\n        mainModule: bundles.mvp.mainModule,\n        mainWorker: bundles.mvp.mainWorker,\n        pthreadWorker: null,\n    };\n}\n", "import Worker from 'web-worker';\n\nexport async function createWorker(url: string) {\n    const request = new Request(url);\n    const workerScript = await fetch(request);\n    const workerURL = URL.createObjectURL(await workerScript.blob());\n    return new Worker(workerURL);\n}\n"],
  "mappings": "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",
  "names": ["require_flechette", "__commonJSMin", "exports", "MAGIC", "EOS", "Version", "Endianness", "MessageHeader", "Type", "Precision", "DateUnit", "TimeUnit", "IntervalUnit", "UnionMode", "uint8Array", "uint16Array", "uint32Array", "uint64Array", "int8Array", "int16Array", "int32Array", "int64Array", "float32Array", "float64Array", "isArrayBufferLike", "data", "intArrayType", "bitWidth", "signed", "i", "TypedArray", "isTypedArray", "value", "isArray", "isInt64ArrayType", "bisect", "offsets", "index", "a", "b", "mid", "align64", "length", "bpe", "align", "array", "alignedLength", "resize", "newLength", "offset", "newArray", "grow", "shift", "isDate", "isIterable", "check", "test", "message", "checkOneOf", "set", "keyFor", "object", "key", "val", "invalidDataType", "typeId", "field", "name", "type", "nullable", "metadata", "isField", "isDataType", "asField", "defaultName", "defaultNullable", "basicType", "dictionary", "indexType", "ordered", "id", "int32", "nullType", "int", "int8", "int16", "int64", "uint8", "uint16", "uint32", "uint64", "float", "precision", "float16", "float32", "float64", "binary", "utf8", "bool", "decimal", "scale", "decimal32", "decimal64", "decimal128", "decimal256", "date", "unit", "dateDay", "dateMillisecond", "time", "timeSecond", "timeMillisecond", "timeMicrosecond", "timeNanosecond", "timestamp", "timezone", "interval", "list", "child", "struct", "children", "union", "mode", "typeIds", "typeIdForValue", "v", "m", "fixedSizeBinary", "stride", "fixedSizeList", "mapType", "keysSorted", "map", "keyField", "valueField", "duration", "largeBinary", "largeUtf8", "largeList", "runEndEncoded", "runsField", "valuesField", "binaryView", "utf8View", "listView", "largeListView", "f64", "buf", "i64", "u32", "i32", "u8", "identity", "toBigInt", "toOffset", "toDateDay", "toTimestamp", "toMonthDayNanoBytes", "d", "n", "toNumber", "divide", "num", "div", "toDecimal32", "toDecimal", "asUint64", "fromDecimal64", "fromDecimal128", "x", "fromDecimal256", "toFloat16", "sign", "expo", "sigf", "textDecoder", "textEncoder", "decodeUtf8", "encodeUtf8", "str", "keyString", "objectKey", "s", "k", "SIZEOF_INT", "SIZEOF_SHORT", "decodeBit", "bitmap", "readObject", "pos", "readInt32", "vtable", "size", "readInt16", "read", "fallback", "off", "readOffset", "readBoolean", "readInt8", "readUint8", "readUint16", "readUint32", "readInt64", "readString", "readVector", "extract", "base", "_", "RowIndex", "proxyFactory", "names", "batches", "RowObject", "structObject", "proto", "batch", "objectFactory", "obj", "isDirectBatch", "DirectBatch", "Batch", "nullCount", "validity", "values", "sizes", "start", "end", "options", "NumberBatch", "ArrayBatch", "NullBatch", "Int64Batch", "Float16Batch", "BoolBatch", "Decimal32NumberBatch", "DecimalBatch", "DecimalNumberBatch", "DecimalBigIntBatch", "DateBatch", "DateDayBatch", "DateDayMillisecondBatch", "TimestampSecondBatch", "TimestampMillisecondBatch", "TimestampMicrosecondBatch", "TimestampNanosecondBatch", "IntervalDayTimeBatch", "IntervalMonthDayNanoBatch", "offset32", "offset64", "BinaryBatch", "LargeBinaryBatch", "Utf8Batch", "LargeUtf8Batch", "ListBatch", "LargeListBatch", "ListViewBatch", "LargeListViewBatch", "FixedBatch", "FixedBinaryBatch", "FixedListBatch", "pairs", "keys", "vals", "entries", "MapEntryBatch", "MapBatch", "SparseUnionBatch", "typeMap", "DenseUnionBatch", "StructBatch", "factory", "StructProxyBatch", "RunEndEncodedBatch", "runs", "DictionaryBatch", "ViewBatch", "BinaryViewBatch", "Utf8ViewBatch", "columnBuilder", "Column", "_a", "batchedIterator", "copy", "ArrayType", "copyArray", "extractArray", "iter", "next", "j", "Table", "_Table", "schema", "useProxy", "f", "gen", "indices", "as", "fields", "renameField", "all", "cols", "getFactory", "numRows", "output", "row", "batchType", "useBigInt", "useDate", "useDecimalInt", "useMap", "wrap", "BaseClass", "WrapperClass", "decodeBlock", "decodeBlocks", "decodeRecordBatch", "version", "get", "decodeDictionaryBatch", "decodeDataType", "decodeMetadata", "decodeSchema", "decodeSchemaFields", "fieldsOffset", "decodeField", "typeOffset", "dict", "decodeDictionary", "decodeFieldChildren", "fieldOffset", "decodeInt", "invalidMessageMetadata", "expected", "actual", "invalidMessageBodyLength", "invalidMessageType", "decodeMessage", "metadataLength", "head", "bodyLength", "content", "decoder", "body", "decodeIPC", "source", "isArrowFileFormat", "decodeIPCFile", "decodeIPCStream", "stream", "records", "dictionaries", "dicts", "recs", "tableFromIPC", "createTable", "dictionaryMap", "context", "contextGenerator", "dictionaryTypes", "visitSchemaFields", "isDelta", "visit$1", "ctx", "c", "visitor", "visitField", "_b", "_c", "nodes", "regions", "variadic", "nodeIndex", "bufferIndex", "variadicIndex", "node", "buffer", "BatchType", "writeInt32", "INIT_SIZE", "Builder", "sink", "prep", "numFields", "addFields", "objectBuilder", "items", "itemSize", "alignment", "writeItem", "rootOffset", "bytes", "pad", "byteCount", "builder", "additionalBytes", "space", "minalign", "bufSize", "used", "alignSize", "startOffset", "slot", "defaultValue", "vtableOffset", "standardFields", "len", "existingTable", "vtables", "vt1", "outer_loop", "vt2", "encodeRecordBatch", "nodeVector", "regionVector", "region", "variadicVector", "count", "encodeDictionaryBatch", "dictionaryBatch", "dataOffset", "encodeMetadata", "encodeDataType", "encodeDictionary", "encodeInt", "encodeFloat", "encodeDecimal", "encodeDate", "encodeTime", "encodeTimestamp", "encodeInterval", "encodeDuration", "encodeFixedSize", "encodeMap", "encodeUnion", "timezoneOffset", "typeIdsOffset", "isLittleEndian", "encodeSchema", "fieldOffsets", "encodeField", "fieldsVectorOffset", "metadataOffset", "dictionaryOffset", "childOffsets", "childrenVectorOffset", "nameOffset", "writeFooter", "dictBlocks", "recordBlocks", "recsOffset", "encodeBlock", "dictsOffset", "schemaOffset", "writeMessage", "headerType", "headerOffset", "blocks", "prefixSize", "messageSize", "alignedSize", "Sink", "MemorySink", "bufs", "sum", "STREAM", "FILE", "encodeIPC", "format", "file", "writeBuffers", "buffers", "tableToIPC", "table", "columns", "checkBatchLengths", "idMap", "assembleDictionaryBatches", "assembleRecordBatches", "assembleSchema", "assembleContext", "byteLength", "visit", "dictMap", "dictionaryColumn", "assembleRecordBatch", "col", "visitDictionaries", "visitDictType", "visitFields", "parentType", "batchIndex", "column", "arrayType", "Buffer", "Bitmap", "BatchBuilder", "ValidityBuilder", "isValid", "dictionaryContext", "dictionaryValues", "valueType", "DictionaryBuilder", "inferType", "profile", "profiler", "boolCount", "numberCount", "intCount", "bigintCount", "dateCount", "dayCount", "stringCount", "arrayCount", "structCount", "min", "max", "minLength", "maxLength", "minBigInt", "maxBigInt", "arrayProfile", "structProfiles", "valid", "intType", "bigintType", "unionType", "BinaryBuilder", "BoolBuilder", "DecimalBuilder", "FixedSizeBinaryBuilder", "FixedSizeListBuilder", "IntervalDayTimeBuilder", "IntervalMonthDayNanoBuilder", "AbstractListBuilder", "offsetType", "ListBuilder", "AbstractStructBuilder", "StructBuilder", "setters", "MapBuilder", "MapStructBuilder", "keyValuePair", "NO_VALUE", "RunEndEncodedBuilder", "AbstractUnionBuilder", "lookup", "SparseUnionBuilder", "DenseUnionBuilder", "Utf8Builder", "DirectBuilder", "Int64Builder", "TransformBuilder", "transform", "builderContext", "columnFromValues", "callback", "maxBatchRows", "opt", "nullBatches", "limit", "numBatches", "rem", "columnFromArray", "columnFromTypedArray", "typeForTypedArray", "add", "idx", "tableFromColumns", "tableFromArrays", "types", "require_node", "__commonJSMin", "exports", "module", "URL", "VM", "threads", "WORKER", "EVENTS", "EventTarget", "event", "err", "list", "handler", "type", "fn", "events", "index", "Event", "target", "mainThread", "workerThread", "baseUrl", "Worker", "url", "options", "name", "mod", "worker", "data", "error", "transferList", "self", "q", "flush", "buffered", "WorkerGlobalScope", "proto", "isDataUrl", "evaluateDataUrl", "parseDataUrl", "m", "encoding", "duckdb_exports", "__export", "AsyncDuckDB", "AsyncDuckDBConnection", "AsyncDuckDBDispatcher", "AsyncPreparedStatement", "AsyncResultStreamIterator", "ConsoleLogger", "DuckDBAccessMode", "DuckDBDataProtocol", "IsArrowBuffer", "IsDuckDBWasmRetry", "LogEvent", "LogLevel", "LogOrigin", "LogTopic", "PACKAGE_NAME", "PACKAGE_VERSION", "PACKAGE_VERSION_MAJOR", "PACKAGE_VERSION_MINOR", "PACKAGE_VERSION_PATCH", "StatusCode", "TokenType", "VoidLogger", "WorkerRequestType", "WorkerResponseType", "WorkerTask", "createWorker", "getJsDelivrBundles", "getLogEventLabel", "getLogLevelLabel", "getLogOriginLabel", "getLogTopicLabel", "getPlatformFeatures", "isFirefox", "isNode", "isSafari", "selectBundle", "__toCommonJS", "DuckDBAccessMode", "TokenType", "LogLevel", "LogTopic", "LogEvent", "LogOrigin", "VoidLogger", "_entry", "ConsoleLogger", "level", "entry", "getLogLevelLabel", "getLogEventLabel", "event", "getLogTopicLabel", "topic", "getLogOriginLabel", "origin", "StatusCode", "IsArrowBuffer", "status", "IsDuckDBWasmRetry", "import_flechette", "AsyncDuckDBConnection", "bindings", "conn", "callback", "text", "buffer", "allowStreamResult", "header", "AsyncResultStreamIterator", "query", "stmt", "AsyncPreparedStatement", "options", "db", "connectionId", "statementId", "params", "WorkerRequestType", "WorkerResponseType", "WorkerTask", "type", "data", "resolve", "reject", "REGEX_OPFS_FILE", "REGEX_OPFS_PROTOCOL", "isOPFSProtocol", "path", "searchOPFSFiles", "text", "match", "TEXT_ENCODER", "AsyncDuckDB", "logger", "worker", "resolve", "_reject", "task", "transfer", "mid", "event", "_a", "response", "p", "e", "WorkerTask", "name", "names", "mainModuleURL", "pthreadWorkerURL", "progress", "_p", "config", "text", "cid", "AsyncDuckDBConnection", "conn", "files", "allowStreamResult", "statement", "params", "path", "buffer", "url", "proto", "directIO", "handle", "protocol", "enable", "options", "isOPFSProtocol", "searchOPFSFiles", "result", "file", "TextDecoderWrapper", "decoder", "data", "decodeText", "DuckDBDataProtocol", "AsyncDuckDBDispatcher", "entry", "request", "e", "obj", "p", "path", "conn", "_", "c", "result", "transfer", "infos", "buffer", "bulkMemory", "exceptions", "simd", "threads", "e", "package_default", "PACKAGE_NAME", "package_default", "PACKAGE_VERSION", "VERSION_PARTS", "PACKAGE_VERSION_MAJOR", "PACKAGE_VERSION_MINOR", "PACKAGE_VERSION_PATCH", "isNode", "userAgent", "isFirefox", "isSafari", "getJsDelivrBundles", "jsdelivr_dist_url", "PACKAGE_NAME", "PACKAGE_VERSION", "bigInt64Array", "wasmExceptions", "wasmThreads", "wasmSIMD", "wasmBulkMemory", "getPlatformFeatures", "exceptions", "threads", "simd", "bulkMemory", "selectBundle", "bundles", "platform", "import_web_worker", "createWorker", "url", "request", "workerScript", "workerURL", "Worker"]
}
